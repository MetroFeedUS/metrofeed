<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Route 45 ‚Äì NEW ALBANY | MetroFeed Portland</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background-color: #0d0d0d;
      color: #cccccc;
    }
    header {
      background-color: #0d0d0d;
      border-bottom: 3px solid #4dd0e1;
      padding: 1rem;
      text-align: center;
    }
    header img {
      max-height: 60px;
    }
    .ad-banner {
      text-align: center;
      margin: 1rem auto;
      background-color: #222;
      color: #888;
      padding: 1rem;
      border: 2px dashed #4dd0e1;
      font-size: 0.9rem;
      border-radius: 8px;
    }
    h1 {
      text-align: center;
      margin: 1rem 0;
      font-size: 2rem;
      color: #f0f0f0;
    }
    .content-box {
      border: 2px solid #4dd0e1;
      border-radius: 12px;
      padding: 1rem;
      margin: 1rem;
      background-color: #1e1e1e;
    }
    #map {
      width: 100%;
      height: 400px;
      border-radius: 8px;
    }
    .button-bar {
      display: flex;
      justify-content: center;
      margin: 1rem 0;
    }
    .button-bar a {
      background: #4dd0e1;
      color: #0d0d0d;
      padding: 0.5rem 1rem;
      text-decoration: none;
      border-radius: 8px;
      font-weight: bold;
    }

.back-button {
  background-color: #4dd0e1;
  color: #0d0d0d;
  border: none;
  padding: 0.6rem 1.2rem;
  font-size: 1rem;
  font-weight: bold;
  border-radius: 8px;
  cursor: pointer;
  box-shadow: 0 0 10px #4dd0e1;
  text-decoration: none;
}
.back-button:hover {
  background-color: #35c0d6;
}
.site-footer {
      text-align: center;
      margin-top: 3rem;
      margin-bottom: 120px;
      font-size: 0.85rem;
      color: #aaa;
    }
    .site-footer a {
      color: #00BFFF;
      text-decoration: none;
    }
    .site-footer a:hover {
      text-decoration: underline;
    }

  </style>
</head>
<body>
  <header>
    <img src="MetroFeedPortlandLogo.png" alt="MetroFeed Portland">
  </header>

  <div class="ad-banner">
    [Ad Banner Placeholder ‚Äî 300x250]
  </div>

  <div class="disclaimer" style="margin: 1rem auto 0.5rem; max-width: 600px; font-size: 0.8rem; color: #bbb; text-align: center; padding: 0.5rem 1rem; background-color: #111; border: 1px dashed #444; border-radius: 6px;">
    ‚ö†Ô∏è This is a Beta program, work in progress. Please REPORT bugs and pretend to be impressed.
  </div>
  <div class="disclaimer" style="margin: 0 auto 1rem; max-width: 600px; font-size: 0.75rem; color: #888; text-align: center; padding: 0.25rem 1rem;">
    This tool is not affiliated with or endorsed by TriMet. For official schedules and service alerts, visit <a href="https://trimet.org" style="color:#4dd0e1;">trimet.org</a>.
  </div>

  <div style="margin: 2rem 0; text-align: center;">
  <button class="back-button" onclick="history.back()">‚¨Ö Back</button>
  </div>

  <h1>Route 45 ‚Äì NEW ALBANY</h1>

  <div class="content-box">
    <div id="map"></div>
    <div style="text-align:right; font-size: 0.7rem; color: #777; margin-top: 0.5rem;">
      Data courtesy of TriMet.
    </div>
  </div>

  
  <script>
  const apiKey = "2C4447D4A42083BCD84DE3B8E";
  const routeNumber = 45;
  const direction = parseInt(0);

  const map = L.map('map').setView([45.6, -122.7], 12);
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    maxZoom: 19
  }).addTo(map);

  const shapeOutbound = [
  [39.956235, -82.998909],
  [39.957556, -82.999183],
  [39.95754, -82.99928],
  [39.95748, -82.999749],
  [39.95819, -82.999879],
  [39.95872, -82.99998],
  [39.95881, -83.0],
  [39.958849, -83.000009],
  [39.95892, -83.00003],
  [39.95943, -83.000139],
  [39.96017, -83.0003],
  [39.961009, -83.00045],
  [39.96116, -83.00048],
  [39.96131, -83.000509],
  [39.961469, -83.00054],
  [39.96221, -83.000679],
  [39.96293, -83.000819],
  [39.963629, -83.000949],
  [39.96411, -83.001039],
  [39.964259, -83.00107],
  [39.96494, -83.001189],
  [39.965069, -83.00026],
  [39.96509, -83.00008],
  [39.96511, -82.999879],
  [39.96518, -82.999339],
  [39.9652, -82.999149],
  [39.965219, -82.999],
  [39.965239, -82.99887],
  [39.965249, -82.998749],
  [39.96528, -82.998529],
  [39.96538, -82.997639],
  [39.965409, -82.99739],
  [39.965499, -82.996739],
  [39.965519, -82.996549],
  [39.96554, -82.99635],
  [39.96556, -82.99607],
  [39.96557, -82.99589],
  [39.965579, -82.99577],
  [39.965619, -82.995419],
  [39.965679, -82.994889],
  [39.965779, -82.99406],
  [39.96581, -82.99378],
  [39.96583, -82.993569],
  [39.96592, -82.992849],
  [39.965939, -82.99269],
  [39.966, -82.99217],
  [39.966069, -82.991559],
  [39.966139, -82.991019],
  [39.966149, -82.99091],
  [39.96621, -82.99046],
  [39.966239, -82.990209],
  [39.96635, -82.989269],
  [39.96639, -82.988889],
  [39.966409, -82.988719],
  [39.96647, -82.98824],
  [39.96654, -82.987589],
  [39.966589, -82.98717],
  [39.966599, -82.987059],
  [39.966609, -82.98694],
  [39.966689, -82.98623],
  [39.966699, -82.98618],
  [39.96674, -82.985829],
  [39.966779, -82.985479],
  [39.966789, -82.985349],
  [39.966849, -82.984939],
  [39.966879, -82.98456],
  [39.96689, -82.984449],
  [39.966939, -82.984039],
  [39.966959, -82.98389],
  [39.96698, -82.983719],
  [39.967, -82.983589],
  [39.967029, -82.98334],
  [39.967039, -82.9832],
  [39.967059, -82.98302],
  [39.96709, -82.98272],
  [39.96728, -82.982739],
  [39.96745, -82.982769],
  [39.96755, -82.9828],
  [39.9677, -82.98285],
  [39.9679, -82.982959],
  [39.968119, -82.983099],
  [39.96828, -82.983179],
  [39.96842, -82.983219],
  [39.968639, -82.98326],
  [39.968919, -82.98334],
  [39.96933, -82.98339],
  [39.96969, -82.98342],
  [39.970009, -82.98343],
  [39.970209, -82.98343],
  [39.970649, -82.98339],
  [39.971279, -82.983229],
  [39.971719, -82.98308],
  [39.97212, -82.98293],
  [39.972539, -82.982769],
  [39.97292, -82.98263],
  [39.973249, -82.98252],
  [39.973609, -82.982419],
  [39.97409, -82.98225],
  [39.974529, -82.982229],
  [39.974869, -82.98221],
  [39.974959, -82.982199],
  [39.97519, -82.982149],
  [39.97548, -82.982059],
  [39.97564, -82.982009],
  [39.975789, -82.98195],
  [39.975879, -82.98191],
  [39.97601, -82.981839],
  [39.976149, -82.98176],
  [39.97634, -82.98163],
  [39.97647, -82.981529],
  [39.976579, -82.981439],
  [39.97681, -82.98123],
  [39.97701, -82.98101],
  [39.97719, -82.980799],
  [39.977379, -82.980539],
  [39.977489, -82.98038],
  [39.977589, -82.980179],
  [39.97772, -82.97992],
  [39.977829, -82.97965],
  [39.977919, -82.979369],
  [39.978009, -82.979039],
  [39.978089, -82.9787],
  [39.97814, -82.978359],
  [39.97817, -82.97803],
  [39.978199, -82.97757],
  [39.978209, -82.97726],
  [39.97823, -82.976879],
  [39.97825, -82.976569],
  [39.978289, -82.97641],
  [39.978299, -82.975629],
  [39.978309, -82.975259],
  [39.978359, -82.974459],
  [39.978399, -82.97397],
  [39.97844, -82.973509],
  [39.9785, -82.973139],
  [39.978569, -82.972889],
  [39.978629, -82.972239],
  [39.978659, -82.97195],
  [39.978669, -82.97187],
  [39.978809, -82.970889],
  [39.97897, -82.96984],
  [39.97914, -82.9688],
  [39.979209, -82.968369],
  [39.97926, -82.96809],
  [39.979629, -82.96587],
  [39.97976, -82.96508],
  [39.979929, -82.96404],
  [39.98007, -82.963149],
  [39.980349, -82.961439],
  [39.98043, -82.96088],
  [39.980449, -82.96067],
  [39.9805, -82.960239],
  [39.980559, -82.959609],
  [39.98061, -82.958879],
  [39.980639, -82.95774],
  [39.980619, -82.95665],
  [39.98059, -82.954689],
  [39.9806, -82.95355],
  [39.98066, -82.952489],
  [39.98067, -82.952369],
  [39.98069, -82.952039],
  [39.980739, -82.951419],
  [39.98077, -82.95085],
  [39.98078, -82.95044],
  [39.98079, -82.95013],
  [39.980809, -82.9481],
  [39.980819, -82.947099],
  [39.98086, -82.945889],
  [39.980899, -82.944799],
  [39.98094, -82.9442],
  [39.98097, -82.943819],
  [39.981009, -82.943449],
  [39.98104, -82.943269],
  [39.981099, -82.94298],
  [39.981159, -82.942719],
  [39.98124, -82.942449],
  [39.981339, -82.94217],
  [39.98147, -82.94186],
  [39.981639, -82.941519],
  [39.981729, -82.94135],
  [39.981799, -82.94123],
  [39.98195, -82.941009],
  [39.98203, -82.94091],
  [39.98211, -82.94081],
  [39.98229, -82.940619],
  [39.982439, -82.940479],
  [39.98256, -82.94037],
  [39.982869, -82.940119],
  [39.98303, -82.94001],
  [39.9833, -82.93986],
  [39.98358, -82.93973],
  [39.983859, -82.93961],
  [39.98445, -82.939389],
  [39.98536, -82.939079],
  [39.985579, -82.938999],
  [39.986139, -82.938819],
  [39.98678, -82.93862],
  [39.98734, -82.938459],
  [39.98771, -82.93835],
  [39.98822, -82.9382],
  [39.9885, -82.93811],
  [39.98878, -82.938009],
  [39.988909, -82.937959],
  [39.98915, -82.937859],
  [39.98934, -82.937769],
  [39.989619, -82.937639],
  [39.98985, -82.937519],
  [39.990179, -82.937339],
  [39.99039, -82.93721],
  [39.99065, -82.93704],
  [39.990909, -82.93686],
  [39.991229, -82.93663],
  [39.991449, -82.936469],
  [39.991719, -82.93623],
  [39.992149, -82.935849],
  [39.99326, -82.934889],
  [39.99383, -82.934399],
  [39.994049, -82.93421],
  [39.99428, -82.933999],
  [39.994329, -82.933949],
  [39.99464, -82.93366],
  [39.994929, -82.933319],
  [39.995129, -82.933059],
  [39.995319, -82.932779],
  [39.9957, -82.93221],
  [39.996389, -82.93119],
  [39.996669, -82.93077],
  [39.99698, -82.93028],
  [39.99762, -82.92929],
  [39.998809, -82.927429],
  [39.99948, -82.926399],
  [40.000409, -82.924959],
  [40.00084, -82.92429],
  [40.00101, -82.92402],
  [40.001799, -82.92277],
  [40.001969, -82.922469],
  [40.00211, -82.922199],
  [40.002429, -82.92161],
  [40.002509, -82.92147],
  [40.002869, -82.920819],
  [40.003409, -82.91984],
  [40.00445, -82.91795],
  [40.005109, -82.916719],
  [40.005449, -82.916089],
  [40.005559, -82.91588],
  [40.00561, -82.91579],
  [40.00659, -82.914],
  [40.007459, -82.91241],
  [40.007539, -82.912259],
  [40.00797, -82.91147],
  [40.008269, -82.91094],
  [40.0084, -82.910729],
  [40.008629, -82.910379],
  [40.009519, -82.909079],
  [40.00984, -82.9086],
  [40.009889, -82.908519],
  [40.010079, -82.9082],
  [40.010229, -82.90793],
  [40.010339, -82.907709],
  [40.01037, -82.90766],
  [40.01047, -82.907449],
  [40.010609, -82.907139],
  [40.01074, -82.906819],
  [40.01085, -82.906509],
  [40.010959, -82.9062],
  [40.01112, -82.90577],
  [40.01127, -82.905289],
  [40.011579, -82.90446],
  [40.011789, -82.90392],
  [40.01191, -82.90365],
  [40.012029, -82.903389],
  [40.01216, -82.90314],
  [40.012219, -82.903039],
  [40.012309, -82.902899],
  [40.01256, -82.902539],
  [40.012739, -82.90225],
  [40.01297, -82.902049],
  [40.013029, -82.901999],
  [40.01353, -82.90172],
  [40.013729, -82.90162],
  [40.013919, -82.90154],
  [40.01405, -82.901499],
  [40.01425, -82.90145],
  [40.014459, -82.90144],
  [40.01479, -82.90144],
  [40.014929, -82.90145],
  [40.01506, -82.901469],
  [40.01516, -82.90149],
  [40.015299, -82.90153],
  [40.015379, -82.901549],
  [40.01549, -82.901589],
  [40.01558, -82.901609],
  [40.01568, -82.901639],
  [40.015739, -82.90166],
  [40.015809, -82.901699],
  [40.01586, -82.901729],
  [40.016019, -82.90184],
  [40.01616, -82.90194],
  [40.01641, -82.902129],
  [40.01669, -82.902359],
  [40.01756, -82.90306],
  [40.01767, -82.90315],
  [40.018059, -82.903439],
  [40.018339, -82.903629],
  [40.01858, -82.903759],
  [40.01875, -82.903839],
  [40.01891, -82.903899],
  [40.01901, -82.903929],
  [40.01921, -82.903979],
  [40.01946, -82.904019],
  [40.019709, -82.904029],
  [40.019979, -82.904019],
  [40.02038, -82.90401],
  [40.020669, -82.903989],
  [40.02084, -82.903979],
  [40.020949, -82.903979],
  [40.021029, -82.904],
  [40.02146, -82.90397],
  [40.02242, -82.903889],
  [40.022549, -82.90388],
  [40.02308, -82.903839],
  [40.025559, -82.90364],
  [40.026249, -82.903569],
  [40.02829, -82.90341],
  [40.02953, -82.90332],
  [40.03007, -82.90328],
  [40.030739, -82.90323],
  [40.031499, -82.903169],
  [40.031639, -82.90316],
  [40.03263, -82.90307],
  [40.03315, -82.903029],
  [40.033559, -82.902999],
  [40.03443, -82.902949],
  [40.036049, -82.902819],
  [40.03676, -82.902769],
  [40.03749, -82.902729],
  [40.038129, -82.9027],
  [40.03891, -82.902639],
  [40.0399, -82.90257],
  [40.04217, -82.90239],
  [40.044629, -82.90221],
  [40.046679, -82.902059],
  [40.047139, -82.90203],
  [40.048019, -82.901969],
  [40.048059, -82.901969],
  [40.04873, -82.90194],
  [40.04924, -82.901949],
  [40.049769, -82.901959],
  [40.050289, -82.90198],
  [40.050819, -82.902009],
  [40.051359, -82.902049],
  [40.051899, -82.902099],
  [40.052439, -82.90216],
  [40.05314, -82.902279],
  [40.05357, -82.90235],
  [40.053989, -82.9023],
  [40.05439, -82.902319],
  [40.05465, -82.9023],
  [40.05491, -82.902269],
  [40.055049, -82.902239],
  [40.0553, -82.90216],
  [40.05546, -82.902089],
  [40.05574, -82.901919],
  [40.056059, -82.90171],
  [40.05617, -82.90163],
  [40.056249, -82.90158],
  [40.05639, -82.901509],
  [40.05656, -82.90145],
  [40.0569, -82.901369],
  [40.057129, -82.90136],
  [40.057209, -82.902629],
  [40.057229, -82.903029],
  [40.057239, -82.903259],
  [40.05726, -82.90364],
  [40.05728, -82.904289],
  [40.057299, -82.90459],
  [40.05734, -82.905429],
  [40.05745, -82.90567],
  [40.05755, -82.90721],
  [40.057569, -82.907589],
  [40.057599, -82.90811],
  [40.05762, -82.90842],
  [40.058229, -82.908389],
  [40.058389, -82.908399],
  [40.058559, -82.90841],
  [40.058919, -82.90838],
  [40.05914, -82.908359],
  [40.05944, -82.908339],
  [40.05977, -82.908309],
  [40.060449, -82.908249],
  [40.06051, -82.908249],
  [40.060659, -82.908219],
  [40.06078, -82.908269],
  [40.06087, -82.908349],
  [40.06094, -82.90842],
  [40.060989, -82.90851],
  [40.060829, -82.90877],
  [40.060719, -82.908849],
  [40.0607, -82.909029],
  [40.060719, -82.90946],
  [40.060739, -82.90982],
  [40.06078, -82.909929],
  [40.060839, -82.909979],
  [40.060919, -82.90994],
  [40.06096, -82.909869],
  [40.060979, -82.90963],
  [40.060929, -82.909029],
  [40.060829, -82.90877],
  [40.060989, -82.90851],
  [40.06105, -82.90865],
  [40.061109, -82.908889],
  [40.061109, -82.909119],
  [40.06112, -82.909529],
  [40.06113, -82.91013],
  [40.061269, -82.910139],
  [40.061379, -82.910159],
  [40.0615, -82.910189],
  [40.061539, -82.910199],
  [40.061619, -82.910229],
  [40.061709, -82.91027],
  [40.061969, -82.91044],
  [40.062059, -82.910499],
  [40.062189, -82.91063],
  [40.062329, -82.910789],
  [40.062369, -82.91085],
  [40.06247, -82.91102],
  [40.062539, -82.911139],
  [40.06266, -82.911449],
  [40.062729, -82.91175],
  [40.06277, -82.912029],
  [40.062789, -82.912439],
  [40.062819, -82.91322],
  [40.06285, -82.91385],
  [40.06287, -82.914149],
  [40.062879, -82.91422],
  [40.062899, -82.91436],
  [40.06295, -82.914559],
  [40.06301, -82.91475],
  [40.063059, -82.91489],
  [40.06312, -82.91503],
  [40.0632, -82.9152],
  [40.063239, -82.91529],
  [40.063329, -82.91544],
  [40.063359, -82.91548],
  [40.06355, -82.915729],
  [40.064149, -82.914869],
  [40.06463, -82.914199],
  [40.064769, -82.914009],
  [40.065309, -82.913249],
  [40.065579, -82.91286],
  [40.06643, -82.91165],
  [40.067199, -82.910559],
  [40.06744, -82.910229],
  [40.06808, -82.909339],
  [40.06823, -82.909119],
  [40.06863, -82.908569],
  [40.068999, -82.908039],
  [40.06915, -82.90784],
  [40.069179, -82.907799],
  [40.06933, -82.907589],
  [40.069539, -82.9073],
  [40.069719, -82.907049],
  [40.06997, -82.90667],
  [40.070369, -82.90612],
  [40.070829, -82.9055],
  [40.070979, -82.9053],
  [40.07185, -82.904069],
  [40.072259, -82.90352],
  [40.07331, -82.902089],
  [40.073509, -82.90181],
  [40.073679, -82.90158],
  [40.074479, -82.90049],
  [40.074599, -82.900329],
  [40.07482, -82.90004],
  [40.075199, -82.899519],
  [40.075389, -82.899259],
  [40.07562, -82.89896],
  [40.076219, -82.898179],
  [40.076649, -82.89761],
  [40.077029, -82.897089],
  [40.07717, -82.89694],
  [40.077299, -82.89681],
  [40.077369, -82.89676],
  [40.07752, -82.89663],
  [40.07768, -82.896509],
  [40.077729, -82.89648],
  [40.07798, -82.89632],
  [40.078289, -82.89618],
  [40.078629, -82.896059],
  [40.078839, -82.896019],
  [40.079069, -82.895979],
  [40.07958, -82.895919],
  [40.080059, -82.895889],
  [40.08066, -82.89585],
  [40.08113, -82.89581],
  [40.08122, -82.89567],
  [40.081249, -82.895609],
  [40.08129, -82.895529],
  [40.081339, -82.89542],
  [40.08132, -82.89531],
  [40.08119, -82.89479],
  [40.081079, -82.894349],
  [40.080999, -82.894039],
  [40.08086, -82.89347],
  [40.08069, -82.892699],
  [40.080639, -82.89245],
  [40.080619, -82.892139],
  [40.0805, -82.89158],
  [40.08039, -82.890889],
  [40.080369, -82.890749],
  [40.08033, -82.890429],
  [40.080259, -82.889899],
  [40.08024, -82.88939],
  [40.08024, -82.88921],
  [40.08021, -82.888089],
  [40.08021, -82.88799],
  [40.08021, -82.88766],
  [40.080259, -82.88686],
  [40.08031, -82.886439],
  [40.0804, -82.88552],
  [40.080519, -82.884219],
  [40.080539, -82.88381],
  [40.080549, -82.88336],
  [40.080539, -82.8825],
  [40.08051, -82.881849],
  [40.0804, -82.88123],
  [40.080369, -82.88028],
  [40.080339, -82.879859],
  [40.0803, -82.879099],
  [40.08021, -82.87751],
  [40.080169, -82.87679],
  [40.080089, -82.87556],
  [40.080059, -82.87521],
  [40.079979, -82.87435],
  [40.079889, -82.873469],
  [40.079829, -82.872799],
  [40.079629, -82.870909],
  [40.079559, -82.870049],
  [40.079519, -82.86936],
  [40.07951, -82.86854],
  [40.079529, -82.86768],
  [40.079559, -82.867219],
  [40.07958, -82.866989],
  [40.07966, -82.866269],
  [40.07977, -82.865519],
  [40.079879, -82.864979],
  [40.080059, -82.86423],
  [40.080159, -82.863879],
  [40.080269, -82.863489],
  [40.080549, -82.86266],
  [40.08078, -82.86201],
  [40.08122, -82.86081],
  [40.08157, -82.85986],
  [40.081889, -82.858849],
  [40.08204, -82.85847],
  [40.08256, -82.857149],
  [40.083129, -82.855569],
  [40.083519, -82.854489],
  [40.08373, -82.853899],
  [40.083769, -82.85379],
  [40.08382, -82.853629],
  [40.08399, -82.85315],
  [40.0849, -82.850559],
  [40.08534, -82.849299],
  [40.085769, -82.84821],
  [40.08587, -82.847969],
  [40.086369, -82.846609],
  [40.08707, -82.844669],
  [40.088089, -82.841839],
  [40.08866, -82.840259],
  [40.08896, -82.83938],
  [40.08924, -82.838609],
  [40.090089, -82.83629],
  [40.090689, -82.83461],
  [40.090969, -82.833689],
  [40.091139, -82.83299],
  [40.09128, -82.83231],
  [40.09137, -82.831719],
  [40.091429, -82.831269],
  [40.09148, -82.830759],
  [40.091509, -82.83039],
  [40.091529, -82.82993],
  [40.091529, -82.829689],
  [40.09154, -82.829049],
  [40.091509, -82.82792],
  [40.09145, -82.82675],
  [40.091349, -82.82467],
  [40.0913, -82.82305],
  [40.091259, -82.822179],
  [40.091229, -82.821599],
  [40.09121, -82.82116],
  [40.09119, -82.82076],
  [40.091169, -82.82035],
  [40.091149, -82.819969],
  [40.091149, -82.819879],
  [40.09113, -82.8195],
  [40.0911, -82.818889],
  [40.091059, -82.818259],
  [40.09102, -82.817499],
  [40.091, -82.81683],
  [40.090979, -82.816369],
  [40.090969, -82.8162],
  [40.09093, -82.815199],
  [40.09091, -82.814619],
  [40.09084, -82.813139],
  [40.090789, -82.811949],
  [40.09074, -82.810929],
  [40.09068, -82.80959],
  [40.090619, -82.80821],
  [40.090529, -82.806379],
  [40.0905, -82.80595],
  [40.09046, -82.80554],
  [40.09041, -82.80515],
  [40.09037, -82.804859],
  [40.09032, -82.80455],
  [40.090269, -82.80428],
  [40.09014, -82.80365],
  [40.089979, -82.80294],
  [40.089709, -82.802329],
  [40.089629, -82.802139],
  [40.08942, -82.80176],
  [40.08921, -82.80145],
  [40.089089, -82.80131],
  [40.08905, -82.80126],
  [40.088699, -82.800879],
  [40.088199, -82.80033],
  [40.08778, -82.79978],
  [40.087549, -82.799489],
  [40.087739, -82.79907],
  [40.087889, -82.79874],
  [40.087999, -82.79849],
  [40.08815, -82.7982],
  [40.0884, -82.797699],
  [40.08867, -82.797149],
  [40.08905, -82.796349],
  [40.089189, -82.79605],
  [40.089259, -82.79591],
  [40.08938, -82.795679],
  [40.089539, -82.795349],
  [40.08966, -82.79511],
  [40.089789, -82.79484],
  [40.089909, -82.79457],
  [40.089989, -82.79439],
  [40.090349, -82.793599],
  [40.08995, -82.79326],
  [40.08967, -82.793],
  [40.089459, -82.79276],
  [40.089259, -82.79249],
  [40.08911, -82.79228],
  [40.08884, -82.79183],
  [40.08894, -82.79173],
  [40.089079, -82.791579],
  [40.08922, -82.79132],
  [40.089429, -82.79088],
  [40.08995, -82.789809],
  [40.090429, -82.788829],
  [40.09102, -82.7876]
];

const stopNames = {
  "SOUTER8": "COTA TRANSIT TERMINAL BAY 8",
  "HIGSTANN": "S HIGH ST &amp; E STATE ST",
  "LON4THE": "E LONG ST &amp; N 4TH ST",
  "LONWASE": "E LONG ST &amp; N WASHINGTON AVE",
  "HIGLONN2": "N HIGH ST &amp; E LONG ST",
  "HIGBRONN": "S HIGH ST &amp; E BROAD ST",
  "FORFORE": "NEW ALBANY PARK &amp; RIDE",
  "EASTER5": "EASTON TERMINAL BAY 5"
};

const stops = [
  { stop_id: "SOUTER8", name: "COTA TRANSIT TERMINAL BAY 8", lat: 39.956723, lon: -82.998988, times: ["6:19 AM"] },
  { stop_id: "HIGSTANN", name: "S HIGH ST &amp; E STATE ST", lat: 39.959828, lon: -83.000011, times: ["6:22 AM"] },
  { stop_id: "HIGBRONN", name: "S HIGH ST &amp; E BROAD ST", lat: 39.961674, lon: -83.000405, times: ["6:23 AM"] },
  { stop_id: "HIGLONN2", name: "N HIGH ST &amp; E LONG ST", lat: 39.964416, lon: -83.000956, times: ["6:24 AM"] },
  { stop_id: "LON4THE", name: "E LONG ST &amp; N 4TH ST", lat: 39.965299, lon: -82.996981, times: ["6:24 AM"] },
  { stop_id: "LONWASE", name: "E LONG ST &amp; N WASHINGTON AVE", lat: 39.966475, lon: -82.987289, times: ["6:25 AM"] },
  { stop_id: "EASTER5", name: "EASTON TERMINAL BAY 5", lat: 40.060719, lon: -82.909141, times: ["6:41 AM"] },
  { stop_id: "FORFORE", name: "NEW ALBANY PARK &amp; RIDE", lat: 40.090778, lon: -82.78788, times: ["6:53 AM"] },
]

  const polylineOut = L.polyline(shapeOutbound, {
    color: 'blue',
    weight: 4,
    opacity: 0.7
  }).addTo(map);

  map.fitBounds(polylineOut.getBounds());

  stops.forEach(stop => {
    const marker = L.circleMarker([stop.lat, stop.lon], {
      radius: 6,
      color: '#4dd0e1',
      fillColor: '#4dd0e1',
      fillOpacity: 0.9,
      weight: 1
    });

    const popupContent = `
      <strong>${stop.name}</strong><br>
      ${stop.times && stop.times.length ? stop.times.join("<br>") : "No scheduled times"}
    `;

    marker.bindPopup(popupContent);
    marker.addTo(map);
  });

  let busMarkers = {};

  async function fetchAndDisplay() {
    const res = await fetch(`https://developer.trimet.org/ws/v2/vehicles?route=${routeNumber}&appID=${apiKey}&json=true`);
    const data = await res.json();
    const buses = (data.resultSet.vehicle || []).filter(v =>
      v.routeNumber == routeNumber && v.direction == direction
    );

    Object.values(busMarkers).forEach(m => map.removeLayer(m));
    busMarkers = {};

    if (buses.length === 0) return;

    buses.forEach(bus => {
      if (!bus.latitude || !bus.longitude || !bus.blockID) return;

      const icon = L.divIcon({
        className: '',
        html: `
          <div style="text-align:center;">
            <div style="background:#0071CE;color:#fff;padding:2px 6px;border-radius:6px;font-weight:bold;">${bus.vehicleID}</div>
            <div style="width:0;height:0;border-left:5px solid transparent;border-right:5px solid transparent;border-top:10px solid #00bfff;margin:auto;"></div>
          </div>
        `,
        iconSize: [40, 30],
        iconAnchor: [20, 30]
      });

      const marker = L.marker([bus.latitude, bus.longitude], { icon }).addTo(map);
      busMarkers[bus.vehicleID] = marker;
    });
  }

  fetchAndDisplay();
  setInterval(fetchAndDisplay, 15000);
  </script>

<footer class="site-footer">
  <a href="terms.html">Terms of Use</a> &nbsp;|&nbsp;
  <a href="contact.html">Contact Us</a> &nbsp;|&nbsp;
  <a href="report.html">Report a Problem</a> &nbsp;|&nbsp;
  <a href="privacy.html">Privacy Policy</a>
</footer>

<div id="cookie-banner" style="display: none; position: fixed; bottom: 0; width: 100%; background: #333; color: #fff; text-align: center; padding: 1rem; z-index: 1000; font-size: 0.9rem;">
  üì¢ We use cookies for personalized ads and analytics. By using MetroFeed, you agree to our 
  <a href="privacy.html" style="color: #4dd0e1; text-decoration: underline;">Privacy Policy</a>.
  <button onclick="acceptCookies()" style="margin-left: 1rem; background: #4dd0e1; color: #000; border: none; padding: 0.5rem 1rem; border-radius: 5px; cursor: pointer;">OK</button>
</div>

<script>
  function acceptCookies() {
    localStorage.setItem('cookieConsent', 'true');
    document.getElementById('cookie-banner').style.display = 'none';
  }

  window.onload = function() {
    if (!localStorage.getItem('cookieConsent')) {
      document.getElementById('cookie-banner').style.display = 'block';
    }
  }
</script>


</body>
</html>