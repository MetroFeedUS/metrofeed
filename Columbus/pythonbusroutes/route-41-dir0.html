<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Route 41 – CROSSWOODS-POLARIS | MetroFeed Portland</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background-color: #0d0d0d;
      color: #cccccc;
    }
    header {
      background-color: #0d0d0d;
      border-bottom: 3px solid #4dd0e1;
      padding: 1rem;
      text-align: center;
    }
    header img {
      max-height: 60px;
    }
    .ad-banner {
      text-align: center;
      margin: 1rem auto;
      background-color: #222;
      color: #888;
      padding: 1rem;
      border: 2px dashed #4dd0e1;
      font-size: 0.9rem;
      border-radius: 8px;
    }
    h1 {
      text-align: center;
      margin: 1rem 0;
      font-size: 2rem;
      color: #f0f0f0;
    }
    .content-box {
      border: 2px solid #4dd0e1;
      border-radius: 12px;
      padding: 1rem;
      margin: 1rem;
      background-color: #1e1e1e;
    }
    #map {
      width: 100%;
      height: 400px;
      border-radius: 8px;
    }
    .button-bar {
      display: flex;
      justify-content: center;
      margin: 1rem 0;
    }
    .button-bar a {
      background: #4dd0e1;
      color: #0d0d0d;
      padding: 0.5rem 1rem;
      text-decoration: none;
      border-radius: 8px;
      font-weight: bold;
    }

.back-button {
  background-color: #4dd0e1;
  color: #0d0d0d;
  border: none;
  padding: 0.6rem 1.2rem;
  font-size: 1rem;
  font-weight: bold;
  border-radius: 8px;
  cursor: pointer;
  box-shadow: 0 0 10px #4dd0e1;
  text-decoration: none;
}
.back-button:hover {
  background-color: #35c0d6;
}
.site-footer {
      text-align: center;
      margin-top: 3rem;
      margin-bottom: 120px;
      font-size: 0.85rem;
      color: #aaa;
    }
    .site-footer a {
      color: #00BFFF;
      text-decoration: none;
    }
    .site-footer a:hover {
      text-decoration: underline;
    }

  </style>
</head>
<body>
  <header>
    <img src="MetroFeedPortlandLogo.png" alt="MetroFeed Portland">
  </header>

  <div class="ad-banner">
    [Ad Banner Placeholder — 300x250]
  </div>

  <div class="disclaimer" style="margin: 1rem auto 0.5rem; max-width: 600px; font-size: 0.8rem; color: #bbb; text-align: center; padding: 0.5rem 1rem; background-color: #111; border: 1px dashed #444; border-radius: 6px;">
    ⚠️ This is a Beta program, work in progress. Please REPORT bugs and pretend to be impressed.
  </div>
  <div class="disclaimer" style="margin: 0 auto 1rem; max-width: 600px; font-size: 0.75rem; color: #888; text-align: center; padding: 0.25rem 1rem;">
    This tool is not affiliated with or endorsed by TriMet. For official schedules and service alerts, visit <a href="https://trimet.org" style="color:#4dd0e1;">trimet.org</a>.
  </div>

  <div style="margin: 2rem 0; text-align: center;">
  <button class="back-button" onclick="history.back()">⬅ Back</button>
  </div>

  <h1>Route 41 – CROSSWOODS-POLARIS</h1>

  <div class="content-box">
    <div id="map"></div>
    <div style="text-align:right; font-size: 0.7rem; color: #777; margin-top: 0.5rem;">
      Data courtesy of TriMet.
    </div>
  </div>

  
  <script>
  const apiKey = "2C4447D4A42083BCD84DE3B8E";
  const routeNumber = 41;
  const direction = parseInt(0);

  const map = L.map('map').setView([45.6, -122.7], 12);
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    maxZoom: 19
  }).addTo(map);

  const shapeOutbound = [
  [39.956235, -82.998909],
  [39.957556, -82.999183],
  [39.95754, -82.99928],
  [39.95748, -82.999749],
  [39.95819, -82.999879],
  [39.95872, -82.99998],
  [39.95881, -83.0],
  [39.958849, -83.000009],
  [39.95892, -83.00003],
  [39.95943, -83.000139],
  [39.96017, -83.0003],
  [39.961009, -83.00045],
  [39.96116, -83.00048],
  [39.96131, -83.000509],
  [39.961469, -83.00054],
  [39.96221, -83.000679],
  [39.96293, -83.000819],
  [39.963629, -83.000949],
  [39.96411, -83.001039],
  [39.964259, -83.00107],
  [39.96494, -83.001189],
  [39.965069, -83.00026],
  [39.96509, -83.00008],
  [39.96511, -82.999879],
  [39.96518, -82.999339],
  [39.9652, -82.999149],
  [39.965219, -82.999],
  [39.965239, -82.99887],
  [39.965249, -82.998749],
  [39.96528, -82.998529],
  [39.96538, -82.997639],
  [39.965409, -82.99739],
  [39.965499, -82.996739],
  [39.965519, -82.996549],
  [39.96554, -82.99635],
  [39.96556, -82.99607],
  [39.96557, -82.99589],
  [39.965579, -82.99577],
  [39.965619, -82.995419],
  [39.965679, -82.994889],
  [39.965779, -82.99406],
  [39.96581, -82.99378],
  [39.96583, -82.993569],
  [39.96592, -82.992849],
  [39.965939, -82.99269],
  [39.966, -82.99217],
  [39.966069, -82.991559],
  [39.966139, -82.991019],
  [39.966149, -82.99091],
  [39.96621, -82.99046],
  [39.966239, -82.990209],
  [39.96635, -82.989269],
  [39.96639, -82.988889],
  [39.966409, -82.988719],
  [39.96647, -82.98824],
  [39.96654, -82.987589],
  [39.966589, -82.98717],
  [39.966599, -82.987059],
  [39.966609, -82.98694],
  [39.966689, -82.98623],
  [39.966699, -82.98618],
  [39.96674, -82.985829],
  [39.966779, -82.985479],
  [39.966789, -82.985349],
  [39.966849, -82.984939],
  [39.966879, -82.98456],
  [39.96689, -82.984449],
  [39.966939, -82.984039],
  [39.966959, -82.98389],
  [39.96698, -82.983719],
  [39.967, -82.983589],
  [39.967029, -82.98334],
  [39.967039, -82.9832],
  [39.967059, -82.98302],
  [39.96709, -82.98272],
  [39.96728, -82.982739],
  [39.96745, -82.982769],
  [39.96755, -82.9828],
  [39.9677, -82.98285],
  [39.9679, -82.982959],
  [39.968119, -82.983099],
  [39.96828, -82.983179],
  [39.96842, -82.983219],
  [39.968639, -82.98326],
  [39.968919, -82.98334],
  [39.96933, -82.98339],
  [39.96969, -82.98342],
  [39.970009, -82.98343],
  [39.970209, -82.98343],
  [39.970649, -82.98339],
  [39.97113, -82.98338],
  [39.97161, -82.98334],
  [39.972169, -82.983279],
  [39.972619, -82.9832],
  [39.97294, -82.98316],
  [39.97319, -82.98317],
  [39.973429, -82.98321],
  [39.97373, -82.98317],
  [39.97383, -82.98316],
  [39.9742, -82.98311],
  [39.97445, -82.98311],
  [39.974709, -82.98312],
  [39.9751, -82.98316],
  [39.97529, -82.983179],
  [39.975489, -82.98321],
  [39.97589, -82.983269],
  [39.97697, -82.98344],
  [39.97725, -82.983499],
  [39.977389, -82.98353],
  [39.977949, -82.983629],
  [39.978269, -82.98369],
  [39.978639, -82.983769],
  [39.978759, -82.98379],
  [39.978809, -82.9838],
  [39.97914, -82.983859],
  [39.97934, -82.983899],
  [39.97986, -82.983989],
  [39.980469, -82.984119],
  [39.98111, -82.98424],
  [39.98156, -82.98432],
  [39.9816, -82.98433],
  [39.982169, -82.984439],
  [39.98273, -82.98455],
  [39.982889, -82.98459],
  [39.983439, -82.984709],
  [39.98428, -82.98487],
  [39.985479, -82.985109],
  [39.985869, -82.98518],
  [39.986309, -82.985259],
  [39.987029, -82.98536],
  [39.987289, -82.985389],
  [39.98752, -82.98542],
  [39.988009, -82.985469],
  [39.9885, -82.985479],
  [39.988739, -82.985469],
  [39.989109, -82.98545],
  [39.989359, -82.985429],
  [39.9897, -82.98542],
  [39.99006, -82.9854],
  [39.99012, -82.985389],
  [39.9902, -82.985379],
  [39.991439, -82.985249],
  [39.991779, -82.98522],
  [39.992259, -82.985169],
  [39.993589, -82.98504],
  [39.99384, -82.985019],
  [39.99489, -82.98491],
  [39.996009, -82.984799],
  [39.996209, -82.98479],
  [39.99644, -82.98477],
  [39.997539, -82.984659],
  [39.99814, -82.98461],
  [39.99913, -82.98451],
  [40.0002, -82.984449],
  [40.000719, -82.98443],
  [40.001519, -82.98442],
  [40.001709, -82.98442],
  [40.002, -82.98442],
  [40.002699, -82.98442],
  [40.00283, -82.98442],
  [40.003599, -82.98443],
  [40.00382, -82.98443],
  [40.004129, -82.98443],
  [40.00488, -82.984439],
  [40.005379, -82.98447],
  [40.005569, -82.9845],
  [40.00589, -82.98455],
  [40.00641, -82.98469],
  [40.006899, -82.98488],
  [40.00724, -82.98506],
  [40.00752, -82.985199],
  [40.00784, -82.98541],
  [40.00804, -82.985569],
  [40.0083, -82.98576],
  [40.008719, -82.986149],
  [40.00912, -82.98658],
  [40.00949, -82.987059],
  [40.009809, -82.987549],
  [40.010079, -82.988049],
  [40.010419, -82.98875],
  [40.010869, -82.98964],
  [40.01101, -82.98992],
  [40.01117, -82.99023],
  [40.011489, -82.99081],
  [40.011769, -82.99127],
  [40.01199, -82.991589],
  [40.0122, -82.99188],
  [40.01262, -82.99233],
  [40.013049, -82.99278],
  [40.013499, -82.993179],
  [40.01397, -82.99355],
  [40.01444, -82.99386],
  [40.01488, -82.9941],
  [40.01497, -82.99414],
  [40.01544, -82.994349],
  [40.01589, -82.994519],
  [40.01597, -82.99455],
  [40.016079, -82.99458],
  [40.0165, -82.99469],
  [40.01703, -82.99478],
  [40.01757, -82.99485],
  [40.017869, -82.994879],
  [40.01838, -82.994929],
  [40.0192, -82.995],
  [40.01975, -82.99503],
  [40.02057, -82.99504],
  [40.021209, -82.99503],
  [40.022229, -82.99499],
  [40.02306, -82.994919],
  [40.0236, -82.994839],
  [40.02408, -82.99477],
  [40.024829, -82.99459],
  [40.02523, -82.9945],
  [40.026349, -82.994249],
  [40.026599, -82.994209],
  [40.026809, -82.99418],
  [40.027139, -82.99414],
  [40.02773, -82.994109],
  [40.028249, -82.994109],
  [40.02864, -82.99413],
  [40.0289, -82.994159],
  [40.029139, -82.99419],
  [40.02964, -82.994249],
  [40.03018, -82.99436],
  [40.030649, -82.99449],
  [40.030949, -82.99458],
  [40.03153, -82.99478],
  [40.03161, -82.99481],
  [40.03205, -82.995],
  [40.03225, -82.99509],
  [40.033099, -82.99548],
  [40.03335, -82.99559],
  [40.03352, -82.99566],
  [40.03388, -82.99581],
  [40.034559, -82.996049],
  [40.03522, -82.99625],
  [40.035369, -82.996289],
  [40.03577, -82.996379],
  [40.03631, -82.99649],
  [40.03686, -82.99657],
  [40.03746, -82.996629],
  [40.037679, -82.996649],
  [40.038779, -82.996729],
  [40.0416, -82.99693],
  [40.042449, -82.996989],
  [40.042929, -82.99702],
  [40.04376, -82.997079],
  [40.04486, -82.997179],
  [40.045959, -82.997229],
  [40.046339, -82.997259],
  [40.047059, -82.997319],
  [40.048059, -82.99739],
  [40.04873, -82.99743],
  [40.049829, -82.99751],
  [40.050189, -82.997539],
  [40.05054, -82.99756],
  [40.05089, -82.997589],
  [40.05276, -82.997729],
  [40.056409, -82.997989],
  [40.057399, -82.99806],
  [40.057829, -82.998089],
  [40.058379, -82.998119],
  [40.058929, -82.99815],
  [40.059479, -82.99815],
  [40.060029, -82.99811],
  [40.06058, -82.998039],
  [40.06113, -82.99793],
  [40.0616, -82.997799],
  [40.06212, -82.997619],
  [40.06238, -82.99751],
  [40.06268, -82.99738],
  [40.06283, -82.997309],
  [40.063249, -82.997099],
  [40.06376, -82.99679],
  [40.06437, -82.996369],
  [40.06472, -82.996089],
  [40.06503, -82.995819],
  [40.06518, -82.995689],
  [40.065519, -82.995369],
  [40.06565, -82.995239],
  [40.066049, -82.99481],
  [40.06646, -82.99433],
  [40.067479, -82.99311],
  [40.068299, -82.992139],
  [40.06871, -82.991649],
  [40.069009, -82.9913],
  [40.069119, -82.99117],
  [40.069559, -82.99073],
  [40.069999, -82.990299],
  [40.070469, -82.98991],
  [40.07094, -82.98955],
  [40.071429, -82.98923],
  [40.072069, -82.98887],
  [40.072709, -82.98857],
  [40.073239, -82.988369],
  [40.073779, -82.9882],
  [40.074329, -82.98807],
  [40.074879, -82.98798],
  [40.075229, -82.987949],
  [40.075849, -82.987899],
  [40.07715, -82.987819],
  [40.077399, -82.9878],
  [40.0775, -82.98779],
  [40.07823, -82.98775],
  [40.079559, -82.98767],
  [40.08186, -82.98752],
  [40.08245, -82.98748],
  [40.08337, -82.987419],
  [40.08452, -82.98735],
  [40.085829, -82.987269],
  [40.086739, -82.98721],
  [40.087539, -82.98716],
  [40.08768, -82.987139],
  [40.08842, -82.987089],
  [40.08951, -82.98703],
  [40.090069, -82.98699],
  [40.09058, -82.98694],
  [40.09119, -82.986869],
  [40.091439, -82.98684],
  [40.09199, -82.98677],
  [40.09254, -82.98668],
  [40.093129, -82.986559],
  [40.093489, -82.986469],
  [40.0939, -82.986379],
  [40.094019, -82.98635],
  [40.09424, -82.9863],
  [40.09452, -82.98621],
  [40.094839, -82.98612],
  [40.095559, -82.985929],
  [40.096029, -82.985799],
  [40.096659, -82.98559],
  [40.09694, -82.98549],
  [40.09777, -82.98518],
  [40.09831, -82.98496],
  [40.0991, -82.984619],
  [40.099629, -82.98437],
  [40.10011, -82.984129],
  [40.100329, -82.98402],
  [40.100579, -82.98389],
  [40.10111, -82.98361],
  [40.10172, -82.983279],
  [40.10201, -82.98312],
  [40.10298, -82.98253],
  [40.103389, -82.98227],
  [40.103769, -82.982019],
  [40.103919, -82.981919],
  [40.10441, -82.98155],
  [40.104639, -82.9814],
  [40.104829, -82.98128],
  [40.105289, -82.980969],
  [40.10549, -82.980839],
  [40.106449, -82.980179],
  [40.1073, -82.979439],
  [40.107359, -82.97938],
  [40.107539, -82.97915],
  [40.107709, -82.97889],
  [40.10786, -82.97861],
  [40.107999, -82.978319],
  [40.10813, -82.97802],
  [40.10849, -82.97704],
  [40.108779, -82.97623],
  [40.10894, -82.975929],
  [40.10901, -82.97582],
  [40.109139, -82.97564],
  [40.1092, -82.975569],
  [40.10928, -82.975489],
  [40.10936, -82.97541],
  [40.109419, -82.975359],
  [40.10956, -82.97525],
  [40.109679, -82.975169],
  [40.10984, -82.975079],
  [40.10992, -82.975039],
  [40.11, -82.97501],
  [40.110139, -82.97496],
  [40.110309, -82.97492],
  [40.11046, -82.974909],
  [40.110589, -82.974909],
  [40.110779, -82.97492],
  [40.110959, -82.974949],
  [40.111129, -82.97501],
  [40.11126, -82.97507],
  [40.111419, -82.97516],
  [40.111479, -82.9752],
  [40.111579, -82.97528],
  [40.11173, -82.97542],
  [40.11181, -82.9755],
  [40.111869, -82.975569],
  [40.11191, -82.975619],
  [40.11197, -82.9757],
  [40.112019, -82.97577],
  [40.1121, -82.975899],
  [40.11216, -82.976],
  [40.112199, -82.976079],
  [40.11228, -82.97627],
  [40.11237, -82.9765],
  [40.11245, -82.97681],
  [40.112479, -82.976969],
  [40.112499, -82.977109],
  [40.11252, -82.977379],
  [40.11252, -82.97757],
  [40.11251, -82.977729],
  [40.112489, -82.977959],
  [40.112469, -82.978099],
  [40.11245, -82.97821],
  [40.11242, -82.97834],
  [40.11237, -82.978509],
  [40.112299, -82.97871],
  [40.112109, -82.97939],
  [40.112049, -82.979499],
  [40.111949, -82.97966],
  [40.11191, -82.979729],
  [40.111849, -82.97984],
  [40.111769, -82.979999],
  [40.111679, -82.98019],
  [40.11147, -82.980659],
  [40.11137, -82.980899],
  [40.11127, -82.981159],
  [40.11117, -82.98145],
  [40.1111, -82.98168],
  [40.111049, -82.981869],
  [40.11101, -82.982049],
  [40.110969, -82.982239],
  [40.110949, -82.982379],
  [40.110929, -82.982549],
  [40.11092, -82.982649],
  [40.11091, -82.98279],
  [40.1109, -82.9829],
  [40.11089, -82.98306],
  [40.11089, -82.983489],
  [40.11091, -82.98429],
  [40.11092, -82.984619],
  [40.110929, -82.985079],
  [40.110929, -82.98531],
  [40.110929, -82.98541],
  [40.11092, -82.98559],
  [40.11091, -82.98572],
  [40.110879, -82.985929],
  [40.110959, -82.987859],
  [40.11099, -82.988499],
  [40.11101, -82.98902],
  [40.111029, -82.9895],
  [40.111049, -82.989899],
  [40.11109, -82.991019],
  [40.11111, -82.991739],
  [40.11116, -82.993039],
  [40.11129, -82.99612],
  [40.11143, -82.999389],
  [40.11146, -83.00018],
  [40.11153, -83.00241],
  [40.11154, -83.002759],
  [40.111569, -83.0034],
  [40.111579, -83.003709],
  [40.11162, -83.00439],
  [40.11172, -83.00651],
  [40.111759, -83.00746],
  [40.111779, -83.00801],
  [40.11208, -83.01079],
  [40.112129, -83.011259],
  [40.112199, -83.011899],
  [40.112229, -83.012069],
  [40.11227, -83.012289],
  [40.112289, -83.01245],
  [40.11234, -83.012649],
  [40.112409, -83.012919],
  [40.112479, -83.01314],
  [40.11254, -83.013339],
  [40.112579, -83.013429],
  [40.11272, -83.01377],
  [40.11288, -83.01408],
  [40.11314, -83.014539],
  [40.113189, -83.01462],
  [40.11323, -83.014689],
  [40.11335, -83.014909],
  [40.113489, -83.015139],
  [40.11359, -83.015349],
  [40.113659, -83.015589],
  [40.113739, -83.01588],
  [40.1138, -83.016039],
  [40.11388, -83.016169],
  [40.11398, -83.016269],
  [40.114079, -83.016339],
  [40.11416, -83.01638],
  [40.114349, -83.016359],
  [40.11449, -83.016349],
  [40.1146, -83.016299],
  [40.114719, -83.01628],
  [40.1155, -83.0162],
  [40.1156, -83.01619],
  [40.11611, -83.01614],
  [40.11684, -83.016079],
  [40.117149, -83.01606],
  [40.11714, -83.015799],
  [40.11712, -83.0153],
  [40.11711, -83.01503],
  [40.11711, -83.014909],
  [40.117079, -83.014679],
  [40.11696, -83.0143],
  [40.11665, -83.01439],
  [40.11658, -83.014409],
  [40.116449, -83.014449],
  [40.1162, -83.01452],
  [40.116009, -83.014559],
  [40.115559, -83.014639],
  [40.115099, -83.014719],
  [40.11488, -83.01476],
  [40.114799, -83.014769],
  [40.11461, -83.014769],
  [40.11441, -83.014739],
  [40.114279, -83.01467],
  [40.114209, -83.014629],
  [40.113999, -83.01443],
  [40.11386, -83.014199],
  [40.11379, -83.014009],
  [40.113729, -83.013739],
  [40.113719, -83.013429],
  [40.11369, -83.01277],
  [40.1137, -83.01263],
  [40.11371, -83.0125],
  [40.1138, -83.01205],
  [40.11387, -83.011889],
  [40.114009, -83.011449],
  [40.11404, -83.01114],
  [40.11404, -83.01084],
  [40.114029, -83.010589],
  [40.113989, -83.009549],
  [40.11396, -83.00889],
  [40.113939, -83.0084],
  [40.113929, -83.00795],
  [40.113899, -83.00724],
  [40.113909, -83.0071],
  [40.113989, -83.006799],
  [40.114119, -83.006529],
  [40.114209, -83.00642],
  [40.1144, -83.006229],
  [40.1145, -83.00616],
  [40.1147, -83.006079],
  [40.114709, -83.006079],
  [40.114929, -83.00607],
  [40.11505, -83.00606],
  [40.115809, -83.006009],
  [40.116269, -83.00598],
  [40.116429, -83.00598],
  [40.116639, -83.00602],
  [40.116899, -83.006169],
  [40.116999, -83.006259]
];

const stopNames = {
  "SOUTER4": "COTA TRANSIT TERMINAL BAY 4",
  "VANREDS": "VANTAGE DR &amp; RED ROOF INN",
  "HIGSTANN": "S HIGH ST &amp; E STATE ST",
  "LON4THE": "E LONG ST &amp; N 4TH ST",
  "LONWASE": "E LONG ST &amp; N WASHINGTON AVE",
  "CRORIDN": "CROSSWOODS PARK AND RIDE",
  "VAN741S": "VANTAGE DR &amp; HUTCHINSON AVE",
  "HIGLONN2": "N HIGH ST &amp; E LONG ST",
  "HIGBRONN": "S HIGH ST &amp; E BROAD ST",
  "HUN733N": "7330 HUNTINGTON PARK DR",
  "HUTHIGE": "HUTCHINSON AVE &amp; HIGH CROSS BLVD"
};

const stops = [
  { stop_id: "SOUTER4", name: "COTA TRANSIT TERMINAL BAY 4", lat: 39.957151, lon: -82.999079, times: ["4:58 PM"] },
  { stop_id: "HIGSTANN", name: "S HIGH ST &amp; E STATE ST", lat: 39.959828, lon: -83.000011, times: ["5:01 PM"] },
  { stop_id: "HIGBRONN", name: "S HIGH ST &amp; E BROAD ST", lat: 39.961674, lon: -83.000405, times: ["5:02 PM"] },
  { stop_id: "HIGLONN2", name: "N HIGH ST &amp; E LONG ST", lat: 39.964416, lon: -83.000956, times: ["5:03 PM"] },
  { stop_id: "LON4THE", name: "E LONG ST &amp; N 4TH ST", lat: 39.965299, lon: -82.996981, times: ["5:03 PM"] },
  { stop_id: "LONWASE", name: "E LONG ST &amp; N WASHINGTON AVE", lat: 39.966475, lon: -82.987289, times: ["5:04 PM"] },
  { stop_id: "VANREDS", name: "VANTAGE DR &amp; RED ROOF INN", lat: 40.116275, lon: -83.014575, times: ["5:25 PM"] },
  { stop_id: "VAN741S", name: "VANTAGE DR &amp; HUTCHINSON AVE", lat: 40.114346, lon: -83.014782, times: ["5:25 PM"] },
  { stop_id: "HUTHIGE", name: "HUTCHINSON AVE &amp; HIGH CROSS BLVD", lat: 40.113921, lon: -83.011456, times: ["5:26 PM"] },
  { stop_id: "HUN733N", name: "7330 HUNTINGTON PARK DR", lat: 40.114376, lon: -83.006163, times: ["5:26 PM"] },
  { stop_id: "CRORIDN", name: "CROSSWOODS PARK AND RIDE", lat: 40.116954, lon: -83.006133, times: ["5:27 PM"] },
]

  const polylineOut = L.polyline(shapeOutbound, {
    color: 'blue',
    weight: 4,
    opacity: 0.7
  }).addTo(map);

  map.fitBounds(polylineOut.getBounds());

  stops.forEach(stop => {
    const marker = L.circleMarker([stop.lat, stop.lon], {
      radius: 6,
      color: '#4dd0e1',
      fillColor: '#4dd0e1',
      fillOpacity: 0.9,
      weight: 1
    });

    const popupContent = `
      <strong>${stop.name}</strong><br>
      ${stop.times && stop.times.length ? stop.times.join("<br>") : "No scheduled times"}
    `;

    marker.bindPopup(popupContent);
    marker.addTo(map);
  });

  let busMarkers = {};

  async function fetchAndDisplay() {
    const res = await fetch(`https://developer.trimet.org/ws/v2/vehicles?route=${routeNumber}&appID=${apiKey}&json=true`);
    const data = await res.json();
    const buses = (data.resultSet.vehicle || []).filter(v =>
      v.routeNumber == routeNumber && v.direction == direction
    );

    Object.values(busMarkers).forEach(m => map.removeLayer(m));
    busMarkers = {};

    if (buses.length === 0) return;

    buses.forEach(bus => {
      if (!bus.latitude || !bus.longitude || !bus.blockID) return;

      const icon = L.divIcon({
        className: '',
        html: `
          <div style="text-align:center;">
            <div style="background:#0071CE;color:#fff;padding:2px 6px;border-radius:6px;font-weight:bold;">${bus.vehicleID}</div>
            <div style="width:0;height:0;border-left:5px solid transparent;border-right:5px solid transparent;border-top:10px solid #00bfff;margin:auto;"></div>
          </div>
        `,
        iconSize: [40, 30],
        iconAnchor: [20, 30]
      });

      const marker = L.marker([bus.latitude, bus.longitude], { icon }).addTo(map);
      busMarkers[bus.vehicleID] = marker;
    });
  }

  fetchAndDisplay();
  setInterval(fetchAndDisplay, 15000);
  </script>

<footer class="site-footer">
  <a href="terms.html">Terms of Use</a> &nbsp;|&nbsp;
  <a href="contact.html">Contact Us</a> &nbsp;|&nbsp;
  <a href="report.html">Report a Problem</a> &nbsp;|&nbsp;
  <a href="privacy.html">Privacy Policy</a>
</footer>

<div id="cookie-banner" style="display: none; position: fixed; bottom: 0; width: 100%; background: #333; color: #fff; text-align: center; padding: 1rem; z-index: 1000; font-size: 0.9rem;">
  📢 We use cookies for personalized ads and analytics. By using MetroFeed, you agree to our 
  <a href="privacy.html" style="color: #4dd0e1; text-decoration: underline;">Privacy Policy</a>.
  <button onclick="acceptCookies()" style="margin-left: 1rem; background: #4dd0e1; color: #000; border: none; padding: 0.5rem 1rem; border-radius: 5px; cursor: pointer;">OK</button>
</div>

<script>
  function acceptCookies() {
    localStorage.setItem('cookieConsent', 'true');
    document.getElementById('cookie-banner').style.display = 'none';
  }

  window.onload = function() {
    if (!localStorage.getItem('cookieConsent')) {
      document.getElementById('cookie-banner').style.display = 'block';
    }
  }
</script>


</body>
</html>