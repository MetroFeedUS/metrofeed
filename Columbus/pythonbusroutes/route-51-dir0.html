<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Route 51 – REYNOLDSBURG | MetroFeed Portland</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background-color: #0d0d0d;
      color: #cccccc;
    }
    header {
      background-color: #0d0d0d;
      border-bottom: 3px solid #4dd0e1;
      padding: 1rem;
      text-align: center;
    }
    header img {
      max-height: 60px;
    }
    .ad-banner {
      text-align: center;
      margin: 1rem auto;
      background-color: #222;
      color: #888;
      padding: 1rem;
      border: 2px dashed #4dd0e1;
      font-size: 0.9rem;
      border-radius: 8px;
    }
    h1 {
      text-align: center;
      margin: 1rem 0;
      font-size: 2rem;
      color: #f0f0f0;
    }
    .content-box {
      border: 2px solid #4dd0e1;
      border-radius: 12px;
      padding: 1rem;
      margin: 1rem;
      background-color: #1e1e1e;
    }
    #map {
      width: 100%;
      height: 400px;
      border-radius: 8px;
    }
    .button-bar {
      display: flex;
      justify-content: center;
      margin: 1rem 0;
    }
    .button-bar a {
      background: #4dd0e1;
      color: #0d0d0d;
      padding: 0.5rem 1rem;
      text-decoration: none;
      border-radius: 8px;
      font-weight: bold;
    }

.back-button {
  background-color: #4dd0e1;
  color: #0d0d0d;
  border: none;
  padding: 0.6rem 1.2rem;
  font-size: 1rem;
  font-weight: bold;
  border-radius: 8px;
  cursor: pointer;
  box-shadow: 0 0 10px #4dd0e1;
  text-decoration: none;
}
.back-button:hover {
  background-color: #35c0d6;
}
.site-footer {
      text-align: center;
      margin-top: 3rem;
      margin-bottom: 120px;
      font-size: 0.85rem;
      color: #aaa;
    }
    .site-footer a {
      color: #00BFFF;
      text-decoration: none;
    }
    .site-footer a:hover {
      text-decoration: underline;
    }

  </style>
</head>
<body>
  <header>
    <img src="MetroFeedPortlandLogo.png" alt="MetroFeed Portland">
  </header>

  <div class="ad-banner">
    [Ad Banner Placeholder — 300x250]
  </div>

  <div class="disclaimer" style="margin: 1rem auto 0.5rem; max-width: 600px; font-size: 0.8rem; color: #bbb; text-align: center; padding: 0.5rem 1rem; background-color: #111; border: 1px dashed #444; border-radius: 6px;">
    ⚠️ This is a Beta program, work in progress. Please REPORT bugs and pretend to be impressed.
  </div>
  <div class="disclaimer" style="margin: 0 auto 1rem; max-width: 600px; font-size: 0.75rem; color: #888; text-align: center; padding: 0.25rem 1rem;">
    This tool is not affiliated with or endorsed by TriMet. For official schedules and service alerts, visit <a href="https://trimet.org" style="color:#4dd0e1;">trimet.org</a>.
  </div>

  <div style="margin: 2rem 0; text-align: center;">
  <button class="back-button" onclick="history.back()">⬅ Back</button>
  </div>

  <h1>Route 51 – REYNOLDSBURG</h1>

  <div class="content-box">
    <div id="map"></div>
    <div style="text-align:right; font-size: 0.7rem; color: #777; margin-top: 0.5rem;">
      Data courtesy of TriMet.
    </div>
  </div>

  
  <script>
  const apiKey = "2C4447D4A42083BCD84DE3B8E";
  const routeNumber = 51;
  const direction = parseInt(0);

  const map = L.map('map').setView([45.6, -122.7], 12);
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    maxZoom: 19
  }).addTo(map);

  const shapeOutbound = [
  [39.966139, -83.00259],
  [39.965579, -83.00247],
  [39.965579, -83.002209],
  [39.965499, -83.00219],
  [39.96485, -83.00205],
  [39.96494, -83.001189],
  [39.965069, -83.00026],
  [39.96509, -83.00008],
  [39.96511, -82.999879],
  [39.96518, -82.999339],
  [39.9652, -82.999149],
  [39.965219, -82.999],
  [39.965239, -82.99887],
  [39.965249, -82.998749],
  [39.96528, -82.998529],
  [39.964979, -82.99847],
  [39.964959, -82.99847],
  [39.96458, -82.998399],
  [39.96431, -82.998349],
  [39.96393, -82.99828],
  [39.96324, -82.998119],
  [39.962979, -82.998069],
  [39.96287, -82.99805],
  [39.962529, -82.997979],
  [39.96185, -82.99783],
  [39.96149, -82.997759],
  [39.961119, -82.99769],
  [39.96095, -82.99766],
  [39.960849, -82.997639],
  [39.96071, -82.99761],
  [39.960659, -82.9976],
  [39.960479, -82.99756],
  [39.95979, -82.99743],
  [39.95953, -82.99738],
  [39.95934, -82.997349],
  [39.959129, -82.997309],
  [39.95872, -82.99724],
  [39.95847, -82.997189],
  [39.958239, -82.99715],
  [39.957789, -82.997079],
  [39.957759, -82.997319],
  [39.957669, -82.99806],
  [39.95766, -82.99819],
  [39.957579, -82.998889],
  [39.95757, -82.99901],
  [39.95754, -82.99928],
  [39.95748, -82.999749],
  [39.956799, -82.99963],
  [39.956169, -82.999519],
  [39.95558, -82.99937],
  [39.955449, -82.999339],
  [39.955089, -82.999259],
  [39.954809, -82.999199],
  [39.95466, -82.999169],
  [39.954349, -82.999109],
  [39.95406, -82.999059],
  [39.953719, -82.998989],
  [39.95348, -82.998939],
  [39.95357, -82.998169],
  [39.953639, -82.997499],
  [39.95369, -82.99702],
  [39.95377, -82.9963],
  [39.95387, -82.995419],
  [39.953919, -82.995019],
  [39.953979, -82.994559],
  [39.954069, -82.993979],
  [39.954259, -82.99266],
  [39.95433, -82.99197],
  [39.954429, -82.991049],
  [39.954549, -82.989879],
  [39.954609, -82.98938],
  [39.95469, -82.988369],
  [39.9545, -82.98794],
  [39.95442, -82.987719],
  [39.95431, -82.9874],
  [39.954189, -82.98703],
  [39.954069, -82.98653],
  [39.95402, -82.98626],
  [39.953999, -82.985929],
  [39.954009, -82.98559],
  [39.95406, -82.98523],
  [39.95414, -82.984809],
  [39.95449, -82.983819],
  [39.954619, -82.983399],
  [39.954709, -82.98303],
  [39.95477, -82.982679],
  [39.95483, -82.98243],
  [39.95483, -82.98227],
  [39.95483, -82.981969],
  [39.954819, -82.981569],
  [39.954799, -82.98109],
  [39.954709, -82.979709],
  [39.95466, -82.979169],
  [39.954619, -82.97879],
  [39.9546, -82.978549],
  [39.95456, -82.97821],
  [39.9543, -82.976389],
  [39.95423, -82.97579],
  [39.95395, -82.973559],
  [39.953889, -82.972879],
  [39.95386, -82.972339],
  [39.95385, -82.972019],
  [39.95385, -82.971889],
  [39.95387, -82.97174],
  [39.95384, -82.97147],
  [39.953809, -82.971169],
  [39.953709, -82.96985],
  [39.95366, -82.96912],
  [39.953629, -82.96854],
  [39.9536, -82.96787],
  [39.95359, -82.967569],
  [39.95358, -82.96705],
  [39.95357, -82.96665],
  [39.953549, -82.96579],
  [39.953539, -82.965549],
  [39.953529, -82.965409],
  [39.95352, -82.964999],
  [39.953449, -82.961039],
  [39.95341, -82.95891],
  [39.953369, -82.95751],
  [39.95332, -82.95638],
  [39.953279, -82.955379],
  [39.953259, -82.954979],
  [39.95325, -82.954749],
  [39.95323, -82.95422],
  [39.953199, -82.953629],
  [39.953179, -82.953219],
  [39.953089, -82.951099],
  [39.953009, -82.949069],
  [39.95297, -82.948489],
  [39.95296, -82.948359],
  [39.952929, -82.948039],
  [39.952899, -82.9478],
  [39.95287, -82.94761],
  [39.952829, -82.947399],
  [39.9528, -82.947269],
  [39.95276, -82.94711],
  [39.952729, -82.946999],
  [39.95269, -82.946869],
  [39.952649, -82.94675],
  [39.9526, -82.94661],
  [39.952539, -82.946459],
  [39.95249, -82.946339],
  [39.95243, -82.94621],
  [39.952359, -82.946059],
  [39.952269, -82.945889],
  [39.952209, -82.945779],
  [39.95215, -82.94568],
  [39.952099, -82.945599],
  [39.952019, -82.945479],
  [39.951939, -82.94537],
  [39.951849, -82.945249],
  [39.951759, -82.94513],
  [39.951669, -82.945019],
  [39.951569, -82.94491],
  [39.9515, -82.944839],
  [39.951369, -82.944719],
  [39.951279, -82.94464],
  [39.95114, -82.944519],
  [39.951009, -82.94441],
  [39.950949, -82.944359],
  [39.95087, -82.944299],
  [39.95078, -82.94424],
  [39.950669, -82.944179],
  [39.950589, -82.94414],
  [39.95045, -82.944069],
  [39.950409, -82.94405],
  [39.95027, -82.943989],
  [39.95, -82.943899],
  [39.949859, -82.943859],
  [39.949689, -82.943819],
  [39.94953, -82.94379],
  [39.94938, -82.943769],
  [39.94916, -82.94375],
  [39.94838, -82.943729],
  [39.94793, -82.943719],
  [39.947679, -82.9437],
  [39.94748, -82.943679],
  [39.947399, -82.943669],
  [39.94727, -82.94365],
  [39.94712, -82.943619],
  [39.946989, -82.943589],
  [39.946859, -82.94356],
  [39.94665, -82.943499],
  [39.94656, -82.94347],
  [39.94647, -82.943439],
  [39.946359, -82.943399],
  [39.9462, -82.94333],
  [39.9461, -82.943279],
  [39.94594, -82.9432],
  [39.94585, -82.94315],
  [39.945629, -82.94302],
  [39.94538, -82.942859],
  [39.945179, -82.942719],
  [39.944979, -82.94257],
  [39.94448, -82.942189],
  [39.94405, -82.94185],
  [39.943909, -82.941739],
  [39.94361, -82.941509],
  [39.94262, -82.940739],
  [39.94072, -82.93928],
  [39.939769, -82.938549],
  [39.939609, -82.93842],
  [39.93945, -82.93829],
  [39.93809, -82.937249],
  [39.936999, -82.93641],
  [39.9356, -82.93532],
  [39.934909, -82.93479],
  [39.93443, -82.93442],
  [39.93398, -82.934039],
  [39.933549, -82.93361],
  [39.93316, -82.93311],
  [39.93281, -82.932559],
  [39.932649, -82.932279],
  [39.932499, -82.931979],
  [39.93242, -82.93178],
  [39.932309, -82.9315],
  [39.932199, -82.93122],
  [39.932039, -82.9307],
  [39.93189, -82.930029],
  [39.93183, -82.92969],
  [39.93179, -82.92934],
  [39.931759, -82.92899],
  [39.93173, -82.928279],
  [39.93172, -82.927969],
  [39.93172, -82.92768],
  [39.93172, -82.927289],
  [39.93172, -82.926969],
  [39.93171, -82.92651],
  [39.931689, -82.924729],
  [39.931669, -82.92332],
  [39.93164, -82.921209],
  [39.931599, -82.918019],
  [39.931599, -82.91792],
  [39.931589, -82.91719],
  [39.931579, -82.916309],
  [39.931569, -82.915949],
  [39.931569, -82.915809],
  [39.93156, -82.91558],
  [39.93155, -82.91525],
  [39.93155, -82.91504],
  [39.93154, -82.91457],
  [39.93152, -82.91274],
  [39.931509, -82.91192],
  [39.931499, -82.91121],
  [39.931499, -82.91081],
  [39.931509, -82.90964],
  [39.93154, -82.909169],
  [39.93156, -82.90896],
  [39.931599, -82.90838],
  [39.93162, -82.908169],
  [39.9317, -82.907409],
  [39.93181, -82.90658],
  [39.932029, -82.90536],
  [39.93237, -82.90395],
  [39.932769, -82.902359],
  [39.933919, -82.897899],
  [39.934459, -82.89578],
  [39.9347, -82.894749],
  [39.934749, -82.89452],
  [39.934919, -82.893719],
  [39.935089, -82.89284],
  [39.93524, -82.891979],
  [39.9354, -82.890929],
  [39.935539, -82.88988],
  [39.93567, -82.88883],
  [39.935889, -82.886519],
  [39.936009, -82.88528],
  [39.93602, -82.88516],
  [39.936089, -82.88447],
  [39.936159, -82.883739],
  [39.936279, -82.882529],
  [39.93641, -82.881079],
  [39.93648, -82.88029],
  [39.93657, -82.87934],
  [39.936629, -82.878649],
  [39.936709, -82.877829],
  [39.93675, -82.87742],
  [39.936819, -82.876719],
  [39.936889, -82.87601],
  [39.93694, -82.8753],
  [39.936969, -82.874819],
  [39.936979, -82.874599],
  [39.936999, -82.87399],
  [39.936999, -82.873869],
  [39.936999, -82.873159],
  [39.936979, -82.87265],
  [39.93694, -82.871949],
  [39.936889, -82.871269],
  [39.93687, -82.87103],
  [39.93683, -82.87066],
  [39.93674, -82.86995],
  [39.936629, -82.869249],
  [39.9365, -82.868559],
  [39.936349, -82.86787],
  [39.936189, -82.867179],
  [39.935999, -82.86647],
  [39.935649, -82.865199],
  [39.935629, -82.86512],
  [39.93557, -82.8649],
  [39.93552, -82.864699],
  [39.93541, -82.86427],
  [39.935189, -82.863429],
  [39.93485, -82.86211],
  [39.9347, -82.86148],
  [39.934619, -82.861149],
  [39.934559, -82.860829],
  [39.934469, -82.86044],
  [39.93441, -82.86014],
  [39.93431, -82.85942],
  [39.93425, -82.858709],
  [39.93416, -82.857309],
  [39.934089, -82.85595],
  [39.934019, -82.854849],
  [39.93398, -82.853939],
  [39.933929, -82.852999],
  [39.933909, -82.85274],
  [39.933899, -82.852459],
  [39.93388, -82.85226],
  [39.93386, -82.85195],
  [39.93379, -82.85085],
  [39.93377, -82.850429],
  [39.933729, -82.849719],
  [39.93369, -82.84915],
  [39.93368, -82.848899],
  [39.933569, -82.84699],
  [39.933309, -82.842609],
  [39.93324, -82.84136],
  [39.933209, -82.840849],
  [39.93296, -82.83628],
  [39.932929, -82.8357],
  [39.93289, -82.835089],
  [39.932829, -82.83403],
  [39.932659, -82.83106],
  [39.93262, -82.830859],
  [39.9326, -82.830669],
  [39.93253, -82.830139],
  [39.93246, -82.829599],
  [39.93242, -82.829419],
  [39.93237, -82.82926],
  [39.932319, -82.82912],
  [39.93225, -82.829],
  [39.93215, -82.8289],
  [39.932049, -82.828829],
  [39.93192, -82.828779],
  [39.93179, -82.82876],
  [39.93165, -82.828779],
  [39.93152, -82.828829],
  [39.931399, -82.828919],
  [39.931299, -82.829049],
  [39.931219, -82.829189],
  [39.931149, -82.82936],
  [39.9311, -82.82954],
  [39.93108, -82.829729],
  [39.93108, -82.829919],
  [39.93111, -82.830089],
  [39.93117, -82.830269],
  [39.931239, -82.830409],
  [39.931329, -82.83053],
  [39.93144, -82.83061],
  [39.93156, -82.83066],
  [39.931689, -82.830689],
  [39.931839, -82.830689],
  [39.93234, -82.8307],
  [39.9326, -82.830669],
  [39.93264, -82.830669],
  [39.932939, -82.830639],
  [39.93343, -82.830599],
  [39.934009, -82.83056],
  [39.934989, -82.83048],
  [39.93551, -82.83044],
  [39.93568, -82.830449],
  [39.935889, -82.83047],
  [39.936269, -82.83043],
  [39.93642, -82.830419],
  [39.936699, -82.83039],
  [39.936909, -82.830369],
  [39.93713, -82.83035],
  [39.937429, -82.830319],
  [39.938349, -82.830229],
  [39.9383, -82.82918],
  [39.938259, -82.82832],
  [39.938219, -82.82768],
  [39.938329, -82.82765],
  [39.93866, -82.8275],
  [39.93891, -82.827349],
  [39.93899, -82.82728],
  [39.93908, -82.827209],
  [39.939229, -82.827079],
  [39.939339, -82.827249],
  [39.93935, -82.82737],
  [39.939319, -82.82745],
  [39.93926, -82.827479]
];

const stopNames = {
  "NORTER1": "SPRING ST TERMINAL BAY 1",
  "EASOFFE": "EASTGREEN BLVD &amp; OFFICEVIEW PL",
  "REYRIDSW": "REYNOLDSBURG PARK &amp; RIDE",
  "3RDGAYS": "N 3RD ST &amp; E GAY ST",
  "3RDBROS1": "S 3RD ST &amp; E BROAD ST",
  "3RDTOWS": "S 3RD ST &amp; E TOWN ST",
  "HIGMAIS2": "S HIGH ST &amp; W MAIN ST",
  "EFUL4THE": "E FULTON ST &amp; S 4TH ST",
  "EFULGRAE": "E FULTON ST &amp; S GRANT AVE",
  "EFULSHIE": "E FULTON ST &amp; S HIGH ST"
};

const stops = [
  { stop_id: "NORTER1", name: "SPRING ST TERMINAL BAY 1", lat: 39.96596, lon: -83.002432, times: ["7:15 AM"] },
  { stop_id: "3RDGAYS", name: "N 3RD ST &amp; E GAY ST", lat: 39.964264, lon: -82.998422, times: ["7:16 AM"] },
  { stop_id: "3RDBROS1", name: "S 3RD ST &amp; E BROAD ST", lat: 39.962074, lon: -82.997987, times: ["7:17 AM"] },
  { stop_id: "3RDTOWS", name: "S 3RD ST &amp; E TOWN ST", lat: 39.958666, lon: -82.997331, times: ["7:18 AM"] },
  { stop_id: "HIGMAIS2", name: "S HIGH ST &amp; W MAIN ST", lat: 39.955568, lon: -82.999488, times: ["7:19 AM"] },
  { stop_id: "EFULSHIE", name: "E FULTON ST &amp; S HIGH ST", lat: 39.953495, lon: -82.998104, times: ["7:21 AM"] },
  { stop_id: "EFUL4THE", name: "E FULTON ST &amp; S 4TH ST", lat: 39.953988, lon: -82.993938, times: ["7:21 AM"] },
  { stop_id: "EFULGRAE", name: "E FULTON ST &amp; S GRANT AVE", lat: 39.954333, lon: -82.990908, times: ["7:21 AM"] },
  { stop_id: "EASOFFE", name: "EASTGREEN BLVD &amp; OFFICEVIEW PL", lat: 39.93829, lon: -82.829364, times: ["7:38 AM"] },
  { stop_id: "REYRIDSW", name: "REYNOLDSBURG PARK &amp; RIDE", lat: 39.939288, lon: -82.82751, times: ["7:39 AM"] },
]

  const polylineOut = L.polyline(shapeOutbound, {
    color: 'blue',
    weight: 4,
    opacity: 0.7
  }).addTo(map);

  map.fitBounds(polylineOut.getBounds());

  stops.forEach(stop => {
    const marker = L.circleMarker([stop.lat, stop.lon], {
      radius: 6,
      color: '#4dd0e1',
      fillColor: '#4dd0e1',
      fillOpacity: 0.9,
      weight: 1
    });

    const popupContent = `
      <strong>${stop.name}</strong><br>
      ${stop.times && stop.times.length ? stop.times.join("<br>") : "No scheduled times"}
    `;

    marker.bindPopup(popupContent);
    marker.addTo(map);
  });

  let busMarkers = {};

  async function fetchAndDisplay() {
    const res = await fetch(`https://developer.trimet.org/ws/v2/vehicles?route=${routeNumber}&appID=${apiKey}&json=true`);
    const data = await res.json();
    const buses = (data.resultSet.vehicle || []).filter(v =>
      v.routeNumber == routeNumber && v.direction == direction
    );

    Object.values(busMarkers).forEach(m => map.removeLayer(m));
    busMarkers = {};

    if (buses.length === 0) return;

    buses.forEach(bus => {
      if (!bus.latitude || !bus.longitude || !bus.blockID) return;

      const icon = L.divIcon({
        className: '',
        html: `
          <div style="text-align:center;">
            <div style="background:#0071CE;color:#fff;padding:2px 6px;border-radius:6px;font-weight:bold;">${bus.vehicleID}</div>
            <div style="width:0;height:0;border-left:5px solid transparent;border-right:5px solid transparent;border-top:10px solid #00bfff;margin:auto;"></div>
          </div>
        `,
        iconSize: [40, 30],
        iconAnchor: [20, 30]
      });

      const marker = L.marker([bus.latitude, bus.longitude], { icon }).addTo(map);
      busMarkers[bus.vehicleID] = marker;
    });
  }

  fetchAndDisplay();
  setInterval(fetchAndDisplay, 15000);
  </script>

<footer class="site-footer">
  <a href="terms.html">Terms of Use</a> &nbsp;|&nbsp;
  <a href="contact.html">Contact Us</a> &nbsp;|&nbsp;
  <a href="report.html">Report a Problem</a> &nbsp;|&nbsp;
  <a href="privacy.html">Privacy Policy</a>
</footer>

<div id="cookie-banner" style="display: none; position: fixed; bottom: 0; width: 100%; background: #333; color: #fff; text-align: center; padding: 1rem; z-index: 1000; font-size: 0.9rem;">
  📢 We use cookies for personalized ads and analytics. By using MetroFeed, you agree to our 
  <a href="privacy.html" style="color: #4dd0e1; text-decoration: underline;">Privacy Policy</a>.
  <button onclick="acceptCookies()" style="margin-left: 1rem; background: #4dd0e1; color: #000; border: none; padding: 0.5rem 1rem; border-radius: 5px; cursor: pointer;">OK</button>
</div>

<script>
  function acceptCookies() {
    localStorage.setItem('cookieConsent', 'true');
    document.getElementById('cookie-banner').style.display = 'none';
  }

  window.onload = function() {
    if (!localStorage.getItem('cookieConsent')) {
      document.getElementById('cookie-banner').style.display = 'block';
    }
  }
</script>


</body>
</html>