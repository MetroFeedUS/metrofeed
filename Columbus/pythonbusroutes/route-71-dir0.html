<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Route 71 – HILLIARD | MetroFeed Portland</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background-color: #0d0d0d;
      color: #cccccc;
    }
    header {
      background-color: #0d0d0d;
      border-bottom: 3px solid #4dd0e1;
      padding: 1rem;
      text-align: center;
    }
    header img {
      max-height: 60px;
    }
    .ad-banner {
      text-align: center;
      margin: 1rem auto;
      background-color: #222;
      color: #888;
      padding: 1rem;
      border: 2px dashed #4dd0e1;
      font-size: 0.9rem;
      border-radius: 8px;
    }
    h1 {
      text-align: center;
      margin: 1rem 0;
      font-size: 2rem;
      color: #f0f0f0;
    }
    .content-box {
      border: 2px solid #4dd0e1;
      border-radius: 12px;
      padding: 1rem;
      margin: 1rem;
      background-color: #1e1e1e;
    }
    #map {
      width: 100%;
      height: 400px;
      border-radius: 8px;
    }
    .button-bar {
      display: flex;
      justify-content: center;
      margin: 1rem 0;
    }
    .button-bar a {
      background: #4dd0e1;
      color: #0d0d0d;
      padding: 0.5rem 1rem;
      text-decoration: none;
      border-radius: 8px;
      font-weight: bold;
    }

.back-button {
  background-color: #4dd0e1;
  color: #0d0d0d;
  border: none;
  padding: 0.6rem 1.2rem;
  font-size: 1rem;
  font-weight: bold;
  border-radius: 8px;
  cursor: pointer;
  box-shadow: 0 0 10px #4dd0e1;
  text-decoration: none;
}
.back-button:hover {
  background-color: #35c0d6;
}
.site-footer {
      text-align: center;
      margin-top: 3rem;
      margin-bottom: 120px;
      font-size: 0.85rem;
      color: #aaa;
    }
    .site-footer a {
      color: #00BFFF;
      text-decoration: none;
    }
    .site-footer a:hover {
      text-decoration: underline;
    }

  </style>
</head>
<body>
  <header>
    <img src="MetroFeedPortlandLogo.png" alt="MetroFeed Portland">
  </header>

  <div class="ad-banner">
    [Ad Banner Placeholder — 300x250]
  </div>

  <div class="disclaimer" style="margin: 1rem auto 0.5rem; max-width: 600px; font-size: 0.8rem; color: #bbb; text-align: center; padding: 0.5rem 1rem; background-color: #111; border: 1px dashed #444; border-radius: 6px;">
    ⚠️ This is a Beta program, work in progress. Please REPORT bugs and pretend to be impressed.
  </div>
  <div class="disclaimer" style="margin: 0 auto 1rem; max-width: 600px; font-size: 0.75rem; color: #888; text-align: center; padding: 0.25rem 1rem;">
    This tool is not affiliated with or endorsed by TriMet. For official schedules and service alerts, visit <a href="https://trimet.org" style="color:#4dd0e1;">trimet.org</a>.
  </div>

  <div style="margin: 2rem 0; text-align: center;">
  <button class="back-button" onclick="history.back()">⬅ Back</button>
  </div>

  <h1>Route 71 – HILLIARD</h1>

  <div class="content-box">
    <div id="map"></div>
    <div style="text-align:right; font-size: 0.7rem; color: #777; margin-top: 0.5rem;">
      Data courtesy of TriMet.
    </div>
  </div>

  
  <script>
  const apiKey = "2C4447D4A42083BCD84DE3B8E";
  const routeNumber = 71;
  const direction = parseInt(0);

  const map = L.map('map').setView([45.6, -122.7], 12);
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    maxZoom: 19
  }).addTo(map);

  const shapeOutbound = [
  [39.95757, -82.99901],
  [39.956249, -82.998749],
  [39.95627, -82.998569],
  [39.95629, -82.99838],
  [39.956309, -82.998179],
  [39.956329, -82.998029],
  [39.95638, -82.997579],
  [39.95639, -82.99751],
  [39.956399, -82.997359],
  [39.95646, -82.996819],
  [39.956499, -82.996459],
  [39.95656, -82.99594],
  [39.95666, -82.995069],
  [39.957319, -82.995189],
  [39.95799, -82.99532],
  [39.958859, -82.995509],
  [39.958939, -82.99553],
  [39.959299, -82.995599],
  [39.959999, -82.995729],
  [39.960659, -82.995869],
  [39.961269, -82.99598],
  [39.96131, -82.99599],
  [39.96141, -82.996009],
  [39.96168, -82.996059],
  [39.96178, -82.99608],
  [39.962009, -82.99613],
  [39.962719, -82.996229],
  [39.96297, -82.996279],
  [39.963439, -82.996369],
  [39.96413, -82.996499],
  [39.964779, -82.99661],
  [39.965499, -82.996739],
  [39.965849, -82.996809],
  [39.966, -82.99684],
  [39.96611, -82.996859],
  [39.966319, -82.996899],
  [39.966489, -82.99693],
  [39.96654, -82.99694],
  [39.966779, -82.996989],
  [39.966759, -82.997309],
  [39.96673, -82.99751],
  [39.966679, -82.997899],
  [39.96665, -82.998169],
  [39.966589, -82.99877],
  [39.96656, -82.99909],
  [39.966509, -82.99953],
  [39.96644, -83.000189],
  [39.966399, -83.00052],
  [39.966339, -83.001009],
  [39.96629, -83.00142],
  [39.96617, -83.00233],
  [39.966139, -83.00259],
  [39.966069, -83.00324],
  [39.965979, -83.004059],
  [39.965879, -83.004919],
  [39.965769, -83.005809],
  [39.96573, -83.006169],
  [39.96573, -83.00643],
  [39.96573, -83.006619],
  [39.96574, -83.00675],
  [39.96575, -83.00688],
  [39.965759, -83.006989],
  [39.965769, -83.007389],
  [39.965779, -83.007609],
  [39.965789, -83.007799],
  [39.96581, -83.00841],
  [39.96582, -83.008739],
  [39.96584, -83.009099],
  [39.965849, -83.00948],
  [39.965859, -83.009769],
  [39.965889, -83.01039],
  [39.96591, -83.011039],
  [39.96592, -83.01124],
  [39.965969, -83.012429],
  [39.96602, -83.013609],
  [39.96603, -83.01389],
  [39.966049, -83.014099],
  [39.966059, -83.014279],
  [39.96609, -83.01484],
  [39.96611, -83.01525],
  [39.9661, -83.01597],
  [39.9661, -83.016129],
  [39.9661, -83.016249],
  [39.96612, -83.016519],
  [39.96612, -83.01678],
  [39.96612, -83.01705],
  [39.96608, -83.01763],
  [39.966069, -83.01773],
  [39.96602, -83.018499],
  [39.96599, -83.01902],
  [39.965979, -83.019179],
  [39.965979, -83.01933],
  [39.965969, -83.0196],
  [39.965979, -83.019819],
  [39.965979, -83.020039],
  [39.965979, -83.020569],
  [39.966, -83.020929],
  [39.96602, -83.021109],
  [39.966069, -83.02146],
  [39.96619, -83.02199],
  [39.966339, -83.022459],
  [39.96647, -83.022819],
  [39.966579, -83.02308],
  [39.966769, -83.023499],
  [39.96699, -83.02388],
  [39.96707, -83.02406],
  [39.967149, -83.024279],
  [39.96719, -83.024439],
  [39.967239, -83.02461],
  [39.967319, -83.024939],
  [39.96734, -83.025209],
  [39.967389, -83.025709],
  [39.96737, -83.026239],
  [39.967299, -83.02686],
  [39.96698, -83.02681],
  [39.966769, -83.0268],
  [39.966679, -83.026789],
  [39.966589, -83.0268],
  [39.966419, -83.026829],
  [39.966239, -83.026879],
  [39.966059, -83.02695],
  [39.96592, -83.02703],
  [39.965779, -83.027139],
  [39.96557, -83.027329],
  [39.96538, -83.02754],
  [39.96519, -83.027819],
  [39.96501, -83.028179],
  [39.964889, -83.02847],
  [39.964779, -83.02883],
  [39.96466, -83.02934],
  [39.96446, -83.030389],
  [39.96446, -83.030789],
  [39.96449, -83.03118],
  [39.964509, -83.031389],
  [39.96457, -83.0318],
  [39.96467, -83.032279],
  [39.964769, -83.03267],
  [39.96502, -83.03347],
  [39.965319, -83.034359],
  [39.96628, -83.037319],
  [39.96708, -83.039739],
  [39.967309, -83.040419],
  [39.96783, -83.042229],
  [39.96808, -83.04311],
  [39.968229, -83.043749],
  [39.96824, -83.04381],
  [39.968319, -83.04414],
  [39.968389, -83.044419],
  [39.968469, -83.04476],
  [39.96871, -83.04588],
  [39.96878, -83.046279],
  [39.96888, -83.047029],
  [39.968949, -83.047579],
  [39.96896, -83.04777],
  [39.969019, -83.048529],
  [39.96907, -83.049329],
  [39.96908, -83.04999],
  [39.969089, -83.050419],
  [39.96908, -83.051219],
  [39.96905, -83.051819],
  [39.968999, -83.05236],
  [39.968939, -83.05301],
  [39.9689, -83.053419],
  [39.968829, -83.053959],
  [39.968749, -83.054559],
  [39.968639, -83.055189],
  [39.96851, -83.055859],
  [39.968399, -83.05634],
  [39.96836, -83.05652],
  [39.968319, -83.05669],
  [39.968119, -83.057489],
  [39.96799, -83.058009],
  [39.96789, -83.058429],
  [39.96783, -83.05871],
  [39.96779, -83.058929],
  [39.96772, -83.059419],
  [39.967679, -83.059869],
  [39.967659, -83.06016],
  [39.96765, -83.06065],
  [39.967659, -83.06088],
  [39.967669, -83.06128],
  [39.9677, -83.061699],
  [39.967749, -83.062109],
  [39.96781, -83.062479],
  [39.9679, -83.062919],
  [39.96798, -83.06326],
  [39.9681, -83.063729],
  [39.968319, -83.064579],
  [39.968579, -83.06546],
  [39.968999, -83.066799],
  [39.969179, -83.06731],
  [39.96977, -83.06907],
  [39.970259, -83.070519],
  [39.970629, -83.071479],
  [39.971269, -83.07335],
  [39.971439, -83.07388],
  [39.97168, -83.074619],
  [39.97188, -83.07528],
  [39.97238, -83.07704],
  [39.97247, -83.077379],
  [39.972609, -83.077959],
  [39.97287, -83.07906],
  [39.972999, -83.07965],
  [39.97328, -83.081099],
  [39.97339, -83.0817],
  [39.97346, -83.082129],
  [39.973679, -83.083569],
  [39.973859, -83.08499],
  [39.974, -83.086379],
  [39.974079, -83.087449],
  [39.974129, -83.088259],
  [39.97418, -83.089329],
  [39.9742, -83.08999],
  [39.97421, -83.09063],
  [39.974219, -83.091359],
  [39.974249, -83.092809],
  [39.97427, -83.09333],
  [39.974309, -83.094],
  [39.974329, -83.09441],
  [39.974429, -83.09552],
  [39.974499, -83.096539],
  [39.974579, -83.097249],
  [39.974669, -83.097969],
  [39.974699, -83.098209],
  [39.974879, -83.099459],
  [39.974949, -83.09993],
  [39.974979, -83.10011],
  [39.975049, -83.10065],
  [39.97517, -83.101529],
  [39.975219, -83.101929],
  [39.975399, -83.103299],
  [39.97556, -83.104509],
  [39.975879, -83.1069],
  [39.97611, -83.108649],
  [39.97616, -83.109129],
  [39.976219, -83.109679],
  [39.97628, -83.110299],
  [39.976299, -83.11073],
  [39.97635, -83.1115],
  [39.976389, -83.112279],
  [39.97644, -83.113359],
  [39.97647, -83.114089],
  [39.976489, -83.11483],
  [39.976489, -83.114859],
  [39.976509, -83.115889],
  [39.97654, -83.11713],
  [39.976579, -83.11852],
  [39.976589, -83.118819],
  [39.976589, -83.118939],
  [39.976599, -83.11919],
  [39.97661, -83.119799],
  [39.97663, -83.12055],
  [39.97664, -83.12096],
  [39.97665, -83.12127],
  [39.97665, -83.121459],
  [39.97665, -83.121689],
  [39.976669, -83.12248],
  [39.9767, -83.123669],
  [39.97672, -83.124309],
  [39.976749, -83.12545],
  [39.976779, -83.12667],
  [39.97681, -83.12766],
  [39.976839, -83.12883],
  [39.976869, -83.129969],
  [39.976869, -83.13008],
  [39.97688, -83.13031],
  [39.9769, -83.131089],
  [39.976929, -83.132319],
  [39.976939, -83.132859],
  [39.976959, -83.13373],
  [39.977049, -83.137049],
  [39.97706, -83.137619],
  [39.97706, -83.13773],
  [39.9771, -83.13954],
  [39.97717, -83.142439],
  [39.977209, -83.143929],
  [39.977229, -83.144779],
  [39.97725, -83.14543],
  [39.977289, -83.14736],
  [39.977299, -83.14768],
  [39.977379, -83.14773],
  [39.97744, -83.147849],
  [39.977499, -83.14827],
  [39.977549, -83.1485],
  [39.977579, -83.148649],
  [39.9776, -83.14875],
  [39.977729, -83.149099],
  [39.977849, -83.14934],
  [39.978009, -83.14958],
  [39.97817, -83.149769],
  [39.97844, -83.15003],
  [39.97859, -83.150139],
  [39.978759, -83.150229],
  [39.97916, -83.15047],
  [39.979539, -83.15051],
  [39.97985, -83.150539],
  [39.980099, -83.15057],
  [39.980439, -83.15065],
  [39.980639, -83.150679],
  [39.980809, -83.150709],
  [39.980979, -83.150719],
  [39.98122, -83.15073],
  [39.98121, -83.151069],
  [39.98122, -83.151339],
  [39.98123, -83.15151],
  [39.98124, -83.151659],
  [39.981259, -83.151849],
  [39.981269, -83.151939],
  [39.981279, -83.152019],
  [39.98132, -83.15236],
  [39.981359, -83.15263],
  [39.981429, -83.15299],
  [39.98149, -83.153279],
  [39.981639, -83.154059],
  [39.98202, -83.15389],
  [39.98222, -83.153819],
  [39.9824, -83.1551],
  [39.982519, -83.155169],
  [39.982679, -83.15516],
  [39.982859, -83.155139],
  [39.982989, -83.155179],
  [39.98302, -83.15547],
  [39.983049, -83.15583],
  [39.98312, -83.15582],
  [39.983699, -83.15569],
  [39.983799, -83.155669],
  [39.98411, -83.15561],
  [39.984329, -83.155529],
  [39.985299, -83.155139],
  [39.98545, -83.155049],
  [39.9857, -83.15493],
  [39.98617, -83.154769],
  [39.98635, -83.154729],
  [39.98653, -83.15471],
  [39.98687, -83.154729],
  [39.987219, -83.154819],
  [39.98742, -83.154909],
  [39.987929, -83.155219],
  [39.988389, -83.15552],
  [39.988659, -83.15564],
  [39.988839, -83.15569],
  [39.98904, -83.155719],
  [39.989269, -83.15573],
  [39.98951, -83.155719],
  [39.9897, -83.15569],
  [39.99042, -83.155449],
  [39.990779, -83.15533],
  [39.99092, -83.155269],
  [39.991089, -83.155139],
  [39.99122, -83.154999],
  [39.991319, -83.154859],
  [39.991409, -83.15466],
  [39.99149, -83.154419],
  [39.991529, -83.154179],
  [39.99155, -83.153919],
  [39.991509, -83.15326],
  [39.991509, -83.15303],
  [39.991509, -83.15262],
  [39.991509, -83.152419],
  [39.99155, -83.15195],
  [39.9922, -83.152069],
  [39.99254, -83.15213],
  [39.99272, -83.152159],
  [39.99357, -83.15231],
  [39.99393, -83.15237],
  [39.99416, -83.1524],
  [39.99443, -83.15244],
  [39.99452, -83.15245],
  [39.994869, -83.152509],
  [39.995309, -83.15258],
  [39.995579, -83.15262],
  [39.99581, -83.152659],
  [39.99643, -83.15276],
  [39.99659, -83.152779],
  [39.99706, -83.15286],
  [39.9975, -83.152929],
  [39.99849, -83.15308],
  [39.99887, -83.153139],
  [39.999259, -83.15321],
  [39.99984, -83.1533],
  [39.99995, -83.153319],
  [40.00057, -83.153419],
  [40.00064, -83.15343],
  [40.00085, -83.153459],
  [40.00155, -83.153559],
  [40.00212, -83.153639],
  [40.002249, -83.15366],
  [40.00257, -83.15371],
  [40.002949, -83.153769],
  [40.00328, -83.15381],
  [40.003489, -83.153829],
  [40.003759, -83.15385],
  [40.004379, -83.15385],
  [40.00461, -83.15384],
  [40.004859, -83.153819],
  [40.00489, -83.153819],
  [40.00543, -83.15379],
  [40.00563, -83.153779],
  [40.00589, -83.153769],
  [40.00644, -83.15375],
  [40.00687, -83.15372],
  [40.00705, -83.15371],
  [40.007279, -83.153689],
  [40.00805, -83.153639],
  [40.00847, -83.15362],
  [40.009169, -83.15358],
  [40.0101, -83.153509],
  [40.01108, -83.15345],
  [40.01129, -83.15344],
  [40.01147, -83.15343],
  [40.011519, -83.15343],
  [40.01173, -83.153419],
  [40.012919, -83.15336],
  [40.01335, -83.15334],
  [40.01351, -83.153329],
  [40.0136, -83.153329],
  [40.01397, -83.15331],
  [40.01425, -83.15335],
  [40.014379, -83.153379],
  [40.014479, -83.153409],
  [40.014669, -83.153469],
  [40.014929, -83.15358],
  [40.01517, -83.15371],
  [40.015379, -83.153859],
  [40.015639, -83.15408],
  [40.01576, -83.15421],
  [40.01579, -83.154239],
  [40.01594, -83.15439],
  [40.01616, -83.154689],
  [40.016349, -83.154999],
  [40.01649, -83.155269],
  [40.01661, -83.155539],
  [40.01668, -83.155749],
  [40.01675, -83.155949],
  [40.01677, -83.15605],
  [40.016899, -83.15655],
  [40.017099, -83.157289],
  [40.017239, -83.15766],
  [40.017339, -83.157879],
  [40.01749, -83.158149],
  [40.017689, -83.158449],
  [40.017809, -83.158599],
  [40.018049, -83.158869],
  [40.018329, -83.159129],
  [40.018509, -83.159259],
  [40.018629, -83.15934],
  [40.01877, -83.15942],
  [40.018969, -83.15951],
  [40.019049, -83.15955],
  [40.019169, -83.159589],
  [40.01938, -83.15965],
  [40.01954, -83.159679],
  [40.02, -83.159769],
  [40.020239, -83.159799],
  [40.02093, -83.159899],
  [40.02098, -83.15991],
  [40.021849, -83.160039],
  [40.022279, -83.16011],
  [40.022739, -83.160169],
  [40.02296, -83.1602],
  [40.02327, -83.16024],
  [40.023489, -83.16027],
  [40.023549, -83.16028],
  [40.02396, -83.160339],
  [40.02422, -83.160389],
  [40.02442, -83.16042],
  [40.0246, -83.16045],
  [40.02514, -83.16054],
  [40.025379, -83.160579],
  [40.02585, -83.16065],
  [40.02605, -83.16068],
  [40.026099, -83.16069],
  [40.026639, -83.16078],
  [40.02674, -83.160799],
  [40.02703, -83.160839],
  [40.02719, -83.16087],
  [40.02738, -83.1609],
  [40.02746, -83.16091],
  [40.02783, -83.160969],
  [40.02803, -83.161],
  [40.02828, -83.16104],
  [40.028339, -83.16101],
  [40.028419, -83.161],
  [40.028499, -83.16101],
  [40.02856, -83.161019],
  [40.028619, -83.16101],
  [40.02874, -83.16099],
  [40.028769, -83.16092],
  [40.02884, -83.160839],
  [40.02893, -83.16083],
  [40.02903, -83.16086],
  [40.0291, -83.16095],
  [40.02912, -83.16108],
  [40.0291, -83.16119],
  [40.029059, -83.16126],
  [40.02899, -83.161299],
  [40.02893, -83.16131],
  [40.02883, -83.16128],
  [40.02876, -83.16119],
  [40.02864, -83.161159],
  [40.02855, -83.16114],
  [40.02848, -83.161119],
  [40.028419, -83.161109],
  [40.028349, -83.16109],
  [40.02828, -83.16104],
  [40.02803, -83.161],
  [40.02783, -83.160969],
  [40.02746, -83.16091],
  [40.02738, -83.1609],
  [40.02719, -83.16087],
  [40.02703, -83.160839],
  [40.02674, -83.160799],
  [40.026639, -83.16078],
  [40.026099, -83.16069],
  [40.02605, -83.16068],
  [40.02585, -83.16065],
  [40.025379, -83.160579],
  [40.02514, -83.16054],
  [40.025079, -83.161209],
  [40.02505, -83.16149],
  [40.02505, -83.16164],
  [40.02504, -83.161749],
  [40.02506, -83.16216],
  [40.025089, -83.162679],
  [40.02506, -83.162819],
  [40.025009, -83.16298],
  [40.024899, -83.163139],
  [40.0248, -83.163239],
  [40.02469, -83.16334],
  [40.02452, -83.163399],
  [40.024379, -83.163409],
  [40.02425, -83.16339],
  [40.024099, -83.163329],
  [40.0237, -83.16317],
  [40.02353, -83.163129],
  [40.023199, -83.16311],
  [40.022839, -83.16307],
  [40.022669, -83.162999],
  [40.02254, -83.162909],
  [40.02244, -83.1628],
  [40.02224, -83.162499],
  [40.02217, -83.162279],
  [40.02215, -83.162139],
  [40.022129, -83.16191],
  [40.022209, -83.160969],
  [40.022209, -83.160929]
];

const stopNames = {
  "SOUTER3": "COTA TRANSIT TERMINAL BAY 3",
  "4THTOWN": "S 4TH ST &amp; E TOWN ST",
  "SPRFROW": "W SPRING ST &amp; N FRONT ST",
  "HILNIKN": "HILLIARD ROME RD &amp; NIKE DR",
  "HILROBN": "HILLIARD ROME &amp; ROBERTS RD",
  "MAILUTN": "MAIN ST &amp; LUTHER LN",
  "SPRMARW": "W SPRING ST &amp; MARCONI BLVD",
  "HILCOVN": "HILLIARD ROME RD &amp; CABOT COVE DR",
  "HILWHIN": "HILLIARD ROME &amp; WHISPERING OAK BLVD",
  "HILSPRN": "HILLIARD ROME RD &amp; SPRINGDALE BLVD",
  "4THATHN": "N 4TH ST &amp; E GAY ST",
  "HILTINAN": "HILLIARD ROME RD &amp; TINAPPLE RD",
  "MAISCIN": "MAIN ST &amp; SCIOTO DARBY CREEK RD",
  "MAISCIS": "MAIN ST &amp; SCIOTO DARBY RD",
  "RENRPRE": "RENNER RD PARK AND RIDE",
  "TANWECN": "TANGLEWOOD PARK BLVD &amp; WESTCHESTER",
  "TANSTEN": "TANGLEWOOD PARK BLVD &amp; STEFFI DR",
  "SPR4THW": "E SPRING ST &amp; N 4TH ST",
  "4THCAPN": "S 4TH ST &amp; E CAPITAL ST",
  "HERCOLWB": "HERITAGE CLUB DR &amp; COLONIAL DR",
  "HERMAIE": "HERITAGE CLUB DR &amp; MAIN ST"
};

const stops = [
  { stop_id: "SOUTER3", name: "COTA TRANSIT TERMINAL BAY 3", lat: 39.957006, lon: -82.998928, times: ["5:10 PM"] },
  { stop_id: "4THTOWN", name: "S 4TH ST &amp; E TOWN ST", lat: 39.958965, lon: -82.995424, times: ["5:15 PM"] },
  { stop_id: "4THCAPN", name: "S 4TH ST &amp; E CAPITAL ST", lat: 39.961951, lon: -82.995987, times: ["5:17 PM"] },
  { stop_id: "4THATHN", name: "N 4TH ST &amp; E GAY ST", lat: 39.963808, lon: -82.996336, times: ["5:18 PM"] },
  { stop_id: "SPR4THW", name: "E SPRING ST &amp; N 4TH ST", lat: 39.966769, lon: -82.997738, times: ["5:19 PM"] },
  { stop_id: "SPRFROW", name: "W SPRING ST &amp; N FRONT ST", lat: 39.966198, lon: -83.002659, times: ["5:22 PM"] },
  { stop_id: "SPRMARW", name: "W SPRING ST &amp; MARCONI BLVD", lat: 39.965979, lon: -83.004621, times: ["5:22 PM"] },
  { stop_id: "RENRPRE", name: "RENNER RD PARK AND RIDE", lat: 39.982243, lon: -83.154542, times: ["5:42 PM"] },
  { stop_id: "TANWECN", name: "TANGLEWOOD PARK BLVD &amp; WESTCHESTER", lat: 39.985884, lon: -83.154787, times: ["5:42 PM"] },
  { stop_id: "TANSTEN", name: "TANGLEWOOD PARK BLVD &amp; STEFFI DR", lat: 39.990265, lon: -83.155463, times: ["5:43 PM"] },
  { stop_id: "HILNIKN", name: "HILLIARD ROME RD &amp; NIKE DR", lat: 39.994632, lon: -83.152319, times: ["5:45 PM"] },
  { stop_id: "HILCOVN", name: "HILLIARD ROME RD &amp; CABOT COVE DR", lat: 39.99864, lon: -83.152954, times: ["5:46 PM"] },
  { stop_id: "HILROBN", name: "HILLIARD ROME &amp; ROBERTS RD", lat: 40.004185, lon: -83.153716, times: ["5:47 PM"] },
  { stop_id: "HILWHIN", name: "HILLIARD ROME &amp; WHISPERING OAK BLVD", lat: 40.008425, lon: -83.153484, times: ["5:48 PM"] },
  { stop_id: "HILSPRN", name: "HILLIARD ROME RD &amp; SPRINGDALE BLVD", lat: 40.013616, lon: -83.153191, times: ["5:49 PM"] },
  { stop_id: "HILTINAN", name: "HILLIARD ROME RD &amp; TINAPPLE RD", lat: 40.017091, lon: -83.156968, times: ["5:50 PM"] },
  { stop_id: "MAILUTN", name: "MAIN ST &amp; LUTHER LN", lat: 40.02266, lon: -83.160043, times: ["5:51 PM"] },
  { stop_id: "MAISCIN", name: "MAIN ST &amp; SCIOTO DARBY CREEK RD", lat: 40.027281, lon: -83.16076, times: ["5:53 PM"] },
  { stop_id: "MAISCIS", name: "MAIN ST &amp; SCIOTO DARBY RD", lat: 40.027656, lon: -83.161061, times: ["5:55 PM"] },
  { stop_id: "HERCOLWB", name: "HERITAGE CLUB DR &amp; COLONIAL DR", lat: 40.025156, lon: -83.162651, times: ["5:56 PM"] },
  { stop_id: "HERMAIE", name: "HERITAGE CLUB DR &amp; MAIN ST", lat: 40.022153, lon: -83.160981, times: ["5:57 PM"] },
]

  const polylineOut = L.polyline(shapeOutbound, {
    color: 'blue',
    weight: 4,
    opacity: 0.7
  }).addTo(map);

  map.fitBounds(polylineOut.getBounds());

  stops.forEach(stop => {
    const marker = L.circleMarker([stop.lat, stop.lon], {
      radius: 6,
      color: '#4dd0e1',
      fillColor: '#4dd0e1',
      fillOpacity: 0.9,
      weight: 1
    });

    const popupContent = `
      <strong>${stop.name}</strong><br>
      ${stop.times && stop.times.length ? stop.times.join("<br>") : "No scheduled times"}
    `;

    marker.bindPopup(popupContent);
    marker.addTo(map);
  });

  let busMarkers = {};

  async function fetchAndDisplay() {
    const res = await fetch(`https://developer.trimet.org/ws/v2/vehicles?route=${routeNumber}&appID=${apiKey}&json=true`);
    const data = await res.json();
    const buses = (data.resultSet.vehicle || []).filter(v =>
      v.routeNumber == routeNumber && v.direction == direction
    );

    Object.values(busMarkers).forEach(m => map.removeLayer(m));
    busMarkers = {};

    if (buses.length === 0) return;

    buses.forEach(bus => {
      if (!bus.latitude || !bus.longitude || !bus.blockID) return;

      const icon = L.divIcon({
        className: '',
        html: `
          <div style="text-align:center;">
            <div style="background:#0071CE;color:#fff;padding:2px 6px;border-radius:6px;font-weight:bold;">${bus.vehicleID}</div>
            <div style="width:0;height:0;border-left:5px solid transparent;border-right:5px solid transparent;border-top:10px solid #00bfff;margin:auto;"></div>
          </div>
        `,
        iconSize: [40, 30],
        iconAnchor: [20, 30]
      });

      const marker = L.marker([bus.latitude, bus.longitude], { icon }).addTo(map);
      busMarkers[bus.vehicleID] = marker;
    });
  }

  fetchAndDisplay();
  setInterval(fetchAndDisplay, 15000);
  </script>

<footer class="site-footer">
  <a href="terms.html">Terms of Use</a> &nbsp;|&nbsp;
  <a href="contact.html">Contact Us</a> &nbsp;|&nbsp;
  <a href="report.html">Report a Problem</a> &nbsp;|&nbsp;
  <a href="privacy.html">Privacy Policy</a>
</footer>

<div id="cookie-banner" style="display: none; position: fixed; bottom: 0; width: 100%; background: #333; color: #fff; text-align: center; padding: 1rem; z-index: 1000; font-size: 0.9rem;">
  📢 We use cookies for personalized ads and analytics. By using MetroFeed, you agree to our 
  <a href="privacy.html" style="color: #4dd0e1; text-decoration: underline;">Privacy Policy</a>.
  <button onclick="acceptCookies()" style="margin-left: 1rem; background: #4dd0e1; color: #000; border: none; padding: 0.5rem 1rem; border-radius: 5px; cursor: pointer;">OK</button>
</div>

<script>
  function acceptCookies() {
    localStorage.setItem('cookieConsent', 'true');
    document.getElementById('cookie-banner').style.display = 'none';
  }

  window.onload = function() {
    if (!localStorage.getItem('cookieConsent')) {
      document.getElementById('cookie-banner').style.display = 'block';
    }
  }
</script>


</body>
</html>