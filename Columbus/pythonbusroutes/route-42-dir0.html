<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Route 42 ‚Äì SHARON WOODS | MetroFeed Portland</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background-color: #0d0d0d;
      color: #cccccc;
    }
    header {
      background-color: #0d0d0d;
      border-bottom: 3px solid #4dd0e1;
      padding: 1rem;
      text-align: center;
    }
    header img {
      max-height: 60px;
    }
    .ad-banner {
      text-align: center;
      margin: 1rem auto;
      background-color: #222;
      color: #888;
      padding: 1rem;
      border: 2px dashed #4dd0e1;
      font-size: 0.9rem;
      border-radius: 8px;
    }
    h1 {
      text-align: center;
      margin: 1rem 0;
      font-size: 2rem;
      color: #f0f0f0;
    }
    .content-box {
      border: 2px solid #4dd0e1;
      border-radius: 12px;
      padding: 1rem;
      margin: 1rem;
      background-color: #1e1e1e;
    }
    #map {
      width: 100%;
      height: 400px;
      border-radius: 8px;
    }
    .button-bar {
      display: flex;
      justify-content: center;
      margin: 1rem 0;
    }
    .button-bar a {
      background: #4dd0e1;
      color: #0d0d0d;
      padding: 0.5rem 1rem;
      text-decoration: none;
      border-radius: 8px;
      font-weight: bold;
    }

.back-button {
  background-color: #4dd0e1;
  color: #0d0d0d;
  border: none;
  padding: 0.6rem 1.2rem;
  font-size: 1rem;
  font-weight: bold;
  border-radius: 8px;
  cursor: pointer;
  box-shadow: 0 0 10px #4dd0e1;
  text-decoration: none;
}
.back-button:hover {
  background-color: #35c0d6;
}
.site-footer {
      text-align: center;
      margin-top: 3rem;
      margin-bottom: 120px;
      font-size: 0.85rem;
      color: #aaa;
    }
    .site-footer a {
      color: #00BFFF;
      text-decoration: none;
    }
    .site-footer a:hover {
      text-decoration: underline;
    }

  </style>
</head>
<body>
  <header>
    <img src="MetroFeedPortlandLogo.png" alt="MetroFeed Portland">
  </header>

  <div class="ad-banner">
    [Ad Banner Placeholder ‚Äî 300x250]
  </div>

  <div class="disclaimer" style="margin: 1rem auto 0.5rem; max-width: 600px; font-size: 0.8rem; color: #bbb; text-align: center; padding: 0.5rem 1rem; background-color: #111; border: 1px dashed #444; border-radius: 6px;">
    ‚ö†Ô∏è This is a Beta program, work in progress. Please REPORT bugs and pretend to be impressed.
  </div>
  <div class="disclaimer" style="margin: 0 auto 1rem; max-width: 600px; font-size: 0.75rem; color: #888; text-align: center; padding: 0.25rem 1rem;">
    This tool is not affiliated with or endorsed by TriMet. For official schedules and service alerts, visit <a href="https://trimet.org" style="color:#4dd0e1;">trimet.org</a>.
  </div>

  <div style="margin: 2rem 0; text-align: center;">
  <button class="back-button" onclick="history.back()">‚¨Ö Back</button>
  </div>

  <h1>Route 42 ‚Äì SHARON WOODS</h1>

  <div class="content-box">
    <div id="map"></div>
    <div style="text-align:right; font-size: 0.7rem; color: #777; margin-top: 0.5rem;">
      Data courtesy of TriMet.
    </div>
  </div>

  
  <script>
  const apiKey = "2C4447D4A42083BCD84DE3B8E";
  const routeNumber = 42;
  const direction = parseInt(0);

  const map = L.map('map').setView([45.6, -122.7], 12);
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    maxZoom: 19
  }).addTo(map);

  const shapeOutbound = [
  [39.956235, -82.998909],
  [39.957556, -82.999183],
  [39.95754, -82.99928],
  [39.95748, -82.999749],
  [39.95819, -82.999879],
  [39.95872, -82.99998],
  [39.95881, -83.0],
  [39.958849, -83.000009],
  [39.95892, -83.00003],
  [39.95943, -83.000139],
  [39.96017, -83.0003],
  [39.961009, -83.00045],
  [39.96116, -83.00048],
  [39.96131, -83.000509],
  [39.961469, -83.00054],
  [39.96221, -83.000679],
  [39.96293, -83.000819],
  [39.963629, -83.000949],
  [39.96411, -83.001039],
  [39.964259, -83.00107],
  [39.96494, -83.001189],
  [39.965069, -83.00026],
  [39.96509, -83.00008],
  [39.96511, -82.999879],
  [39.96518, -82.999339],
  [39.9652, -82.999149],
  [39.965219, -82.999],
  [39.965239, -82.99887],
  [39.965249, -82.998749],
  [39.96528, -82.998529],
  [39.96538, -82.997639],
  [39.965409, -82.99739],
  [39.965499, -82.996739],
  [39.965519, -82.996549],
  [39.96554, -82.99635],
  [39.96556, -82.99607],
  [39.96557, -82.99589],
  [39.965579, -82.99577],
  [39.965619, -82.995419],
  [39.965679, -82.994889],
  [39.965779, -82.99406],
  [39.96581, -82.99378],
  [39.96583, -82.993569],
  [39.96592, -82.992849],
  [39.965939, -82.99269],
  [39.966, -82.99217],
  [39.966069, -82.991559],
  [39.966139, -82.991019],
  [39.966149, -82.99091],
  [39.96621, -82.99046],
  [39.966239, -82.990209],
  [39.96635, -82.989269],
  [39.96639, -82.988889],
  [39.966409, -82.988719],
  [39.96647, -82.98824],
  [39.96654, -82.987589],
  [39.966589, -82.98717],
  [39.966599, -82.987059],
  [39.966609, -82.98694],
  [39.966689, -82.98623],
  [39.966699, -82.98618],
  [39.96674, -82.985829],
  [39.966779, -82.985479],
  [39.966789, -82.985349],
  [39.966849, -82.984939],
  [39.966879, -82.98456],
  [39.96689, -82.984449],
  [39.966939, -82.984039],
  [39.966959, -82.98389],
  [39.96698, -82.983719],
  [39.967, -82.983589],
  [39.967029, -82.98334],
  [39.967039, -82.9832],
  [39.967059, -82.98302],
  [39.96709, -82.98272],
  [39.96728, -82.982739],
  [39.96745, -82.982769],
  [39.96755, -82.9828],
  [39.9677, -82.98285],
  [39.9679, -82.982959],
  [39.968119, -82.983099],
  [39.96828, -82.983179],
  [39.96842, -82.983219],
  [39.968639, -82.98326],
  [39.968919, -82.98334],
  [39.96933, -82.98339],
  [39.96969, -82.98342],
  [39.970009, -82.98343],
  [39.970209, -82.98343],
  [39.970649, -82.98339],
  [39.97113, -82.98338],
  [39.97161, -82.98334],
  [39.972169, -82.983279],
  [39.972619, -82.9832],
  [39.97294, -82.98316],
  [39.97319, -82.98317],
  [39.973429, -82.98321],
  [39.97373, -82.98317],
  [39.97383, -82.98316],
  [39.9742, -82.98311],
  [39.97445, -82.98311],
  [39.974709, -82.98312],
  [39.9751, -82.98316],
  [39.97529, -82.983179],
  [39.975489, -82.98321],
  [39.97589, -82.983269],
  [39.97697, -82.98344],
  [39.97725, -82.983499],
  [39.977389, -82.98353],
  [39.977949, -82.983629],
  [39.978269, -82.98369],
  [39.978639, -82.983769],
  [39.978759, -82.98379],
  [39.978809, -82.9838],
  [39.97914, -82.983859],
  [39.97934, -82.983899],
  [39.97986, -82.983989],
  [39.980469, -82.984119],
  [39.98111, -82.98424],
  [39.98156, -82.98432],
  [39.9816, -82.98433],
  [39.982169, -82.984439],
  [39.98273, -82.98455],
  [39.982889, -82.98459],
  [39.983439, -82.984709],
  [39.98428, -82.98487],
  [39.985479, -82.985109],
  [39.985869, -82.98518],
  [39.986309, -82.985259],
  [39.987029, -82.98536],
  [39.987289, -82.985389],
  [39.98752, -82.98542],
  [39.988009, -82.985469],
  [39.9885, -82.985479],
  [39.988739, -82.985469],
  [39.989109, -82.98545],
  [39.989359, -82.985429],
  [39.9897, -82.98542],
  [39.99006, -82.9854],
  [39.99012, -82.985389],
  [39.9902, -82.985379],
  [39.991439, -82.985249],
  [39.991779, -82.98522],
  [39.992259, -82.985169],
  [39.993589, -82.98504],
  [39.99384, -82.985019],
  [39.99489, -82.98491],
  [39.996009, -82.984799],
  [39.996209, -82.98479],
  [39.99644, -82.98477],
  [39.997539, -82.984659],
  [39.99814, -82.98461],
  [39.99913, -82.98451],
  [40.0002, -82.984449],
  [40.000719, -82.98443],
  [40.001519, -82.98442],
  [40.001709, -82.98442],
  [40.002, -82.98442],
  [40.002699, -82.98442],
  [40.00283, -82.98442],
  [40.003599, -82.98443],
  [40.00382, -82.98443],
  [40.004129, -82.98443],
  [40.00488, -82.984439],
  [40.005379, -82.98447],
  [40.005569, -82.9845],
  [40.00589, -82.98455],
  [40.00641, -82.98469],
  [40.006899, -82.98488],
  [40.00724, -82.98506],
  [40.00752, -82.985199],
  [40.00784, -82.98541],
  [40.00804, -82.985569],
  [40.0083, -82.98576],
  [40.008719, -82.986149],
  [40.00912, -82.98658],
  [40.00949, -82.987059],
  [40.009809, -82.987549],
  [40.010079, -82.988049],
  [40.010419, -82.98875],
  [40.010869, -82.98964],
  [40.01101, -82.98992],
  [40.01117, -82.99023],
  [40.011489, -82.99081],
  [40.011769, -82.99127],
  [40.01199, -82.991589],
  [40.0122, -82.99188],
  [40.01262, -82.99233],
  [40.013049, -82.99278],
  [40.013499, -82.993179],
  [40.01397, -82.99355],
  [40.01444, -82.99386],
  [40.01488, -82.9941],
  [40.01497, -82.99414],
  [40.01544, -82.994349],
  [40.01589, -82.994519],
  [40.01597, -82.99455],
  [40.016079, -82.99458],
  [40.0165, -82.99469],
  [40.01703, -82.99478],
  [40.01757, -82.99485],
  [40.017869, -82.994879],
  [40.01838, -82.994929],
  [40.0192, -82.995],
  [40.01975, -82.99503],
  [40.02057, -82.99504],
  [40.021209, -82.99503],
  [40.022229, -82.99499],
  [40.02306, -82.994919],
  [40.0236, -82.994839],
  [40.02408, -82.99477],
  [40.024829, -82.99459],
  [40.02523, -82.9945],
  [40.026349, -82.994249],
  [40.026599, -82.994209],
  [40.026809, -82.99418],
  [40.027139, -82.99414],
  [40.02773, -82.994109],
  [40.028249, -82.994109],
  [40.02864, -82.99413],
  [40.0289, -82.994159],
  [40.029139, -82.99419],
  [40.02964, -82.994249],
  [40.03018, -82.99436],
  [40.030649, -82.99449],
  [40.030949, -82.99458],
  [40.03153, -82.99478],
  [40.03161, -82.99481],
  [40.03205, -82.995],
  [40.03225, -82.99509],
  [40.033099, -82.99548],
  [40.03335, -82.99559],
  [40.03352, -82.99566],
  [40.03388, -82.99581],
  [40.034559, -82.996049],
  [40.03522, -82.99625],
  [40.035369, -82.996289],
  [40.03577, -82.996379],
  [40.03631, -82.99649],
  [40.03686, -82.99657],
  [40.03746, -82.996629],
  [40.037679, -82.996649],
  [40.038779, -82.996729],
  [40.0416, -82.99693],
  [40.042449, -82.996989],
  [40.042929, -82.99702],
  [40.04376, -82.997079],
  [40.04486, -82.997179],
  [40.045959, -82.997229],
  [40.046339, -82.997259],
  [40.047059, -82.997319],
  [40.048059, -82.99739],
  [40.04873, -82.99743],
  [40.049829, -82.99751],
  [40.050189, -82.997539],
  [40.05054, -82.99756],
  [40.05089, -82.997589],
  [40.05276, -82.997729],
  [40.056409, -82.997989],
  [40.057399, -82.99806],
  [40.057829, -82.998089],
  [40.058589, -82.99796],
  [40.05899, -82.997889],
  [40.05951, -82.99774],
  [40.059829, -82.997619],
  [40.059999, -82.99756],
  [40.06031, -82.997409],
  [40.060469, -82.99733],
  [40.06059, -82.997279],
  [40.060829, -82.99716],
  [40.060989, -82.99712],
  [40.061169, -82.99707],
  [40.061369, -82.99706],
  [40.06157, -82.99706],
  [40.061539, -82.99631],
  [40.061529, -82.995919],
  [40.061519, -82.99544],
  [40.061519, -82.995329],
  [40.06151, -82.99514],
  [40.06149, -82.994559],
  [40.061469, -82.994159],
  [40.061459, -82.99391],
  [40.061439, -82.9935],
  [40.061429, -82.99324],
  [40.06142, -82.992989],
  [40.0614, -82.99252],
  [40.061379, -82.99199],
  [40.061369, -82.991689],
  [40.06132, -82.990569],
  [40.061279, -82.98969],
  [40.061249, -82.98905],
  [40.06122, -82.98839],
  [40.06121, -82.988179],
  [40.061199, -82.98803],
  [40.061159, -82.987289],
  [40.06113, -82.98675],
  [40.06112, -82.98662],
  [40.061089, -82.986199],
  [40.061069, -82.9859],
  [40.06105, -82.98563],
  [40.061019, -82.9851],
  [40.060999, -82.9847],
  [40.06096, -82.984129],
  [40.06094, -82.9837],
  [40.060919, -82.983409],
  [40.06088, -82.982689],
  [40.060839, -82.982],
  [40.0608, -82.981389],
  [40.06077, -82.980879],
  [40.060739, -82.98037],
  [40.06069, -82.979629],
  [40.06069, -82.97952],
  [40.060659, -82.978949],
  [40.060659, -82.97888],
  [40.060649, -82.978769],
  [40.060639, -82.97844],
  [40.060629, -82.978329],
  [40.060629, -82.978279],
  [40.06061, -82.97794],
  [40.06058, -82.97736],
  [40.061099, -82.97732],
  [40.06112, -82.97732],
  [40.061159, -82.97732],
  [40.06141, -82.9773],
  [40.0615, -82.977289],
  [40.061539, -82.977289],
  [40.06167, -82.977279],
  [40.061969, -82.97726],
  [40.062349, -82.97722],
  [40.062369, -82.97722],
  [40.062419, -82.97722],
  [40.062509, -82.97721],
  [40.062599, -82.977199],
  [40.063159, -82.977149],
  [40.063789, -82.97709],
  [40.06526, -82.97696],
  [40.06663, -82.97685],
  [40.066779, -82.976839],
  [40.066939, -82.97682],
  [40.06818, -82.97673],
  [40.06835, -82.97672],
  [40.07032, -82.97654],
  [40.070619, -82.976519],
  [40.070709, -82.97651],
  [40.07087, -82.9765],
  [40.07149, -82.97645],
  [40.07185, -82.976429],
  [40.072269, -82.976389],
  [40.07232, -82.976389],
  [40.07237, -82.976389],
  [40.073079, -82.97632],
  [40.07346, -82.976289],
  [40.07357, -82.97628],
  [40.073879, -82.976259],
  [40.075599, -82.97614],
  [40.076229, -82.97609],
  [40.07645, -82.976069],
  [40.076859, -82.97604],
  [40.077039, -82.976029],
  [40.07768, -82.975979],
  [40.07832, -82.975929],
  [40.07869, -82.975899],
  [40.078909, -82.97588],
  [40.07895, -82.97588],
  [40.07987, -82.975809],
  [40.08014, -82.97579],
  [40.08058, -82.975749],
  [40.08066, -82.97574],
  [40.080989, -82.975709],
  [40.081089, -82.9757],
  [40.08155, -82.975669],
  [40.081799, -82.97565],
  [40.081959, -82.97564],
  [40.083059, -82.975569],
  [40.083509, -82.975539],
  [40.08428, -82.975489],
  [40.084659, -82.97546],
  [40.085029, -82.97543],
  [40.085109, -82.97542],
  [40.085489, -82.975389],
  [40.08555, -82.975389],
  [40.085759, -82.97538],
  [40.085949, -82.97537],
  [40.086399, -82.97534],
  [40.08654, -82.97533],
  [40.08679, -82.975309],
  [40.08708, -82.97529],
  [40.08723, -82.97528],
  [40.08768, -82.975259],
  [40.087749, -82.975259],
  [40.08814, -82.97523],
  [40.088199, -82.97523],
  [40.088289, -82.97523],
  [40.088379, -82.97525],
  [40.088459, -82.975259],
  [40.08851, -82.97528],
  [40.08895, -82.97543],
  [40.089169, -82.97547],
  [40.08942, -82.975479],
  [40.089799, -82.975449],
  [40.090509, -82.975399],
  [40.09145, -82.97534],
  [40.09182, -82.975309],
  [40.09209, -82.97529],
  [40.092309, -82.975299],
  [40.092409, -82.975309],
  [40.09254, -82.97533],
  [40.09281, -82.97543],
  [40.093059, -82.975569],
  [40.09325, -82.97573],
  [40.09353, -82.975929],
  [40.093589, -82.97596],
  [40.09373, -82.97605],
  [40.093849, -82.97609],
  [40.09397, -82.976119],
  [40.09416, -82.976119],
  [40.09489, -82.97609],
  [40.095119, -82.976069],
  [40.096529, -82.975979],
  [40.096899, -82.97596],
  [40.09696, -82.97596],
  [40.097639, -82.97592],
  [40.09806, -82.975849],
  [40.09824, -82.97579],
  [40.098439, -82.97569],
  [40.09874, -82.97552],
  [40.09913, -82.97528],
  [40.0995, -82.97507],
  [40.09965, -82.974999],
  [40.099879, -82.974939],
  [40.100069, -82.97493],
  [40.1002, -82.97492],
  [40.10039, -82.974909],
  [40.100509, -82.974909],
  [40.101039, -82.97487],
  [40.10272, -82.97474],
  [40.10346, -82.974679],
  [40.103769, -82.974669],
  [40.10406, -82.974639],
  [40.10435, -82.97461],
  [40.104489, -82.9746],
  [40.104749, -82.974579],
  [40.10498, -82.97456],
  [40.105289, -82.974539],
  [40.105289, -82.974179],
  [40.105269, -82.97357],
  [40.10532, -82.97307],
  [40.105379, -82.97268],
  [40.1054, -82.972569],
  [40.105569, -82.97196],
  [40.105629, -82.97174],
  [40.105899, -82.970799],
  [40.105989, -82.970449],
  [40.10606, -82.970179],
  [40.10622, -82.96962],
  [40.106349, -82.96913],
  [40.106439, -82.9688],
  [40.106529, -82.96848],
  [40.106619, -82.96814],
  [40.10677, -82.96758],
  [40.10693, -82.96692],
  [40.106989, -82.96646],
  [40.106989, -82.96598],
  [40.106979, -82.965759],
  [40.10696, -82.964779],
  [40.10697, -82.96431],
  [40.106979, -82.96421],
  [40.10702, -82.96391],
  [40.10705, -82.96377],
  [40.10711, -82.9635],
  [40.1072, -82.96314],
  [40.10685, -82.962979],
  [40.106539, -82.962899],
  [40.10615, -82.962849],
  [40.10579, -82.962849],
  [40.105479, -82.96287],
  [40.10523, -82.96291],
  [40.10487, -82.962979],
  [40.10391, -82.963149],
  [40.10351, -82.963159],
  [40.102959, -82.963119],
  [40.10279, -82.963069],
  [40.102399, -82.96295],
  [40.101689, -82.962659],
  [40.10129, -82.9625],
  [40.10084, -82.962309],
  [40.100509, -82.962219],
  [40.10019, -82.962159],
  [40.09977, -82.96214],
  [40.099529, -82.96215],
  [40.09932, -82.962169],
  [40.098999, -82.96223],
  [40.098449, -82.96246],
  [40.098089, -82.96264],
  [40.097459, -82.962969],
  [40.097109, -82.96318],
  [40.096809, -82.96341],
  [40.096379, -82.963789],
  [40.096119, -82.964069],
  [40.09604, -82.96417],
  [40.095749, -82.964499],
  [40.095379, -82.96506],
  [40.09488, -82.965909]
];

const stopNames = {
  "SOUTER6": "COTA TRANSIT TERMINAL BAY 6",
  "KARHEMN": "KARL RD &amp; HEMPWOOD DR",
  "KAR629N": "6292 KARL RD",
  "MORSANE": "MORSE RD &amp; SANDY LANE RD",
  "MORMAIE": "MORSE RD &amp; MAIZE RD",
  "MORALME": "MORSE RD &amp; ALMONT DR",
  "KARMORN": "KARL RD &amp; MORSE RD",
  "KARREDN": "KARL RD &amp; RED ROBIN RD",
  "KARNORMN": "KARL RD &amp; NORMA RD",
  "KARPENN": "KARL RD &amp; PENWORTH DR",
  "KARSANN": "KARL RD &amp; SANDALWOOD PL",
  "KAR161N": "KARL RD &amp; STATE ROUTE 161",
  "KAR602N": "6024 KARL RD",
  "KARALPN": "KARL RD &amp; ALPINE DR",
  "KARCRAN": "KARL RD &amp; CRANWOOD DR",
  "KARBARN": "KARL RD &amp; BARNES DR E",
  "HIGSTANN": "S HIGH ST &amp; E STATE ST",
  "LON4THE": "E LONG ST &amp; N 4TH ST",
  "LONWASE": "E LONG ST &amp; N WASHINGTON AVE",
  "KARCOLN": "KARL RD &amp; COLUMBUS PUBLIC LIBRARY",
  "HIGLONN2": "N HIGH ST &amp; E LONG ST",
  "HIGBRONN": "S HIGH ST &amp; E BROAD ST",
  "SCHKARE": "SCHROCK RD &amp; KARL RD",
  "SCHSKYE": "SCHROCK RD &amp; SKYWAE DR",
  "SCHSHAE": "SCHROCK RD &amp; SHARON WOODS BLVD",
  "SHAHEAS": "SHARON WOODS BLVD &amp; HEARTHSTONE AVE",
  "SHAMEAS": "SHARON WOODS BLVD &amp; MEANDER DR",
  "SHASKYS": "SHARON WOODS BLVD &amp; SKYWAE DR"
};

const stops = [
  { stop_id: "SOUTER6", name: "COTA TRANSIT TERMINAL BAY 6", lat: 39.956939, lon: -82.999038, times: ["5:13 PM"] },
  { stop_id: "HIGSTANN", name: "S HIGH ST &amp; E STATE ST", lat: 39.959828, lon: -83.000011, times: ["5:16 PM"] },
  { stop_id: "HIGBRONN", name: "S HIGH ST &amp; E BROAD ST", lat: 39.961674, lon: -83.000405, times: ["5:17 PM"] },
  { stop_id: "HIGLONN2", name: "N HIGH ST &amp; E LONG ST", lat: 39.964416, lon: -83.000956, times: ["5:19 PM"] },
  { stop_id: "LON4THE", name: "E LONG ST &amp; N 4TH ST", lat: 39.965299, lon: -82.996981, times: ["5:19 PM"] },
  { stop_id: "LONWASE", name: "E LONG ST &amp; N WASHINGTON AVE", lat: 39.966475, lon: -82.987289, times: ["5:20 PM"] },
  { stop_id: "MORSANE", name: "MORSE RD &amp; SANDY LANE RD", lat: 40.061264, lon: -82.992829, times: ["5:35 PM"] },
  { stop_id: "MORMAIE", name: "MORSE RD &amp; MAIZE RD", lat: 40.061006, lon: -82.986753, times: ["5:35 PM"] },
  { stop_id: "MORALME", name: "MORSE RD &amp; ALMONT DR", lat: 40.06077, lon: -82.983053, times: ["5:36 PM"] },
  { stop_id: "KARMORN", name: "KARL RD &amp; MORSE RD", lat: 40.061252, lon: -82.977198, times: ["5:37 PM"] },
  { stop_id: "KARREDN", name: "KARL RD &amp; RED ROBIN RD", lat: 40.064983, lon: -82.976924, times: ["5:37 PM"] },
  { stop_id: "KARNORMN", name: "KARL RD &amp; NORMA RD", lat: 40.068175, lon: -82.976663, times: ["5:38 PM"] },
  { stop_id: "KARPENN", name: "KARL RD &amp; PENWORTH DR", lat: 40.071638, lon: -82.976386, times: ["5:38 PM"] },
  { stop_id: "KARSANN", name: "KARL RD &amp; SANDALWOOD PL", lat: 40.077368, lon: -82.975909, times: ["5:39 PM"] },
  { stop_id: "KARCOLN", name: "KARL RD &amp; COLUMBUS PUBLIC LIBRARY", lat: 40.08099, lon: -82.975612, times: ["5:40 PM"] },
  { stop_id: "KARHEMN", name: "KARL RD &amp; HEMPWOOD DR", lat: 40.084416, lon: -82.975401, times: ["5:41 PM"] },
  { stop_id: "KAR161N", name: "KARL RD &amp; STATE ROUTE 161", lat: 40.087992, lon: -82.975151, times: ["5:42 PM"] },
  { stop_id: "KAR602N", name: "6024 KARL RD", lat: 40.090253, lon: -82.975393, times: ["5:42 PM"] },
  { stop_id: "KARALPN", name: "KARL RD &amp; ALPINE DR", lat: 40.092959, lon: -82.97545, times: ["5:42 PM"] },
  { stop_id: "KAR629N", name: "6292 KARL RD", lat: 40.095763, lon: -82.975972, times: ["5:43 PM"] },
  { stop_id: "KARCRAN", name: "KARL RD &amp; CRANWOOD DR", lat: 40.099415, lon: -82.975069, times: ["5:44 PM"] },
  { stop_id: "KARBARN", name: "KARL RD &amp; BARNES DR E", lat: 40.103565, lon: -82.974602, times: ["5:44 PM"] },
  { stop_id: "SCHKARE", name: "SCHROCK RD &amp; KARL RD", lat: 40.105158, lon: -82.974095, times: ["5:45 PM"] },
  { stop_id: "SCHSKYE", name: "SCHROCK RD &amp; SKYWAE DR", lat: 40.106218, lon: -82.96915, times: ["5:45 PM"] },
  { stop_id: "SCHSHAE", name: "SCHROCK RD &amp; SHARON WOODS BLVD", lat: 40.107122, lon: -82.963318, times: ["5:46 PM"] },
  { stop_id: "SHAHEAS", name: "SHARON WOODS BLVD &amp; HEARTHSTONE AVE", lat: 40.101396, lon: -82.962562, times: ["5:47 PM"] },
  { stop_id: "SHAMEAS", name: "SHARON WOODS BLVD &amp; MEANDER DR", lat: 40.097849, lon: -82.962864, times: ["5:48 PM"] },
  { stop_id: "SHASKYS", name: "SHARON WOODS BLVD &amp; SKYWAE DR", lat: 40.095213, lon: -82.965475, times: ["5:49 PM"] },
]

  const polylineOut = L.polyline(shapeOutbound, {
    color: 'blue',
    weight: 4,
    opacity: 0.7
  }).addTo(map);

  map.fitBounds(polylineOut.getBounds());

  stops.forEach(stop => {
    const marker = L.circleMarker([stop.lat, stop.lon], {
      radius: 6,
      color: '#4dd0e1',
      fillColor: '#4dd0e1',
      fillOpacity: 0.9,
      weight: 1
    });

    const popupContent = `
      <strong>${stop.name}</strong><br>
      ${stop.times && stop.times.length ? stop.times.join("<br>") : "No scheduled times"}
    `;

    marker.bindPopup(popupContent);
    marker.addTo(map);
  });

  let busMarkers = {};

  async function fetchAndDisplay() {
    const res = await fetch(`https://developer.trimet.org/ws/v2/vehicles?route=${routeNumber}&appID=${apiKey}&json=true`);
    const data = await res.json();
    const buses = (data.resultSet.vehicle || []).filter(v =>
      v.routeNumber == routeNumber && v.direction == direction
    );

    Object.values(busMarkers).forEach(m => map.removeLayer(m));
    busMarkers = {};

    if (buses.length === 0) return;

    buses.forEach(bus => {
      if (!bus.latitude || !bus.longitude || !bus.blockID) return;

      const icon = L.divIcon({
        className: '',
        html: `
          <div style="text-align:center;">
            <div style="background:#0071CE;color:#fff;padding:2px 6px;border-radius:6px;font-weight:bold;">${bus.vehicleID}</div>
            <div style="width:0;height:0;border-left:5px solid transparent;border-right:5px solid transparent;border-top:10px solid #00bfff;margin:auto;"></div>
          </div>
        `,
        iconSize: [40, 30],
        iconAnchor: [20, 30]
      });

      const marker = L.marker([bus.latitude, bus.longitude], { icon }).addTo(map);
      busMarkers[bus.vehicleID] = marker;
    });
  }

  fetchAndDisplay();
  setInterval(fetchAndDisplay, 15000);
  </script>

<footer class="site-footer">
  <a href="terms.html">Terms of Use</a> &nbsp;|&nbsp;
  <a href="contact.html">Contact Us</a> &nbsp;|&nbsp;
  <a href="report.html">Report a Problem</a> &nbsp;|&nbsp;
  <a href="privacy.html">Privacy Policy</a>
</footer>

<div id="cookie-banner" style="display: none; position: fixed; bottom: 0; width: 100%; background: #333; color: #fff; text-align: center; padding: 1rem; z-index: 1000; font-size: 0.9rem;">
  üì¢ We use cookies for personalized ads and analytics. By using MetroFeed, you agree to our 
  <a href="privacy.html" style="color: #4dd0e1; text-decoration: underline;">Privacy Policy</a>.
  <button onclick="acceptCookies()" style="margin-left: 1rem; background: #4dd0e1; color: #000; border: none; padding: 0.5rem 1rem; border-radius: 5px; cursor: pointer;">OK</button>
</div>

<script>
  function acceptCookies() {
    localStorage.setItem('cookieConsent', 'true');
    document.getElementById('cookie-banner').style.display = 'none';
  }

  window.onload = function() {
    if (!localStorage.getItem('cookieConsent')) {
      document.getElementById('cookie-banner').style.display = 'block';
    }
  }
</script>


</body>
</html>