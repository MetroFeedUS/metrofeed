<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Route 290 - To Milwaukie | MetroFeed Portland</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background-color: #0d0d0d;
      color: #cccccc;
    }
    header {
      background-color: #0d0d0d;
      border-bottom: 3px solid #4dd0e1;
      padding: 1rem;
      text-align: center;
    }
    header img {
      max-height: 60px;
    }
    .ad-banner {
      text-align: center;
      margin: 1rem auto;
      background-color: #222;
      color: #888;
      padding: 1rem;
      border: 2px dashed #4dd0e1;
      font-size: 0.9rem;
      border-radius: 8px;
    }
    h1 {
      text-align: center;
      margin: 1rem 0;
      font-size: 2rem;
      color: #f0f0f0;
    }
    .content-box {
      border: 2px solid #4dd0e1;
      border-radius: 12px;
      padding: 1rem;
      margin: 1rem;
      background-color: #1e1e1e;
    }
    #map {
      width: 100%;
      height: 400px;
      border-radius: 8px;
    }
    .button-bar {
      display: flex;
      justify-content: center;
      margin: 1rem 0;
    }
    .button-bar a {
      background: #4dd0e1;
      color: #0d0d0d;
      padding: 0.5rem 1rem;
      text-decoration: none;
      border-radius: 8px;
      font-weight: bold;
    }

.back-button {
  background-color: #4dd0e1;
  color: #0d0d0d;
  border: none;
  padding: 0.6rem 1.2rem;
  font-size: 1rem;
  font-weight: bold;
  border-radius: 8px;
  cursor: pointer;
  box-shadow: 0 0 10px #4dd0e1;
  text-decoration: none;
}
.back-button:hover {
  background-color: #35c0d6;
}
.site-footer {
      text-align: center;
      margin-top: 3rem;
      margin-bottom: 120px;
      font-size: 0.85rem;
      color: #aaa;
    }
    .site-footer a {
      color: #00BFFF;
      text-decoration: none;
    }
    .site-footer a:hover {
      text-decoration: underline;
    }

  </style>
</head>
<body>
  <header>
    <img src="MetroFeedPortlandLogo.png" alt="MetroFeed Portland">
  </header>

  <div class="ad-banner">
    [Ad Banner Placeholder — 300x250]
  </div>

  <div class="disclaimer" style="margin: 1rem auto 0.5rem; max-width: 600px; font-size: 0.8rem; color: #bbb; text-align: center; padding: 0.5rem 1rem; background-color: #111; border: 1px dashed #444; border-radius: 6px;">
    ⚠️ This is a Beta program, work in progress. Please REPORT bugs and pretend to be impressed.
  </div>
  <div class="disclaimer" style="margin: 0 auto 1rem; max-width: 600px; font-size: 0.75rem; color: #888; text-align: center; padding: 0.25rem 1rem;">
    This tool is not affiliated with or endorsed by TriMet. For official schedules and service alerts, visit <a href="https://trimet.org" style="color:#4dd0e1;">trimet.org</a>.
  </div>

  <div style="margin: 2rem 0; text-align: center;">
  <button class="back-button" onclick="history.back()">⬅ Back</button>
  </div>

  <h1>Route 290 - To Milwaukie</h1>

  <div class="content-box">
    <div id="map"></div>
    <div style="text-align:right; font-size: 0.7rem; color: #777; margin-top: 0.5rem;">
      Data courtesy of TriMet.
    </div>
  </div>

  
  <script>
  const apiKey = "2C4447D4A42083BCD84DE3B8E";
  const routeNumber = 290;
  const direction = parseInt(1);

  const map = L.map('map').setView([45.6, -122.7], 12);
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    maxZoom: 19
  }).addTo(map);

  const shapeOutbound = [
  [45.526736, -122.67553],
  [45.52673, -122.675529],
  [45.526702, -122.675528],
  [45.526645, -122.675527],
  [45.526585, -122.675524],
  [45.52599, -122.675512],
  [45.52593, -122.67551],
  [45.525224, -122.675481],
  [45.524508, -122.675451],
  [45.524455, -122.675457],
  [45.523886, -122.675436],
  [45.523856, -122.675435],
  [45.523796, -122.675434],
  [45.523744, -122.675433],
  [45.523208, -122.675414],
  [45.523141, -122.675403],
  [45.523025, -122.675386],
  [45.522962, -122.67538],
  [45.522922, -122.675383],
  [45.52288, -122.675394],
  [45.522703, -122.675478],
  [45.522612, -122.675527],
  [45.52258, -122.675542],
  [45.522549, -122.675556],
  [45.522184, -122.67573],
  [45.522128, -122.67575],
  [45.52206, -122.675774],
  [45.521541, -122.67606],
  [45.521534, -122.676064],
  [45.521457, -122.67611],
  [45.52137, -122.67616],
  [45.520857, -122.676429],
  [45.52079, -122.676466],
  [45.520181, -122.676796],
  [45.520125, -122.676825],
  [45.520048, -122.676865],
  [45.519566, -122.677133],
  [45.519507, -122.677166],
  [45.519457, -122.67719],
  [45.519358, -122.677239],
  [45.518833, -122.677521],
  [45.518798, -122.677543],
  [45.51877, -122.67756],
  [45.51874, -122.677579],
  [45.518233, -122.677849],
  [45.518179, -122.677878],
  [45.518142, -122.677899],
  [45.518112, -122.677916],
  [45.518045, -122.677953],
  [45.517539, -122.678221],
  [45.517462, -122.678283],
  [45.516795, -122.678644],
  [45.51613, -122.679004],
  [45.515462, -122.679366],
  [45.514899, -122.679671],
  [45.51479, -122.67973],
  [45.514133, -122.680086],
  [45.513466, -122.680448],
  [45.513249, -122.680565],
  [45.513019, -122.68069],
  [45.512796, -122.68081],
  [45.512727, -122.680848],
  [45.512371, -122.68104],
  [45.512133, -122.68117],
  [45.512001, -122.681241],
  [45.511705, -122.681401],
  [45.511617, -122.681449],
  [45.511595, -122.681461],
  [45.511468, -122.68153],
  [45.511448, -122.68154],
  [45.511222, -122.681664],
  [45.510879, -122.681849],
  [45.510797, -122.681893],
  [45.510523, -122.682043],
  [45.510426, -122.682095],
  [45.510239, -122.682195],
  [45.510133, -122.682253],
  [45.509636, -122.682522],
  [45.509467, -122.682613],
  [45.509098, -122.682922],
  [45.508976, -122.682991],
  [45.508934, -122.683015],
  [45.508907, -122.683033],
  [45.508886, -122.683046],
  [45.508846, -122.683073],
  [45.508819, -122.683089],
  [45.508739, -122.683143],
  [45.508634, -122.683209],
  [45.50859, -122.683239],
  [45.508554, -122.683257],
  [45.508534, -122.683266],
  [45.5085, -122.683274],
  [45.508477, -122.683274],
  [45.508465, -122.683274],
  [45.50843, -122.683269],
  [45.508397, -122.683257],
  [45.50835, -122.683227],
  [45.508303, -122.683177],
  [45.508283, -122.68315],
  [45.508256, -122.683109],
  [45.50823, -122.683064],
  [45.508214, -122.683033],
  [45.508207, -122.683018],
  [45.508184, -122.682972],
  [45.508171, -122.682939],
  [45.508152, -122.682889],
  [45.50814, -122.68285],
  [45.508126, -122.6828],
  [45.508115, -122.68276],
  [45.508096, -122.682663],
  [45.508089, -122.682613],
  [45.508082, -122.68254],
  [45.508078, -122.682494],
  [45.508068, -122.68226],
  [45.508059, -122.682113],
  [45.508055, -122.682072],
  [45.508052, -122.682044],
  [45.508038, -122.681949],
  [45.508028, -122.681898],
  [45.507999, -122.681763],
  [45.507985, -122.681692],
  [45.507923, -122.681388],
  [45.507914, -122.68132],
  [45.507908, -122.681157],
  [45.507905, -122.680975],
  [45.507884, -122.680156],
  [45.507883, -122.680139],
  [45.507882, -122.680035],
  [45.507883, -122.679987],
  [45.507884, -122.679931],
  [45.507887, -122.679796],
  [45.507889, -122.679749],
  [45.507892, -122.679676],
  [45.507907, -122.679459],
  [45.507946, -122.678891],
  [45.507949, -122.678835],
  [45.507955, -122.678744],
  [45.50796, -122.678593],
  [45.507963, -122.678509],
  [45.507964, -122.67815],
  [45.507961, -122.677505],
  [45.507958, -122.676814],
  [45.507957, -122.676708],
  [45.507955, -122.676639],
  [45.507951, -122.676522],
  [45.507947, -122.676474],
  [45.50794, -122.676419],
  [45.50793, -122.676359],
  [45.507917, -122.676293],
  [45.507906, -122.676247],
  [45.507891, -122.676199],
  [45.507867, -122.676127],
  [45.507851, -122.676082],
  [45.50783, -122.676035],
  [45.507801, -122.675976],
  [45.507772, -122.675924],
  [45.507746, -122.675881],
  [45.507724, -122.67585],
  [45.507699, -122.675815],
  [45.507668, -122.675776],
  [45.507629, -122.675736],
  [45.507562, -122.675674],
  [45.50753, -122.67565],
  [45.507509, -122.675635],
  [45.507472, -122.675613],
  [45.507433, -122.675592],
  [45.507397, -122.675575],
  [45.507322, -122.675544],
  [45.506886, -122.675416],
  [45.506792, -122.675383],
  [45.506695, -122.675345],
  [45.506175, -122.675106],
  [45.506142, -122.67509],
  [45.506069, -122.675052],
  [45.505977, -122.674997],
  [45.505921, -122.674959],
  [45.505874, -122.674926],
  [45.505825, -122.674889],
  [45.505778, -122.67485],
  [45.505734, -122.674811],
  [45.505696, -122.674774],
  [45.505648, -122.674729],
  [45.505477, -122.674549],
  [45.505359, -122.674417],
  [45.505266, -122.674325],
  [45.505191, -122.674258],
  [45.505132, -122.67421],
  [45.50508, -122.674171],
  [45.504967, -122.674094],
  [45.504863, -122.67403],
  [45.504531, -122.673827],
  [45.504285, -122.67368],
  [45.504212, -122.673638],
  [45.504105, -122.673585],
  [45.504061, -122.673564],
  [45.503684, -122.67338],
  [45.503645, -122.673361],
  [45.503499, -122.673291],
  [45.503293, -122.673188],
  [45.502748, -122.672915],
  [45.502678, -122.67288],
  [45.502642, -122.672863],
  [45.502602, -122.672839],
  [45.502568, -122.672814],
  [45.502536, -122.672785],
  [45.502507, -122.672751],
  [45.502482, -122.672718],
  [45.502457, -122.672678],
  [45.502419, -122.672602],
  [45.502402, -122.672552],
  [45.502389, -122.672508],
  [45.502381, -122.672468],
  [45.502374, -122.672422],
  [45.502371, -122.672387],
  [45.502369, -122.672362],
  [45.502369, -122.672336],
  [45.502369, -122.672295],
  [45.502372, -122.672248],
  [45.502377, -122.672203],
  [45.502382, -122.672171],
  [45.502396, -122.672107],
  [45.502407, -122.672069],
  [45.502422, -122.672015],
  [45.502457, -122.671906],
  [45.502489, -122.671795],
  [45.502685, -122.671149],
  [45.502688, -122.671138],
  [45.502698, -122.671102],
  [45.502805, -122.670749],
  [45.502954, -122.670238],
  [45.50299, -122.670124],
  [45.503031, -122.670005],
  [45.503052, -122.669957],
  [45.503077, -122.669893],
  [45.503099, -122.669843],
  [45.50313, -122.669779],
  [45.503154, -122.669733],
  [45.503182, -122.669685],
  [45.503262, -122.669552],
  [45.50331, -122.669482],
  [45.505115, -122.666714],
  [45.505615, -122.665944],
  [45.506402, -122.664739],
  [45.506431, -122.664689],
  [45.506446, -122.664659],
  [45.506463, -122.664619],
  [45.506487, -122.664544],
  [45.506493, -122.664517],
  [45.506499, -122.664489],
  [45.506504, -122.664452],
  [45.506508, -122.6644],
  [45.506507, -122.664309],
  [45.506499, -122.664132],
  [45.506487, -122.663857],
  [45.506482, -122.663712],
  [45.506479, -122.663419],
  [45.506466, -122.66256],
  [45.506464, -122.66247],
  [45.506459, -122.662121],
  [45.50646, -122.662096],
  [45.506463, -122.662036],
  [45.506475, -122.661819],
  [45.506505, -122.661362],
  [45.506509, -122.661271],
  [45.506511, -122.661192],
  [45.506515, -122.661064],
  [45.506513, -122.660883],
  [45.506506, -122.660777],
  [45.506497, -122.660682],
  [45.506491, -122.660629],
  [45.50648, -122.660543],
  [45.506459, -122.660409],
  [45.506429, -122.660257],
  [45.506393, -122.660098],
  [45.506351, -122.659935],
  [45.506326, -122.65985],
  [45.506294, -122.65974],
  [45.506262, -122.659647],
  [45.506194, -122.659473],
  [45.506153, -122.65938],
  [45.506091, -122.659236],
  [45.505843, -122.65874],
  [45.505557, -122.658186],
  [45.505262, -122.657653],
  [45.505199, -122.657543],
  [45.505086, -122.657344],
  [45.503712, -122.654895],
  [45.503639, -122.654765],
  [45.503547, -122.6546],
  [45.503441, -122.654413],
  [45.503352, -122.654271],
  [45.503304, -122.654193],
  [45.503226, -122.654091],
  [45.503162, -122.653989],
  [45.503064, -122.653848],
  [45.502936, -122.653618],
  [45.502609, -122.653036],
  [45.50259, -122.653002],
  [45.502542, -122.652918],
  [45.50239, -122.652641],
  [45.502303, -122.65249],
  [45.502152, -122.652216],
  [45.501723, -122.651449],
  [45.501267, -122.650637],
  [45.500915, -122.650004],
  [45.500865, -122.649918],
  [45.500764, -122.649765],
  [45.5007, -122.649672],
  [45.500643, -122.649598],
  [45.500602, -122.649541],
  [45.500556, -122.649486],
  [45.500459, -122.649379],
  [45.500388, -122.649307],
  [45.500318, -122.649243],
  [45.500264, -122.649193],
  [45.500217, -122.649155],
  [45.500143, -122.649093],
  [45.499781, -122.648796],
  [45.499455, -122.648535],
  [45.499361, -122.648457],
  [45.499304, -122.648413],
  [45.499175, -122.648327],
  [45.499103, -122.648291],
  [45.499009, -122.648253],
  [45.498966, -122.648242],
  [45.498903, -122.648222],
  [45.498845, -122.648214],
  [45.498721, -122.648203],
  [45.498497, -122.648208],
  [45.497652, -122.648221],
  [45.497644, -122.648221],
  [45.497537, -122.648221],
  [45.49746, -122.648225],
  [45.497094, -122.648206],
  [45.496961, -122.648203],
  [45.496881, -122.648202],
  [45.496748, -122.648203],
  [45.496688, -122.648208],
  [45.496583, -122.648213],
  [45.496509, -122.648224],
  [45.496404, -122.648239],
  [45.496164, -122.648292],
  [45.495854, -122.648363],
  [45.495726, -122.648388],
  [45.495633, -122.648408],
  [45.495532, -122.648424],
  [45.495464, -122.648433],
  [45.495343, -122.648451],
  [45.495235, -122.64846],
  [45.495077, -122.648475],
  [45.49497, -122.648481],
  [45.494788, -122.648485],
  [45.494611, -122.648484],
  [45.494197, -122.648488],
  [45.493989, -122.648485],
  [45.49391, -122.648484],
  [45.493312, -122.64849],
  [45.492715, -122.648491],
  [45.492147, -122.6485],
  [45.492082, -122.648506],
  [45.492016, -122.648509],
  [45.491874, -122.64852],
  [45.491605, -122.648536],
  [45.4915, -122.648547],
  [45.491259, -122.64856],
  [45.491093, -122.648571],
  [45.490877, -122.648579],
  [45.49066, -122.648584],
  [45.490639, -122.648584],
  [45.490546, -122.648584],
  [45.490326, -122.648588],
  [45.490169, -122.648585],
  [45.488853, -122.648593],
  [45.488517, -122.648589],
  [45.488032, -122.648568],
  [45.487849, -122.648548],
  [45.487628, -122.64852],
  [45.487561, -122.648509],
  [45.487431, -122.64849],
  [45.487189, -122.648461],
  [45.487013, -122.648437],
  [45.486959, -122.648425],
  [45.486906, -122.648411],
  [45.486876, -122.648402],
  [45.486798, -122.648369],
  [45.486708, -122.648317],
  [45.486693, -122.648306],
  [45.486625, -122.648251],
  [45.48657, -122.648201],
  [45.48654, -122.648169],
  [45.48652, -122.648144],
  [45.486471, -122.648084],
  [45.486443, -122.648042],
  [45.486402, -122.647974],
  [45.486359, -122.647892],
  [45.48615, -122.647457],
  [45.485838, -122.646811],
  [45.485662, -122.646443],
  [45.485607, -122.646332],
  [45.485374, -122.64585],
  [45.485267, -122.645631],
  [45.485138, -122.645374],
  [45.485045, -122.645205],
  [45.484929, -122.645003],
  [45.484819, -122.644823],
  [45.484695, -122.64463],
  [45.484571, -122.644449],
  [45.484457, -122.644292],
  [45.484326, -122.64412],
  [45.484181, -122.643942],
  [45.484036, -122.643774],
  [45.4839, -122.643626],
  [45.483773, -122.643495],
  [45.483624, -122.64335],
  [45.483469, -122.643209],
  [45.483292, -122.64306],
  [45.482983, -122.642823],
  [45.481703, -122.641919],
  [45.481425, -122.641731],
  [45.481324, -122.641671],
  [45.481268, -122.64164],
  [45.481198, -122.641603],
  [45.481131, -122.641564],
  [45.481029, -122.64152],
  [45.480858, -122.641454],
  [45.480675, -122.641401],
  [45.480566, -122.641373],
  [45.479884, -122.641212],
  [45.479718, -122.641173],
  [45.479457, -122.641111],
  [45.478774, -122.640951],
  [45.475955, -122.640289],
  [45.475833, -122.640269],
  [45.475691, -122.640247],
  [45.475496, -122.640222],
  [45.475407, -122.640212],
  [45.475353, -122.640204],
  [45.475309, -122.640197],
  [45.47525, -122.640184],
  [45.47466, -122.640043],
  [45.474605, -122.64003],
  [45.47438, -122.639976],
  [45.47389, -122.639866],
  [45.473528, -122.639772],
  [45.47297, -122.639617],
  [45.472546, -122.639511],
  [45.472274, -122.63945],
  [45.471733, -122.63932],
  [45.471503, -122.639269],
  [45.471212, -122.639197],
  [45.470939, -122.639134],
  [45.470439, -122.639017],
  [45.47012, -122.638939],
  [45.468355, -122.638528],
  [45.46807, -122.638462],
  [45.467529, -122.638331],
  [45.467334, -122.638284],
  [45.466577, -122.638112],
  [45.466393, -122.638078],
  [45.466109, -122.638028],
  [45.465931, -122.638007],
  [45.465779, -122.637994],
  [45.465631, -122.637984],
  [45.465352, -122.63797],
  [45.465155, -122.637975],
  [45.46491, -122.637983],
  [45.464811, -122.637992],
  [45.464607, -122.638013],
  [45.464482, -122.638027],
  [45.464012, -122.638104],
  [45.463895, -122.638119],
  [45.463584, -122.63817],
  [45.463435, -122.638182],
  [45.463358, -122.638192],
  [45.463317, -122.638194],
  [45.463275, -122.638189],
  [45.463225, -122.638176],
  [45.463178, -122.638154],
  [45.463129, -122.638123],
  [45.463078, -122.638075],
  [45.463025, -122.638015],
  [45.462618, -122.637442],
  [45.462616, -122.637439],
  [45.462511, -122.637291],
  [45.462498, -122.637266],
  [45.462448, -122.637196],
  [45.462412, -122.637151],
  [45.462388, -122.637126],
  [45.462374, -122.637111],
  [45.462356, -122.637095],
  [45.462314, -122.637061],
  [45.46226, -122.637027],
  [45.462226, -122.63701],
  [45.46219, -122.636997],
  [45.462122, -122.636979],
  [45.460477, -122.636623],
  [45.460216, -122.636567],
  [45.459938, -122.636512],
  [45.459762, -122.636493],
  [45.45956, -122.636473],
  [45.459288, -122.636432],
  [45.458093, -122.636284],
  [45.457908, -122.636254],
  [45.457798, -122.636235],
  [45.457652, -122.636193],
  [45.457545, -122.636156],
  [45.457418, -122.636105],
  [45.457238, -122.636037],
  [45.457035, -122.635949],
  [45.456715, -122.635807],
  [45.456455, -122.635711],
  [45.456299, -122.635665],
  [45.456228, -122.63565],
  [45.456171, -122.635645],
  [45.456023, -122.635619],
  [45.455689, -122.6356],
  [45.455576, -122.635612],
  [45.455202, -122.635641],
  [45.454933, -122.63567],
  [45.454627, -122.635702],
  [45.454405, -122.635719],
  [45.454296, -122.63573],
  [45.453989, -122.635742],
  [45.453442, -122.635788],
  [45.453172, -122.635812],
  [45.45308, -122.63582],
  [45.452895, -122.63584],
  [45.452765, -122.635854],
  [45.452623, -122.63587],
  [45.452348, -122.635905],
  [45.452223, -122.635922],
  [45.45202, -122.635951],
  [45.451887, -122.635971],
  [45.451731, -122.635996],
  [45.451532, -122.636029],
  [45.451406, -122.636051],
  [45.451262, -122.636077],
  [45.450987, -122.636139],
  [45.450871, -122.636168],
  [45.45078, -122.636189],
  [45.45062, -122.636225],
  [45.449741, -122.636421],
  [45.449612, -122.63645],
  [45.449545, -122.63646],
  [45.449439, -122.636478],
  [45.449248, -122.636505],
  [45.449032, -122.636531],
  [45.448923, -122.636545],
  [45.448864, -122.636557],
  [45.448752, -122.636586],
  [45.448324, -122.636711],
  [45.448205, -122.636749],
  [45.448093, -122.636788],
  [45.448013, -122.636816],
  [45.447269, -122.637088],
  [45.446965, -122.637201],
  [45.44674, -122.63729],
  [45.446424, -122.637418],
  [45.446299, -122.63747],
  [45.445953, -122.637619],
  [45.445637, -122.637761],
  [45.445118, -122.638006],
  [45.444411, -122.638359],
  [45.444206, -122.638462],
  [45.443922, -122.638606],
  [45.442694, -122.639259],
  [45.441954, -122.639633],
  [45.441891, -122.639665],
  [45.441666, -122.63978],
  [45.441337, -122.639928],
  [45.441058, -122.640091],
  [45.44104, -122.640101],
  [45.440987, -122.640131],
  [45.440402, -122.64043],
  [45.439819, -122.640726],
  [45.439113, -122.641083],
  [45.439052, -122.641107],
  [45.438992, -122.641129],
  [45.438935, -122.641141],
  [45.43888, -122.641149],
  [45.438827, -122.641152],
  [45.438755, -122.641147],
  [45.438696, -122.641137],
  [45.438612, -122.641116],
  [45.438559, -122.641095],
  [45.438509, -122.641071],
  [45.438417, -122.641015],
  [45.438259, -122.6409],
  [45.437681, -122.640457],
  [45.437551, -122.640344],
  [45.437447, -122.64026],
  [45.437336, -122.640163],
  [45.437217, -122.640051],
  [45.43708, -122.639918],
  [45.436896, -122.639732],
  [45.43677, -122.639594],
  [45.436563, -122.639358],
  [45.436349, -122.639096],
  [45.436195, -122.638901],
  [45.435631, -122.638187],
  [45.435014, -122.637397],
  [45.434815, -122.637148],
  [45.434574, -122.636852],
  [45.434452, -122.636708],
  [45.434335, -122.636583],
  [45.434224, -122.636469],
  [45.434128, -122.636375],
  [45.433996, -122.636257],
  [45.433898, -122.636171],
  [45.433726, -122.636033],
  [45.433519, -122.635887],
  [45.433418, -122.635816],
  [45.433287, -122.635737],
  [45.433084, -122.63562],
  [45.432961, -122.635559],
  [45.43285, -122.635507],
  [45.432715, -122.635453],
  [45.432622, -122.635422],
  [45.432489, -122.635385],
  [45.432377, -122.635359],
  [45.432191, -122.635325],
  [45.431979, -122.635264],
  [45.431768, -122.635203],
  [45.431615, -122.635176],
  [45.431399, -122.635141],
  [45.431171, -122.635106],
  [45.431035, -122.635083],
  [45.430741, -122.635046],
  [45.430736, -122.635045]
];

const stopNames = {
  "7601": "Union Station/NW 5th &amp; Glisan MAX Stn",
  "7606": "PSU South/SW 5th &amp; Jackson MAX Stn",
  "7608": "City Hall/SW 5th &amp; Jefferson MAX Station",
  "7618": "PSU Urban Center/SW 5th &amp; Mill MAX Station",
  "7627": "SW 5th &amp; Oak St MAX Station",
  "7646": "Pioneer Place/SW 5th Ave MAX Station",
  "9303": "NW 5th &amp; Couch MAX Station",
  "13710": "Lincoln St/SW 3rd Ave MAX Station",
  "13711": "South Waterfront/S Moody MAX Station",
  "13712": "OMSI/SE Water MAX Station",
  "13713": "Clinton St/SE 12th Ave MAX Station",
  "13714": "SE 17th Ave &amp; Rhine St MAX Station",
  "13715": "SE 17th Ave &amp; Holgate Blvd MAX Station",
  "13716": "SE Bybee Blvd MAX Station",
  "13717": "SE Tacoma/Johnson Creek MAX Station",
  "13718": "Milwaukie/Main St MAX Station",
  "13720": "SE Park Ave MAX Station"
};

const stops = [
  { stop_id: "7601", name: "Union Station/NW 5th &amp; Glisan MAX Stn", lat: 45.526732, lon: -122.675604, times: ["2:17 PM"] },
  { stop_id: "9303", name: "NW 5th &amp; Couch MAX Station", lat: 45.523885, lon: -122.675498, times: ["2:18 PM"] },
  { stop_id: "7627", name: "SW 5th &amp; Oak St MAX Station", lat: 45.521573, lon: -122.676178, times: ["2:20 PM"] },
  { stop_id: "7646", name: "Pioneer Place/SW 5th Ave MAX Station", lat: 45.518255, lon: -122.677934, times: ["2:22 PM"] },
  { stop_id: "7608", name: "City Hall/SW 5th &amp; Jefferson MAX Station", lat: 45.514914, lon: -122.679742, times: ["2:24 PM"] },
  { stop_id: "7618", name: "PSU Urban Center/SW 5th &amp; Mill MAX Station", lat: 45.511645, lon: -122.681551, times: ["2:11 PM"] },
  { stop_id: "7606", name: "PSU South/SW 5th &amp; Jackson MAX Stn", lat: 45.508979, lon: -122.682999, times: ["2:13 PM"] },
  { stop_id: "13710", name: "Lincoln St/SW 3rd Ave MAX Station", lat: 45.507902, lon: -122.680154, times: ["2:15 PM"] },
  { stop_id: "13711", name: "South Waterfront/S Moody MAX Station", lat: 45.502693, lon: -122.671141, times: ["2:18 PM"] },
  { stop_id: "13712", name: "OMSI/SE Water MAX Station", lat: 45.506475, lon: -122.662559, times: ["2:21 PM"] },
  { stop_id: "13713", name: "Clinton St/SE 12th Ave MAX Station", lat: 45.502604, lon: -122.652986, times: ["2:23 PM"] },
  { stop_id: "13714", name: "SE 17th Ave &amp; Rhine St MAX Station", lat: 45.497644, lon: -122.648178, times: ["2:10 PM"] },
  { stop_id: "13715", name: "SE 17th Ave &amp; Holgate Blvd MAX Station", lat: 45.490639, lon: -122.64854, times: ["2:13 PM"] },
  { stop_id: "13716", name: "SE Bybee Blvd MAX Station", lat: 45.474667, lon: -122.63999, times: ["2:16 PM"] },
  { stop_id: "13717", name: "SE Tacoma/Johnson Creek MAX Station", lat: 45.462631, lon: -122.637423, times: ["2:18 PM"] },
  { stop_id: "13718", name: "Milwaukie/Main St MAX Station", lat: 45.441027, lon: -122.640056, times: ["2:22 PM"] },
  { stop_id: "13720", name: "SE Park Ave MAX Station", lat: 45.430734, lon: -122.635065, times: ["2:10 PM"] },
]

  const polylineOut = L.polyline(shapeOutbound, {
    color: 'blue',
    weight: 4,
    opacity: 0.7
  }).addTo(map);

  map.fitBounds(polylineOut.getBounds());

  stops.forEach(stop => {
    const marker = L.circleMarker([stop.lat, stop.lon], {
      radius: 6,
      color: '#4dd0e1',
      fillColor: '#4dd0e1',
      fillOpacity: 0.9,
      weight: 1
    });

    const popupContent = `
      <strong>${stop.name}</strong><br>
      ${stop.times && stop.times.length ? stop.times.join("<br>") : "No scheduled times"}
    `;

    marker.bindPopup(popupContent);
    marker.addTo(map);
  });

  let busMarkers = {};

  async function fetchAndDisplay() {
    const res = await fetch(`https://developer.trimet.org/ws/v2/vehicles?route=${routeNumber}&appID=${apiKey}&json=true`);
    const data = await res.json();
    const buses = (data.resultSet.vehicle || []).filter(v =>
      v.routeNumber == routeNumber && v.direction == direction
    );

    Object.values(busMarkers).forEach(m => map.removeLayer(m));
    busMarkers = {};

    if (buses.length === 0) return;

    buses.forEach(bus => {
      if (!bus.latitude || !bus.longitude || !bus.blockID) return;

      const icon = L.divIcon({
        className: '',
        html: `
          <div style="text-align:center;">
            <div style="background:#0071CE;color:#fff;padding:2px 6px;border-radius:6px;font-weight:bold;">${bus.vehicleID}</div>
            <div style="width:0;height:0;border-left:5px solid transparent;border-right:5px solid transparent;border-top:10px solid #00bfff;margin:auto;"></div>
          </div>
        `,
        iconSize: [40, 30],
        iconAnchor: [20, 30]
      });

      const marker = L.marker([bus.latitude, bus.longitude], { icon }).addTo(map);
      busMarkers[bus.vehicleID] = marker;
    });
  }

  fetchAndDisplay();
  setInterval(fetchAndDisplay, 15000);
  </script>

<footer class="site-footer">
  <a href="terms.html">Terms of Use</a> &nbsp;|&nbsp;
  <a href="contact.html">Contact Us</a> &nbsp;|&nbsp;
  <a href="report.html">Report a Problem</a> &nbsp;|&nbsp;
  <a href="privacy.html">Privacy Policy</a>
</footer>

<div id="cookie-banner" style="display: none; position: fixed; bottom: 0; width: 100%; background: #333; color: #fff; text-align: center; padding: 1rem; z-index: 1000; font-size: 0.9rem;">
  📢 We use cookies for personalized ads and analytics. By using MetroFeed, you agree to our 
  <a href="privacy.html" style="color: #4dd0e1; text-decoration: underline;">Privacy Policy</a>.
  <button onclick="acceptCookies()" style="margin-left: 1rem; background: #4dd0e1; color: #000; border: none; padding: 0.5rem 1rem; border-radius: 5px; cursor: pointer;">OK</button>
</div>

<script>
  function acceptCookies() {
    localStorage.setItem('cookieConsent', 'true');
    document.getElementById('cookie-banner').style.display = 'none';
  }

  window.onload = function() {
    if (!localStorage.getItem('cookieConsent')) {
      document.getElementById('cookie-banner').style.display = 'block';
    }
  }
</script>


</body>
</html>