<!DOCTYPE html>
<html lang="en">
<head>
  
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2219550569810489"
     crossorigin="anonymous"></script>

<meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Route 71 - To Clackamas Town Center | MetroFeed Portland</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background-color: #0d0d0d;
      color: #cccccc;
    }
    header {
      background-color: #0d0d0d;
      border-bottom: 3px solid #4dd0e1;
      padding: 1rem;
      text-align: center;
    }
    header img {
      max-height: 60px;
    }
     .ad-banner {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      background: #222;
      padding: 0;
      z-index: 1000;
      box-shadow: 0 2px 2px rgba(0,0,0,0.5);
      text-align: center;
    }

    .ad-banner img {
      width: 100%;
      max-width: 728px;
      height: 90px;
      
      display: block;
      margin: 0 auto;
    }
    h1 {
      text-align: center;
      margin: 1rem 0;
      font-size: 2rem;
      color: #f0f0f0;
    }
    .content-box {
      border: 2px solid #4dd0e1;
      border-radius: 12px;
      padding: 1rem;
      margin: 1rem;
      background-color: #1e1e1e;
    }
    #map {
  width: 100vw;
  min-width: 100vw;
  height: 400px;
  border-radius: 0;
  margin-left: 50%;
  transform: translateX(-50%);
  border: none;
  box-shadow: none;
  padding: 0;
}
    .button-bar {
      display: flex;
      justify-content: center;
      margin: 1rem 0;
    }
    .button-bar a {
      background: #4dd0e1;
      color: #0d0d0d;
      padding: 0.5rem 1rem;
      text-decoration: none;
      border-radius: 8px;
      font-weight: bold;
    }

.back-button {
  background-color: #4dd0e1;
  color: #0d0d0d;
  border: none;
  padding: 0.6rem 1.2rem;
  font-size: 1rem;
  font-weight: bold;
  border-radius: 8px;
  cursor: pointer;
  box-shadow: 0 0 10px #4dd0e1;
  text-decoration: none;
}
.back-button:hover {
  background-color: #35c0d6;
}
.site-footer {
      text-align: center;
      margin-top: 3rem;
      margin-bottom: 120px;
      font-size: 0.85rem;
      color: #aaa;
    }
    .site-footer a {
      color: #00BFFF;
      text-decoration: none;
    }
    .site-footer a:hover {
      text-decoration: underline;
    }
  @media (max-width: 600px) {
      .ad-banner {
        padding-top: 1rem;
        padding-bottom: rem;
      }
    }
  </style>
</head>
<body>
 
  <!-- üü¶ Auto-Injected Banner Ad (route-specific) -->
  <div class="ad-banner">
    <iframe src="https://metrofeedus.com/portland/Ads/route-71-dir0-ad.html" style="border:none; width:100%; max-width 728px; height:90px;"></iframe>
  </div>


 <header>
    <img src="MetroFeedPortlandLogo.png" alt="MetroFeed Portland">
  </header>

  <div class="disclaimer" style="margin: 1rem auto 0.5rem; max-width: 600px; font-size: 0.8rem; color: #bbb; text-align: center; padding: 0.5rem 1rem; background-color: #111; border: 1px dashed #444; border-radius: 6px;">
    ‚ö†Ô∏è This is a Beta program, work in progress. Please REPORT bugs and pretend to be impressed.
  </div>
  <div class="disclaimer" style="margin: 0 auto 1rem; max-width: 600px; font-size: 0.75rem; color: #888; text-align: center; padding: 0.25rem 1rem;">
    This tool is not affiliated with or endorsed by TriMet. For official schedules and service alerts, visit <a href="https://trimet.org" style="color:#4dd0e1;">trimet.org</a>.
  </div>

  <div style="margin: 2rem 0; text-align: center;">
  <button class="back-button" onclick="history.back()">‚¨Ö Back</button>
  </div>

  <h1>Route 71 - To Clackamas Town Center</h1>

  <div class="content-box">
    <div id="map"></div>
    <div style="text-align:right; font-size: 0.7rem; color: #777; margin-top: 0.5rem;">
      Data courtesy of TriMet.
    </div>
  </div>

  
  <script>
  const apiKey = "2C4447D4A42083BCD84DE3B8E";
  const routeNumber = 71;
  const direction = parseInt(0);

  // --- Set map bounds and zoom limits ---
  const bounds = L.latLngBounds(
    [45.40, -122.85], // SW
    [45.65, -122.45]  // NE
  );

  const map = L.map('map', {
    maxBounds: bounds,
    maxBoundsViscosity: 1.0,
    minZoom: 12,   // Don't allow zooming out past city
    maxZoom: 19,   // Allow good zoom in
    zoomControl: true,
    scrollWheelZoom: true,
    dragging: true
  }).setView([45.52, -122.68], 13);

  map.setMaxBounds(bounds);

// Keep map locked in bounds if user somehow escapes
map.on('moveend', function() {
  if (!bounds.contains(map.getCenter())) {
    map.panInsideBounds(bounds, { animate: true });
  }
});

  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    maxZoom: 19
  }).addTo(map);

  const shapeOutbound = [
  [45.558262, -122.565211],
  [45.558233, -122.565225],
  [45.558158, -122.565241],
  [45.55807, -122.565245],
  [45.558039, -122.565242],
  [45.557994, -122.56523],
  [45.557894, -122.565169],
  [45.557792, -122.565434],
  [45.557598, -122.565933],
  [45.557131, -122.567108],
  [45.55696, -122.567528],
  [45.556924, -122.567621],
  [45.556821, -122.567883],
  [45.556663, -122.568269],
  [45.556436, -122.568835],
  [45.556211, -122.56939],
  [45.555917, -122.570115],
  [45.555689, -122.570668],
  [45.555781, -122.571006],
  [45.555802, -122.571108],
  [45.555819, -122.571219],
  [45.55582, -122.571233],
  [45.555833, -122.571346],
  [45.555835, -122.571467],
  [45.555834, -122.571562],
  [45.55583, -122.571653],
  [45.555818, -122.571767],
  [45.5558, -122.571893],
  [45.555718, -122.572333],
  [45.555589, -122.573023],
  [45.555485, -122.573579],
  [45.555458, -122.573726],
  [45.55544, -122.57384],
  [45.555428, -122.573933],
  [45.555418, -122.574058],
  [45.555413, -122.574205],
  [45.555413, -122.574702],
  [45.555416, -122.575671],
  [45.555419, -122.576655],
  [45.55542, -122.577008],
  [45.555422, -122.57763],
  [45.555428, -122.578477],
  [45.555425, -122.578617],
  [45.555423, -122.57876],
  [45.555425, -122.579281],
  [45.555427, -122.579632],
  [45.555429, -122.580641],
  [45.555429, -122.581629],
  [45.555431, -122.582678],
  [45.555432, -122.583537],
  [45.555432, -122.583688],
  [45.555435, -122.584706],
  [45.555436, -122.585718],
  [45.555437, -122.586767],
  [45.555439, -122.587745],
  [45.55544, -122.588666],
  [45.555439, -122.588743],
  [45.55544, -122.589001],
  [45.55544, -122.589177],
  [45.555441, -122.590182],
  [45.555443, -122.591198],
  [45.555445, -122.592214],
  [45.555446, -122.592645],
  [45.555446, -122.593232],
  [45.555447, -122.593711],
  [45.555447, -122.594044],
  [45.555448, -122.595249],
  [45.55545, -122.595778],
  [45.555451, -122.596278],
  [45.555452, -122.597179],
  [45.555452, -122.597288],
  [45.555453, -122.598302],
  [45.555456, -122.599272],
  [45.555464, -122.599959],
  [45.555465, -122.600137],
  [45.555468, -122.600679],
  [45.555466, -122.600891],
  [45.555373, -122.600974],
  [45.555061, -122.601211],
  [45.554987, -122.601267],
  [45.554805, -122.601422],
  [45.554665, -122.601542],
  [45.554428, -122.601741],
  [45.553889, -122.602194],
  [45.552607, -122.603275],
  [45.552493, -122.60337],
  [45.551829, -122.603928],
  [45.55167, -122.604063],
  [45.551495, -122.60421],
  [45.551219, -122.604441],
  [45.551164, -122.604476],
  [45.551095, -122.604512],
  [45.551014, -122.604529],
  [45.550954, -122.604535],
  [45.550387, -122.604547],
  [45.549668, -122.60456],
  [45.548958, -122.604567],
  [45.548311, -122.604563],
  [45.548244, -122.60456],
  [45.548178, -122.604558],
  [45.547976, -122.604558],
  [45.547938, -122.604558],
  [45.547536, -122.604562],
  [45.546915, -122.604568],
  [45.545449, -122.604579],
  [45.545377, -122.60458],
  [45.544621, -122.604588],
  [45.544193, -122.604587],
  [45.543706, -122.604591],
  [45.542859, -122.604594],
  [45.542676, -122.604597],
  [45.542387, -122.604605],
  [45.542225, -122.604591],
  [45.542113, -122.604567],
  [45.541901, -122.604564],
  [45.541813, -122.604564],
  [45.54167, -122.604564],
  [45.541164, -122.604573],
  [45.540951, -122.604581],
  [45.540645, -122.604586],
  [45.540465, -122.604594],
  [45.540138, -122.604598],
  [45.539937, -122.604603],
  [45.539771, -122.604614],
  [45.539376, -122.604619],
  [45.53912, -122.604622],
  [45.539108, -122.604623],
  [45.539029, -122.60463],
  [45.538949, -122.604638],
  [45.538904, -122.604639],
  [45.538815, -122.604645],
  [45.538732, -122.604651],
  [45.537725, -122.604664],
  [45.536632, -122.604678],
  [45.536597, -122.604679],
  [45.536536, -122.604681],
  [45.536441, -122.604683],
  [45.535058, -122.604703],
  [45.534372, -122.604719],
  [45.534149, -122.604723],
  [45.534067, -122.604725],
  [45.533893, -122.604747],
  [45.533782, -122.604752],
  [45.533714, -122.604754],
  [45.533713, -122.604648],
  [45.533711, -122.604175],
  [45.53371, -122.60406],
  [45.533709, -122.603702],
  [45.533708, -122.603182],
  [45.533708, -122.603123],
  [45.533707, -122.602656],
  [45.533707, -122.602281],
  [45.533707, -122.602163],
  [45.533633, -122.602165],
  [45.533011, -122.602173],
  [45.53234, -122.602183],
  [45.532284, -122.602184],
  [45.531637, -122.602193],
  [45.531001, -122.602207],
  [45.530319, -122.602214],
  [45.529559, -122.602224],
  [45.52895, -122.602239],
  [45.528642, -122.602246],
  [45.528603, -122.602248],
  [45.528312, -122.602257],
  [45.528217, -122.602259],
  [45.527957, -122.602265],
  [45.527219, -122.602274],
  [45.526952, -122.602262],
  [45.526626, -122.602264],
  [45.526582, -122.602264],
  [45.526481, -122.602265],
  [45.525822, -122.602277],
  [45.525718, -122.602279],
  [45.525639, -122.60228],
  [45.525363, -122.602272],
  [45.525031, -122.602276],
  [45.52491, -122.602278],
  [45.524215, -122.602288],
  [45.523771, -122.602295],
  [45.523376, -122.602317],
  [45.523143, -122.60233],
  [45.522955, -122.602332],
  [45.522868, -122.602334],
  [45.522787, -122.602336],
  [45.522616, -122.602337],
  [45.52259, -122.602337],
  [45.522211, -122.60232],
  [45.521634, -122.60233],
  [45.520124, -122.602354],
  [45.519845, -122.602373],
  [45.519608, -122.602378],
  [45.519406, -122.602379],
  [45.519373, -122.602377],
  [45.519353, -122.602373],
  [45.519329, -122.602368],
  [45.519255, -122.602364],
  [45.519255, -122.602098],
  [45.519189, -122.602095],
  [45.517067, -122.60203],
  [45.516873, -122.602024],
  [45.516825, -122.602023],
  [45.516759, -122.602014],
  [45.516682, -122.602003],
  [45.516116, -122.60198],
  [45.515512, -122.601962],
  [45.515372, -122.601958],
  [45.515245, -122.601954],
  [45.514862, -122.601946],
  [45.514143, -122.601923],
  [45.514136, -122.601922],
  [45.514086, -122.601919],
  [45.514034, -122.601915],
  [45.51326, -122.601899],
  [45.512903, -122.601892],
  [45.512612, -122.601882],
  [45.511962, -122.601862],
  [45.511905, -122.60186],
  [45.509456, -122.601796],
  [45.509431, -122.601796],
  [45.508605, -122.601777],
  [45.508141, -122.601766],
  [45.508073, -122.601765],
  [45.508071, -122.602652],
  [45.50807, -122.602819],
  [45.508065, -122.603501],
  [45.508063, -122.603766],
  [45.50807, -122.603769],
  [45.508075, -122.603773],
  [45.50808, -122.603778],
  [45.508085, -122.603783],
  [45.508089, -122.603789],
  [45.508092, -122.603796],
  [45.508095, -122.603803],
  [45.508097, -122.60381],
  [45.508098, -122.603818],
  [45.508099, -122.603835],
  [45.508097, -122.603851],
  [45.508095, -122.603859],
  [45.508092, -122.603866],
  [45.508089, -122.603873],
  [45.508085, -122.603879],
  [45.50808, -122.603884],
  [45.508075, -122.603889],
  [45.50807, -122.603892],
  [45.508059, -122.603896],
  [45.508059, -122.604451],
  [45.508061, -122.604962],
  [45.508059, -122.605073],
  [45.508053, -122.605529],
  [45.508051, -122.606011],
  [45.508067, -122.606047],
  [45.508076, -122.606091],
  [45.508078, -122.606156],
  [45.50809, -122.606459],
  [45.508092, -122.606504],
  [45.508087, -122.60655],
  [45.508068, -122.606579],
  [45.508047, -122.606591],
  [45.508047, -122.607085],
  [45.508047, -122.607608],
  [45.50804, -122.608118],
  [45.508032, -122.608776],
  [45.508029, -122.609048],
  [45.507708, -122.609053],
  [45.507236, -122.609061],
  [45.506682, -122.609048],
  [45.505901, -122.609022],
  [45.505507, -122.609008],
  [45.505461, -122.609045],
  [45.505394, -122.609045],
  [45.505362, -122.609044],
  [45.505317, -122.609002],
  [45.505034, -122.609002],
  [45.504826, -122.609001],
  [45.504365, -122.609001],
  [45.504252, -122.609002],
  [45.503437, -122.609004],
  [45.503085, -122.60901],
  [45.503045, -122.60901],
  [45.502457, -122.60902],
  [45.502018, -122.609027],
  [45.501579, -122.609032],
  [45.501425, -122.609033],
  [45.50119, -122.609034],
  [45.500284, -122.609036],
  [45.498915, -122.609047],
  [45.498657, -122.609047],
  [45.497841, -122.609049],
  [45.49749, -122.609049],
  [45.497187, -122.609048],
  [45.497171, -122.609048],
  [45.497003, -122.609046],
  [45.49683, -122.609045],
  [45.496722, -122.609045],
  [45.496626, -122.609044],
  [45.496348, -122.609042],
  [45.496315, -122.609042],
  [45.496145, -122.609041],
  [45.495712, -122.609038],
  [45.495462, -122.609037],
  [45.495248, -122.609035],
  [45.49521, -122.609035],
  [45.495154, -122.609034],
  [45.494585, -122.609021],
  [45.494419, -122.609019],
  [45.493895, -122.609011],
  [45.493719, -122.60901],
  [45.493514, -122.60901],
  [45.493146, -122.609008],
  [45.492737, -122.609009],
  [45.492378, -122.609007],
  [45.491965, -122.609003],
  [45.491348, -122.609],
  [45.490589, -122.609006],
  [45.490496, -122.609005],
  [45.490357, -122.609005],
  [45.490294, -122.609001],
  [45.49023, -122.608998],
  [45.490077, -122.608987],
  [45.489694, -122.608958],
  [45.489103, -122.608919],
  [45.488476, -122.608876],
  [45.487972, -122.608841],
  [45.487905, -122.608836],
  [45.487149, -122.608783],
  [45.486812, -122.60876],
  [45.486674, -122.608755],
  [45.486607, -122.608753],
  [45.48568, -122.608747],
  [45.485416, -122.60875],
  [45.485012, -122.608747],
  [45.484666, -122.60875],
  [45.484435, -122.608747],
  [45.484379, -122.608747],
  [45.484252, -122.608746],
  [45.483852, -122.608744],
  [45.483452, -122.608744],
  [45.483045, -122.608739],
  [45.482835, -122.60874],
  [45.482751, -122.608741],
  [45.482081, -122.608739],
  [45.48204, -122.608739],
  [45.481823, -122.608742],
  [45.481411, -122.608739],
  [45.481359, -122.608738],
  [45.480942, -122.608737],
  [45.480617, -122.608736],
  [45.480493, -122.608737],
  [45.480067, -122.608736],
  [45.479902, -122.608735],
  [45.479559, -122.608736],
  [45.479391, -122.608736],
  [45.479254, -122.608736],
  [45.479161, -122.608735],
  [45.479059, -122.608733],
  [45.478774, -122.608734],
  [45.478696, -122.608734],
  [45.478581, -122.608734],
  [45.47842, -122.608741],
  [45.478126, -122.608743],
  [45.47788, -122.608743],
  [45.47782, -122.608743],
  [45.477711, -122.608743],
  [45.477488, -122.608741],
  [45.477006, -122.60874],
  [45.476541, -122.608742],
  [45.476281, -122.608737],
  [45.476075, -122.608727],
  [45.475943, -122.608727],
  [45.475904, -122.608726],
  [45.47583, -122.608735],
  [45.475751, -122.608754],
  [45.475303, -122.608914],
  [45.474431, -122.60922],
  [45.473944, -122.609392],
  [45.473658, -122.609493],
  [45.473568, -122.609526],
  [45.473107, -122.609691],
  [45.472626, -122.609857],
  [45.472489, -122.609899],
  [45.472361, -122.60993],
  [45.472218, -122.609959],
  [45.472065, -122.609979],
  [45.47194, -122.609994],
  [45.471878, -122.609997],
  [45.471179, -122.610004],
  [45.470948, -122.610004],
  [45.470476, -122.610002],
  [45.470025, -122.610003],
  [45.469806, -122.610007],
  [45.469335, -122.610008],
  [45.468861, -122.610009],
  [45.468641, -122.610009],
  [45.468639, -122.609295],
  [45.468639, -122.60922],
  [45.468639, -122.608672],
  [45.468638, -122.608607],
  [45.468638, -122.60851],
  [45.468636, -122.608053],
  [45.468637, -122.607641],
  [45.468637, -122.607351],
  [45.468636, -122.60698],
  [45.468635, -122.606675],
  [45.468635, -122.606457],
  [45.468635, -122.605307],
  [45.468633, -122.604794],
  [45.468633, -122.604553],
  [45.468631, -122.602357],
  [45.468631, -122.602183],
  [45.468628, -122.599569],
  [45.468628, -122.599234],
  [45.468628, -122.599091],
  [45.468628, -122.598882],
  [45.468628, -122.598558],
  [45.468632, -122.598124],
  [45.468633, -122.597807],
  [45.468633, -122.597152],
  [45.468633, -122.596835],
  [45.468636, -122.59618],
  [45.468636, -122.595865],
  [45.468636, -122.595418],
  [45.468638, -122.595207],
  [45.468637, -122.595054],
  [45.468637, -122.594886],
  [45.468642, -122.594226],
  [45.468641, -122.593256],
  [45.468644, -122.592289],
  [45.468645, -122.591406],
  [45.468645, -122.591319],
  [45.468646, -122.590333],
  [45.468652, -122.589459],
  [45.468654, -122.589358],
  [45.468576, -122.589362],
  [45.468322, -122.589362],
  [45.468231, -122.589362],
  [45.467874, -122.589362],
  [45.467033, -122.589363],
  [45.466836, -122.589363],
  [45.466475, -122.589364],
  [45.46639, -122.589365],
  [45.46634, -122.589365],
  [45.46609, -122.589366],
  [45.465843, -122.589367],
  [45.46542, -122.58937],
  [45.465056, -122.589369],
  [45.464851, -122.589371],
  [45.464331, -122.589372],
  [45.46417, -122.589371],
  [45.46412, -122.589371],
  [45.463973, -122.589371],
  [45.463657, -122.589371],
  [45.463272, -122.589372],
  [45.462359, -122.589366],
  [45.461495, -122.589376],
  [45.461448, -122.589377],
  [45.461198, -122.589377],
  [45.461099, -122.589377],
  [45.460764, -122.589375],
  [45.46004, -122.589369],
  [45.459338, -122.589359],
  [45.45894, -122.589356],
  [45.458796, -122.589359],
  [45.458737, -122.589371],
  [45.458679, -122.589396],
  [45.458633, -122.589438],
  [45.458606, -122.589475],
  [45.458584, -122.589531],
  [45.458574, -122.589588],
  [45.458567, -122.589665],
  [45.458564, -122.589834],
  [45.458589, -122.591816],
  [45.45859, -122.591944],
  [45.458597, -122.59285],
  [45.457719, -122.592843],
  [45.45682, -122.592846],
  [45.456204, -122.592847],
  [45.456168, -122.592848],
  [45.456055, -122.592848],
  [45.455962, -122.592845],
  [45.455865, -122.592841],
  [45.45576, -122.592843],
  [45.455715, -122.592844],
  [45.455653, -122.592845],
  [45.455497, -122.592848],
  [45.455424, -122.592849],
  [45.455026, -122.592855],
  [45.454888, -122.592858],
  [45.454287, -122.592854],
  [45.453592, -122.592866],
  [45.453295, -122.592856],
  [45.453239, -122.592853],
  [45.45316, -122.592855],
  [45.452897, -122.592858],
  [45.452703, -122.592856],
  [45.452583, -122.592855],
  [45.452554, -122.592855],
  [45.452188, -122.592855],
  [45.451832, -122.592856],
  [45.45147, -122.592857],
  [45.451132, -122.592853],
  [45.450597, -122.59286],
  [45.450471, -122.592859],
  [45.44988, -122.592858],
  [45.449653, -122.592856],
  [45.449264, -122.592851],
  [45.448917, -122.592847],
  [45.448731, -122.592834],
  [45.448422, -122.5928],
  [45.448182, -122.5928],
  [45.44798, -122.592812],
  [45.447905, -122.592823],
  [45.447892, -122.592722],
  [45.44785, -122.592544],
  [45.447803, -122.592391],
  [45.447738, -122.592224],
  [45.447673, -122.592084],
  [45.447587, -122.591926],
  [45.447314, -122.591414],
  [45.447211, -122.591184],
  [45.44716, -122.591015],
  [45.447129, -122.590893],
  [45.44711, -122.590787],
  [45.447088, -122.59064],
  [45.447069, -122.590421],
  [45.447068, -122.590271],
  [45.447067, -122.590161],
  [45.447062, -122.588753],
  [45.44706, -122.588192],
  [45.44706, -122.587336],
  [45.447061, -122.587301],
  [45.447061, -122.587197],
  [45.447053, -122.586326],
  [45.44705, -122.585782],
  [45.44705, -122.585145],
  [45.447048, -122.584246],
  [45.447044, -122.583298],
  [45.447044, -122.583039],
  [45.447042, -122.582545],
  [45.447041, -122.582238],
  [45.44704, -122.582217],
  [45.447039, -122.581885],
  [45.447038, -122.581478],
  [45.447037, -122.581234],
  [45.447035, -122.580934],
  [45.447035, -122.58078],
  [45.447034, -122.580525],
  [45.44703, -122.579907],
  [45.447029, -122.57957],
  [45.447029, -122.579535],
  [45.447029, -122.579453],
  [45.447029, -122.579393],
  [45.447028, -122.579222],
  [45.447028, -122.578904],
  [45.446912, -122.578897],
  [45.446588, -122.578896],
  [45.446495, -122.578896],
  [45.446311, -122.578896],
  [45.446049, -122.57891],
  [45.445924, -122.578916],
  [45.44563, -122.578921],
  [45.445523, -122.578922],
  [45.445221, -122.578925],
  [45.445098, -122.578926],
  [45.444861, -122.578924],
  [45.444649, -122.578922],
  [45.444533, -122.57892],
  [45.444401, -122.578917],
  [45.44422, -122.578918],
  [45.444168, -122.578919],
  [45.444013, -122.578919],
  [45.443899, -122.57892],
  [45.443581, -122.578922],
  [45.442938, -122.578927],
  [45.44225, -122.578928],
  [45.441956, -122.578928],
  [45.441274, -122.578929],
  [45.441274, -122.578704],
  [45.441271, -122.578042],
  [45.441269, -122.577752],
  [45.441268, -122.577606],
  [45.441265, -122.577263],
  [45.441265, -122.577037],
  [45.441264, -122.576731],
  [45.441258, -122.57591],
  [45.44126, -122.575766],
  [45.441262, -122.575668],
  [45.44126, -122.574901],
  [45.441258, -122.574803],
  [45.441251, -122.573323],
  [45.44125, -122.573122],
  [45.441249, -122.572995],
  [45.44124, -122.57119],
  [45.441168, -122.571198],
  [45.440886, -122.571207],
  [45.440811, -122.571209],
  [45.440488, -122.571214],
  [45.440056, -122.571213],
  [45.439727, -122.571213],
  [45.439668, -122.571211],
  [45.439566, -122.571203],
  [45.439518, -122.571196],
  [45.439362, -122.571163],
  [45.439194, -122.571119],
  [45.439151, -122.571103],
  [45.438981, -122.57104],
  [45.43893, -122.571018],
  [45.438841, -122.57098],
  [45.438819, -122.570972],
  [45.438772, -122.570962],
  [45.438744, -122.570958],
  [45.438713, -122.570955],
  [45.438683, -122.570952],
  [45.438645, -122.57095],
  [45.438553, -122.57095],
  [45.438528, -122.57095],
  [45.438384, -122.570951],
  [45.438274, -122.570955],
  [45.438276, -122.571584],
  [45.438278, -122.572139],
  [45.438281, -122.572732],
  [45.43828, -122.572969],
  [45.438278, -122.573529],
  [45.43828, -122.574742],
  [45.438279, -122.57478],
  [45.438279, -122.575642],
  [45.438135, -122.575645],
  [45.437361, -122.575662],
  [45.437263, -122.575656],
  [45.437261, -122.575546],
  [45.437255, -122.575444],
  [45.437262, -122.575233],
  [45.437277, -122.575122],
  [45.43731, -122.575012],
  [45.437375, -122.574795],
  [45.437398, -122.574718],
  [45.437412, -122.574635],
  [45.437415, -122.574575],
  [45.437416, -122.574539],
  [45.437414, -122.574347],
  [45.437414, -122.574259],
  [45.437402, -122.57331],
  [45.4374, -122.57317],
  [45.437398, -122.572993],
  [45.437386, -122.572789],
  [45.437284, -122.572368],
  [45.437243, -122.572174],
  [45.437236, -122.572096],
  [45.437225, -122.571976],
  [45.437224, -122.571863],
  [45.437222, -122.571679],
  [45.437221, -122.571651],
  [45.437216, -122.571433],
  [45.437212, -122.571197],
  [45.437206, -122.570998],
  [45.437202, -122.570785],
  [45.437198, -122.570562],
  [45.437193, -122.570335],
  [45.437189, -122.570119],
  [45.437184, -122.569903],
  [45.43718, -122.569685],
  [45.437176, -122.569469],
  [45.437175, -122.569407],
  [45.437162, -122.569347],
  [45.437139, -122.569296],
  [45.437114, -122.569251],
  [45.437081, -122.569233],
  [45.437007, -122.569226],
  [45.43683, -122.569231],
  [45.436637, -122.569217],
  [45.436537, -122.569201],
  [45.436415, -122.569182],
  [45.436264, -122.569157],
  [45.436107, -122.569129],
  [45.43607, -122.569123],
  [45.43595, -122.569104],
  [45.435618, -122.569051],
  [45.435528, -122.569036],
  [45.435508, -122.568883],
  [45.435533, -122.568653],
  [45.435564, -122.568572],
  [45.435568, -122.568479],
  [45.435599, -122.568167],
  [45.435602, -122.568142],
  [45.435613, -122.568101],
  [45.435626, -122.56807],
  [45.43567, -122.568073],
  [45.435735, -122.568086],
  [45.435757, -122.56809],
  [45.43581, -122.568136],
  [45.436148, -122.5682],
  [45.436575, -122.568281],
  [45.436566, -122.56838],
  [45.436554, -122.568507],
  [45.436532, -122.568749],
  [45.436108, -122.568667],
  [45.435763, -122.568601],
  [45.435689, -122.56859],
  [45.435678, -122.568589]
];

const stopNames = {
  "68": "SE Alberta &amp; 70th",
  "396": "SE Bell &amp; Johnson Creek",
  "398": "SE Bell &amp; Jordan",
  "987": "8800 Block SE Causey",
  "1239": "NE Cully &amp; Shaver",
  "1241": "NE Cully &amp; Prescott",
  "1245": "NE Cully &amp; Mason",
  "1732": "SE Flavel &amp; 52nd",
  "1738": "SE Flavel &amp; 57th",
  "1739": "SE Flavel &amp; 60th",
  "1742": "SE Flavel &amp; 62nd",
  "1748": "SE Flavel &amp; 66th Place",
  "1754": "SE Flavel &amp; 70th",
  "2434": "NE Halsey &amp; 58th",
  "3224": "7100 Block SE King",
  "3226": "7900 Block SE King",
  "3251": "SE King &amp; 74th",
  "3404": "SE Lincoln &amp; 57th",
  "4745": "NE Prescott &amp; 64th",
  "4749": "NE Prescott &amp; 68th",
  "4753": "NE Prescott &amp; 72nd",
  "4757": "NE Prescott &amp; 77th",
  "4761": "NE Prescott &amp; 82nd",
  "4763": "NE Prescott &amp; 84th",
  "7676": "SE 52nd &amp; Cooper",
  "7679": "SE 52nd &amp; Division",
  "7682": "SE 52nd &amp; Duke",
  "7684": "SE 52nd &amp; Bush",
  "7687": "SE 52nd &amp; Franklin",
  "7688": "SE 52nd &amp; Center/Gladstone",
  "7691": "SE 52nd &amp; Harold",
  "7693": "SE 52nd &amp; Holgate",
  "7696": "SE 52nd &amp; Lincoln",
  "7703": "SE 52nd &amp; Ogden",
  "7706": "SE 52nd &amp; Powell",
  "7709": "SE 52nd &amp; Reedway",
  "7711": "SE 52nd &amp; Schiller",
  "7716": "SE 52nd &amp; Steele",
  "7718": "SE 52nd &amp; Carlton",
  "7723": "SE 52nd &amp; Woodward",
  "7733": "NE 57th &amp; Fremont",
  "7735": "NE 57th &amp; Hancock",
  "7738": "NE 57th &amp; Sandy",
  "7741": "NE 57th &amp; Siskiyou",
  "7744": "NE 57th &amp; Thompson",
  "7813": "SE 60th &amp; Belmont",
  "7814": "SE 60th &amp; E Burnside",
  "7819": "NE 60th &amp; Glisan",
  "7824": "SE 60th &amp; Hawthorne",
  "7828": "NE 60th &amp; 60th Ave MAX Stn/I-84",
  "7831": "SE 60th &amp; Salmon",
  "7833": "SE 60th &amp; Stark",
  "7835": "SE 60th &amp; Stephens",
  "7837": "NE 60th &amp; Wasco",
  "7874": "SE 72nd &amp; Luther",
  "7875": "SE 72nd &amp; Flavel",
  "7882": "SE 72nd &amp; Lexington",
  "7892": "SE 72nd &amp; Tenino",
  "7921": "SE 82nd &amp; Monroe/Boyer",
  "7990": "SE 82nd &amp; King",
  "8448": "8300 Block SE Causey",
  "8457": "SE Bell &amp; Sandview",
  "8467": "SE 90th &amp; Monterey",
  "10481": "SE 52nd &amp; Woodstock",
  "10820": "NE Prescott &amp; 89th",
  "10850": "Parkrose/ Sumner Transit Center ",
  "12921": "Clackamas Town Center Mall",
  "12992": "NE Prescott &amp; 87th",
  "13037": "SE 90th &amp; Causey",
  "13247": "Clackamas Town Center TC",
  "13248": "Clackamas Town Center Transit Center"
};

const stops = [
  { stop_id: "10850", name: "Parkrose/ Sumner Transit Center ", lat: 45.558282, lon: -122.565304, times: ["9:23 PM", "9:53 PM", "10:23 PM", "10:53 PM", "5:38 AM", "6:08 AM", "6:38 AM", "7:08 AM"] },
  { stop_id: "10820", name: "NE Prescott &amp; 89th", lat: 45.555894, lon: -122.571216, times: ["9:24 PM", "9:54 PM", "10:24 PM", "10:54 PM", "5:39 AM", "6:09 AM", "6:39 AM", "7:09 AM"] },
  { stop_id: "12992", name: "NE Prescott &amp; 87th", lat: 45.555539, lon: -122.573599, times: ["9:24 PM", "9:54 PM", "10:24 PM", "10:54 PM", "5:39 AM", "6:09 AM", "6:39 AM", "7:09 AM"] },
  { stop_id: "4763", name: "NE Prescott &amp; 84th", lat: 45.555489, lon: -122.577009, times: ["9:25 PM", "9:55 PM", "10:25 PM", "10:55 PM", "5:40 AM", "6:10 AM", "6:40 AM", "7:10 AM"] },
  { stop_id: "4761", name: "NE Prescott &amp; 82nd", lat: 45.555488, lon: -122.57928, times: ["9:25 PM", "9:55 PM", "10:25 PM", "10:55 PM", "5:40 AM", "6:10 AM", "6:40 AM", "7:10 AM"] },
  { stop_id: "4757", name: "NE Prescott &amp; 77th", lat: 45.555476, lon: -122.583538, times: ["9:26 PM", "9:56 PM", "10:26 PM", "10:56 PM", "5:41 AM", "6:11 AM", "6:41 AM", "7:11 AM"] },
  { stop_id: "4753", name: "NE Prescott &amp; 72nd", lat: 45.555515, lon: -122.588666, times: ["9:27 PM", "9:57 PM", "10:27 PM", "10:57 PM", "5:42 AM", "6:12 AM", "6:42 AM", "7:12 AM"] },
  { stop_id: "4749", name: "NE Prescott &amp; 68th", lat: 45.555505, lon: -122.593711, times: ["9:28 PM", "9:58 PM", "10:28 PM", "10:58 PM", "5:43 AM", "6:13 AM", "6:43 AM", "7:13 AM"] },
  { stop_id: "4745", name: "NE Prescott &amp; 64th", lat: 45.555518, lon: -122.597181, times: ["9:28 PM", "9:58 PM", "10:28 PM", "10:58 PM", "5:43 AM", "6:13 AM", "6:43 AM", "7:13 AM"] },
  { stop_id: "1241", name: "NE Cully &amp; Prescott", lat: 45.554849, lon: -122.601532, times: ["9:29 PM", "9:59 PM", "10:29 PM", "10:59 PM", "5:44 AM", "6:14 AM", "6:44 AM", "7:14 AM"] },
  { stop_id: "1245", name: "NE Cully &amp; Mason", lat: 45.552652, lon: -122.603392, times: ["9:30 PM", "10:00 PM", "10:30 PM", "11:00 PM", "5:45 AM", "6:15 AM", "6:45 AM", "7:15 AM"] },
  { stop_id: "1239", name: "NE Cully &amp; Shaver", lat: 45.551716, lon: -122.604174, times: ["9:30 PM", "10:00 PM", "10:30 PM", "11:00 PM", "5:45 AM", "6:15 AM", "6:45 AM", "7:15 AM"] },
  { stop_id: "7733", name: "NE 57th &amp; Fremont", lat: 45.547975, lon: -122.604646, times: ["9:31 PM", "10:01 PM", "10:31 PM", "11:01 PM", "5:46 AM", "6:16 AM", "6:46 AM", "7:16 AM"] },
  { stop_id: "7741", name: "NE 57th &amp; Siskiyou", lat: 45.545449, lon: -122.604668, times: ["9:32 PM", "10:02 PM", "10:32 PM", "11:02 PM", "5:47 AM", "6:17 AM", "6:47 AM", "7:17 AM"] },
  { stop_id: "7738", name: "NE 57th &amp; Sandy", lat: 45.541813, lon: -122.604649, times: ["9:33 PM", "10:03 PM", "10:33 PM", "11:03 PM", "5:48 AM", "6:18 AM", "6:48 AM", "7:18 AM"] },
  { stop_id: "7744", name: "NE 57th &amp; Thompson", lat: 45.539149, lon: -122.604709, times: ["9:33 PM", "10:03 PM", "10:33 PM", "11:03 PM", "5:48 AM", "6:18 AM", "6:48 AM", "7:18 AM"] },
  { stop_id: "7735", name: "NE 57th &amp; Hancock", lat: 45.53659, lon: -122.604725, times: ["9:34 PM", "10:04 PM", "10:34 PM", "11:04 PM", "5:49 AM", "6:19 AM", "6:49 AM", "7:19 AM"] },
  { stop_id: "2434", name: "NE Halsey &amp; 58th", lat: 45.533656, lon: -122.604176, times: ["9:35 PM", "10:05 PM", "10:35 PM", "11:05 PM", "5:50 AM", "6:20 AM", "6:50 AM", "7:20 AM"] },
  { stop_id: "7837", name: "NE 60th &amp; Wasco", lat: 45.53234, lon: -122.602269, times: ["9:10 PM", "9:36 PM", "10:06 PM", "10:36 PM", "11:06 PM", "5:51 AM", "6:21 AM", "6:51 AM"] },
  { stop_id: "7828", name: "NE 60th &amp; 60th Ave MAX Stn/I-84", lat: 45.528606, lon: -122.602393, times: ["9:12 PM", "9:38 PM", "10:08 PM", "10:38 PM", "11:08 PM", "5:53 AM", "6:23 AM", "6:53 AM"] },
  { stop_id: "7819", name: "NE 60th &amp; Glisan", lat: 45.526626, lon: -122.602351, times: ["9:12 PM", "9:38 PM", "10:08 PM", "10:38 PM", "11:08 PM", "5:53 AM", "6:23 AM", "6:53 AM"] },
  { stop_id: "7814", name: "SE 60th &amp; E Burnside", lat: 45.522613, lon: -122.602454, times: ["9:13 PM", "9:39 PM", "10:09 PM", "10:39 PM", "11:09 PM", "5:54 AM", "6:24 AM", "6:54 AM"] },
  { stop_id: "7833", name: "SE 60th &amp; Stark", lat: 45.519346, lon: -122.602445, times: ["9:14 PM", "9:40 PM", "10:10 PM", "10:40 PM", "11:10 PM", "5:55 AM", "6:25 AM", "6:55 AM"] },
  { stop_id: "7813", name: "SE 60th &amp; Belmont", lat: 45.51687, lon: -122.602089, times: ["9:15 PM", "9:41 PM", "10:11 PM", "10:41 PM", "11:11 PM", "5:56 AM", "6:26 AM", "6:56 AM"] },
  { stop_id: "7831", name: "SE 60th &amp; Salmon", lat: 45.514134, lon: -122.601999, times: ["9:16 PM", "9:42 PM", "10:12 PM", "10:42 PM", "11:12 PM", "5:57 AM", "6:27 AM", "6:57 AM"] },
  { stop_id: "7824", name: "SE 60th &amp; Hawthorne", lat: 45.511962, lon: -122.601921, times: ["9:17 PM", "9:43 PM", "10:13 PM", "10:42 PM", "11:12 PM", "5:58 AM", "6:28 AM", "6:58 AM"] },
  { stop_id: "7835", name: "SE 60th &amp; Stephens", lat: 45.509456, lon: -122.601855, times: ["9:18 PM", "9:44 PM", "10:14 PM", "10:43 PM", "11:13 PM", "5:59 AM", "6:29 AM", "6:59 AM"] },
  { stop_id: "3404", name: "SE Lincoln &amp; 57th", lat: 45.508116, lon: -122.605075, times: ["9:19 PM", "9:45 PM", "10:15 PM", "10:44 PM", "11:14 PM", "6:00 AM", "6:30 AM", "7:00 AM"] },
  { stop_id: "7696", name: "SE 52nd &amp; Lincoln", lat: 45.507708, lon: -122.609122, times: ["9:20 PM", "9:46 PM", "10:16 PM", "10:45 PM", "11:15 PM", "6:01 AM", "6:31 AM", "7:01 AM"] },
  { stop_id: "7679", name: "SE 52nd &amp; Division", lat: 45.505034, lon: -122.609081, times: ["9:21 PM", "9:47 PM", "10:17 PM", "10:46 PM", "11:16 PM", "6:02 AM", "6:32 AM", "7:02 AM"] },
  { stop_id: "7723", name: "SE 52nd &amp; Woodward", lat: 45.501191, lon: -122.609129, times: ["9:22 PM", "9:48 PM", "10:18 PM", "10:47 PM", "11:17 PM", "6:03 AM", "6:33 AM", "7:03 AM"] },
  { stop_id: "7687", name: "SE 52nd &amp; Franklin", lat: 45.498655, lon: -122.609124, times: ["9:23 PM", "9:49 PM", "10:19 PM", "10:48 PM", "11:18 PM", "6:04 AM", "6:34 AM", "7:04 AM"] },
  { stop_id: "7706", name: "SE 52nd &amp; Powell", lat: 45.497182, lon: -122.609143, times: ["9:23 PM", "9:49 PM", "10:19 PM", "10:48 PM", "11:18 PM", "6:04 AM", "6:34 AM", "7:04 AM"] },
  { stop_id: "7684", name: "SE 52nd &amp; Bush", lat: 45.495246, lon: -122.609113, times: ["9:24 PM", "9:50 PM", "10:20 PM", "10:49 PM", "11:19 PM", "6:05 AM", "6:35 AM", "7:05 AM"] },
  { stop_id: "7688", name: "SE 52nd &amp; Center/Gladstone", lat: 45.493726, lon: -122.609132, times: ["9:25 PM", "9:51 PM", "10:21 PM", "10:50 PM", "11:20 PM", "6:06 AM", "6:36 AM", "7:06 AM"] },
  { stop_id: "7693", name: "SE 52nd &amp; Holgate", lat: 45.490496, lon: -122.609085, times: ["9:27 PM", "9:53 PM", "10:23 PM", "10:52 PM", "11:22 PM", "6:08 AM", "6:38 AM", "7:08 AM"] },
  { stop_id: "7711", name: "SE 52nd &amp; Schiller", lat: 45.487966, lon: -122.608922, times: ["9:27 PM", "9:53 PM", "10:23 PM", "10:52 PM", "11:22 PM", "6:08 AM", "6:38 AM", "7:08 AM"] },
  { stop_id: "7716", name: "SE 52nd &amp; Steele", lat: 45.484431, lon: -122.60883, times: ["9:28 PM", "9:54 PM", "10:24 PM", "10:53 PM", "11:23 PM", "6:09 AM", "6:39 AM", "7:09 AM"] },
  { stop_id: "7691", name: "SE 52nd &amp; Harold", lat: 45.482833, lon: -122.608819, times: ["9:28 PM", "9:54 PM", "10:24 PM", "10:53 PM", "11:23 PM", "6:09 AM", "6:39 AM", "7:09 AM"] },
  { stop_id: "7709", name: "SE 52nd &amp; Reedway", lat: 45.481409, lon: -122.60882, times: ["9:29 PM", "9:55 PM", "10:25 PM", "10:54 PM", "11:24 PM", "6:10 AM", "6:40 AM", "7:10 AM"] },
  { stop_id: "10481", name: "SE 52nd &amp; Woodstock", lat: 45.479391, lon: -122.608814, times: ["9:29 PM", "9:55 PM", "10:25 PM", "10:54 PM", "11:24 PM", "6:10 AM", "6:40 AM", "7:10 AM"] },
  { stop_id: "7718", name: "SE 52nd &amp; Carlton", lat: 45.47782, lon: -122.608805, times: ["9:29 PM", "9:55 PM", "10:25 PM", "10:54 PM", "11:24 PM", "6:10 AM", "6:40 AM", "7:10 AM"] },
  { stop_id: "7682", name: "SE 52nd &amp; Duke", lat: 45.475941, lon: -122.608808, times: ["9:30 PM", "9:56 PM", "10:26 PM", "10:55 PM", "11:25 PM", "6:11 AM", "6:41 AM", "7:11 AM"] },
  { stop_id: "7676", name: "SE 52nd &amp; Cooper", lat: 45.47367, lon: -122.609582, times: ["9:30 PM", "9:56 PM", "10:26 PM", "10:55 PM", "11:25 PM", "6:11 AM", "6:41 AM", "7:11 AM"] },
  { stop_id: "7703", name: "SE 52nd &amp; Ogden", lat: 45.470946, lon: -122.610098, times: ["9:31 PM", "9:57 PM", "10:27 PM", "10:56 PM", "11:26 PM", "6:12 AM", "6:42 AM", "7:12 AM"] },
  { stop_id: "1732", name: "SE Flavel &amp; 52nd", lat: 45.468558, lon: -122.609299, times: ["9:32 PM", "9:58 PM", "10:28 PM", "10:57 PM", "11:27 PM", "6:13 AM", "6:43 AM", "7:13 AM"] },
  { stop_id: "1738", name: "SE Flavel &amp; 57th", lat: 45.468567, lon: -122.604554, times: ["9:32 PM", "9:58 PM", "10:28 PM", "10:57 PM", "11:27 PM", "6:13 AM", "6:43 AM", "7:13 AM"] },
  { stop_id: "1739", name: "SE Flavel &amp; 60th", lat: 45.468554, lon: -122.602359, times: ["9:33 PM", "9:59 PM", "10:29 PM", "10:58 PM", "11:28 PM", "6:14 AM", "6:44 AM", "7:14 AM"] },
  { stop_id: "1742", name: "SE Flavel &amp; 62nd", lat: 45.46856, lon: -122.599248, times: ["9:33 PM", "9:59 PM", "10:29 PM", "10:58 PM", "11:28 PM", "6:14 AM", "6:44 AM", "7:14 AM"] },
  { stop_id: "1748", name: "SE Flavel &amp; 66th Place", lat: 45.46856, lon: -122.595052, times: ["9:34 PM", "10:00 PM", "10:30 PM", "10:59 PM", "11:29 PM", "6:15 AM", "6:45 AM", "7:15 AM"] },
  { stop_id: "1754", name: "SE Flavel &amp; 70th", lat: 45.468576, lon: -122.591403, times: ["9:34 PM", "10:00 PM", "10:30 PM", "10:59 PM", "11:29 PM", "6:15 AM", "6:45 AM", "7:15 AM"] },
  { stop_id: "7875", name: "SE 72nd &amp; Flavel", lat: 45.468323, lon: -122.589435, times: ["9:35 PM", "10:01 PM", "10:31 PM", "11:00 PM", "11:30 PM", "6:16 AM", "6:46 AM", "7:16 AM"] },
  { stop_id: "7882", name: "SE 72nd &amp; Lexington", lat: 45.466476, lon: -122.589456, times: ["9:35 PM", "10:01 PM", "10:31 PM", "11:00 PM", "11:30 PM", "6:16 AM", "6:46 AM", "7:16 AM"] },
  { stop_id: "7892", name: "SE 72nd &amp; Tenino", lat: 45.463969, lon: -122.589466, times: ["9:36 PM", "10:02 PM", "10:32 PM", "11:01 PM", "11:31 PM", "6:17 AM", "6:47 AM", "7:17 AM"] },
  { stop_id: "7874", name: "SE 72nd &amp; Luther", lat: 45.461198, lon: -122.589474, times: ["9:37 PM", "10:02 PM", "10:32 PM", "11:01 PM", "11:31 PM", "6:18 AM", "6:48 AM", "7:18 AM"] },
  { stop_id: "68", name: "SE Alberta &amp; 70th", lat: 45.458637, lon: -122.591826, times: ["9:11 PM", "9:38 PM", "10:03 PM", "10:33 PM", "11:02 PM", "11:32 PM", "6:19 AM", "6:49 AM"] },
  { stop_id: "396", name: "SE Bell &amp; Johnson Creek", lat: 45.45576, lon: -122.59291, times: ["9:11 PM", "9:38 PM", "10:04 PM", "10:34 PM", "11:03 PM", "11:33 PM", "6:19 AM", "6:49 AM"] },
  { stop_id: "398", name: "SE Bell &amp; Jordan", lat: 45.452703, lon: -122.592943, times: ["9:12 PM", "9:39 PM", "10:05 PM", "10:35 PM", "11:04 PM", "11:34 PM", "6:20 AM", "6:50 AM"] },
  { stop_id: "8457", name: "SE Bell &amp; Sandview", lat: 45.449263, lon: -122.592942, times: ["9:13 PM", "9:40 PM", "10:05 PM", "10:35 PM", "11:04 PM", "11:34 PM", "6:21 AM", "6:51 AM"] },
  { stop_id: "3224", name: "7100 Block SE King", lat: 45.446985, lon: -122.590273, times: ["9:14 PM", "9:41 PM", "10:06 PM", "10:36 PM", "11:05 PM", "11:35 PM", "6:22 AM", "6:52 AM"] },
  { stop_id: "3251", name: "SE King &amp; 74th", lat: 45.446987, lon: -122.587335, times: ["9:14 PM", "9:41 PM", "10:07 PM", "10:37 PM", "11:06 PM", "11:36 PM", "6:22 AM", "6:52 AM"] },
  { stop_id: "3226", name: "7900 Block SE King", lat: 45.44696, lon: -122.582217, times: ["9:15 PM", "9:42 PM", "10:07 PM", "10:37 PM", "11:06 PM", "11:36 PM", "6:23 AM", "6:53 AM"] },
  { stop_id: "7990", name: "SE 82nd &amp; King", lat: 45.446585, lon: -122.579071, times: ["9:16 PM", "9:43 PM", "10:08 PM", "10:38 PM", "11:07 PM", "11:37 PM", "6:24 AM", "6:54 AM"] },
  { stop_id: "7921", name: "SE 82nd &amp; Monroe/Boyer", lat: 45.444217, lon: -122.579068, times: ["9:16 PM", "9:43 PM", "10:09 PM", "10:39 PM", "11:08 PM", "11:38 PM", "6:24 AM", "6:54 AM"] },
  { stop_id: "8448", name: "8300 Block SE Causey", lat: 45.441204, lon: -122.577609, times: ["9:17 PM", "9:44 PM", "10:10 PM", "10:40 PM", "11:09 PM", "11:39 PM", "6:25 AM", "6:55 AM"] },
  { stop_id: "987", name: "8800 Block SE Causey", lat: 45.441196, lon: -122.572996, times: ["9:18 PM", "9:45 PM", "10:10 PM", "10:40 PM", "11:09 PM", "11:39 PM", "6:26 AM", "6:56 AM"] },
  { stop_id: "13037", name: "SE 90th &amp; Causey", lat: 45.440887, lon: -122.571264, times: ["9:18 PM", "9:45 PM", "10:11 PM", "10:41 PM", "11:10 PM", "11:40 PM", "6:26 AM", "6:56 AM"] },
  { stop_id: "8467", name: "SE 90th &amp; Monterey", lat: 45.438527, lon: -122.571011, times: ["9:19 PM", "9:46 PM", "10:11 PM", "10:41 PM", "11:10 PM", "11:40 PM", "6:27 AM", "6:57 AM"] },
  { stop_id: "12921", name: "Clackamas Town Center Mall", lat: 45.43731, lon: -122.573312, times: ["9:21 PM", "9:48 PM", "10:13 PM", "10:43 PM", "11:12 PM", "11:42 PM", "6:29 AM", "6:59 AM"] },
  { stop_id: "13247", name: "Clackamas Town Center TC", lat: 45.435538, lon: -122.568155, times: ["9:23 PM", "9:50 PM", "10:15 PM", "10:45 PM", "11:14 PM", "11:44 PM", "6:31 AM", "7:01 AM"] },
  { stop_id: "13248", name: "Clackamas Town Center Transit Center", lat: 45.435666, lon: -122.568707, times: ["9:24 PM", "9:51 PM", "10:16 PM", "10:46 PM", "11:15 PM", "11:45 PM", "6:32 AM", "7:02 AM"] },
]

  const polylineOut = L.polyline(shapeOutbound, {
    color: 'blue',
    weight: 4,
    opacity: 0.7
  }).addTo(map);

  map.fitBounds(polylineOut.getBounds());

  stops.forEach(stop => {
    const marker = L.circleMarker([stop.lat, stop.lon], {
      radius: 6,
      color: '#4dd0e1',
      fillColor: '#4dd0e1',
      fillOpacity: 0.9,
      weight: 1
    });

    const popupContent = `
      <strong>${stop.name}</strong><br>
      ${stop.times && stop.times.length ? stop.times.join("<br>") : "No scheduled times"}
    `;

    marker.bindPopup(popupContent);
    marker.addTo(map);
  });

  let busMarkers = {};

  async function fetchAndDisplay() {
    const res = await fetch(`https://developer.trimet.org/ws/v2/vehicles?route=${routeNumber}&appID=${apiKey}&json=true`);
    const data = await res.json();
    const buses = (data.resultSet.vehicle || []).filter(v =>
      v.routeNumber == routeNumber && v.direction == direction
    );

    Object.values(busMarkers).forEach(m => map.removeLayer(m));
    busMarkers = {};

    if (buses.length === 0) return;

    buses.forEach(bus => {
      if (!bus.latitude || !bus.longitude || !bus.blockID) return;

      const icon = L.divIcon({
        className: '',
        html: `
          <div style="text-align:center;">
            <div style="background:#0071CE;color:#fff;padding:2px 6px;border-radius:6px;font-weight:bold;">${bus.vehicleID}</div>
            <div style="width:0;height:0;border-left:5px solid transparent;border-right:5px solid transparent;border-top:10px solid #00bfff;margin:auto;"></div>
          </div>
        `,
        iconSize: [40, 30],
        iconAnchor: [20, 30]
      });

      const marker = L.marker([bus.latitude, bus.longitude], { icon }).addTo(map);
      busMarkers[bus.vehicleID] = marker;
    });
  }

  fetchAndDisplay();
  setInterval(fetchAndDisplay, 15000);
  </script>

<footer class="site-footer">
  <a href="terms.html">Terms of Use</a> &nbsp;|&nbsp;
  <a href="contact.html">Contact Us</a> &nbsp;|&nbsp;
  <a href="report.html">Report a Problem</a> &nbsp;|&nbsp;
  <a href="privacy.html">Privacy Policy</a>
</footer>

  <script>
    if (!localStorage.getItem('cookieConsent')) {
      document.write(`
        <div id="cookie-banner" style="position: fixed; bottom: 0; left: 0; right: 0; background: #333; color: #fff; padding: 1rem; z-index: 1000; font-size: 0.9rem; line-height: 1.4; text-align: center; box-sizing: border-box;">
          üì¢ We use cookies to improve functionality and analyze traffic.
          By using MetroFeed, you agree to our 
          <a href='privacy.html' style='color: #4dd0e1; text-decoration: underline;'>Privacy Policy</a>.<br>
          <button onclick='localStorage.setItem("cookieConsent", "true"); document.getElementById("cookie-banner").remove();' style='margin-top: 0.5rem; background: #4dd0e1; color: #000; border: none; padding: 0.5rem 1rem; border-radius: 5px; cursor: pointer; font-weight: bold;'>OK</button>
        </div>
      `);
    }
</script>


</body>
</html>