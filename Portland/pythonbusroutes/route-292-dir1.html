<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Route 292 - To Goose Hollow/SW Jefferson | MetroFeed Portland</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', sans-serif;
      background-color: #0d0d0d;
      color: #cccccc;
      overflow-y: auto;
    }

    body {
      padding-top: 100px;
    }

    .ad-banner {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      background: #222;
      padding: 0.5rem 0;
      z-index: 1000;
      box-shadow: 0 2px 8px rgba(0,0,0,0.5);
      text-align: center;
    }

    .ad-banner img {
  width: 100%;
  max-width: 970px;
  height: auto;
  max-height: 120px; /* üëà Caps desktop height */
  display: block;
  margin: 0 auto;
}
    .home-button {
      position: fixed;
      top: 120px;
      left: 10px;
      background-color: #4dd0e1;
      color: #0d0d0d;
      padding: 0.5rem 1rem;
      font-weight: bold;
      border-radius: 8px;
      text-decoration: none;
      z-index: 1001;
      box-shadow: 0 0 10px #4dd0e1;
    }

    .home-button:hover {
      background-color: #00bcd4;
      color: #ffffff;
    }

    header {
      background-color: #0d0d0d;
      border-top: 4px solid #4dd0e1;
      border-bottom: 3px solid #4dd0e1;
      padding: 1rem;
      text-align: center;
    }

    header img {
      max-height: 60px;
    }

    h1 {
      text-align: center;
      margin: 1rem 0;
      font-size: 2rem;
      color: #f0f0f0;
    }

    .content-box {
      border-radius: 12px;
      padding: 0;
      margin: 0;
      background-color: #1e1e1e;
    }

    #map {
      width: 100%;
      height: 85vh;
      border: none;
      margin: 0 auto;
      display: block;
      border-radius: 8px;
    }

    .button-bar {
      display: flex;
      justify-content: center;
      margin: 1rem 0;
    }

    .button-bar a, .back-button {
      background: #4dd0e1;
      color: #0d0d0d;
      padding: 0.6rem 1.2rem;
      text-decoration: none;
      border-radius: 8px;
      font-weight: bold;
      border: none;
      cursor: pointer;
      box-shadow: 0 0 10px #4dd0e1;
    }

    .back-button:hover {
      background-color: #35c0d6;
    }

    .site-footer {
      text-align: center;
      margin-top: 3rem;
      margin-bottom: 120px;
      font-size: 0.85rem;
      color: #aaa;
    }

    .site-footer a {
      color: #00BFFF;
      text-decoration: none;
    }

    .site-footer a:hover {
      text-decoration: underline;
    }

@media (max-width: 600px) {
  .ad-banner {
    padding-top: 1rem;
    padding-bottom: 1rem;
  }
}


  </style>
</head>

<body>
 


 <header>
    <img src="MetroFeedPortlandLogo.png" alt="MetroFeed Portland">
  </header>

  <div class="disclaimer" style="margin: 1rem auto 0.5rem; max-width: 600px; font-size: 0.8rem; color: #bbb; text-align: center; padding: 0.5rem 1rem; background-color: #111; border: 1px dashed #444; border-radius: 6px;">
    ‚ö†Ô∏è This is a Beta program, work in progress. Please REPORT bugs and pretend to be impressed.
  </div>
  <div class="disclaimer" style="margin: 0 auto 1rem; max-width: 600px; font-size: 0.75rem; color: #888; text-align: center; padding: 0.25rem 1rem;">
    This tool is not affiliated with or endorsed by TriMet. For official schedules and service alerts, visit <a href="https://trimet.org" style="color:#4dd0e1;">trimet.org</a>.
  </div>

  <div style="margin: 2rem 0; text-align: center;">
    <button class="back-button" onclick="history.back()">Back</button>
  </div>

  <h1>Route 292 - To Goose Hollow/SW Jefferson</h1>

  <div class="content-box">
    <div id="map"></div>
    <div style="text-align:right; font-size: 0.7rem; color: #777; margin-top: 0.5rem;">
      Data courtesy of TriMet.
    </div>
  </div>

  <script>
    if (document.referrer === "" && performance.navigation.type === 0) {
      window.location.href = "/index.html";
    }

    const apiKey = "2C4447D4A42083BCD84DE3B8E";
    const routeNumber = 292;
    const direction = parseInt(1);

    // Initialize map
    const map = L.map('map', {
      center: [45.6, -122.7],
      zoom: 12,
      minZoom: 12,
      maxZoom: 18,
      maxBounds: [[45.3, -123.1], [45.9, -122.3]],
      maxBoundsViscosity: 1.0
    });
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { maxZoom: 19 }).addTo(map);

    // Injected shape & stop data
    const shapeOutbound = [
  [45.588037, -122.592952],
  [45.588029, -122.592951],
  [45.587974, -122.592935],
  [45.587826, -122.592842],
  [45.587754, -122.59276],
  [45.5876, -122.59262],
  [45.587472, -122.592518],
  [45.5872, -122.592337],
  [45.587137, -122.592298],
  [45.587029, -122.592191],
  [45.586593, -122.591936],
  [45.586458, -122.591899],
  [45.586237, -122.591739],
  [45.58614, -122.591663],
  [45.586051, -122.591569],
  [45.585918, -122.591386],
  [45.585763, -122.591099],
  [45.584951, -122.589016],
  [45.584676, -122.588308],
  [45.58465, -122.588217],
  [45.584585, -122.587959],
  [45.58455, -122.587737],
  [45.584533, -122.587501],
  [45.58452, -122.587229],
  [45.584535, -122.586899],
  [45.584579, -122.586641],
  [45.584647, -122.586388],
  [45.584846, -122.585874],
  [45.584974, -122.585602],
  [45.585075, -122.58529],
  [45.585112, -122.585182],
  [45.585152, -122.585017],
  [45.585194, -122.584809],
  [45.585228, -122.584566],
  [45.585238, -122.584309],
  [45.585241, -122.584093],
  [45.585228, -122.583915],
  [45.5852, -122.583723],
  [45.585171, -122.583559],
  [45.585132, -122.583392],
  [45.585091, -122.583253],
  [45.58503, -122.583081],
  [45.584805, -122.582505],
  [45.584022, -122.580491],
  [45.583313, -122.578645],
  [45.582961, -122.577741],
  [45.582785, -122.577289],
  [45.581677, -122.574442],
  [45.581551, -122.574331],
  [45.581397, -122.573937],
  [45.581036, -122.573036],
  [45.580983, -122.572956],
  [45.580951, -122.572926],
  [45.580902, -122.572897],
  [45.580854, -122.572885],
  [45.580801, -122.572885],
  [45.580689, -122.572889],
  [45.579991, -122.573434],
  [45.579846, -122.573462],
  [45.579751, -122.573536],
  [45.579383, -122.573827],
  [45.579151, -122.574011],
  [45.579053, -122.574085],
  [45.578956, -122.57416],
  [45.578866, -122.57424],
  [45.578788, -122.574328],
  [45.578686, -122.574451],
  [45.578552, -122.574655],
  [45.578477, -122.574789],
  [45.578437, -122.574879],
  [45.578403, -122.574953],
  [45.578346, -122.575111],
  [45.578275, -122.575343],
  [45.578019, -122.576309],
  [45.577964, -122.576478],
  [45.577875, -122.576695],
  [45.577824, -122.576915],
  [45.57774, -122.577055],
  [45.577651, -122.577182],
  [45.577548, -122.577304],
  [45.577458, -122.577395],
  [45.577411, -122.577435],
  [45.577329, -122.577502],
  [45.577193, -122.577593],
  [45.57718, -122.577601],
  [45.577055, -122.577668],
  [45.576945, -122.577716],
  [45.57682, -122.577752],
  [45.576681, -122.577777],
  [45.576548, -122.577787],
  [45.576091, -122.577786],
  [45.575946, -122.577777],
  [45.575946, -122.577622],
  [45.575947, -122.577209],
  [45.575946, -122.576989],
  [45.575938, -122.576838],
  [45.575923, -122.576705],
  [45.575903, -122.576565],
  [45.575874, -122.576415],
  [45.575833, -122.57625],
  [45.575779, -122.576093],
  [45.575712, -122.575926],
  [45.575572, -122.575649],
  [45.575485, -122.575512],
  [45.575376, -122.575358],
  [45.575293, -122.575262],
  [45.575199, -122.575164],
  [45.575103, -122.575081],
  [45.57501, -122.575011],
  [45.574908, -122.574946],
  [45.574801, -122.57489],
  [45.574706, -122.574847],
  [45.574596, -122.574812],
  [45.574569, -122.574629],
  [45.574603, -122.57441],
  [45.574657, -122.57417],
  [45.574733, -122.573911],
  [45.5748, -122.573707],
  [45.574872, -122.573523],
  [45.574945, -122.573347],
  [45.575043, -122.573144],
  [45.575131, -122.572982],
  [45.575295, -122.572719],
  [45.575429, -122.572545],
  [45.575514, -122.572438],
  [45.575612, -122.572328],
  [45.575707, -122.572232],
  [45.575845, -122.572101],
  [45.576045, -122.571927],
  [45.576251, -122.571744],
  [45.576399, -122.571608],
  [45.57655, -122.571459],
  [45.576677, -122.571309],
  [45.576771, -122.57118],
  [45.576848, -122.571055],
  [45.576939, -122.570886],
  [45.577019, -122.570714],
  [45.57708, -122.570553],
  [45.577103, -122.570488],
  [45.577137, -122.570366],
  [45.577179, -122.570207],
  [45.577223, -122.569992],
  [45.577253, -122.56981],
  [45.577269, -122.569619],
  [45.577277, -122.56936],
  [45.577269, -122.569129],
  [45.57725, -122.56891],
  [45.57722, -122.568707],
  [45.577172, -122.568464],
  [45.57711, -122.568253],
  [45.577044, -122.568066],
  [45.577013, -122.567988],
  [45.57694, -122.567833],
  [45.576868, -122.567695],
  [45.576682, -122.567402],
  [45.576647, -122.567351],
  [45.5765, -122.567136],
  [45.57648, -122.567107],
  [45.576405, -122.566987],
  [45.576361, -122.566918],
  [45.576293, -122.566819],
  [45.576247, -122.56677],
  [45.576163, -122.566704],
  [45.576086, -122.566663],
  [45.575984, -122.566628],
  [45.575919, -122.566598],
  [45.57584, -122.566542],
  [45.575773, -122.566474],
  [45.575728, -122.566398],
  [45.575665, -122.566267],
  [45.575598, -122.566106],
  [45.575412, -122.565629],
  [45.575099, -122.56483],
  [45.575009, -122.564608],
  [45.574837, -122.564195],
  [45.574688, -122.563819],
  [45.574608, -122.563645],
  [45.574548, -122.563513],
  [45.574486, -122.563325],
  [45.574423, -122.563138],
  [45.574268, -122.562691],
  [45.574092, -122.562242],
  [45.574021, -122.562052],
  [45.573685, -122.561153],
  [45.573353, -122.560259],
  [45.573311, -122.560146],
  [45.573263, -122.560023],
  [45.573037, -122.559448],
  [45.572897, -122.5593],
  [45.572801, -122.559058],
  [45.572664, -122.558723],
  [45.572644, -122.558687],
  [45.572613, -122.558651],
  [45.572566, -122.558608],
  [45.572484, -122.558573],
  [45.572431, -122.55855],
  [45.572293, -122.558495],
  [45.572218, -122.558464],
  [45.572127, -122.558423],
  [45.572047, -122.558399],
  [45.57197, -122.558386],
  [45.571915, -122.558391],
  [45.571876, -122.558399],
  [45.57182, -122.558415],
  [45.571753, -122.558448],
  [45.571661, -122.558519],
  [45.571595, -122.558529],
  [45.570625, -122.559297],
  [45.569589, -122.560117],
  [45.569495, -122.560186],
  [45.569396, -122.560253],
  [45.569301, -122.560309],
  [45.569198, -122.560367],
  [45.569075, -122.560422],
  [45.569014, -122.560192],
  [45.56898, -122.560078],
  [45.568893, -122.559792],
  [45.56879, -122.55948],
  [45.568686, -122.559194],
  [45.568584, -122.55894],
  [45.568475, -122.558678],
  [45.568368, -122.558442],
  [45.568245, -122.55819],
  [45.568036, -122.557794],
  [45.56784, -122.557464],
  [45.567661, -122.557181],
  [45.56747, -122.556887],
  [45.567269, -122.556587],
  [45.567217, -122.55649],
  [45.567154, -122.55636],
  [45.56712, -122.556274],
  [45.567086, -122.556174],
  [45.567053, -122.556055],
  [45.567023, -122.555913],
  [45.566998, -122.555762],
  [45.566987, -122.555661],
  [45.566976, -122.555508],
  [45.566967, -122.555261],
  [45.566945, -122.554124],
  [45.566936, -122.554063],
  [45.566918, -122.553973],
  [45.566793, -122.554131],
  [45.566593, -122.554378],
  [45.566485, -122.554507],
  [45.566426, -122.554566],
  [45.566361, -122.554621],
  [45.566303, -122.554663],
  [45.566243, -122.55469],
  [45.56617, -122.554709],
  [45.566089, -122.554717],
  [45.565969, -122.554721],
  [45.56531, -122.554716],
  [45.564516, -122.554721],
  [45.564275, -122.554722],
  [45.564224, -122.554722],
  [45.563929, -122.554724],
  [45.563005, -122.554728],
  [45.56238, -122.55473],
  [45.562226, -122.55473],
  [45.562082, -122.55473],
  [45.561573, -122.55473],
  [45.560229, -122.554723],
  [45.55991, -122.554727],
  [45.559705, -122.554733],
  [45.558983, -122.554738],
  [45.558875, -122.55473],
  [45.558886, -122.554869],
  [45.558923, -122.555269],
  [45.558968, -122.555757],
  [45.559005, -122.556196],
  [45.559025, -122.556467],
  [45.559044, -122.55677],
  [45.559064, -122.557024],
  [45.559083, -122.557263],
  [45.55911, -122.55763],
  [45.559121, -122.557775],
  [45.559132, -122.557898],
  [45.559169, -122.558301],
  [45.559209, -122.558783],
  [45.559299, -122.5598],
  [45.559347, -122.560357],
  [45.559359, -122.560549],
  [45.559369, -122.560659],
  [45.559382, -122.560756],
  [45.559419, -122.560857],
  [45.55946, -122.560949],
  [45.5595, -122.561012],
  [45.559663, -122.561278],
  [45.559762, -122.561425],
  [45.559628, -122.561532],
  [45.55941, -122.56172],
  [45.55925, -122.56185],
  [45.559164, -122.561927],
  [45.559106, -122.562003],
  [45.559074, -122.56206],
  [45.559031, -122.562168],
  [45.558991, -122.562272],
  [45.558759, -122.562877],
  [45.558665, -122.563133],
  [45.558484, -122.563648],
  [45.558411, -122.563841],
  [45.558367, -122.563954],
  [45.558332, -122.564046],
  [45.558138, -122.564539],
  [45.557894, -122.565169],
  [45.557994, -122.56523],
  [45.558039, -122.565242],
  [45.55807, -122.565245],
  [45.558158, -122.565241],
  [45.558233, -122.565225],
  [45.558312, -122.565188],
  [45.55842, -122.565084],
  [45.558637, -122.564812],
  [45.558797, -122.564613],
  [45.558801, -122.564607],
  [45.558847, -122.56455],
  [45.558884, -122.56449],
  [45.558895, -122.564443],
  [45.558888, -122.564384],
  [45.558862, -122.564329],
  [45.558747, -122.564229],
  [45.558582, -122.564109],
  [45.558367, -122.563954],
  [45.558411, -122.563841],
  [45.558484, -122.563648],
  [45.558665, -122.563133],
  [45.558759, -122.562877],
  [45.558991, -122.562272],
  [45.559031, -122.562168],
  [45.559074, -122.56206],
  [45.559091, -122.561903],
  [45.559246, -122.561484],
  [45.559293, -122.561362],
  [45.559323, -122.561244],
  [45.559347, -122.561093],
  [45.559382, -122.560756],
  [45.559369, -122.560659],
  [45.559359, -122.560549],
  [45.559347, -122.560357],
  [45.559299, -122.5598],
  [45.559209, -122.558783],
  [45.559169, -122.558301],
  [45.559132, -122.557898],
  [45.559121, -122.557775],
  [45.559017, -122.557776],
  [45.558914, -122.557776],
  [45.55735, -122.557775],
  [45.557197, -122.557775],
  [45.555968, -122.557775],
  [45.555389, -122.557775],
  [45.555318, -122.557775],
  [45.554893, -122.557778],
  [45.554798, -122.557779],
  [45.554496, -122.557782],
  [45.554074, -122.557784],
  [45.553581, -122.557788],
  [45.552786, -122.557793],
  [45.551992, -122.557799],
  [45.551778, -122.5578],
  [45.551199, -122.557806],
  [45.550803, -122.55781],
  [45.550399, -122.557812],
  [45.549956, -122.557816],
  [45.549602, -122.557818],
  [45.549318, -122.557816],
  [45.549064, -122.557809],
  [45.548668, -122.557783],
  [45.548523, -122.557777],
  [45.548491, -122.557776],
  [45.54818, -122.557775],
  [45.548106, -122.557775],
  [45.547966, -122.55778],
  [45.54767, -122.557785],
  [45.545945, -122.557816],
  [45.544909, -122.557834],
  [45.544145, -122.55784],
  [45.543576, -122.55785],
  [45.542857, -122.557862],
  [45.542676, -122.557868],
  [45.542398, -122.557889],
  [45.542206, -122.557905],
  [45.541996, -122.557923],
  [45.54189, -122.557931],
  [45.541679, -122.557941],
  [45.541384, -122.557948],
  [45.541081, -122.557952],
  [45.540701, -122.557958],
  [45.540254, -122.557964],
  [45.539663, -122.557974],
  [45.539476, -122.557977],
  [45.538933, -122.557985],
  [45.538566, -122.557989],
  [45.538325, -122.557993],
  [45.538068, -122.557997],
  [45.537838, -122.558001],
  [45.537808, -122.558001],
  [45.537695, -122.558002],
  [45.537615, -122.558003],
  [45.536848, -122.558015],
  [45.536297, -122.558023],
  [45.53546, -122.558036],
  [45.535261, -122.558039],
  [45.534403, -122.558056],
  [45.534206, -122.558058],
  [45.534131, -122.55806],
  [45.533903, -122.558063],
  [45.533629, -122.558066],
  [45.533538, -122.558063],
  [45.533186, -122.558066],
  [45.53309, -122.558067],
  [45.533005, -122.558068],
  [45.532947, -122.558069],
  [45.532791, -122.558072],
  [45.532051, -122.558083],
  [45.531766, -122.558086],
  [45.531357, -122.55809],
  [45.531275, -122.558091],
  [45.530888, -122.558096],
  [45.530683, -122.558098],
  [45.530643, -122.558099],
  [45.529991, -122.55811],
  [45.529903, -122.558111],
  [45.529486, -122.558114],
  [45.529487, -122.558267],
  [45.529484, -122.559244],
  [45.529483, -122.560035],
  [45.529481, -122.561113],
  [45.529488, -122.561828],
  [45.529477, -122.561942],
  [45.52947, -122.562054],
  [45.529468, -122.562594],
  [45.529467, -122.562813],
  [45.529466, -122.563],
  [45.529533, -122.563066],
  [45.529537, -122.563312],
  [45.529537, -122.563337],
  [45.529538, -122.563394],
  [45.529547, -122.563465],
  [45.529549, -122.563479],
  [45.529567, -122.563548],
  [45.529588, -122.563598],
  [45.529653, -122.563654],
  [45.529748, -122.56368],
  [45.529938, -122.563661],
  [45.530105, -122.56369],
  [45.530678, -122.563903],
  [45.531008, -122.564005],
  [45.531055, -122.564003],
  [45.531106, -122.563969],
  [45.531154, -122.563897],
  [45.531162, -122.563873],
  [45.531172, -122.563846],
  [45.531186, -122.563794],
  [45.531199, -122.563739],
  [45.531234, -122.563555],
  [45.531163, -122.563535],
  [45.531062, -122.563504],
  [45.530303, -122.563198],
  [45.530197, -122.563158],
  [45.529906, -122.563116],
  [45.529894, -122.563118],
  [45.529758, -122.563141],
  [45.529692, -122.563131],
  [45.529684, -122.56313],
  [45.529636, -122.56312],
  [45.529533, -122.563066],
  [45.529466, -122.563],
  [45.529468, -122.562594],
  [45.52947, -122.562054],
  [45.529477, -122.561942],
  [45.528923, -122.561944],
  [45.528501, -122.561948],
  [45.528369, -122.56195],
  [45.528199, -122.561952],
  [45.52772, -122.561958],
  [45.527497, -122.561961],
  [45.52641, -122.561985],
  [45.526284, -122.561981],
  [45.526286, -122.562097],
  [45.526288, -122.562907],
  [45.526296, -122.563531],
  [45.526304, -122.56391],
  [45.526311, -122.564199],
  [45.526315, -122.564316],
  [45.526318, -122.564463],
  [45.526319, -122.56462],
  [45.526329, -122.56585],
  [45.526327, -122.566043],
  [45.526332, -122.566568],
  [45.526334, -122.566786],
  [45.526335, -122.566924],
  [45.52634, -122.567445],
  [45.526342, -122.567708],
  [45.526347, -122.568346],
  [45.52635, -122.568652],
  [45.526354, -122.569331],
  [45.526358, -122.56992],
  [45.526361, -122.570308],
  [45.526367, -122.571264],
  [45.526377, -122.572877],
  [45.526381, -122.573624],
  [45.526384, -122.573889],
  [45.526393, -122.574993],
  [45.526396, -122.575291],
  [45.526401, -122.575976],
  [45.526401, -122.57601],
  [45.526404, -122.576486],
  [45.526405, -122.57662],
  [45.526408, -122.577031],
  [45.526415, -122.578042],
  [45.526418, -122.578445],
  [45.526419, -122.578521],
  [45.526421, -122.578928],
  [45.52642, -122.579056],
  [45.526515, -122.579058],
  [45.526716, -122.579056],
  [45.526742, -122.579056],
  [45.526968, -122.579053],
  [45.527999, -122.579055],
  [45.528385, -122.579052],
  [45.529475, -122.579045],
  [45.530187, -122.579044],
  [45.530957, -122.579039],
  [45.5316, -122.579041],
  [45.531713, -122.579041],
  [45.531779, -122.579041],
  [45.532143, -122.579032],
  [45.532343, -122.579032],
  [45.532414, -122.579034],
  [45.532501, -122.579036],
  [45.532764, -122.579036],
  [45.532846, -122.579036],
  [45.532963, -122.579036],
  [45.533025, -122.578964],
  [45.533171, -122.578964],
  [45.533614, -122.578962],
  [45.53382, -122.578962],
  [45.533972, -122.579039],
  [45.533966, -122.578853],
  [45.533964, -122.578775],
  [45.533963, -122.578736],
  [45.533956, -122.578654],
  [45.533949, -122.578609],
  [45.533927, -122.578538],
  [45.533809, -122.578232],
  [45.533717, -122.577994],
  [45.53365, -122.577803],
  [45.533612, -122.577683],
  [45.533607, -122.57766],
  [45.533592, -122.577599],
  [45.533577, -122.577519],
  [45.533566, -122.577393],
  [45.533563, -122.577328],
  [45.533561, -122.577268],
  [45.533552, -122.576687],
  [45.533553, -122.576617],
  [45.533564, -122.576564],
  [45.533576, -122.576517],
  [45.533595, -122.576471],
  [45.533613, -122.576438],
  [45.533638, -122.576403],
  [45.533668, -122.576376],
  [45.533741, -122.576316],
  [45.533914, -122.576501],
  [45.534032, -122.576697],
  [45.534106, -122.576831],
  [45.534162, -122.576936],
  [45.534218, -122.577054],
  [45.534283, -122.577197],
  [45.534335, -122.577314],
  [45.534428, -122.577548],
  [45.534476, -122.57769],
  [45.534502, -122.577786],
  [45.534526, -122.577887],
  [45.534545, -122.578007],
  [45.534558, -122.578106],
  [45.534569, -122.578234],
  [45.534574, -122.578335],
  [45.534575, -122.578417],
  [45.534575, -122.578518],
  [45.534568, -122.578678],
  [45.5345, -122.578867],
  [45.53449, -122.578928],
  [45.534475, -122.579001],
  [45.534453, -122.579086],
  [45.534429, -122.579171],
  [45.534379, -122.579316],
  [45.534346, -122.579399],
  [45.534314, -122.579474],
  [45.534272, -122.579569],
  [45.53421, -122.579694],
  [45.534023, -122.580071],
  [45.533775, -122.580562],
  [45.533704, -122.580705],
  [45.533674, -122.580775],
  [45.533648, -122.580843],
  [45.533635, -122.580885],
  [45.533625, -122.58093],
  [45.533617, -122.58098],
  [45.533612, -122.581028],
  [45.533608, -122.581103],
  [45.533607, -122.581159],
  [45.533607, -122.581708],
  [45.533606, -122.58196],
  [45.533606, -122.582035],
  [45.533604, -122.582941],
  [45.533604, -122.583165],
  [45.533602, -122.583912],
  [45.533601, -122.584182],
  [45.5336, -122.584829],
  [45.533599, -122.585194],
  [45.533598, -122.585802],
  [45.533598, -122.586207],
  [45.533596, -122.586785],
  [45.533595, -122.58722],
  [45.533594, -122.587751],
  [45.533593, -122.588239],
  [45.533594, -122.588734],
  [45.533596, -122.58938],
  [45.533597, -122.589826],
  [45.5336, -122.590095],
  [45.533609, -122.590392],
  [45.533623, -122.590841],
  [45.533634, -122.591729],
  [45.533637, -122.59236],
  [45.533637, -122.592574],
  [45.533643, -122.593877],
  [45.533645, -122.594334],
  [45.533647, -122.594756],
  [45.533661, -122.595965],
  [45.533669, -122.596606],
  [45.533671, -122.596749],
  [45.533682, -122.59768],
  [45.53369, -122.598621],
  [45.533693, -122.598931],
  [45.533697, -122.599558],
  [45.533701, -122.60022],
  [45.533704, -122.600604],
  [45.533706, -122.601197],
  [45.533707, -122.601621],
  [45.533706, -122.602022],
  [45.533707, -122.602163],
  [45.533633, -122.602165],
  [45.533617, -122.602165],
  [45.533011, -122.602173],
  [45.532284, -122.602184],
  [45.531637, -122.602193],
  [45.531001, -122.602207],
  [45.530319, -122.602214],
  [45.529559, -122.602224],
  [45.52895, -122.602239],
  [45.528642, -122.602246],
  [45.528603, -122.602248],
  [45.528312, -122.602257],
  [45.528217, -122.602259],
  [45.527957, -122.602265],
  [45.527219, -122.602274],
  [45.526952, -122.602262],
  [45.526582, -122.602264],
  [45.526481, -122.602265],
  [45.526486, -122.603834],
  [45.52659, -122.603835],
  [45.526932, -122.603834],
  [45.527018, -122.603841],
  [45.527111, -122.603861],
  [45.527198, -122.60391],
  [45.527265, -122.603973],
  [45.527327, -122.60406],
  [45.527387, -122.604173],
  [45.527603, -122.604638],
  [45.527648, -122.604747],
  [45.527709, -122.604929],
  [45.527747, -122.605053],
  [45.527761, -122.605156],
  [45.527761, -122.605258],
  [45.527749, -122.605356],
  [45.527672, -122.605792],
  [45.527617, -122.606148],
  [45.527572, -122.606493],
  [45.527537, -122.606835],
  [45.527523, -122.606983],
  [45.527512, -122.607132],
  [45.527495, -122.607375],
  [45.527485, -122.607585],
  [45.52748, -122.607794],
  [45.527475, -122.607968],
  [45.527422, -122.608276],
  [45.527427, -122.608347],
  [45.527458, -122.608669],
  [45.527494, -122.608986],
  [45.527538, -122.609271],
  [45.527592, -122.609575],
  [45.527657, -122.609873],
  [45.527733, -122.610172],
  [45.527817, -122.61046],
  [45.527911, -122.610736],
  [45.528017, -122.611016],
  [45.528128, -122.61128],
  [45.528254, -122.611543],
  [45.528385, -122.611793],
  [45.528519, -122.612034],
  [45.528664, -122.612277],
  [45.528805, -122.612507],
  [45.530274, -122.614778],
  [45.53077, -122.61531],
  [45.530954, -122.615578],
  [45.531212, -122.615995],
  [45.531471, -122.616434],
  [45.531684, -122.616849],
  [45.531778, -122.617053],
  [45.532169, -122.617977],
  [45.532419, -122.618553],
  [45.53254, -122.61875],
  [45.532699, -122.618944],
  [45.532817, -122.619023],
  [45.532912, -122.619066],
  [45.533036, -122.619096],
  [45.533101, -122.619101],
  [45.53347, -122.619098],
  [45.533703, -122.619098],
  [45.53379, -122.619096],
  [45.53379, -122.619171],
  [45.533792, -122.619553],
  [45.533793, -122.619652],
  [45.533794, -122.619781],
  [45.533799, -122.620308],
  [45.533798, -122.62045],
  [45.533797, -122.620699],
  [45.533796, -122.620943],
  [45.533795, -122.621029],
  [45.533795, -122.621142],
  [45.533795, -122.621292],
  [45.533793, -122.621732],
  [45.533798, -122.621887],
  [45.5338, -122.621934],
  [45.533806, -122.622061],
  [45.533821, -122.622306],
  [45.533833, -122.622454],
  [45.533836, -122.622487],
  [45.533844, -122.622754],
  [45.533809, -122.62295],
  [45.533886, -122.622901],
  [45.533931, -122.622885],
  [45.534309, -122.622884],
  [45.534367, -122.622884],
  [45.534768, -122.622883],
  [45.534866, -122.622899],
  [45.534709, -122.623296],
  [45.534486, -122.623813],
  [45.534445, -122.623913],
  [45.534405, -122.624009],
  [45.534315, -122.624216],
  [45.534245, -122.624373],
  [45.534178, -122.624537],
  [45.534052, -122.624854],
  [45.534044, -122.624969],
  [45.534033, -122.625149],
  [45.533988, -122.62527],
  [45.533962, -122.625359],
  [45.533952, -122.625432],
  [45.533948, -122.625495],
  [45.53395, -122.62556],
  [45.533954, -122.625627],
  [45.533965, -122.625695],
  [45.53399, -122.625857],
  [45.534302, -122.627244],
  [45.534357, -122.627509],
  [45.534406, -122.627765],
  [45.534448, -122.628024],
  [45.534475, -122.628255],
  [45.534497, -122.628497],
  [45.534508, -122.628709],
  [45.534512, -122.628901],
  [45.534509, -122.629096],
  [45.534498, -122.629258],
  [45.534485, -122.629436],
  [45.534467, -122.629583],
  [45.534438, -122.629765],
  [45.5344, -122.629962],
  [45.53435, -122.630168],
  [45.534301, -122.630376],
  [45.534247, -122.630547],
  [45.534192, -122.630703],
  [45.53412, -122.630862],
  [45.534062, -122.630986],
  [45.533959, -122.631178],
  [45.533843, -122.631359],
  [45.533726, -122.631521],
  [45.533602, -122.631672],
  [45.53348, -122.631835],
  [45.533354, -122.631987],
  [45.533222, -122.632135],
  [45.533089, -122.632273],
  [45.532949, -122.632413],
  [45.532809, -122.632541],
  [45.532672, -122.632659],
  [45.532249, -122.633018],
  [45.532104, -122.633143],
  [45.531963, -122.633265],
  [45.531826, -122.63339],
  [45.531686, -122.633525],
  [45.531559, -122.633655],
  [45.531429, -122.633805],
  [45.531306, -122.633959],
  [45.531188, -122.634126],
  [45.531083, -122.6343],
  [45.530981, -122.634479],
  [45.530884, -122.634674],
  [45.530805, -122.634861],
  [45.530729, -122.635074],
  [45.530664, -122.635287],
  [45.530604, -122.635508],
  [45.530556, -122.635732],
  [45.530515, -122.635961],
  [45.530483, -122.636188],
  [45.530457, -122.636427],
  [45.530438, -122.63667],
  [45.530422, -122.6369],
  [45.53041, -122.637133],
  [45.530353, -122.638209],
  [45.529983, -122.646034],
  [45.529986, -122.646901],
  [45.529985, -122.647138],
  [45.529978, -122.647376],
  [45.529967, -122.647598],
  [45.529919, -122.648173],
  [45.529898, -122.648413],
  [45.529873, -122.648665],
  [45.529846, -122.64891],
  [45.529826, -122.649139],
  [45.529816, -122.649304],
  [45.529812, -122.649456],
  [45.529814, -122.64959],
  [45.529821, -122.649707],
  [45.52984, -122.649886],
  [45.529861, -122.650059],
  [45.529953, -122.650688],
  [45.529969, -122.650838],
  [45.529979, -122.650972],
  [45.529988, -122.651256],
  [45.529978, -122.651413],
  [45.529963, -122.651547],
  [45.529936, -122.651703],
  [45.529918, -122.651783],
  [45.529905, -122.651843],
  [45.529825, -122.652172],
  [45.529729, -122.652384],
  [45.529615, -122.652595],
  [45.529577, -122.652812],
  [45.529471, -122.653166],
  [45.529409, -122.653354],
  [45.529351, -122.65353],
  [45.529238, -122.653617],
  [45.529104, -122.654163],
  [45.52906, -122.654334],
  [45.529147, -122.654388],
  [45.529237, -122.654443],
  [45.529301, -122.654482],
  [45.529409, -122.654557],
  [45.529446, -122.654574],
  [45.529491, -122.654585],
  [45.529522, -122.654586],
  [45.529894, -122.654585],
  [45.529938, -122.654585],
  [45.529999, -122.654583],
  [45.530051, -122.654581],
  [45.530104, -122.65458],
  [45.530119, -122.654579],
  [45.530178, -122.654578],
  [45.530202, -122.654577],
  [45.530574, -122.654588],
  [45.53065, -122.654591],
  [45.530817, -122.654589],
  [45.531391, -122.654592],
  [45.531487, -122.654597],
  [45.531486, -122.6547],
  [45.531492, -122.65648],
  [45.531493, -122.656597],
  [45.531495, -122.656729],
  [45.531495, -122.657075],
  [45.531497, -122.657721],
  [45.5315, -122.658493],
  [45.531501, -122.658609],
  [45.531501, -122.658652],
  [45.5315, -122.658734],
  [45.531504, -122.659645],
  [45.531503, -122.659709],
  [45.531507, -122.660597],
  [45.531507, -122.660659],
  [45.531509, -122.661551],
  [45.531511, -122.661673],
  [45.531512, -122.661812],
  [45.531509, -122.661879],
  [45.531502, -122.661972],
  [45.531485, -122.662062],
  [45.531483, -122.662072],
  [45.53147, -122.662125],
  [45.531445, -122.662198],
  [45.531416, -122.662269],
  [45.531343, -122.662413],
  [45.53129, -122.662513],
  [45.531106, -122.662873],
  [45.531049, -122.662985],
  [45.530966, -122.66314],
  [45.530916, -122.663245],
  [45.530893, -122.663299],
  [45.53087, -122.663358],
  [45.530844, -122.663438],
  [45.53082, -122.66354],
  [45.530807, -122.663625],
  [45.530794, -122.66372],
  [45.530785, -122.663828],
  [45.530784, -122.663947],
  [45.530789, -122.664629],
  [45.530791, -122.664722],
  [45.530797, -122.665528],
  [45.530796, -122.665669],
  [45.530794, -122.665782],
  [45.530704, -122.665831],
  [45.530627, -122.66584],
  [45.530504, -122.665878],
  [45.530408, -122.665911],
  [45.530305, -122.665948],
  [45.530258, -122.665977],
  [45.530221, -122.66602],
  [45.530185, -122.666084],
  [45.530056, -122.666313],
  [45.529979, -122.666427],
  [45.529978, -122.666429],
  [45.52988, -122.666547],
  [45.529824, -122.666612],
  [45.529802, -122.666637],
  [45.529769, -122.666672],
  [45.529651, -122.666796],
  [45.529605, -122.666842],
  [45.529561, -122.666885],
  [45.529524, -122.666918],
  [45.529487, -122.666937],
  [45.529445, -122.666948],
  [45.529383, -122.66696],
  [45.529304, -122.666981],
  [45.529093, -122.66705],
  [45.528988, -122.667116],
  [45.52887, -122.667158],
  [45.528774, -122.667212],
  [45.528694, -122.667259],
  [45.528584, -122.667346],
  [45.528514, -122.667415],
  [45.528435, -122.667506],
  [45.528354, -122.667624],
  [45.528269, -122.667779],
  [45.527772, -122.668873],
  [45.527588, -122.669277],
  [45.52745, -122.669581],
  [45.527077, -122.670373],
  [45.526965, -122.670603],
  [45.526904, -122.670724],
  [45.526867, -122.670807],
  [45.526859, -122.670828],
  [45.526845, -122.670881],
  [45.526834, -122.670939],
  [45.52683, -122.670996],
  [45.526828, -122.671101],
  [45.52688, -122.672382],
  [45.526879, -122.672503],
  [45.526872, -122.672738],
  [45.526863, -122.672975],
  [45.52686, -122.673192],
  [45.526844, -122.673331],
  [45.526834, -122.673421],
  [45.526817, -122.673573],
  [45.526809, -122.673643],
  [45.526755, -122.67409],
  [45.526714, -122.67443],
  [45.526679, -122.674539],
  [45.526674, -122.674659],
  [45.52667, -122.674755],
  [45.526661, -122.67494],
  [45.526646, -122.675469],
  [45.526645, -122.675527],
  [45.526585, -122.675524],
  [45.52599, -122.675512],
  [45.52593, -122.67551],
  [45.525224, -122.675481],
  [45.524508, -122.675451],
  [45.524455, -122.675457],
  [45.523886, -122.675436],
  [45.523856, -122.675435],
  [45.523796, -122.675434],
  [45.523744, -122.675433],
  [45.523208, -122.675414],
  [45.523141, -122.675403],
  [45.523025, -122.675386],
  [45.522962, -122.67538],
  [45.522922, -122.675383],
  [45.52288, -122.675394],
  [45.522703, -122.675478],
  [45.522612, -122.675527],
  [45.52258, -122.675542],
  [45.522549, -122.675556],
  [45.522184, -122.67573],
  [45.522128, -122.67575],
  [45.52206, -122.675774],
  [45.521541, -122.67606],
  [45.521534, -122.676064],
  [45.521457, -122.67611],
  [45.52137, -122.67616],
  [45.520857, -122.676429],
  [45.52079, -122.676466],
  [45.520181, -122.676796],
  [45.520125, -122.676825],
  [45.520048, -122.676865],
  [45.519566, -122.677133],
  [45.519507, -122.677166],
  [45.519457, -122.67719],
  [45.519358, -122.677239],
  [45.51891, -122.67748],
  [45.518833, -122.677521],
  [45.518798, -122.677543],
  [45.518814, -122.677603],
  [45.518834, -122.67767],
  [45.519082, -122.678589],
  [45.519096, -122.678641],
  [45.519236, -122.679162],
  [45.519303, -122.67941],
  [45.519357, -122.679615],
  [45.519602, -122.680517],
  [45.519623, -122.680592],
  [45.51975, -122.681065],
  [45.51977, -122.681138],
  [45.519987, -122.681956],
  [45.519997, -122.681993],
  [45.520015, -122.68206],
  [45.520028, -122.682107],
  [45.520054, -122.682199],
  [45.520065, -122.682245],
  [45.520273, -122.68301],
  [45.520303, -122.683129],
  [45.520328, -122.683232],
  [45.520573, -122.684152],
  [45.520602, -122.684259],
  [45.520838, -122.685153],
  [45.520877, -122.685299],
  [45.521085, -122.686087],
  [45.521115, -122.686206],
  [45.521144, -122.686305],
  [45.521352, -122.687103],
  [45.521371, -122.687176],
  [45.521457, -122.687506],
  [45.521537, -122.687814],
  [45.5216, -122.688056],
  [45.521626, -122.688136],
  [45.521665, -122.688284],
  [45.521877, -122.689075],
  [45.521893, -122.689147],
  [45.52192, -122.689244],
  [45.52213, -122.690035],
  [45.522163, -122.690155],
  [45.522095, -122.690252],
  [45.521882, -122.690367],
  [45.521789, -122.690418],
  [45.521579, -122.690559],
  [45.521445, -122.690635],
  [45.520913, -122.69092],
  [45.520851, -122.690954],
  [45.520791, -122.690992],
  [45.520694, -122.691057],
  [45.520655, -122.691086],
  [45.52061, -122.691127],
  [45.520574, -122.691174],
  [45.520563, -122.691187],
  [45.520395, -122.691314],
  [45.520142, -122.691525],
  [45.520047, -122.691601],
  [45.519949, -122.691679],
  [45.519853, -122.69175],
  [45.519716, -122.691848],
  [45.519435, -122.692023],
  [45.519381, -122.692054],
  [45.51869, -122.692443],
  [45.518466, -122.692577],
  [45.518295, -122.692669],
  [45.518147, -122.69275],
  [45.518115, -122.692767],
  [45.518078, -122.692796],
  [45.51802, -122.692826],
  [45.518027, -122.692852],
  [45.518005, -122.692886],
  [45.517983, -122.69293],
  [45.517954, -122.692989],
  [45.517939, -122.693016],
  [45.51792, -122.693046],
  [45.517898, -122.693084],
  [45.517854, -122.693112],
  [45.517821, -122.693126],
  [45.517784, -122.693135],
  [45.517743, -122.693134],
  [45.517698, -122.693119],
  [45.517655, -122.693088],
  [45.517622, -122.693052]
];

const stopNames = {
  "1114": "SW 18th &amp; Goose Hollow MAX Station",
  "2592": "Rose Quarter Transit Center",
  "6911": "SW 18th &amp; Morrison",
  "7625": "SW 5th &amp; Morrison",
  "7627": "SW 5th &amp; Oak St MAX Station",
  "7828": "NE 60th &amp; 60th Ave MAX Stn/I-84",
  "7999": "NE 82nd &amp; 82nd Ave MAX Stn/I-84",
  "8321": "NE Pacific St &amp; The Oregon Clinic",
  "8513": "NE 11th &amp; Holladay",
  "9303": "NW 5th &amp; Couch MAX Station",
  "9311": "NW Glisan &amp; 3rd",
  "10856": "Parkrose/ Sumner Transit Center",
  "10864": "Gateway Transit Center ",
  "10876": "NE Multnomah &amp; 9th",
  "11492": "NE Multnomah &amp; 3rd",
  "13207": "NE Cascades Pkwy &amp; Mt Hood MAX Stn",
  "13504": "Portland International Airport - Arrivals",
  "13535": "SW Morrison &amp; 10th",
  "14144": "NE Halsey &amp; 42nd (Hollywood)",
  "14543": "9900 Block NE Cascades Pkwy"
};

const stops = [
  { stop_id: "13504", name: "Portland International Airport - Arrivals", lat: 45.588021, lon: -122.593171, times: ["1:00 AM", "1:30 AM", "2:00 AM"] },
  { stop_id: "13207", name: "NE Cascades Pkwy &amp; Mt Hood MAX Stn", lat: 45.576623, lon: -122.567388, times: ["1:08 AM", "1:38 AM", "2:08 AM"] },
  { stop_id: "14543", name: "9900 Block NE Cascades Pkwy", lat: 45.573304, lon: -122.560294, times: ["1:10 AM", "1:40 AM", "2:10 AM"] },
  { stop_id: "10856", name: "Parkrose/ Sumner Transit Center", lat: 45.558736, lon: -122.564507, times: ["1:18 AM", "1:48 AM", "2:18 AM"] },
  { stop_id: "8321", name: "NE Pacific St &amp; The Oregon Clinic", lat: 45.529559, lon: -122.562812, times: ["1:28 AM", "1:58 AM", "2:28 AM"] },
  { stop_id: "10864", name: "Gateway Transit Center ", lat: 45.5299, lon: -122.563177, times: ["1:29 AM", "1:59 AM", "2:29 AM"] },
  { stop_id: "7999", name: "NE 82nd &amp; 82nd Ave MAX Stn/I-84", lat: 45.53361, lon: -122.578852, times: ["1:34 AM", "2:04 AM", "2:34 AM"] },
  { stop_id: "7828", name: "NE 60th &amp; 60th Ave MAX Stn/I-84", lat: 45.528606, lon: -122.602393, times: ["1:41 AM", "2:11 AM", "2:41 AM"] },
  { stop_id: "14144", name: "NE Halsey &amp; 42nd (Hollywood)", lat: 45.53387, lon: -122.620711, times: ["1:45 AM", "2:15 AM", "2:45 AM"] },
  { stop_id: "8513", name: "NE 11th &amp; Holladay", lat: 45.529894, lon: -122.65446, times: ["1:51 AM", "2:21 AM", "2:51 AM"] },
  { stop_id: "10876", name: "NE Multnomah &amp; 9th", lat: 45.531573, lon: -122.657075, times: ["1:52 AM", "2:22 AM", "2:52 AM"] },
  { stop_id: "11492", name: "NE Multnomah &amp; 3rd", lat: 45.531159, lon: -122.66293, times: ["1:55 AM", "2:25 AM", "2:55 AM"] },
  { stop_id: "2592", name: "Rose Quarter Transit Center", lat: 45.530005, lon: -122.666476, times: ["1:57 AM", "2:27 AM", "2:57 AM"] },
  { stop_id: "9311", name: "NW Glisan &amp; 3rd", lat: 45.526817, lon: -122.674106, times: ["2:00 AM", "2:30 AM", "3:00 AM"] },
  { stop_id: "9303", name: "NW 5th &amp; Couch MAX Station", lat: 45.523885, lon: -122.675498, times: ["2:01 AM", "2:31 AM", "3:01 AM"] },
  { stop_id: "7627", name: "SW 5th &amp; Oak St MAX Station", lat: 45.521573, lon: -122.676178, times: ["2:02 AM", "2:32 AM", "3:02 AM"] },
  { stop_id: "7625", name: "SW 5th &amp; Morrison", lat: 45.518932, lon: -122.677571, times: ["2:04 AM", "2:34 AM", "3:04 AM"] },
  { stop_id: "13535", name: "SW Morrison &amp; 10th", lat: 45.520026, lon: -122.681933, times: ["2:05 AM", "2:35 AM", "3:05 AM"] },
  { stop_id: "6911", name: "SW 18th &amp; Morrison", lat: 45.52188, lon: -122.690453, times: ["2:08 AM", "2:38 AM", "3:08 AM"] },
  { stop_id: "1114", name: "SW 18th &amp; Goose Hollow MAX Station", lat: 45.517577, lon: -122.693099, times: ["2:10 AM", "2:40 AM", "3:10 AM"] },
]

    // Draw route polyline
    const polylineOut = L.polyline(shapeOutbound, { color: 'blue', weight: 4, opacity: 0.7 }).addTo(map);
    map.fitBounds(polylineOut.getBounds());

    // 1. Get current time in PT
    const nowPT = new Date(new Date().toLocaleString('en-US', { timeZone: 'America/Los_Angeles' }));
    const datePT = nowPT.toDateString();

    // 2. Add stops with highlighted next time
    stops.forEach(stop => {
      const stamps = stop.times.map(t => new Date(`${datePT} ${t}`));
      const nextIdx = stamps.findIndex(ts => ts > nowPT);
      const timesHtml = stamps.slice(0, 8).map((ts, i) => {
        const lbl = ts.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
        return i === nextIdx ? `<strong>${lbl}</strong>` : lbl;
      }).join('<br>');

      L.circleMarker([stop.lat, stop.lon], {
        radius: 6,
        color: '#4dd0e1',
        fillColor: '#4dd0e1',
        fillOpacity: 0.9,
        weight: 1
      })
      .bindPopup(`<strong>${stop.name}</strong><br>${timesHtml || 'No scheduled times'}`)
      .addTo(map);
    });

    // Bus markers fetch
    let busMarkers = {};
    async function fetchAndDisplay() {
      const res = await fetch(`https://developer.trimet.org/ws/v2/vehicles?route=${routeNumber}&appID=${apiKey}&json=true`);
      const data = await res.json();
      const buses = (data.resultSet.vehicle || []).filter(v => v.routeNumber == routeNumber && v.direction == direction);

      Object.values(busMarkers).forEach(m => map.removeLayer(m));
      busMarkers = {};
      if (!buses.length) return;

      buses.forEach(bus => {
        if (!bus.latitude || !bus.longitude || !bus.blockID) return;
        const icon = L.divIcon({    
           className: '',
	   html: `
            <div style="text-align:center;">
              <div style="background:#0071CE;color:#fff;padding:2px 6px;border-radius:6px;font-weight:bold;">${bus.vehicleID}</div>
              <div style="width:0;height:0;border-left:5px solid transparent;border-right:5px solid transparent;border-top:10px solid #00bfff;margin:auto;"></div>
            </div>
          `,
          iconSize: [40, 30], iconAnchor: [20, 30]
        });
        const marker = L.marker([bus.latitude, bus.longitude], { icon }).addTo(map);
        busMarkers[bus.vehicleID] = marker;
      });
    }
    fetchAndDisplay();
    setInterval(fetchAndDisplay, 15000);
  </script>

  <footer class="site-footer">
    <a href="terms.html">Terms of Use</a> &nbsp;|&nbsp;
    <a href="contact.html">Contact Us</a> &nbsp;|&nbsp;
    <a href="report.html">Report a Problem</a> &nbsp;|&nbsp;
    <a href="privacy.html">Privacy Policy</a>
  </footer>

  <script>
    if (!localStorage.getItem('cookieConsent')) {
      document.write(`
        <div id="cookie-banner" style="position: fixed; bottom: 0; left: 0; right: 0; background: #333; color: #fff; padding: 1rem; z-index: 1000; font-size: 0.9rem; line-height: 1.4; text-align: center; box-sizing: border-box;">
          üì¢ We use cookies to improve functionality and analyze traffic.
          By using MetroFeed, you agree to our 
          <a href='privacy.html' style='color: #4dd0e1; text-decoration: underline;'>Privacy Policy</a>.<br>
          <button onclick='localStorage.setItem("cookieConsent", "true"); document.getElementById("cookie-banner").remove();' style='margin-top: 0.5rem; background: #4dd0e1; color: #000; border: none; padding: 0.5rem 1rem; border-radius: 5px; cursor: pointer; font-weight: bold;'>OK</button>
        </div>
      `);
    }
  </script>
</body>
</html>