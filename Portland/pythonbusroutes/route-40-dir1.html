<!DOCTYPE html>
<html lang="en">
<head>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-EL337T4JX4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-EL337T4JX4');
</script>

<meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Route 40 - To Swan Island | MetroFeed Portland</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', sans-serif;
      background-color: #0d0d0d;
      color: #cccccc;
      overflow-y: auto;
    }

    body {
      padding-top: 120px;
    }

    .ad-banner {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      background: #222;
      padding: 0;
      z-index: 1000;
      box-shadow: 0 2px 2px rgba(0,0,0,0.5);
      text-align: center;
    }

    .ad-banner img {
      width: 100%;
      max-width: 728px;
      max-height: 120px;
      display: block;
      margin: 0 auto;
    }
    .home-button {
      position: fixed;
      top: 120px;
      left: 10px;
      background-color: #4dd0e1;
      color: #0d0d0d;
      padding: 0.5rem 1rem;
      font-weight: bold;
      border-radius: 8px;
      text-decoration: none;
      z-index: 1001;
      box-shadow: 0 0 10px #4dd0e1;
    }

    .home-button:hover {
      background-color: #00bcd4;
      color: #ffffff;
    }

    header {
      background-color: #0d0d0d;
      border-top: 4px solid #4dd0e1;
      border-bottom: 3px solid #4dd0e1;
      padding: 1rem;
      text-align: center;
    }

    header img {
      max-height: 60px;
    }

    h1 {
      text-align: center;
      margin: 1rem 0;
      font-size: 2rem;
      color: #f0f0f0;
    }

    .content-box {
      border-radius: 12px;
      padding: 0;
      margin: 0;
      background-color: #1e1e1e;
    }

    #map {
      width: 100%;
      height: 85vh;
      border: none;
      margin: 0 auto;
      display: block;
      border-radius: 8px;
    }

    .button-bar {
      display: flex;
      justify-content: center;
      margin: 1rem 0;
    }

    .button-bar a, .back-button {
      background: #4dd0e1;
      color: #0d0d0d;
      padding: 0.6rem 1.2rem;
      text-decoration: none;
      border-radius: 8px;
      font-weight: bold;
      border: none;
      cursor: pointer;
      box-shadow: 0 0 10px #4dd0e1;
    }

    .back-button:hover {
      background-color: #35c0d6;
    }

    .site-footer {
      text-align: center;
      margin-top: 3rem;
      margin-bottom: 120px;
      font-size: 0.85rem;
      color: #aaa;
    }

    .site-footer a {
      color: #00BFFF;
      text-decoration: none;
    }

    .site-footer a:hover {
      text-decoration: underline;
    }

    @media (max-width: 600px) {
      .ad-banner {
        padding-top: 1rem;
        padding-bottom: 0rem;
      }
    }
  </style>
</head>

<body>
  <div class="ad-banner">
    <iframe src="https://metrofeedus.com/portland/Ads/route-40-dir1-ad.html" style="border:none; width:100%; max-width: 728px; height:90px;"></iframe>
  </div>

  <header>
    <img src="MetroFeedPortlandLogo.png" alt="MetroFeed Portland">
  </header>

  <div class="disclaimer" style="margin: 1rem auto 0.5rem; max-width: 600px; font-size: 0.8rem; color: #bbb; text-align: center; padding: 0.5rem 1rem; background-color: #111; border: 1px dashed #444; border-radius: 6px;">
    ⚠️ This is a Beta program, work in progress. Please REPORT bugs and pretend to be impressed.
  </div>
  <div class="disclaimer" style="margin: 0 auto 1rem; max-width: 600px; font-size: 0.75rem; color: #888; text-align: center; padding: 0.25rem 1rem;">
    This tool is not affiliated with or endorsed by TriMet. For official schedules and service alerts, visit <a href="https://trimet.org" style="color:#4dd0e1;">trimet.org</a>.
  </div>

  <div style="margin: 2rem 0; text-align: center;">
    <button class="back-button" onclick="history.back()">Back</button>
  </div>

  <h1>Route 40 - To Swan Island</h1>

  <div class="content-box">
    <div id="map"></div>
    <div style="text-align:right; font-size: 0.7rem; color: #777; margin-top: 0.5rem;">
      Data courtesy of TriMet.
    </div>
  </div>

  <script>
    if (document.referrer === "" && performance.navigation.type === 0) {
      window.location.href = "/index.html";
    }

    const apiKey = "2C4447D4A42083BCD84DE3B8E";
    const routeNumber = 40;
    const direction = parseInt(1);

    const map = L.map('map', {
      center: [45.6, -122.7],
      zoom: 12,
      minZoom: 12,
      maxZoom: 18,
      maxBounds: [[45.3, -123.1], [45.9, -122.3]],
      maxBoundsViscosity: 1.0
    });
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { maxZoom: 19 }).addTo(map);

    const shapeOutbound = [
  [45.462581, -122.638616],
  [45.462606, -122.63861],
  [45.462906, -122.638532],
  [45.463174, -122.638468],
  [45.463442, -122.638412],
  [45.463683, -122.638371],
  [45.463997, -122.638326],
  [45.46419, -122.638301],
  [45.464394, -122.638284],
  [45.464523, -122.638231],
  [45.464818, -122.638224],
  [45.464897, -122.638227],
  [45.465249, -122.638244],
  [45.465328, -122.638243],
  [45.465373, -122.638228],
  [45.465434, -122.638182],
  [45.46547, -122.638122],
  [45.465494, -122.638044],
  [45.465503, -122.637968],
  [45.4655, -122.637906],
  [45.465489, -122.637855],
  [45.465449, -122.637788],
  [45.465415, -122.637754],
  [45.465352, -122.63772],
  [45.465137, -122.637683],
  [45.465039, -122.637628],
  [45.46472, -122.637573],
  [45.464576, -122.637624],
  [45.464528, -122.63762],
  [45.464484, -122.637629],
  [45.464429, -122.63766],
  [45.464391, -122.637694],
  [45.464362, -122.637741],
  [45.464331, -122.637823],
  [45.464292, -122.638008],
  [45.46429, -122.638147],
  [45.464289, -122.638256],
  [45.464279, -122.638465],
  [45.464264, -122.638754],
  [45.464248, -122.638921],
  [45.464214, -122.63924],
  [45.464181, -122.639565],
  [45.464132, -122.639987],
  [45.464113, -122.640209],
  [45.464113, -122.640426],
  [45.464124, -122.640586],
  [45.464145, -122.640726],
  [45.464175, -122.640881],
  [45.464243, -122.641143],
  [45.464265, -122.64126],
  [45.464287, -122.641374],
  [45.464304, -122.641516],
  [45.464307, -122.641549],
  [45.46432, -122.641804],
  [45.464315, -122.642029],
  [45.464313, -122.64298],
  [45.464318, -122.645059],
  [45.464318, -122.645917],
  [45.464318, -122.646283],
  [45.464318, -122.646517],
  [45.464318, -122.646601],
  [45.464318, -122.646723],
  [45.464318, -122.646953],
  [45.464318, -122.64704],
  [45.464319, -122.64716],
  [45.464319, -122.647287],
  [45.464319, -122.647417],
  [45.464319, -122.64745],
  [45.464319, -122.64769],
  [45.464319, -122.647991],
  [45.464319, -122.649027],
  [45.464321, -122.650928],
  [45.464322, -122.651023],
  [45.464324, -122.651115],
  [45.464323, -122.6513],
  [45.464323, -122.651712],
  [45.464323, -122.652018],
  [45.464322, -122.652197],
  [45.464322, -122.652449],
  [45.464322, -122.65264],
  [45.464321, -122.653005],
  [45.464321, -122.653345],
  [45.464321, -122.6535],
  [45.464321, -122.653821],
  [45.46432, -122.653973],
  [45.46432, -122.654195],
  [45.46432, -122.654464],
  [45.46433, -122.654993],
  [45.464332, -122.656674],
  [45.464361, -122.656731],
  [45.464362, -122.656873],
  [45.464332, -122.656974],
  [45.464332, -122.657993],
  [45.464367, -122.658075],
  [45.464369, -122.658873],
  [45.464369, -122.658911],
  [45.464332, -122.659004],
  [45.46433, -122.660024],
  [45.464293, -122.66108],
  [45.464292, -122.661122],
  [45.46429, -122.661523],
  [45.464282, -122.668447],
  [45.464283, -122.668588],
  [45.46495, -122.668809],
  [45.465167, -122.668904],
  [45.465273, -122.668939],
  [45.465395, -122.66899],
  [45.465522, -122.669043],
  [45.465653, -122.66912],
  [45.466269, -122.669425],
  [45.466451, -122.669615],
  [45.466724, -122.669741],
  [45.467226, -122.67],
  [45.467377, -122.670085],
  [45.467518, -122.670175],
  [45.467606, -122.670238],
  [45.467841, -122.670459],
  [45.467951, -122.670568],
  [45.468136, -122.670778],
  [45.468325, -122.670976],
  [45.468422, -122.671067],
  [45.468486, -122.671071],
  [45.468618, -122.671163],
  [45.468744, -122.671238],
  [45.468841, -122.671288],
  [45.468925, -122.671322],
  [45.468974, -122.671342],
  [45.469038, -122.671362],
  [45.469272, -122.671413],
  [45.469674, -122.671471],
  [45.469754, -122.671547],
  [45.469807, -122.671553],
  [45.47026, -122.671613],
  [45.470352, -122.671625],
  [45.470634, -122.671659],
  [45.470796, -122.671674],
  [45.470976, -122.671684],
  [45.471294, -122.671666],
  [45.471354, -122.671567],
  [45.471657, -122.671524],
  [45.471741, -122.671513],
  [45.471949, -122.67147],
  [45.47218, -122.671433],
  [45.472432, -122.671412],
  [45.472562, -122.671406],
  [45.472613, -122.671408],
  [45.472709, -122.671411],
  [45.472873, -122.671424],
  [45.472995, -122.671433],
  [45.473364, -122.671476],
  [45.473696, -122.671515],
  [45.4741, -122.671558],
  [45.474394, -122.671589],
  [45.475137, -122.671664],
  [45.475203, -122.671671],
  [45.475518, -122.671704],
  [45.475822, -122.671738],
  [45.476218, -122.671791],
  [45.476549, -122.671857],
  [45.476708, -122.671891],
  [45.476755, -122.6719],
  [45.477011, -122.67198],
  [45.477114, -122.67201],
  [45.477178, -122.672029],
  [45.477252, -122.672058],
  [45.477772, -122.672222],
  [45.477972, -122.672284],
  [45.478102, -122.672327],
  [45.478376, -122.672416],
  [45.478684, -122.672516],
  [45.479274, -122.672702],
  [45.479607, -122.672805],
  [45.4799, -122.672905],
  [45.480219, -122.673011],
  [45.480553, -122.673139],
  [45.48058, -122.673149],
  [45.480896, -122.673258],
  [45.481046, -122.67331],
  [45.481116, -122.673334],
  [45.481187, -122.673357],
  [45.481914, -122.673588],
  [45.482186, -122.673682],
  [45.482219, -122.673694],
  [45.482402, -122.673763],
  [45.482485, -122.673799],
  [45.482742, -122.673911],
  [45.483083, -122.674076],
  [45.483209, -122.674141],
  [45.483545, -122.674322],
  [45.483768, -122.674432],
  [45.483835, -122.674467],
  [45.484526, -122.674831],
  [45.484849, -122.675001],
  [45.484907, -122.675031],
  [45.485034, -122.675094],
  [45.485329, -122.67522],
  [45.485542, -122.675296],
  [45.485745, -122.675359],
  [45.486147, -122.675459],
  [45.486196, -122.675467],
  [45.486339, -122.675491],
  [45.486464, -122.675509],
  [45.486757, -122.675527],
  [45.486989, -122.675521],
  [45.487113, -122.675507],
  [45.487186, -122.675495],
  [45.487365, -122.675456],
  [45.487541, -122.675399],
  [45.487682, -122.675346],
  [45.487841, -122.675265],
  [45.487999, -122.675184],
  [45.488078, -122.675132],
  [45.488156, -122.67508],
  [45.488215, -122.675034],
  [45.488387, -122.674898],
  [45.488411, -122.674879],
  [45.488707, -122.674608],
  [45.489021, -122.674318],
  [45.489316, -122.674068],
  [45.489572, -122.673883],
  [45.489853, -122.673702],
  [45.489907, -122.673667],
  [45.489967, -122.673625],
  [45.490263, -122.673454],
  [45.490536, -122.673325],
  [45.490956, -122.673156],
  [45.491243, -122.673039],
  [45.491398, -122.672982],
  [45.491554, -122.672942],
  [45.491622, -122.672927],
  [45.491705, -122.672912],
  [45.491844, -122.672899],
  [45.491973, -122.672901],
  [45.492173, -122.672905],
  [45.492484, -122.672923],
  [45.492799, -122.67294],
  [45.492948, -122.672973],
  [45.493101, -122.672947],
  [45.493209, -122.672951],
  [45.493471, -122.672954],
  [45.49364, -122.672955],
  [45.493771, -122.672953],
  [45.494044, -122.672941],
  [45.494305, -122.672937],
  [45.494706, -122.672933],
  [45.495027, -122.672914],
  [45.495336, -122.672896],
  [45.495692, -122.67288],
  [45.496382, -122.672866],
  [45.49648, -122.672864],
  [45.497872, -122.672839],
  [45.497974, -122.672842],
  [45.498157, -122.672881],
  [45.498873, -122.672843],
  [45.499096, -122.672807],
  [45.499188, -122.6728],
  [45.499215, -122.672797],
  [45.499404, -122.672778],
  [45.499529, -122.672756],
  [45.499678, -122.672722],
  [45.499882, -122.672672],
  [45.500224, -122.67258],
  [45.50034, -122.672547],
  [45.500406, -122.672535],
  [45.500492, -122.672526],
  [45.500609, -122.672525],
  [45.500714, -122.672546],
  [45.50079, -122.672568],
  [45.500874, -122.672603],
  [45.500951, -122.672644],
  [45.501014, -122.672683],
  [45.50108, -122.672728],
  [45.501158, -122.6728],
  [45.501244, -122.67289],
  [45.501345, -122.673021],
  [45.501399, -122.673112],
  [45.501458, -122.673225],
  [45.501523, -122.673372],
  [45.501612, -122.67364],
  [45.501656, -122.673751],
  [45.501849, -122.674538],
  [45.501864, -122.674611],
  [45.501934, -122.674832],
  [45.502036, -122.675087],
  [45.502084, -122.675182],
  [45.502181, -122.675344],
  [45.502217, -122.675408],
  [45.502234, -122.675442],
  [45.502257, -122.675499],
  [45.502296, -122.6756],
  [45.502482, -122.675846],
  [45.502803, -122.676272],
  [45.502921, -122.676445],
  [45.502975, -122.67652],
  [45.503052, -122.676622],
  [45.503426, -122.677138],
  [45.503452, -122.677174],
  [45.50346, -122.67722],
  [45.503483, -122.677258],
  [45.50352, -122.67739],
  [45.503559, -122.677448],
  [45.503588, -122.677498],
  [45.503615, -122.677549],
  [45.503641, -122.677609],
  [45.503656, -122.677652],
  [45.503671, -122.677705],
  [45.50368, -122.67776],
  [45.503694, -122.677891],
  [45.503737, -122.677998],
  [45.503757, -122.67829],
  [45.503767, -122.678457],
  [45.50377, -122.678505],
  [45.503775, -122.678623],
  [45.503998, -122.678635],
  [45.504297, -122.678642],
  [45.504522, -122.678647],
  [45.50469, -122.678642],
  [45.505055, -122.678632],
  [45.505275, -122.678628],
  [45.505868, -122.678617],
  [45.506003, -122.678617],
  [45.506512, -122.678605],
  [45.506549, -122.678605],
  [45.506688, -122.678602],
  [45.507015, -122.678597],
  [45.507197, -122.678594],
  [45.50748, -122.678594],
  [45.507708, -122.678594],
  [45.507919, -122.678593],
  [45.50796, -122.678593],
  [45.508002, -122.678592],
  [45.508046, -122.678589],
  [45.508306, -122.678576],
  [45.508457, -122.678554],
  [45.508546, -122.678533],
  [45.508623, -122.678506],
  [45.508705, -122.678478],
  [45.508782, -122.678445],
  [45.508824, -122.678428],
  [45.508929, -122.678378],
  [45.509475, -122.678118],
  [45.509562, -122.678089],
  [45.509679, -122.678061],
  [45.50976, -122.678091],
  [45.509778, -122.678085],
  [45.509835, -122.678063],
  [45.509856, -122.678055],
  [45.509935, -122.678357],
  [45.510013, -122.678652],
  [45.510061, -122.678834],
  [45.510094, -122.678955],
  [45.510342, -122.679871],
  [45.510468, -122.680368],
  [45.510487, -122.680453],
  [45.510541, -122.680617],
  [45.510548, -122.680732],
  [45.510543, -122.680835],
  [45.510543, -122.680883],
  [45.510544, -122.680922],
  [45.510549, -122.68096],
  [45.510561, -122.68101],
  [45.510729, -122.681642],
  [45.510773, -122.681808],
  [45.510797, -122.681893],
  [45.510804, -122.68192],
  [45.510877, -122.682196],
  [45.51088, -122.682207],
  [45.511005, -122.682675],
  [45.51106, -122.682884],
  [45.511078, -122.682953],
  [45.511684, -122.682625],
  [45.511759, -122.682585],
  [45.512378, -122.682249],
  [45.512415, -122.682229],
  [45.51293, -122.68195],
  [45.512963, -122.681932],
  [45.513078, -122.68187],
  [45.513111, -122.681852],
  [45.513413, -122.681689],
  [45.513748, -122.681507],
  [45.514291, -122.681213],
  [45.514298, -122.681209],
  [45.514415, -122.681146],
  [45.515072, -122.68079],
  [45.515744, -122.680426],
  [45.515808, -122.680391],
  [45.516359, -122.680124],
  [45.516423, -122.680091],
  [45.516492, -122.680049],
  [45.516963, -122.679796],
  [45.517036, -122.679756],
  [45.517087, -122.67973],
  [45.517171, -122.679685],
  [45.517691, -122.679401],
  [45.51775, -122.679367],
  [45.517829, -122.679321],
  [45.518361, -122.679025],
  [45.518406, -122.679004],
  [45.518432, -122.678987],
  [45.518466, -122.67897],
  [45.519024, -122.67868],
  [45.51907, -122.678655],
  [45.519096, -122.678641],
  [45.519151, -122.678611],
  [45.519656, -122.678345],
  [45.519751, -122.678297],
  [45.519811, -122.678266],
  [45.520283, -122.678006],
  [45.520361, -122.677963],
  [45.520421, -122.677932],
  [45.520477, -122.677904],
  [45.521016, -122.677604],
  [45.521084, -122.677569],
  [45.521685, -122.677242],
  [45.521751, -122.677205],
  [45.521828, -122.677162],
  [45.522399, -122.676848],
  [45.522446, -122.676775],
  [45.52291, -122.676527],
  [45.522939, -122.676511],
  [45.523003, -122.676486],
  [45.523068, -122.676468],
  [45.523122, -122.676459],
  [45.52319, -122.676451],
  [45.523722, -122.676473],
  [45.523777, -122.676474],
  [45.523839, -122.676474],
  [45.524491, -122.676497],
  [45.525135, -122.676527],
  [45.525203, -122.676534],
  [45.525206, -122.676508],
  [45.525222, -122.675623],
  [45.525224, -122.675507],
  [45.525224, -122.675481],
  [45.525242, -122.674483],
  [45.52526, -122.673462],
  [45.525261, -122.673355],
  [45.525275, -122.672598],
  [45.525275, -122.672572],
  [45.525276, -122.672471],
  [45.525277, -122.672349],
  [45.525287, -122.67187],
  [45.525294, -122.671672],
  [45.525301, -122.671576],
  [45.525314, -122.671457],
  [45.525324, -122.671403],
  [45.525343, -122.671324],
  [45.525365, -122.671238],
  [45.525392, -122.671156],
  [45.525407, -122.671111],
  [45.525427, -122.671063],
  [45.52545, -122.671014],
  [45.525482, -122.670958],
  [45.525515, -122.670909],
  [45.525554, -122.67086],
  [45.525582, -122.670829],
  [45.525619, -122.670794],
  [45.52566, -122.670759],
  [45.525729, -122.67071],
  [45.525774, -122.670689],
  [45.525825, -122.670674],
  [45.525884, -122.670662],
  [45.525945, -122.670655],
  [45.526016, -122.670656],
  [45.52607, -122.670663],
  [45.526291, -122.670722],
  [45.526372, -122.670752],
  [45.526407, -122.670758],
  [45.52645, -122.67076],
  [45.526493, -122.67076],
  [45.526536, -122.670756],
  [45.526604, -122.670734],
  [45.526638, -122.67072],
  [45.526671, -122.670702],
  [45.526716, -122.67067],
  [45.52675, -122.670644],
  [45.526785, -122.67061],
  [45.526829, -122.670557],
  [45.526873, -122.670494],
  [45.526904, -122.670434],
  [45.527335, -122.669479],
  [45.527667, -122.66877],
  [45.527963, -122.668126],
  [45.52806, -122.667916],
  [45.528164, -122.667724],
  [45.52834, -122.667407],
  [45.528488, -122.667091],
  [45.528534, -122.666987],
  [45.528559, -122.666926],
  [45.528585, -122.666845],
  [45.528614, -122.666741],
  [45.528627, -122.666676],
  [45.528639, -122.666585],
  [45.52865, -122.66648],
  [45.528657, -122.666372],
  [45.528661, -122.666257],
  [45.528662, -122.666015],
  [45.52866, -122.665857],
  [45.528661, -122.665755],
  [45.528741, -122.665758],
  [45.528992, -122.665759],
  [45.529088, -122.665767],
  [45.529148, -122.66578],
  [45.529192, -122.665794],
  [45.529239, -122.665819],
  [45.529314, -122.665836],
  [45.529388, -122.665864],
  [45.529436, -122.665896],
  [45.529474, -122.665956],
  [45.529722, -122.666465],
  [45.529752, -122.66653],
  [45.529774, -122.666575],
  [45.529782, -122.666594],
  [45.529802, -122.666637],
  [45.529814, -122.666665],
  [45.529851, -122.666749],
  [45.530029, -122.667165],
  [45.530085, -122.667067],
  [45.53015, -122.666966],
  [45.530193, -122.666889],
  [45.530238, -122.666773],
  [45.530257, -122.666726],
  [45.530266, -122.666704],
  [45.530304, -122.666632],
  [45.530337, -122.666578],
  [45.530361, -122.666551],
  [45.530388, -122.666531],
  [45.530427, -122.666502],
  [45.530525, -122.666448],
  [45.530571, -122.666414],
  [45.530609, -122.666373],
  [45.530662, -122.666303],
  [45.530698, -122.666237],
  [45.530745, -122.666199],
  [45.530771, -122.666114],
  [45.530781, -122.666069],
  [45.530787, -122.666016],
  [45.530792, -122.665913],
  [45.530794, -122.665782],
  [45.530704, -122.665831],
  [45.530627, -122.66584],
  [45.530504, -122.665878],
  [45.530408, -122.665911],
  [45.530305, -122.665948],
  [45.530258, -122.665977],
  [45.530221, -122.66602],
  [45.530185, -122.666084],
  [45.530056, -122.666313],
  [45.529979, -122.666427],
  [45.529978, -122.666429],
  [45.52988, -122.666547],
  [45.529824, -122.666612],
  [45.529802, -122.666637],
  [45.529814, -122.666665],
  [45.529851, -122.666749],
  [45.530029, -122.667165],
  [45.530098, -122.667316],
  [45.530193, -122.667537],
  [45.530472, -122.668179],
  [45.530551, -122.668381],
  [45.530606, -122.668523],
  [45.530673, -122.668677],
  [45.530738, -122.668819],
  [45.530859, -122.669078],
  [45.530962, -122.669265],
  [45.531071, -122.669453],
  [45.531126, -122.669555],
  [45.531227, -122.669731],
  [45.531442, -122.670028],
  [45.531609, -122.670234],
  [45.531775, -122.670436],
  [45.53183, -122.670498],
  [45.532098, -122.670798],
  [45.53222, -122.670929],
  [45.532324, -122.671039],
  [45.532508, -122.671252],
  [45.532783, -122.67157],
  [45.532993, -122.671785],
  [45.533347, -122.672119],
  [45.533845, -122.672546],
  [45.534334, -122.672964],
  [45.534608, -122.673182],
  [45.5357, -122.674007],
  [45.535938, -122.674167],
  [45.536138, -122.674295],
  [45.536197, -122.674327],
  [45.536265, -122.674359],
  [45.536366, -122.674395],
  [45.536449, -122.674421],
  [45.53657, -122.674452],
  [45.536692, -122.674469],
  [45.536797, -122.674476],
  [45.536919, -122.67448],
  [45.537189, -122.674487],
  [45.537659, -122.674487],
  [45.537791, -122.674481],
  [45.537933, -122.674477],
  [45.538114, -122.674479],
  [45.538429, -122.674483],
  [45.538522, -122.674483],
  [45.538771, -122.674491],
  [45.53886, -122.674512],
  [45.538953, -122.674553],
  [45.539037, -122.674607],
  [45.539116, -122.674669],
  [45.539182, -122.674734],
  [45.539231, -122.674789],
  [45.539287, -122.674861],
  [45.539338, -122.674936],
  [45.539404, -122.675057],
  [45.539518, -122.675268],
  [45.539802, -122.675795],
  [45.539868, -122.675917],
  [45.539931, -122.676045],
  [45.540074, -122.676368],
  [45.540184, -122.676583],
  [45.540255, -122.676715],
  [45.540296, -122.676784],
  [45.540334, -122.676841],
  [45.54037, -122.676887],
  [45.540413, -122.676932],
  [45.54045, -122.676968],
  [45.54049, -122.676999],
  [45.540562, -122.677044],
  [45.540632, -122.677075],
  [45.540682, -122.677089],
  [45.540748, -122.677103],
  [45.540827, -122.677108],
  [45.540931, -122.677111],
  [45.541009, -122.677122],
  [45.541078, -122.677132],
  [45.541926, -122.677134],
  [45.542428, -122.677132],
  [45.542832, -122.677123],
  [45.542997, -122.67712],
  [45.543117, -122.677109],
  [45.543233, -122.677099],
  [45.543405, -122.677097],
  [45.543503, -122.677098],
  [45.543644, -122.677109],
  [45.54387, -122.677138],
  [45.544067, -122.677161],
  [45.544151, -122.677177],
  [45.544253, -122.677202],
  [45.544372, -122.67724],
  [45.544473, -122.677279],
  [45.544537, -122.677316],
  [45.544619, -122.677383],
  [45.544685, -122.677445],
  [45.544738, -122.677512],
  [45.544784, -122.677601],
  [45.544826, -122.677695],
  [45.544866, -122.677793],
  [45.54493, -122.678005],
  [45.544966, -122.678178],
  [45.544979, -122.678275],
  [45.545127, -122.678855],
  [45.545832, -122.68152],
  [45.545886, -122.681692],
  [45.545923, -122.681797],
  [45.545966, -122.681901],
  [45.546015, -122.682012],
  [45.546178, -122.682298],
  [45.546319, -122.682499],
  [45.546464, -122.682694],
  [45.547111, -122.68357],
  [45.548578, -122.685557],
  [45.548918, -122.68602],
  [45.549892, -122.687334],
  [45.550218, -122.687777],
  [45.550837, -122.688616],
  [45.550981, -122.688806],
  [45.551129, -122.688985],
  [45.551975, -122.689907],
  [45.552825, -122.690834],
  [45.553052, -122.691073],
  [45.553161, -122.691177],
  [45.553287, -122.691289],
  [45.553436, -122.691408],
  [45.553553, -122.691496],
  [45.553712, -122.691604],
  [45.553849, -122.6917],
  [45.554089, -122.691824],
  [45.554306, -122.691946],
  [45.55444, -122.692017],
  [45.554592, -122.692099],
  [45.554733, -122.692165],
  [45.554845, -122.692211],
  [45.55497, -122.692257],
  [45.555062, -122.692288],
  [45.555225, -122.692363],
  [45.555336, -122.692414],
  [45.555537, -122.69253],
  [45.555571, -122.69255],
  [45.555778, -122.692679],
  [45.555988, -122.692666],
  [45.556066, -122.692712],
  [45.556095, -122.692724],
  [45.556123, -122.692727],
  [45.556166, -122.692706],
  [45.556194, -122.692676],
  [45.556256, -122.692567],
  [45.556255, -122.692439],
  [45.556253, -122.69186],
  [45.556242, -122.691288],
  [45.556242, -122.691193],
  [45.556252, -122.691101],
  [45.556268, -122.691009],
  [45.556289, -122.690933],
  [45.55632, -122.690841],
  [45.556408, -122.690653],
  [45.55643, -122.690588],
  [45.556437, -122.690535],
  [45.556439, -122.69048],
  [45.556436, -122.690428],
  [45.556424, -122.690367],
  [45.556408, -122.690328],
  [45.556392, -122.690301],
  [45.556365, -122.690264],
  [45.556333, -122.690237],
  [45.556297, -122.690214],
  [45.556256, -122.690237],
  [45.55623, -122.690236],
  [45.556204, -122.690237],
  [45.556177, -122.690243],
  [45.556154, -122.690252],
  [45.556129, -122.69027],
  [45.556091, -122.690333],
  [45.556081, -122.690401],
  [45.556075, -122.69066],
  [45.555988, -122.691228],
  [45.555987, -122.691431],
  [45.55599, -122.693647],
  [45.555993, -122.694901],
  [45.55599, -122.696271],
  [45.556002, -122.696854],
  [45.556009, -122.69698],
  [45.556023, -122.69727],
  [45.55604, -122.697529],
  [45.556059, -122.697752],
  [45.556083, -122.698004],
  [45.556108, -122.698241],
  [45.556129, -122.698433],
  [45.556158, -122.698684],
  [45.556183, -122.698898],
  [45.556253, -122.699406],
  [45.556312, -122.699797],
  [45.55639, -122.699903],
  [45.556429, -122.700114],
  [45.556458, -122.700265],
  [45.556488, -122.700386],
  [45.556522, -122.700508],
  [45.556578, -122.700674],
  [45.556624, -122.700798],
  [45.556687, -122.70094],
  [45.556745, -122.701059],
  [45.556764, -122.701098],
  [45.556795, -122.701159],
  [45.556891, -122.701372],
  [45.557036, -122.70164],
  [45.557076, -122.701712],
  [45.557431, -122.702353],
  [45.557519, -122.702512],
  [45.557595, -122.702649],
  [45.557809, -122.703038],
  [45.557894, -122.702927],
  [45.558045, -122.702761],
  [45.558697, -122.702052],
  [45.558863, -122.701874],
  [45.559038, -122.701684],
  [45.559348, -122.701344],
  [45.559401, -122.701291],
  [45.559448, -122.701235],
  [45.559481, -122.701214],
  [45.559515, -122.701198],
  [45.55956, -122.701189],
  [45.559613, -122.701197],
  [45.559744, -122.701258],
  [45.559822, -122.701379],
  [45.560283, -122.701835],
  [45.560654, -122.702203],
  [45.560744, -122.702297],
  [45.561048, -122.702609],
  [45.561265, -122.702829],
  [45.561305, -122.702872],
  [45.561329, -122.702902],
  [45.561357, -122.702941],
  [45.561516, -122.703225],
  [45.561834, -122.703811],
  [45.562074, -122.704252],
  [45.562249, -122.704574],
  [45.562276, -122.704625],
  [45.562474, -122.704973],
  [45.562591, -122.70519],
  [45.562653, -122.705291],
  [45.562701, -122.705356],
  [45.562748, -122.705405],
  [45.562799, -122.70545],
  [45.562858, -122.705493],
  [45.562919, -122.705525],
  [45.562971, -122.705545],
  [45.563033, -122.705559],
  [45.563095, -122.705565],
  [45.563882, -122.705574],
  [45.563945, -122.70558],
  [45.564002, -122.705595],
  [45.564074, -122.705624],
  [45.564147, -122.705662],
  [45.564203, -122.705703],
  [45.564258, -122.705757],
  [45.564319, -122.705835],
  [45.564376, -122.70593],
  [45.564794, -122.70669],
  [45.56497, -122.707012],
  [45.565189, -122.707416],
  [45.565375, -122.707757],
  [45.5655, -122.707988],
  [45.565564, -122.708106],
  [45.565883, -122.708692],
  [45.565955, -122.708825],
  [45.566038, -122.708973],
  [45.566537, -122.708424],
  [45.567346, -122.707531],
  [45.567777, -122.707057],
  [45.56868, -122.706065],
  [45.568785, -122.70594],
  [45.568415, -122.70536],
  [45.568336, -122.705236],
  [45.568121, -122.704898],
  [45.567954, -122.704636],
  [45.56764, -122.704143],
  [45.567607, -122.70409],
  [45.567543, -122.703991],
  [45.567314, -122.703631],
  [45.567299, -122.703607],
  [45.567001, -122.70314],
  [45.566919, -122.703011],
  [45.566816, -122.702848],
  [45.566757, -122.702739],
  [45.566702, -122.702595],
  [45.56668, -122.702495],
  [45.566676, -122.702456],
  [45.566665, -122.702351],
  [45.566671, -122.702193],
  [45.56669, -122.702085],
  [45.566725, -122.701964],
  [45.566726, -122.701962],
  [45.566763, -122.701863],
  [45.566793, -122.701804],
  [45.56687, -122.701697],
  [45.566935, -122.701639],
  [45.567004, -122.701585],
  [45.567083, -122.701552],
  [45.567176, -122.701535],
  [45.567539, -122.701546],
  [45.567931, -122.701558],
  [45.568003, -122.701573],
  [45.568078, -122.701599],
  [45.568377, -122.701748],
  [45.568586, -122.701851],
  [45.568813, -122.701956],
  [45.569112, -122.702095],
  [45.569898, -122.7025],
  [45.570128, -122.702614],
  [45.570409, -122.702785],
  [45.570676, -122.702978],
  [45.570928, -122.703183],
  [45.570579, -122.703634],
  [45.569788, -122.704653],
  [45.569381, -122.705178],
  [45.569014, -122.705651],
  [45.568905, -122.705791],
  [45.568785, -122.70594],
  [45.56868, -122.706065],
  [45.567777, -122.707057],
  [45.567346, -122.707531],
  [45.566038, -122.708973],
  [45.566131, -122.709149],
  [45.566209, -122.709286],
  [45.566258, -122.709368],
  [45.56632, -122.709462],
  [45.56639, -122.709544],
  [45.566448, -122.709601],
  [45.566498, -122.709639],
  [45.56654, -122.709667],
  [45.566589, -122.709693],
  [45.566638, -122.709709],
  [45.566757, -122.709739],
  [45.567153, -122.70984],
  [45.567638, -122.709961],
  [45.567658, -122.709967],
  [45.567725, -122.709988],
  [45.567785, -122.710014],
  [45.567839, -122.710046],
  [45.567894, -122.710088],
  [45.567946, -122.710138],
  [45.567987, -122.710183],
  [45.568026, -122.710242],
  [45.568065, -122.710304],
  [45.568145, -122.710453],
  [45.568279, -122.710696],
  [45.568359, -122.710845],
  [45.568446, -122.711006],
  [45.568483, -122.711079],
  [45.568488, -122.711088],
  [45.568517, -122.711155],
  [45.568537, -122.711207],
  [45.568568, -122.711295],
  [45.5686, -122.711401],
  [45.568637, -122.711527],
  [45.568772, -122.711989],
  [45.568989, -122.712735],
  [45.56915, -122.713286],
  [45.569195, -122.713429],
  [45.569229, -122.713523],
  [45.569258, -122.713596],
  [45.569296, -122.713677],
  [45.569311, -122.713705],
  [45.569425, -122.713918],
  [45.569519, -122.71409],
  [45.569714, -122.714448],
  [45.570129, -122.715211],
  [45.570686, -122.716236],
  [45.571437, -122.71762],
  [45.571507, -122.717749],
  [45.571645, -122.718],
  [45.572219, -122.719051],
  [45.572234, -122.71908],
  [45.572314, -122.719232],
  [45.572371, -122.719353],
  [45.572415, -122.719464],
  [45.572454, -122.719575],
  [45.57249, -122.719697],
  [45.572526, -122.719838],
  [45.572562, -122.720005],
  [45.57264, -122.720402],
  [45.572562, -122.720005],
  [45.57253, -122.719858]
];

const stopNames = {
  "143": "SW Arthur &amp; 1st",
  "314": "6300 Block N Basin",
  "316": "6700 Block N Basin (Coast Guard)",
  "318": "N Basin &amp; Emerson",
  "320": "N Basin &amp; Ensign",
  "321": "N Basin &amp; Fathom",
  "324": "N Basin &amp; Pacific Pride",
  "1612": "NW Everett &amp; 2nd",
  "2161": "N Going &amp; Port Center Way",
  "2195": "N Greeley &amp; Going Overpass",
  "2567": "200 Block SW Harrison",
  "2592": "Rose Quarter Transit Center",
  "2962": "N Interstate &amp; Graham",
  "3315": "N Lagoon &amp; Anchor",
  "3365": "N Interstate &amp; Larrabee",
  "3603": "S Macadam &amp; Boundary",
  "3611": "S Macadam &amp; Gaines",
  "3613": "S Macadam &amp; Hamilton Ct",
  "3616": "S Macadam &amp; Julia",
  "3619": "S Macadam &amp; Nebraska",
  "3622": "S Macadam &amp; Nevada",
  "3623": "S Macadam &amp; Pendleton",
  "5665": "SE Tacoma &amp; 13th",
  "5669": "SE Tacoma &amp; 17th",
  "5675": "SE Tacoma &amp; 7th",
  "6472": "2200 Block SW 1st",
  "7751": "SW 6th &amp; W Burnside",
  "7789": "SW 6th &amp; Salmon",
  "7803": "SW 6th &amp; Washington",
  "8886": "NW Everett &amp; 5th",
  "9418": "8300 Block SE McLoughlin",
  "11486": "SW 6th &amp; Columbia",
  "11839": "N Interstate &amp; Albina",
  "11840": "N Interstate &amp; Tillamook",
  "11947": "N Cutter Circle &amp; Leverman",
  "11948": "6000 Block N Cutter Circle",
  "11949": "6300 Block N Cutter Circle",
  "11950": "N Leverman &amp; Cutter Circle",
  "12383": "N Leverman &amp; Basin",
  "13184": "S Macadam &amp; Lowell",
  "13185": "S Macadam &amp; Tram Tower",
  "13305": "SW Harrison &amp; 6th",
  "13817": "S Macadam &amp; Sellwood Bridge"
};

const stops = [
  { stop_id: "9418", name: "8300 Block SE McLoughlin", lat: 45.4629, lon: -122.638361, times: ["6:27 AM", "6:55 AM", "7:21 AM", "7:49 AM", "8:19 AM", "8:52 AM", "9:25 AM", "9:56 AM"] },
  { stop_id: "5669", name: "SE Tacoma &amp; 17th", lat: 45.464385, lon: -122.64745, times: ["6:01 AM", "6:29 AM", "6:57 AM", "7:25 AM", "7:53 AM", "8:23 AM", "8:55 AM", "9:27 AM"] },
  { stop_id: "5665", name: "SE Tacoma &amp; 13th", lat: 45.464388, lon: -122.653346, times: ["6:03 AM", "6:31 AM", "6:59 AM", "7:27 AM", "7:55 AM", "8:25 AM", "8:57 AM", "9:29 AM"] },
  { stop_id: "5675", name: "SE Tacoma &amp; 7th", lat: 45.464394, lon: -122.658873, times: ["6:03 AM", "6:31 AM", "7:00 AM", "7:28 AM", "7:56 AM", "8:26 AM", "8:58 AM", "9:29 AM"] },
  { stop_id: "13817", name: "S Macadam &amp; Sellwood Bridge", lat: 45.465421, lon: -122.668868, times: ["6:06 AM", "6:34 AM", "7:03 AM", "7:31 AM", "8:00 AM", "8:30 AM", "9:01 AM", "9:32 AM"] },
  { stop_id: "3622", name: "S Macadam &amp; Nevada", lat: 45.472877, lon: -122.671349, times: ["6:07 AM", "6:35 AM", "7:04 AM", "7:32 AM", "8:02 AM", "8:32 AM", "9:02 AM", "9:33 AM"] },
  { stop_id: "3619", name: "S Macadam &amp; Nebraska", lat: 45.477128, lon: -122.671902, times: ["6:08 AM", "6:36 AM", "7:05 AM", "7:33 AM", "8:03 AM", "8:33 AM", "9:03 AM", "9:34 AM"] },
  { stop_id: "3623", name: "S Macadam &amp; Pendleton", lat: 45.480907, lon: -122.673171, times: ["6:09 AM", "6:37 AM", "7:06 AM", "7:34 AM", "8:04 AM", "8:34 AM", "9:04 AM", "9:35 AM"] },
  { stop_id: "3603", name: "S Macadam &amp; Boundary", lat: 45.484878, lon: -122.674891, times: ["6:10 AM", "6:38 AM", "7:07 AM", "7:35 AM", "8:05 AM", "8:35 AM", "9:05 AM", "9:36 AM"] },
  { stop_id: "3616", name: "S Macadam &amp; Julia", lat: 45.488049, lon: -122.675047, times: ["6:10 AM", "6:38 AM", "7:07 AM", "7:36 AM", "8:06 AM", "8:36 AM", "9:06 AM", "9:36 AM"] },
  { stop_id: "3613", name: "S Macadam &amp; Hamilton Ct", lat: 45.489817, lon: -122.673596, times: ["6:11 AM", "6:39 AM", "7:08 AM", "7:36 AM", "8:06 AM", "8:36 AM", "9:06 AM", "9:37 AM"] },
  { stop_id: "13184", name: "S Macadam &amp; Lowell", lat: 45.493472, lon: -122.672863, times: ["6:11 AM", "6:39 AM", "7:08 AM", "7:37 AM", "8:07 AM", "8:37 AM", "9:07 AM", "9:37 AM"] },
  { stop_id: "3611", name: "S Macadam &amp; Gaines", lat: 45.496382, lon: -122.672804, times: ["6:12 AM", "6:40 AM", "7:09 AM", "7:38 AM", "8:08 AM", "8:38 AM", "9:08 AM", "9:38 AM"] },
  { stop_id: "13185", name: "S Macadam &amp; Tram Tower", lat: 45.499184, lon: -122.672726, times: ["6:13 AM", "6:41 AM", "7:10 AM", "7:39 AM", "8:09 AM", "8:39 AM", "9:09 AM", "9:39 AM"] },
  { stop_id: "143", name: "SW Arthur &amp; 1st", lat: 45.503812, lon: -122.678451, times: ["6:15 AM", "6:43 AM", "7:12 AM", "7:41 AM", "8:11 AM", "8:41 AM", "9:11 AM", "9:41 AM"] },
  { stop_id: "6472", name: "2200 Block SW 1st", lat: 45.506687, lon: -122.678537, times: ["6:16 AM", "6:44 AM", "7:13 AM", "7:43 AM", "8:13 AM", "8:43 AM", "9:13 AM", "9:43 AM"] },
  { stop_id: "2567", name: "200 Block SW Harrison", lat: 45.510136, lon: -122.67893, times: ["6:17 AM", "6:45 AM", "7:15 AM", "7:44 AM", "8:14 AM", "8:44 AM", "9:14 AM", "9:44 AM"] },
  { stop_id: "13305", name: "SW Harrison &amp; 6th", lat: 45.511054, lon: -122.682648, times: ["6:18 AM", "6:46 AM", "7:16 AM", "7:46 AM", "8:16 AM", "8:46 AM", "9:16 AM", "9:46 AM"] },
  { stop_id: "11486", name: "SW 6th &amp; Columbia", lat: 45.514267, lon: -122.681095, times: ["6:20 AM", "6:48 AM", "7:17 AM", "7:47 AM", "8:17 AM", "8:47 AM", "9:17 AM", "9:47 AM"] },
  { stop_id: "7789", name: "SW 6th &amp; Salmon", lat: 45.516934, lon: -122.679687, times: ["6:21 AM", "6:49 AM", "7:19 AM", "7:49 AM", "8:19 AM", "8:49 AM", "9:19 AM", "9:49 AM"] },
  { stop_id: "7803", name: "SW 6th &amp; Washington", lat: 45.520244, lon: -122.677859, times: ["6:22 AM", "6:50 AM", "7:20 AM", "7:50 AM", "8:20 AM", "8:50 AM", "9:20 AM", "9:50 AM"] },
  { stop_id: "7751", name: "SW 6th &amp; W Burnside", lat: 45.52288, lon: -122.676415, times: ["6:23 AM", "6:51 AM", "7:21 AM", "7:51 AM", "8:21 AM", "8:51 AM", "9:21 AM", "9:51 AM"] },
  { stop_id: "8886", name: "NW Everett &amp; 5th", lat: 45.525182, lon: -122.675622, times: ["6:24 AM", "6:53 AM", "7:23 AM", "7:53 AM", "8:23 AM", "8:53 AM", "9:23 AM", "9:53 AM"] },
  { stop_id: "1612", name: "NW Everett &amp; 2nd", lat: 45.525237, lon: -122.672587, times: ["6:25 AM", "6:54 AM", "7:24 AM", "7:54 AM", "8:24 AM", "8:54 AM", "9:24 AM", "9:54 AM"] },
  { stop_id: "2592", name: "Rose Quarter Transit Center", lat: 45.530005, lon: -122.666476, times: ["6:30 AM", "6:59 AM", "7:29 AM", "7:59 AM", "8:29 AM", "8:59 AM", "9:29 AM", "9:59 AM"] },
  { stop_id: "3365", name: "N Interstate &amp; Larrabee", lat: 45.532537, lon: -122.671201, times: ["6:30 AM", "6:59 AM", "7:29 AM", "7:59 AM", "8:29 AM", "8:59 AM", "9:29 AM", "9:59 AM"] },
  { stop_id: "11840", name: "N Interstate &amp; Tillamook", lat: 45.538115, lon: -122.674426, times: ["6:01 AM", "6:31 AM", "7:01 AM", "7:31 AM", "8:01 AM", "8:31 AM", "9:01 AM", "9:31 AM"] },
  { stop_id: "11839", name: "N Interstate &amp; Albina", lat: 45.539549, lon: -122.675234, times: ["6:02 AM", "6:32 AM", "7:01 AM", "7:31 AM", "8:01 AM", "8:31 AM", "9:01 AM", "9:31 AM"] },
  { stop_id: "2962", name: "N Interstate &amp; Graham", lat: 45.543111, lon: -122.677065, times: ["6:02 AM", "6:32 AM", "7:02 AM", "7:32 AM", "8:02 AM", "8:32 AM", "9:02 AM", "9:32 AM"] },
  { stop_id: "2195", name: "N Greeley &amp; Going Overpass", lat: 45.555604, lon: -122.692295, times: ["6:05 AM", "6:35 AM", "7:05 AM", "7:35 AM", "8:05 AM", "8:35 AM", "9:05 AM", "9:35 AM"] },
  { stop_id: "2161", name: "N Going &amp; Port Center Way", lat: 45.556285, lon: -122.698645, times: ["6:07 AM", "6:37 AM", "7:07 AM", "7:37 AM", "8:07 AM", "8:37 AM", "9:07 AM", "9:37 AM"] },
  { stop_id: "3315", name: "N Lagoon &amp; Anchor", lat: 45.557676, lon: -122.702554, times: ["6:08 AM", "6:38 AM", "7:08 AM", "7:38 AM", "8:08 AM", "8:38 AM", "9:08 AM", "9:38 AM"] },
  { stop_id: "324", name: "N Basin &amp; Pacific Pride", lat: 45.560333, lon: -122.701723, times: ["6:08 AM", "6:38 AM", "7:08 AM", "7:38 AM", "8:08 AM", "8:38 AM", "9:08 AM", "9:38 AM"] },
  { stop_id: "318", name: "N Basin &amp; Emerson", lat: 45.562311, lon: -122.704507, times: ["6:09 AM", "6:39 AM", "7:09 AM", "7:39 AM", "8:09 AM", "8:39 AM", "9:09 AM", "9:39 AM"] },
  { stop_id: "12383", name: "N Leverman &amp; Basin", lat: 45.566471, lon: -122.708311, times: ["6:10 AM", "6:40 AM", "7:10 AM", "7:40 AM", "8:10 AM", "8:40 AM", "9:10 AM", "9:40 AM"] },
  { stop_id: "11947", name: "N Cutter Circle &amp; Leverman", lat: 45.568342, lon: -122.705451, times: ["6:11 AM", "6:41 AM", "7:11 AM", "7:41 AM", "8:11 AM", "8:41 AM", "9:11 AM", "9:41 AM"] },
  { stop_id: "11948", name: "6000 Block N Cutter Circle", lat: 45.566633, lon: -122.701909, times: ["6:12 AM", "6:42 AM", "7:12 AM", "7:42 AM", "8:12 AM", "8:42 AM", "9:12 AM", "9:42 AM"] },
  { stop_id: "11949", name: "6300 Block N Cutter Circle", lat: 45.56884, lon: -122.701825, times: ["6:13 AM", "6:43 AM", "7:13 AM", "7:43 AM", "8:13 AM", "8:43 AM", "9:13 AM", "9:43 AM"] },
  { stop_id: "11950", name: "N Leverman &amp; Cutter Circle", lat: 45.56907, lon: -122.705742, times: ["6:14 AM", "6:44 AM", "7:14 AM", "7:44 AM", "8:14 AM", "8:44 AM", "9:14 AM", "9:44 AM"] },
  { stop_id: "314", name: "6300 Block N Basin", lat: 45.568537, lon: -122.711022, times: ["6:15 AM", "6:45 AM", "7:15 AM", "7:45 AM", "8:15 AM", "8:45 AM", "9:15 AM", "9:45 AM"] },
  { stop_id: "320", name: "N Basin &amp; Ensign", lat: 45.569807, lon: -122.714346, times: ["6:16 AM", "6:46 AM", "7:16 AM", "7:46 AM", "8:16 AM", "8:46 AM", "9:16 AM", "9:46 AM"] },
  { stop_id: "321", name: "N Basin &amp; Fathom", lat: 45.571487, lon: -122.717561, times: ["6:17 AM", "6:47 AM", "7:17 AM", "7:47 AM", "8:17 AM", "8:47 AM", "9:17 AM", "9:47 AM"] },
  { stop_id: "316", name: "6700 Block N Basin (Coast Guard)", lat: 45.572468, lon: -122.719884, times: ["6:18 AM", "6:48 AM", "7:18 AM", "7:48 AM", "8:18 AM", "8:48 AM", "9:18 AM", "9:48 AM"] },
]

    const polylineOut = L.polyline(shapeOutbound, { color: 'blue', weight: 4, opacity: 0.7 }).addTo(map);
    map.fitBounds(polylineOut.getBounds());

    const nowPT = new Date(new Date().toLocaleString('en-US', { timeZone: 'America/Los_Angeles' }));
    const nowMins = nowPT.getHours() * 60 + nowPT.getMinutes();

    stops.forEach(stop => {
      let highlightedTimes = [];
      let foundNext = false;
      stop.times.forEach(timeStr => {
        let cleanTime = timeStr.trim();
        let [h, m] = cleanTime.split(":");
        let schedMins = parseInt(h, 10) * 60 + parseInt(m, 10);
        if (schedMins < nowMins && nowMins - schedMins > 720) {
          schedMins += 1440;
        }
        if (!foundNext && schedMins >= nowMins) {
          highlightedTimes.push(`<span style="background:#4dd0e1; color:#000; padding:2px 6px; border-radius:6px; font-weight:bold;">${cleanTime}</span>`);
          foundNext = true;
        } else {
          highlightedTimes.push(cleanTime);
        }
      });

      L.circleMarker([stop.lat, stop.lon], {
        radius: 6,
        color: '#4dd0e1',
        fillColor: '#4dd0e1',
        fillOpacity: 0.9,
        weight: 1
      })
      .bindPopup(`<strong>${stop.name}</strong><br>${highlightedTimes.join("<br>") || 'No scheduled times'}`)
      .addTo(map);
    });

    let busMarkers = {};
    async function fetchAndDisplay() {
      const res = await fetch(`https://developer.trimet.org/ws/v2/vehicles?route=${routeNumber}&appID=${apiKey}&json=true`);
      const data = await res.json();
      const buses = (data.resultSet.vehicle || []).filter(v => v.routeNumber == routeNumber && v.direction == direction);

      Object.values(busMarkers).forEach(m => map.removeLayer(m));
      busMarkers = {};
      if (!buses.length) return;

      buses.forEach(bus => {
        if (!bus.latitude || !bus.longitude || !bus.blockID) return;
        const icon = L.divIcon({    
           className: '',
           html: `
            <div style="text-align:center;">
              <div style="background:#0071CE;color:#fff;padding:2px 6px;border-radius:6px;font-weight:bold;">${bus.vehicleID}</div>
              <div style="width:0;height:0;border-left:5px solid transparent;border-right:5px solid transparent;border-top:10px solid #00bfff;margin:auto;"></div>
            </div>
          `,
          iconSize: [40, 30], iconAnchor: [20, 30]
        });
        const marker = L.marker([bus.latitude, bus.longitude], { icon }).addTo(map);
        busMarkers[bus.vehicleID] = marker;
      });
    }
    fetchAndDisplay();
    setInterval(fetchAndDisplay, 15000);
  </script>

  <footer class="site-footer">
    <a href="terms.html">Terms of Use</a> &nbsp;|&nbsp;
    <a href="contact.html">Contact Us</a> &nbsp;|&nbsp;
    <a href="report.html">Report a Problem</a> &nbsp;|&nbsp;
    <a href="dmca.html">DMCA</a> &nbsp;|&nbsp;
    <a href="privacy.html">Privacy Policy</a>
  </footer>

  <script>
    if (!localStorage.getItem('cookieConsent')) {
      document.write(`
        <div id="cookie-banner" style="position: fixed; bottom: 0; left: 0; right: 0; background: #333; color: #fff; padding: 1rem; z-index: 1000; font-size: 0.9rem; line-height: 1.4; text-align: center; box-sizing: border-box;">
          📢 We use cookies to improve functionality and analyze traffic.
          By using MetroFeed, you agree to our 
          <a href='privacy.html' style='color: #4dd0e1; text-decoration: underline;'>Privacy Policy</a>.<br>
          <button onclick='localStorage.setItem("cookieConsent", "true"); document.getElementById("cookie-banner").remove();' style='margin-top: 0.5rem; background: #4dd0e1; color: #000; border: none; padding: 0.5rem 1rem; border-radius: 5px; cursor: pointer; font-weight: bold;'>OK</button>
        </div>
      `);
    }
  </script>
</body>
</html>