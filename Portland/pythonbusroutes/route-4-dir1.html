<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Route 4 - To Portland City Center | MetroFeed Portland</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', sans-serif;
      background-color: #0d0d0d;
      color: #cccccc;
      overflow-y: auto;
    }

    body {
      padding-top: 100px;
    }

    .ad-banner {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      background: #222;
      padding: 0.5rem 0;
      z-index: 1000;
      box-shadow: 0 2px 8px rgba(0,0,0,0.5);
      text-align: center;
    }

    .ad-banner img {
  width: 100%;
  max-width: 970px;
  height: auto;
  max-height: 120px; /* üëà Caps desktop height */
  display: block;
  margin: 0 auto;
}
    .home-button {
      position: fixed;
      top: 120px;
      left: 10px;
      background-color: #4dd0e1;
      color: #0d0d0d;
      padding: 0.5rem 1rem;
      font-weight: bold;
      border-radius: 8px;
      text-decoration: none;
      z-index: 1001;
      box-shadow: 0 0 10px #4dd0e1;
    }

    .home-button:hover {
      background-color: #00bcd4;
      color: #ffffff;
    }

    header {
      background-color: #0d0d0d;
      border-top: 4px solid #4dd0e1;
      border-bottom: 3px solid #4dd0e1;
      padding: 1rem;
      text-align: center;
    }

    header img {
      max-height: 60px;
    }

    h1 {
      text-align: center;
      margin: 1rem 0;
      font-size: 2rem;
      color: #f0f0f0;
    }

    .content-box {
      border-radius: 12px;
      padding: 0;
      margin: 0;
      background-color: #1e1e1e;
    }

    #map {
      width: 100%;
      height: 85vh;
      border: none;
      margin: 0 auto;
      display: block;
      border-radius: 8px;
    }

    .button-bar {
      display: flex;
      justify-content: center;
      margin: 1rem 0;
    }

    .button-bar a, .back-button {
      background: #4dd0e1;
      color: #0d0d0d;
      padding: 0.6rem 1.2rem;
      text-decoration: none;
      border-radius: 8px;
      font-weight: bold;
      border: none;
      cursor: pointer;
      box-shadow: 0 0 10px #4dd0e1;
    }

    .back-button:hover {
      background-color: #35c0d6;
    }

    .site-footer {
      text-align: center;
      margin-top: 3rem;
      margin-bottom: 120px;
      font-size: 0.85rem;
      color: #aaa;
    }

    .site-footer a {
      color: #00BFFF;
      text-decoration: none;
    }

    .site-footer a:hover {
      text-decoration: underline;
    }

@media (max-width: 600px) {
  .ad-banner {
    padding-top: 1rem;
    padding-bottom: 1rem;
  }
}


  </style>
</head>

<body>
 


 <header>
    <img src="MetroFeedPortlandLogo.png" alt="MetroFeed Portland">
  </header>

  <div class="disclaimer" style="margin: 1rem auto 0.5rem; max-width: 600px; font-size: 0.8rem; color: #bbb; text-align: center; padding: 0.5rem 1rem; background-color: #111; border: 1px dashed #444; border-radius: 6px;">
    ‚ö†Ô∏è This is a Beta program, work in progress. Please REPORT bugs and pretend to be impressed.
  </div>
  <div class="disclaimer" style="margin: 0 auto 1rem; max-width: 600px; font-size: 0.75rem; color: #888; text-align: center; padding: 0.25rem 1rem;">
    This tool is not affiliated with or endorsed by TriMet. For official schedules and service alerts, visit <a href="https://trimet.org" style="color:#4dd0e1;">trimet.org</a>.
  </div>

  <div style="margin: 2rem 0; text-align: center;">
    <button class="back-button" onclick="history.back()">Back</button>
  </div>

  <h1>Route 4 - To Portland City Center</h1>

  <div class="content-box">
    <div id="map"></div>
    <div style="text-align:right; font-size: 0.7rem; color: #777; margin-top: 0.5rem;">
      Data courtesy of TriMet.
    </div>
  </div>

  <script>
    if (document.referrer === "" && performance.navigation.type === 0) {
      window.location.href = "/index.html";
    }

    const apiKey = "2C4447D4A42083BCD84DE3B8E";
    const routeNumber = 4;
    const direction = parseInt(1);

    // Initialize map
    const map = L.map('map', {
      center: [45.6, -122.7],
      zoom: 12,
      minZoom: 12,
      maxZoom: 18,
      maxBounds: [[45.3, -123.1], [45.9, -122.3]],
      maxBoundsViscosity: 1.0
    });
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { maxZoom: 19 }).addTo(map);

    // Injected shape & stop data
    const shapeOutbound = [
  [45.587862, -122.751804],
  [45.587837, -122.751821],
  [45.5877, -122.751907],
  [45.58741, -122.752095],
  [45.587297, -122.752168],
  [45.587055, -122.752324],
  [45.586543, -122.752656],
  [45.586422, -122.752737],
  [45.586389, -122.752596],
  [45.586129, -122.75179],
  [45.586678, -122.75143],
  [45.586751, -122.751382],
  [45.586902, -122.75185],
  [45.587055, -122.752324],
  [45.587297, -122.752168],
  [45.58741, -122.752095],
  [45.587621, -122.751958],
  [45.5877, -122.751907],
  [45.587837, -122.751821],
  [45.587985, -122.751721],
  [45.588203, -122.751565],
  [45.588345, -122.75147],
  [45.588383, -122.751596],
  [45.58842, -122.751713],
  [45.588474, -122.751858],
  [45.588546, -122.752076],
  [45.588662, -122.752423],
  [45.588878, -122.752281],
  [45.589223, -122.752056],
  [45.589306, -122.752002],
  [45.589562, -122.752794],
  [45.589604, -122.752926],
  [45.589899, -122.753847],
  [45.590083, -122.754423],
  [45.590109, -122.754499],
  [45.590195, -122.754762],
  [45.590229, -122.754865],
  [45.590251, -122.754922],
  [45.590282, -122.754987],
  [45.590309, -122.755026],
  [45.590348, -122.755072],
  [45.590541, -122.755248],
  [45.590698, -122.755403],
  [45.591137, -122.755834],
  [45.591318, -122.756008],
  [45.591525, -122.756206],
  [45.591719, -122.756397],
  [45.591838, -122.756512],
  [45.592329, -122.756986],
  [45.592758, -122.757401],
  [45.592793, -122.757435],
  [45.592853, -122.757493],
  [45.592937, -122.757572],
  [45.592989, -122.757498],
  [45.593153, -122.757168],
  [45.593348, -122.756767],
  [45.593739, -122.755965],
  [45.593931, -122.755569],
  [45.593981, -122.755467],
  [45.594449, -122.754505],
  [45.594464, -122.754473],
  [45.594893, -122.753592],
  [45.594951, -122.753474],
  [45.595148, -122.753071],
  [45.595397, -122.752562],
  [45.59567, -122.752],
  [45.59578, -122.751772],
  [45.595869, -122.751589],
  [45.596372, -122.750556],
  [45.59646, -122.750367],
  [45.596498, -122.750277],
  [45.596534, -122.750178],
  [45.596571, -122.750064],
  [45.596608, -122.749924],
  [45.596616, -122.74989],
  [45.596635, -122.749806],
  [45.596657, -122.749684],
  [45.596675, -122.749541],
  [45.596689, -122.749403],
  [45.596696, -122.749297],
  [45.596697, -122.749172],
  [45.596693, -122.749046],
  [45.596687, -122.748933],
  [45.596675, -122.74881],
  [45.59666, -122.748695],
  [45.596644, -122.748608],
  [45.596618, -122.748479],
  [45.59649, -122.747934],
  [45.596263, -122.746976],
  [45.596193, -122.746684],
  [45.596163, -122.746558],
  [45.596031, -122.74601],
  [45.595918, -122.745529],
  [45.595804, -122.745048],
  [45.595578, -122.744095],
  [45.595515, -122.743831],
  [45.595346, -122.743125],
  [45.595121, -122.742181],
  [45.594925, -122.741348],
  [45.59489, -122.741199],
  [45.59466, -122.740234],
  [45.594438, -122.739273],
  [45.594239, -122.738402],
  [45.594236, -122.738392],
  [45.594216, -122.738306],
  [45.593989, -122.737346],
  [45.593757, -122.736377],
  [45.59353, -122.735424],
  [45.593467, -122.735159],
  [45.593415, -122.734938],
  [45.59326, -122.734334],
  [45.59289, -122.732919],
  [45.592836, -122.732693],
  [45.592786, -122.73248],
  [45.592685, -122.732096],
  [45.59266, -122.732002],
  [45.59251, -122.731407],
  [45.592355, -122.7308],
  [45.59224, -122.730353],
  [45.591997, -122.729389],
  [45.591832, -122.728734],
  [45.591709, -122.728211],
  [45.591626, -122.727843],
  [45.591479, -122.727258],
  [45.591445, -122.72712],
  [45.591389, -122.726899],
  [45.591346, -122.72673],
  [45.591282, -122.726478],
  [45.591267, -122.726405],
  [45.591258, -122.726332],
  [45.591251, -122.726242],
  [45.591247, -122.725272],
  [45.591241, -122.724256],
  [45.591241, -122.724199],
  [45.591241, -122.72414],
  [45.591236, -122.723261],
  [45.591236, -122.723131],
  [45.591229, -122.722106],
  [45.591226, -122.721222],
  [45.591221, -122.721055],
  [45.591215, -122.720894],
  [45.591214, -122.720701],
  [45.591208, -122.720006],
  [45.591203, -122.718996],
  [45.591201, -122.718055],
  [45.5912, -122.717895],
  [45.591197, -122.717508],
  [45.591192, -122.716851],
  [45.591122, -122.716852],
  [45.58966, -122.71687],
  [45.58867, -122.716881],
  [45.58866, -122.715627],
  [45.588659, -122.715524],
  [45.58866, -122.714616],
  [45.58866, -122.714486],
  [45.588651, -122.713519],
  [45.588649, -122.713415],
  [45.588646, -122.713299],
  [45.588635, -122.712615],
  [45.588636, -122.712335],
  [45.588638, -122.711695],
  [45.588638, -122.711654],
  [45.588634, -122.711599],
  [45.588624, -122.711553],
  [45.588604, -122.711514],
  [45.588575, -122.711474],
  [45.588282, -122.711168],
  [45.588038, -122.710888],
  [45.587993, -122.710823],
  [45.587959, -122.71077],
  [45.587924, -122.710704],
  [45.587911, -122.710675],
  [45.587892, -122.710625],
  [45.587867, -122.71054],
  [45.587846, -122.710459],
  [45.587831, -122.710363],
  [45.587825, -122.710268],
  [45.587824, -122.710249],
  [45.587824, -122.7101],
  [45.58782, -122.709209],
  [45.587818, -122.708699],
  [45.587818, -122.708668],
  [45.587815, -122.707878],
  [45.587815, -122.707831],
  [45.587812, -122.707035],
  [45.587804, -122.705605],
  [45.587803, -122.705385],
  [45.58774, -122.705378],
  [45.587472, -122.705394],
  [45.587387, -122.705398],
  [45.58729, -122.705418],
  [45.587216, -122.70544],
  [45.587161, -122.70546],
  [45.587071, -122.7055],
  [45.586982, -122.705553],
  [45.58689, -122.705616],
  [45.586808, -122.705688],
  [45.586735, -122.705756],
  [45.586672, -122.705822],
  [45.5866, -122.70591],
  [45.58646, -122.706102],
  [45.586053, -122.706695],
  [45.585933, -122.70687],
  [45.58556, -122.707405],
  [45.585482, -122.7075],
  [45.585399, -122.707592],
  [45.585317, -122.707666],
  [45.585203, -122.707751],
  [45.585156, -122.70778],
  [45.585074, -122.70782],
  [45.584989, -122.707854],
  [45.584945, -122.707869],
  [45.584919, -122.707877],
  [45.584848, -122.70789],
  [45.584768, -122.707902],
  [45.584697, -122.707912],
  [45.584542, -122.707918],
  [45.584512, -122.707919],
  [45.584419, -122.707921],
  [45.584142, -122.707927],
  [45.584015, -122.707922],
  [45.584012, -122.707182],
  [45.584012, -122.707],
  [45.58401, -122.706589],
  [45.584009, -122.706168],
  [45.584008, -122.705466],
  [45.584008, -122.705342],
  [45.584007, -122.704342],
  [45.584007, -122.703456],
  [45.584006, -122.70337],
  [45.584006, -122.703287],
  [45.584006, -122.702794],
  [45.584006, -122.702658],
  [45.584007, -122.702395],
  [45.584006, -122.701857],
  [45.584004, -122.701416],
  [45.584003, -122.70044],
  [45.583975, -122.70034],
  [45.583969, -122.700056],
  [45.583968, -122.700033],
  [45.583972, -122.699902],
  [45.583973, -122.699838],
  [45.583975, -122.69958],
  [45.584, -122.699465],
  [45.583999, -122.698484],
  [45.583998, -122.697869],
  [45.583997, -122.697357],
  [45.583997, -122.697205],
  [45.583786, -122.697207],
  [45.583325, -122.697211],
  [45.583123, -122.697211],
  [45.582923, -122.697212],
  [45.582868, -122.697216],
  [45.582851, -122.697217],
  [45.582806, -122.697221],
  [45.582668, -122.697226],
  [45.582708, -122.697119],
  [45.582704, -122.694814],
  [45.582696, -122.69255],
  [45.582695, -122.692428],
  [45.582644, -122.692357],
  [45.582406, -122.692094],
  [45.582399, -122.689157],
  [45.582399, -122.689044],
  [45.582393, -122.687788],
  [45.582389, -122.687093],
  [45.582389, -122.687028],
  [45.582389, -122.686896],
  [45.582316, -122.686897],
  [45.581674, -122.686896],
  [45.581156, -122.686896],
  [45.581031, -122.686897],
  [45.580963, -122.686896],
  [45.580251, -122.686892],
  [45.579538, -122.686891],
  [45.578826, -122.686889],
  [45.578219, -122.686891],
  [45.578113, -122.686891],
  [45.578035, -122.686891],
  [45.577214, -122.686891],
  [45.577207, -122.686891],
  [45.577161, -122.686897],
  [45.577125, -122.686908],
  [45.577126, -122.686766],
  [45.577125, -122.686285],
  [45.577124, -122.685797],
  [45.577119, -122.685431],
  [45.577118, -122.685371],
  [45.577117, -122.685248],
  [45.577113, -122.684828],
  [45.577113, -122.684744],
  [45.577113, -122.684227],
  [45.577125, -122.683217],
  [45.577126, -122.682692],
  [45.577127, -122.682338],
  [45.577127, -122.682308],
  [45.577128, -122.682207],
  [45.577129, -122.682126],
  [45.577129, -122.68207],
  [45.57713, -122.681979],
  [45.577085, -122.681852],
  [45.577093, -122.681202],
  [45.5771, -122.680956],
  [45.577103, -122.680836],
  [45.57711, -122.680629],
  [45.577117, -122.680327],
  [45.57717, -122.680219],
  [45.577176, -122.679985],
  [45.577181, -122.679821],
  [45.577185, -122.679738],
  [45.577199, -122.679041],
  [45.577208, -122.678207],
  [45.577208, -122.677508],
  [45.577208, -122.677042],
  [45.577207, -122.676527],
  [45.577207, -122.676336],
  [45.577207, -122.674902],
  [45.577208, -122.674795],
  [45.57694, -122.674797],
  [45.576494, -122.674801],
  [45.575807, -122.674808],
  [45.575583, -122.674814],
  [45.575185, -122.674818],
  [45.575121, -122.674819],
  [45.574816, -122.674823],
  [45.574436, -122.674824],
  [45.573921, -122.674835],
  [45.573495, -122.674836],
  [45.573385, -122.674837],
  [45.572157, -122.674855],
  [45.571832, -122.674858],
  [45.571749, -122.674859],
  [45.570954, -122.674867],
  [45.570041, -122.674876],
  [45.569924, -122.674878],
  [45.569826, -122.674879],
  [45.569639, -122.674881],
  [45.569077, -122.674887],
  [45.568442, -122.674895],
  [45.567583, -122.674906],
  [45.566663, -122.674916],
  [45.566579, -122.674925],
  [45.566508, -122.674929],
  [45.566413, -122.674918],
  [45.566325, -122.674907],
  [45.566284, -122.674906],
  [45.566251, -122.674908],
  [45.56618, -122.674921],
  [45.566133, -122.674924],
  [45.566128, -122.674925],
  [45.565536, -122.674931],
  [45.564804, -122.67494],
  [45.564114, -122.674946],
  [45.563629, -122.674957],
  [45.563515, -122.674958],
  [45.56342, -122.674956],
  [45.56329, -122.674961],
  [45.563105, -122.674961],
  [45.562759, -122.674968],
  [45.562681, -122.674972],
  [45.56261, -122.674975],
  [45.562409, -122.674977],
  [45.561874, -122.674981],
  [45.561147, -122.674989],
  [45.560437, -122.674996],
  [45.559722, -122.675003],
  [45.559073, -122.675008],
  [45.559006, -122.675009],
  [45.558748, -122.675012],
  [45.55843, -122.675015],
  [45.558381, -122.675014],
  [45.558341, -122.675008],
  [45.558303, -122.674993],
  [45.558236, -122.674946],
  [45.558214, -122.67494],
  [45.558187, -122.674939],
  [45.556885, -122.674947],
  [45.556631, -122.67495],
  [45.556109, -122.674955],
  [45.556002, -122.675006],
  [45.555906, -122.67501],
  [45.555866, -122.675018],
  [45.555834, -122.675046],
  [45.555786, -122.67511],
  [45.555536, -122.675477],
  [45.555515, -122.675504],
  [45.555496, -122.675528],
  [45.555431, -122.675555],
  [45.555382, -122.675563],
  [45.555184, -122.675562],
  [45.555109, -122.675512],
  [45.554746, -122.675515],
  [45.554695, -122.675516],
  [45.554623, -122.675515],
  [45.553555, -122.675524],
  [45.553366, -122.675526],
  [45.552101, -122.675536],
  [45.551274, -122.675542],
  [45.550904, -122.675544],
  [45.550842, -122.675544],
  [45.550771, -122.675544],
  [45.5506, -122.675546],
  [45.550009, -122.675551],
  [45.549642, -122.675553],
  [45.549585, -122.675554],
  [45.549517, -122.675555],
  [45.548221, -122.675565],
  [45.547901, -122.675569],
  [45.547825, -122.67557],
  [45.547825, -122.675108],
  [45.547825, -122.675028],
  [45.547826, -122.674675],
  [45.547825, -122.67459],
  [45.547826, -122.674515],
  [45.547832, -122.674399],
  [45.547842, -122.674321],
  [45.547854, -122.674249],
  [45.547871, -122.674163],
  [45.547895, -122.674074],
  [45.547916, -122.674012],
  [45.547952, -122.673931],
  [45.547995, -122.673849],
  [45.548172, -122.673543],
  [45.548196, -122.673488],
  [45.548219, -122.673429],
  [45.548225, -122.67339],
  [45.548235, -122.673338],
  [45.548238, -122.673273],
  [45.548239, -122.672884],
  [45.548241, -122.6725],
  [45.548249, -122.672344],
  [45.548261, -122.67223],
  [45.548262, -122.672166],
  [45.548262, -122.672045],
  [45.548262, -122.671794],
  [45.548262, -122.671761],
  [45.548262, -122.671242],
  [45.548261, -122.670727],
  [45.548261, -122.670146],
  [45.54826, -122.669738],
  [45.54826, -122.669057],
  [45.548261, -122.668884],
  [45.548258, -122.668052],
  [45.548258, -122.667931],
  [45.548197, -122.667929],
  [45.547637, -122.667933],
  [45.547565, -122.667933],
  [45.547504, -122.667932],
  [45.547134, -122.667936],
  [45.546797, -122.667938],
  [45.546672, -122.667944],
  [45.546071, -122.667954],
  [45.545975, -122.667954],
  [45.545832, -122.667955],
  [45.545359, -122.667957],
  [45.544963, -122.667963],
  [45.544887, -122.667972],
  [45.544829, -122.667988],
  [45.544798, -122.667999],
  [45.544668, -122.668043],
  [45.544493, -122.668104],
  [45.544429, -122.668112],
  [45.54384, -122.668119],
  [45.543735, -122.66812],
  [45.543306, -122.668127],
  [45.542822, -122.668125],
  [45.542034, -122.668124],
  [45.541903, -122.668123],
  [45.541514, -122.668117],
  [45.541371, -122.668108],
  [45.541298, -122.668108],
  [45.541251, -122.668097],
  [45.541209, -122.668079],
  [45.541154, -122.668048],
  [45.541064, -122.667976],
  [45.540988, -122.667911],
  [45.540906, -122.667844],
  [45.540848, -122.667806],
  [45.540802, -122.667775],
  [45.54074, -122.667747],
  [45.540723, -122.667739],
  [45.540645, -122.667715],
  [45.540563, -122.667702],
  [45.540461, -122.667691],
  [45.539666, -122.667693],
  [45.539591, -122.667693],
  [45.538679, -122.667703],
  [45.538122, -122.667705],
  [45.538052, -122.667705],
  [45.537465, -122.667706],
  [45.536968, -122.667725],
  [45.536365, -122.667728],
  [45.535616, -122.667721],
  [45.535504, -122.667717],
  [45.535202, -122.667717],
  [45.535114, -122.667757],
  [45.535095, -122.667754],
  [45.535017, -122.667739],
  [45.534499, -122.667743],
  [45.534455, -122.667744],
  [45.534416, -122.667747],
  [45.534373, -122.667751],
  [45.534272, -122.66776],
  [45.534136, -122.667762],
  [45.533994, -122.667759],
  [45.53396, -122.667754],
  [45.533919, -122.667739],
  [45.533876, -122.667706],
  [45.533757, -122.667582],
  [45.533253, -122.667011],
  [45.533051, -122.666744],
  [45.532904, -122.66661],
  [45.532689, -122.666342],
  [45.532614, -122.666252],
  [45.532547, -122.666177],
  [45.532476, -122.66611],
  [45.532413, -122.666056],
  [45.532328, -122.665994],
  [45.532254, -122.665948],
  [45.532185, -122.665906],
  [45.532111, -122.665862],
  [45.53204, -122.665837],
  [45.531959, -122.66581],
  [45.531894, -122.665798],
  [45.531836, -122.665789],
  [45.531788, -122.665785],
  [45.531704, -122.665782],
  [45.530903, -122.665785],
  [45.530794, -122.665782],
  [45.530704, -122.665831],
  [45.530627, -122.66584],
  [45.530504, -122.665878],
  [45.530408, -122.665911],
  [45.530305, -122.665948],
  [45.530258, -122.665977],
  [45.530221, -122.66602],
  [45.530185, -122.666084],
  [45.530056, -122.666313],
  [45.529979, -122.666427],
  [45.529978, -122.666429],
  [45.52988, -122.666547],
  [45.529824, -122.666612],
  [45.529802, -122.666637],
  [45.529769, -122.666672],
  [45.529651, -122.666796],
  [45.529605, -122.666842],
  [45.529561, -122.666885],
  [45.529524, -122.666918],
  [45.529487, -122.666937],
  [45.529445, -122.666948],
  [45.529383, -122.66696],
  [45.529304, -122.666981],
  [45.529093, -122.66705],
  [45.528988, -122.667116],
  [45.52887, -122.667158],
  [45.528774, -122.667212],
  [45.528694, -122.667259],
  [45.528584, -122.667346],
  [45.528514, -122.667415],
  [45.528435, -122.667506],
  [45.528354, -122.667624],
  [45.528269, -122.667779],
  [45.527772, -122.668873],
  [45.527588, -122.669277],
  [45.52745, -122.669581],
  [45.527077, -122.670373],
  [45.526965, -122.670603],
  [45.526904, -122.670724],
  [45.526867, -122.670807],
  [45.526859, -122.670828],
  [45.526845, -122.670881],
  [45.526834, -122.670939],
  [45.52683, -122.670996],
  [45.526828, -122.671101],
  [45.52688, -122.672382],
  [45.526879, -122.672503],
  [45.526872, -122.672738],
  [45.526863, -122.672975],
  [45.52686, -122.673192],
  [45.526844, -122.673331],
  [45.526834, -122.673421],
  [45.526817, -122.673573],
  [45.526809, -122.673643],
  [45.526755, -122.67409],
  [45.526714, -122.67443],
  [45.526679, -122.674539],
  [45.526674, -122.674659],
  [45.52667, -122.674755],
  [45.526661, -122.67494],
  [45.526646, -122.675469],
  [45.526645, -122.675527],
  [45.526585, -122.675524],
  [45.52599, -122.675512],
  [45.52593, -122.67551],
  [45.525224, -122.675481],
  [45.524707, -122.675459],
  [45.524508, -122.675451],
  [45.524455, -122.675457],
  [45.523856, -122.675435],
  [45.523796, -122.675434],
  [45.523744, -122.675433],
  [45.523208, -122.675414],
  [45.523141, -122.675403],
  [45.523025, -122.675386],
  [45.522962, -122.67538],
  [45.522922, -122.675383],
  [45.52288, -122.675394],
  [45.522703, -122.675478],
  [45.522612, -122.675527],
  [45.52258, -122.675542],
  [45.522549, -122.675556],
  [45.522214, -122.675716],
  [45.522184, -122.67573],
  [45.522128, -122.67575],
  [45.52206, -122.675774],
  [45.521534, -122.676064],
  [45.521457, -122.67611],
  [45.52137, -122.67616],
  [45.520857, -122.676429],
  [45.52079, -122.676466],
  [45.520245, -122.676761],
  [45.520181, -122.676796],
  [45.520125, -122.676825],
  [45.520048, -122.676865],
  [45.519566, -122.677133],
  [45.519507, -122.677166],
  [45.519457, -122.67719],
  [45.519358, -122.677239],
  [45.518833, -122.677521],
  [45.518798, -122.677543],
  [45.51877, -122.67756],
  [45.51874, -122.677579],
  [45.518179, -122.677878],
  [45.518142, -122.677899],
  [45.518112, -122.677916],
  [45.518045, -122.677953],
  [45.517539, -122.678221],
  [45.517462, -122.678283],
  [45.51692, -122.678577],
  [45.516795, -122.678644],
  [45.51613, -122.679004],
  [45.515462, -122.679366],
  [45.51479, -122.67973],
  [45.514133, -122.680086],
  [45.514111, -122.680004],
  [45.513957, -122.679425],
  [45.513866, -122.679083],
  [45.513985, -122.679018],
  [45.514412, -122.678787],
  [45.514438, -122.678773],
  [45.514523, -122.678727],
  [45.514597, -122.679003],
  [45.514632, -122.679136],
  [45.514747, -122.679568]
];

const stopNames = {
  "40": "N Trenton &amp; Alaska",
  "41": "N Alaska &amp; Chautauqua",
  "42": "N Alaska &amp; Chautauqua Pl",
  "44": "N Alaska &amp; Foss",
  "72": "N Albina &amp; Ainsworth",
  "74": "N Albina &amp; Alberta",
  "77": "N Albina &amp; Blandena",
  "79": "N Albina &amp; Bryant",
  "81": "N Albina &amp; Buffalo",
  "83": "N Albina &amp; Dekum",
  "89": "N Albina &amp; Killingsworth",
  "90": "N Albina &amp; Lombard St",
  "92": "N Albina &amp; Rosa Parks Way",
  "1046": "N Chautauqua &amp; Washburne",
  "1050": "N Chautauqua &amp; Willis",
  "1299": "N Denver &amp; Russet",
  "1304": "N Denver &amp; Watts",
  "1699": "N Fessenden &amp; Allegheny",
  "1703": "N Fessenden &amp; Burr",
  "1707": "N Fessenden &amp; Columbia Way",
  "1709": "N Fessenden &amp; Geneva",
  "1712": "N Fessenden &amp; Midway",
  "1714": "N Fessenden &amp; Richmond",
  "1720": "N Fessenden &amp; Portsmouth",
  "1722": "N Fessenden &amp; Van Houten",
  "1844": "N Fremont &amp; Mississippi",
  "2316": "N Halleck &amp; Delaware",
  "2592": "Rose Quarter Transit Center",
  "3219": "N Kilpatrick &amp; Brandon",
  "3222": "N Kilpatrick &amp; Denver",
  "3451": "N Lombard &amp; Mississippi",
  "3489": "N Lombard &amp; Fenwick",
  "3506": "N Lombard Transit Center",
  "3509": "N Lombard &amp; John",
  "3957": "N Mississippi &amp; Failing",
  "3967": "N Mississippi &amp; Mason",
  "3977": "N Mississippi &amp; Skidmore",
  "4435": "N Peninsular &amp; Halleck",
  "4817": "N Richmond &amp; Syracuse",
  "4818": "N Richmond &amp; Syracuse",
  "5373": "N St Louis &amp; New York",
  "5376": "N St Louis &amp; Smith",
  "5984": "N Vancouver &amp; Fargo",
  "5997": "N Vancouver &amp; Knott",
  "6000": "N Vancouver &amp; Ivy",
  "6001": "N Vancouver &amp; Page",
  "6003": "N Vancouver &amp; Russell",
  "6006": "N Vancouver &amp; Stanton",
  "6008": "N Vancouver &amp; Tillamook",
  "6009": "N Vancouver &amp; Weidler",
  "6377": "N Willis &amp; Emerald",
  "6383": "N Willis &amp; Peninsular",
  "6386": "N Willis &amp; Wabash",
  "6388": "N Willis &amp; Washburne",
  "7631": "SW 5th &amp; Pine",
  "7634": "SW 5th &amp; Salmon",
  "7642": "SW 5th &amp; Washington",
  "9301": "NW 5th &amp; Davis",
  "9311": "NW Glisan &amp; 3rd",
  "10614": "N Fessenden &amp; Tioga",
  "10649": "N Fremont &amp; Kerby",
  "11007": "N Fessenden &amp; Seneca",
  "11936": "N St Louis &amp; Central",
  "12726": "N Fessenden &amp; Haven",
  "12750": "N Trenton &amp; Dwight",
  "12791": "SW Jefferson &amp; 5th",
  "13877": "N Lombard &amp; St Louis",
  "14216": "N Lombard &amp; Alta"
};

const stops = [
  { stop_id: "4818", name: "N Richmond &amp; Syracuse", lat: 45.587889, lon: -122.751884, times: ["7:12 PM", "7:32 PM", "7:53 PM", "8:13 PM", "8:34 PM", "9:02 PM", "9:32 PM", "10:04 PM"] },
  { stop_id: "4817", name: "N Richmond &amp; Syracuse", lat: 45.587592, lon: -122.751862, times: ["7:13 PM", "7:33 PM", "7:54 PM", "8:14 PM", "8:35 PM", "9:03 PM", "9:33 PM", "10:05 PM"] },
  { stop_id: "3509", name: "N Lombard &amp; John", lat: 45.589615, lon: -122.752757, times: ["7:14 PM", "7:34 PM", "7:55 PM", "8:15 PM", "8:36 PM", "9:04 PM", "9:34 PM", "10:06 PM"] },
  { stop_id: "14216", name: "N Lombard &amp; Alta", lat: 45.590728, lon: -122.755342, times: ["7:15 PM", "7:35 PM", "7:56 PM", "8:16 PM", "8:37 PM", "9:05 PM", "9:35 PM", "10:06 PM"] },
  { stop_id: "13877", name: "N Lombard &amp; St Louis", lat: 45.59279, lon: -122.757332, times: ["7:16 PM", "7:36 PM", "7:57 PM", "8:17 PM", "8:38 PM", "9:06 PM", "9:36 PM", "10:07 PM"] },
  { stop_id: "11936", name: "N St Louis &amp; Central", lat: 45.593867, lon: -122.755506, times: ["7:16 PM", "7:36 PM", "7:57 PM", "8:17 PM", "8:38 PM", "9:06 PM", "9:36 PM", "10:08 PM"] },
  { stop_id: "5376", name: "N St Louis &amp; Smith", lat: 45.59484, lon: -122.75354, times: ["7:17 PM", "7:37 PM", "7:58 PM", "8:18 PM", "8:39 PM", "9:07 PM", "9:37 PM", "10:08 PM"] },
  { stop_id: "5373", name: "N St Louis &amp; New York", lat: 45.595604, lon: -122.751935, times: ["7:17 PM", "7:37 PM", "7:58 PM", "8:18 PM", "8:39 PM", "9:07 PM", "9:37 PM", "10:09 PM"] },
  { stop_id: "11007", name: "N Fessenden &amp; Seneca", lat: 45.596548, lon: -122.749858, times: ["7:18 PM", "7:38 PM", "7:59 PM", "8:19 PM", "8:40 PM", "9:08 PM", "9:38 PM", "10:09 PM"] },
  { stop_id: "1714", name: "N Fessenden &amp; Richmond", lat: 45.596122, lon: -122.746717, times: ["7:19 PM", "7:39 PM", "8:00 PM", "8:20 PM", "8:41 PM", "9:09 PM", "9:39 PM", "10:10 PM"] },
  { stop_id: "1699", name: "N Fessenden &amp; Allegheny", lat: 45.595446, lon: -122.743864, times: ["7:19 PM", "7:39 PM", "8:00 PM", "8:20 PM", "8:41 PM", "9:09 PM", "9:39 PM", "10:11 PM"] },
  { stop_id: "10614", name: "N Fessenden &amp; Tioga", lat: 45.594856, lon: -122.741381, times: ["7:20 PM", "7:40 PM", "8:01 PM", "8:21 PM", "8:42 PM", "9:10 PM", "9:40 PM", "10:11 PM"] },
  { stop_id: "1703", name: "N Fessenden &amp; Burr", lat: 45.594162, lon: -122.738439, times: ["7:21 PM", "7:41 PM", "8:02 PM", "8:22 PM", "8:43 PM", "9:11 PM", "9:41 PM", "10:12 PM"] },
  { stop_id: "1712", name: "N Fessenden &amp; Midway", lat: 45.593412, lon: -122.735186, times: ["7:22 PM", "7:42 PM", "8:03 PM", "8:23 PM", "8:44 PM", "9:12 PM", "9:42 PM", "10:13 PM"] },
  { stop_id: "1707", name: "N Fessenden &amp; Columbia Way", lat: 45.592627, lon: -122.732127, times: ["7:23 PM", "7:43 PM", "8:04 PM", "8:24 PM", "8:45 PM", "9:13 PM", "9:43 PM", "10:14 PM"] },
  { stop_id: "1709", name: "N Fessenden &amp; Geneva", lat: 45.59133, lon: -122.726929, times: ["7:24 PM", "7:44 PM", "8:05 PM", "8:25 PM", "8:46 PM", "9:14 PM", "9:44 PM", "10:15 PM"] },
  { stop_id: "1722", name: "N Fessenden &amp; Van Houten", lat: 45.591193, lon: -122.723262, times: ["7:25 PM", "7:45 PM", "8:06 PM", "8:26 PM", "8:47 PM", "9:15 PM", "9:45 PM", "10:16 PM"] },
  { stop_id: "1720", name: "N Fessenden &amp; Portsmouth", lat: 45.59116, lon: -122.720699, times: ["7:26 PM", "7:46 PM", "8:06 PM", "8:26 PM", "8:47 PM", "9:15 PM", "9:45 PM", "10:16 PM"] },
  { stop_id: "12726", name: "N Fessenden &amp; Haven", lat: 45.59115, lon: -122.718054, times: ["7:26 PM", "7:46 PM", "8:07 PM", "8:27 PM", "8:48 PM", "9:16 PM", "9:46 PM", "10:17 PM"] },
  { stop_id: "12750", name: "N Trenton &amp; Dwight", lat: 45.588621, lon: -122.714636, times: ["7:28 PM", "7:48 PM", "8:09 PM", "8:29 PM", "8:50 PM", "9:18 PM", "9:48 PM", "10:19 PM"] },
  { stop_id: "40", name: "N Trenton &amp; Alaska", lat: 45.588584, lon: -122.711677, times: ["7:29 PM", "7:49 PM", "8:10 PM", "8:30 PM", "8:50 PM", "9:18 PM", "9:48 PM", "10:19 PM"] },
  { stop_id: "44", name: "N Alaska &amp; Foss", lat: 45.58777, lon: -122.71025, times: ["7:29 PM", "7:49 PM", "8:10 PM", "8:30 PM", "8:51 PM", "9:19 PM", "9:49 PM", "10:20 PM"] },
  { stop_id: "42", name: "N Alaska &amp; Chautauqua Pl", lat: 45.587769, lon: -122.707831, times: ["7:30 PM", "7:50 PM", "8:11 PM", "8:31 PM", "8:51 PM", "9:19 PM", "9:49 PM", "10:20 PM"] },
  { stop_id: "41", name: "N Alaska &amp; Chautauqua", lat: 45.587746, lon: -122.705606, times: ["7:31 PM", "7:51 PM", "8:11 PM", "8:31 PM", "8:52 PM", "9:20 PM", "9:50 PM", "10:21 PM"] },
  { stop_id: "1046", name: "N Chautauqua &amp; Washburne", lat: 45.586094, lon: -122.706755, times: ["7:10 PM", "7:31 PM", "7:51 PM", "8:12 PM", "8:32 PM", "8:52 PM", "9:20 PM", "9:50 PM"] },
  { stop_id: "1050", name: "N Chautauqua &amp; Willis", lat: 45.58454, lon: -122.70805, times: ["7:11 PM", "7:32 PM", "7:52 PM", "8:13 PM", "8:33 PM", "8:53 PM", "9:21 PM", "9:51 PM"] },
  { stop_id: "6388", name: "N Willis &amp; Washburne", lat: 45.58394, lon: -122.705466, times: ["7:12 PM", "7:33 PM", "7:53 PM", "8:13 PM", "8:33 PM", "8:54 PM", "9:22 PM", "9:52 PM"] },
  { stop_id: "6386", name: "N Willis &amp; Wabash", lat: 45.583955, lon: -122.702795, times: ["7:13 PM", "7:34 PM", "7:54 PM", "8:14 PM", "8:34 PM", "8:54 PM", "9:22 PM", "9:52 PM"] },
  { stop_id: "6377", name: "N Willis &amp; Emerald", lat: 45.583928, lon: -122.700058, times: ["7:13 PM", "7:34 PM", "7:54 PM", "8:15 PM", "8:35 PM", "8:55 PM", "9:23 PM", "9:53 PM"] },
  { stop_id: "6383", name: "N Willis &amp; Peninsular", lat: 45.583938, lon: -122.697375, times: ["7:14 PM", "7:35 PM", "7:55 PM", "8:15 PM", "8:35 PM", "8:56 PM", "9:24 PM", "9:54 PM"] },
  { stop_id: "4435", name: "N Peninsular &amp; Halleck", lat: 45.582853, lon: -122.697297, times: ["7:15 PM", "7:36 PM", "7:56 PM", "8:16 PM", "8:36 PM", "8:56 PM", "9:24 PM", "9:54 PM"] },
  { stop_id: "2316", name: "N Halleck &amp; Delaware", lat: 45.582637, lon: -122.69255, times: ["7:16 PM", "7:37 PM", "7:57 PM", "8:17 PM", "8:37 PM", "8:57 PM", "9:25 PM", "9:55 PM"] },
  { stop_id: "3219", name: "N Kilpatrick &amp; Brandon", lat: 45.582321, lon: -122.689158, times: ["7:17 PM", "7:38 PM", "7:58 PM", "8:18 PM", "8:38 PM", "8:58 PM", "9:26 PM", "9:56 PM"] },
  { stop_id: "3222", name: "N Kilpatrick &amp; Denver", lat: 45.58233, lon: -122.687095, times: ["7:17 PM", "7:38 PM", "7:58 PM", "8:18 PM", "8:38 PM", "8:59 PM", "9:27 PM", "9:57 PM"] },
  { stop_id: "1304", name: "N Denver &amp; Watts", lat: 45.581157, lon: -122.686996, times: ["7:18 PM", "7:39 PM", "7:59 PM", "8:19 PM", "8:39 PM", "8:59 PM", "9:27 PM", "9:57 PM"] },
  { stop_id: "1299", name: "N Denver &amp; Russet", lat: 45.578219, lon: -122.686958, times: ["7:19 PM", "7:40 PM", "8:00 PM", "8:20 PM", "8:40 PM", "9:00 PM", "9:28 PM", "9:58 PM"] },
  { stop_id: "3489", name: "N Lombard &amp; Fenwick", lat: 45.57705, lon: -122.685434, times: ["7:20 PM", "7:41 PM", "8:01 PM", "8:21 PM", "8:41 PM", "9:01 PM", "9:29 PM", "9:59 PM"] },
  { stop_id: "3506", name: "N Lombard Transit Center", lat: 45.577024, lon: -122.682338, times: ["7:21 PM", "7:42 PM", "8:02 PM", "8:22 PM", "8:42 PM", "9:02 PM", "9:30 PM", "10:00 PM"] },
  { stop_id: "3451", name: "N Lombard &amp; Mississippi", lat: 45.577145, lon: -122.676526, times: ["7:22 PM", "7:43 PM", "8:03 PM", "8:23 PM", "8:43 PM", "9:03 PM", "9:31 PM", "10:01 PM"] },
  { stop_id: "90", name: "N Albina &amp; Lombard St", lat: 45.576941, lon: -122.67489, times: ["7:22 PM", "7:43 PM", "8:03 PM", "8:23 PM", "8:43 PM", "9:03 PM", "9:31 PM", "10:01 PM"] },
  { stop_id: "81", name: "N Albina &amp; Buffalo", lat: 45.575193, lon: -122.67491, times: ["7:23 PM", "7:44 PM", "8:04 PM", "8:24 PM", "8:44 PM", "9:04 PM", "9:32 PM", "10:02 PM"] },
  { stop_id: "79", name: "N Albina &amp; Bryant", lat: 45.573495, lon: -122.67494, times: ["7:24 PM", "7:45 PM", "8:05 PM", "8:25 PM", "8:45 PM", "9:05 PM", "9:33 PM", "10:03 PM"] },
  { stop_id: "83", name: "N Albina &amp; Dekum", lat: 45.571831, lon: -122.674942, times: ["7:24 PM", "7:45 PM", "8:05 PM", "8:25 PM", "8:45 PM", "9:05 PM", "9:33 PM", "10:03 PM"] },
  { stop_id: "92", name: "N Albina &amp; Rosa Parks Way", lat: 45.569639, lon: -122.67498, times: ["7:25 PM", "7:46 PM", "8:06 PM", "8:26 PM", "8:46 PM", "9:06 PM", "9:34 PM", "10:04 PM"] },
  { stop_id: "72", name: "N Albina &amp; Ainsworth", lat: 45.566134, lon: -122.675001, times: ["7:26 PM", "7:47 PM", "8:07 PM", "8:27 PM", "8:47 PM", "9:07 PM", "9:35 PM", "10:05 PM"] },
  { stop_id: "89", name: "N Albina &amp; Killingsworth", lat: 45.56241, lon: -122.675036, times: ["7:28 PM", "7:49 PM", "8:09 PM", "8:29 PM", "8:49 PM", "9:09 PM", "9:37 PM", "10:07 PM"] },
  { stop_id: "74", name: "N Albina &amp; Alberta", lat: 45.558749, lon: -122.67512, times: ["7:29 PM", "7:50 PM", "8:10 PM", "8:30 PM", "8:50 PM", "9:10 PM", "9:38 PM", "10:08 PM"] },
  { stop_id: "77", name: "N Albina &amp; Blandena", lat: 45.556627, lon: -122.675025, times: ["7:10 PM", "7:30 PM", "7:51 PM", "8:11 PM", "8:31 PM", "8:51 PM", "9:11 PM", "9:39 PM"] },
  { stop_id: "3977", name: "N Mississippi &amp; Skidmore", lat: 45.554742, lon: -122.67559, times: ["7:11 PM", "7:31 PM", "7:52 PM", "8:12 PM", "8:32 PM", "8:52 PM", "9:12 PM", "9:40 PM"] },
  { stop_id: "3967", name: "N Mississippi &amp; Mason", lat: 45.553555, lon: -122.675608, times: ["7:11 PM", "7:31 PM", "7:52 PM", "8:12 PM", "8:32 PM", "8:52 PM", "9:12 PM", "9:40 PM"] },
  { stop_id: "3957", name: "N Mississippi &amp; Failing", lat: 45.550606, lon: -122.675648, times: ["7:12 PM", "7:32 PM", "7:53 PM", "8:13 PM", "8:33 PM", "8:53 PM", "9:13 PM", "9:41 PM"] },
  { stop_id: "1844", name: "N Fremont &amp; Mississippi", lat: 45.547787, lon: -122.675108, times: ["7:14 PM", "7:34 PM", "7:54 PM", "8:14 PM", "8:34 PM", "8:54 PM", "9:14 PM", "9:42 PM"] },
  { stop_id: "10649", name: "N Fremont &amp; Kerby", lat: 45.548214, lon: -122.671762, times: ["7:15 PM", "7:35 PM", "7:55 PM", "8:15 PM", "8:35 PM", "8:55 PM", "9:15 PM", "9:43 PM"] },
  { stop_id: "6000", name: "N Vancouver &amp; Ivy", lat: 45.547637, lon: -122.668052, times: ["7:16 PM", "7:36 PM", "7:56 PM", "8:16 PM", "8:36 PM", "8:56 PM", "9:16 PM", "9:44 PM"] },
  { stop_id: "5984", name: "N Vancouver &amp; Fargo", lat: 45.545971, lon: -122.668042, times: ["7:17 PM", "7:37 PM", "7:57 PM", "8:17 PM", "8:37 PM", "8:57 PM", "9:17 PM", "9:45 PM"] },
  { stop_id: "6006", name: "N Vancouver &amp; Stanton", lat: 45.543858, lon: -122.668195, times: ["7:18 PM", "7:38 PM", "7:58 PM", "8:18 PM", "8:38 PM", "8:58 PM", "9:18 PM", "9:46 PM"] },
  { stop_id: "5997", name: "N Vancouver &amp; Knott", lat: 45.542028, lon: -122.668249, times: ["7:18 PM", "7:38 PM", "7:59 PM", "8:19 PM", "8:39 PM", "8:59 PM", "9:19 PM", "9:47 PM"] },
  { stop_id: "6003", name: "N Vancouver &amp; Russell", lat: 45.540714, lon: -122.667863, times: ["7:19 PM", "7:39 PM", "7:59 PM", "8:19 PM", "8:39 PM", "8:59 PM", "9:19 PM", "9:47 PM"] },
  { stop_id: "6001", name: "N Vancouver &amp; Page", lat: 45.539663, lon: -122.667791, times: ["7:19 PM", "7:39 PM", "8:00 PM", "8:20 PM", "8:40 PM", "9:00 PM", "9:20 PM", "9:48 PM"] },
  { stop_id: "6008", name: "N Vancouver &amp; Tillamook", lat: 45.538121, lon: -122.667792, times: ["7:20 PM", "7:40 PM", "8:00 PM", "8:20 PM", "8:40 PM", "9:00 PM", "9:20 PM", "9:48 PM"] },
  { stop_id: "6009", name: "N Vancouver &amp; Weidler", lat: 45.5345, lon: -122.667841, times: ["7:21 PM", "7:41 PM", "8:02 PM", "8:22 PM", "8:42 PM", "9:02 PM", "9:22 PM", "9:50 PM"] },
  { stop_id: "2592", name: "Rose Quarter Transit Center", lat: 45.530005, lon: -122.666476, times: ["7:24 PM", "7:44 PM", "8:04 PM", "8:24 PM", "8:44 PM", "9:04 PM", "9:24 PM", "9:52 PM"] },
  { stop_id: "9311", name: "NW Glisan &amp; 3rd", lat: 45.526817, lon: -122.674106, times: ["7:25 PM", "7:45 PM", "8:05 PM", "8:25 PM", "8:45 PM", "9:05 PM", "9:25 PM", "9:53 PM"] },
  { stop_id: "9301", name: "NW 5th &amp; Davis", lat: 45.524705, lon: -122.675552, times: ["7:28 PM", "7:48 PM", "8:08 PM", "8:28 PM", "8:48 PM", "9:08 PM", "9:28 PM", "9:55 PM"] },
  { stop_id: "7631", name: "SW 5th &amp; Pine", lat: 45.522236, lon: -122.675827, times: ["7:29 PM", "7:49 PM", "8:09 PM", "8:29 PM", "8:49 PM", "9:09 PM", "9:29 PM", "9:57 PM"] },
  { stop_id: "7642", name: "SW 5th &amp; Washington", lat: 45.52027, lon: -122.676855, times: ["7:11 PM", "7:31 PM", "7:51 PM", "8:11 PM", "8:31 PM", "8:51 PM", "9:11 PM", "9:31 PM"] },
  { stop_id: "7634", name: "SW 5th &amp; Salmon", lat: 45.51694, lon: -122.678651, times: ["7:14 PM", "7:34 PM", "7:54 PM", "8:14 PM", "8:34 PM", "8:54 PM", "9:14 PM", "9:34 PM"] },
  { stop_id: "12791", name: "SW Jefferson &amp; 5th", lat: 45.514806, lon: -122.679535, times: ["7:18 PM", "7:38 PM", "7:58 PM", "8:18 PM", "8:38 PM", "8:58 PM", "9:18 PM", "9:38 PM"] },
]

    // Draw route polyline
    const polylineOut = L.polyline(shapeOutbound, { color: 'blue', weight: 4, opacity: 0.7 }).addTo(map);
    map.fitBounds(polylineOut.getBounds());

    // 1. Get current time in PT
    const nowPT = new Date(new Date().toLocaleString('en-US', { timeZone: 'America/Los_Angeles' }));
    const datePT = nowPT.toDateString();

    // 2. Add stops with highlighted next time
    stops.forEach(stop => {
      const stamps = stop.times.map(t => new Date(`${datePT} ${t}`));
      const nextIdx = stamps.findIndex(ts => ts > nowPT);
      const timesHtml = stamps.slice(0, 8).map((ts, i) => {
        const lbl = ts.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
        return i === nextIdx ? `<strong>${lbl}</strong>` : lbl;
      }).join('<br>');

      L.circleMarker([stop.lat, stop.lon], {
        radius: 6,
        color: '#4dd0e1',
        fillColor: '#4dd0e1',
        fillOpacity: 0.9,
        weight: 1
      })
      .bindPopup(`<strong>${stop.name}</strong><br>${timesHtml || 'No scheduled times'}`)
      .addTo(map);
    });

    // Bus markers fetch
    let busMarkers = {};
    async function fetchAndDisplay() {
      const res = await fetch(`https://developer.trimet.org/ws/v2/vehicles?route=${routeNumber}&appID=${apiKey}&json=true`);
      const data = await res.json();
      const buses = (data.resultSet.vehicle || []).filter(v => v.routeNumber == routeNumber && v.direction == direction);

      Object.values(busMarkers).forEach(m => map.removeLayer(m));
      busMarkers = {};
      if (!buses.length) return;

      buses.forEach(bus => {
        if (!bus.latitude || !bus.longitude || !bus.blockID) return;
        const icon = L.divIcon({    
           className: '',
	   html: `
            <div style="text-align:center;">
              <div style="background:#0071CE;color:#fff;padding:2px 6px;border-radius:6px;font-weight:bold;">${bus.vehicleID}</div>
              <div style="width:0;height:0;border-left:5px solid transparent;border-right:5px solid transparent;border-top:10px solid #00bfff;margin:auto;"></div>
            </div>
          `,
          iconSize: [40, 30], iconAnchor: [20, 30]
        });
        const marker = L.marker([bus.latitude, bus.longitude], { icon }).addTo(map);
        busMarkers[bus.vehicleID] = marker;
      });
    }
    fetchAndDisplay();
    setInterval(fetchAndDisplay, 15000);
  </script>

  <footer class="site-footer">
    <a href="terms.html">Terms of Use</a> &nbsp;|&nbsp;
    <a href="contact.html">Contact Us</a> &nbsp;|&nbsp;
    <a href="report.html">Report a Problem</a> &nbsp;|&nbsp;
    <a href="privacy.html">Privacy Policy</a>
  </footer>

  <script>
    if (!localStorage.getItem('cookieConsent')) {
      document.write(`
        <div id="cookie-banner" style="position: fixed; bottom: 0; left: 0; right: 0; background: #333; color: #fff; padding: 1rem; z-index: 1000; font-size: 0.9rem; line-height: 1.4; text-align: center; box-sizing: border-box;">
          üì¢ We use cookies to improve functionality and analyze traffic.
          By using MetroFeed, you agree to our 
          <a href='privacy.html' style='color: #4dd0e1; text-decoration: underline;'>Privacy Policy</a>.<br>
          <button onclick='localStorage.setItem("cookieConsent", "true"); document.getElementById("cookie-banner").remove();' style='margin-top: 0.5rem; background: #4dd0e1; color: #000; border: none; padding: 0.5rem 1rem; border-radius: 5px; cursor: pointer; font-weight: bold;'>OK</button>
        </div>
      `);
    }
  </script>
</body>
</html>