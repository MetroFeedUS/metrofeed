<!DOCTYPE html>
<html lang="en">
<head>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-EL337T4JX4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-EL337T4JX4');
</script>

<meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Route 164 - Direction 1 | MetroFeed Portland</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', sans-serif;
      background-color: #0d0d0d;
      color: #cccccc;
      overflow-y: auto;
    }

    body {
      padding-top: 120px;
    }

    .ad-banner {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      background: #222;
      padding: 0;
      z-index: 1000;
      box-shadow: 0 2px 2px rgba(0,0,0,0.5);
      text-align: center;
    }

    .ad-banner img {
      width: 100%;
      max-width: 728px;
      max-height: 120px;
      display: block;
      margin: 0 auto;
    }
    .home-button {
      position: fixed;
      top: 120px;
      left: 10px;
      background-color: #4dd0e1;
      color: #0d0d0d;
      padding: 0.5rem 1rem;
      font-weight: bold;
      border-radius: 8px;
      text-decoration: none;
      z-index: 1001;
      box-shadow: 0 0 10px #4dd0e1;
    }

    .home-button:hover {
      background-color: #00bcd4;
      color: #ffffff;
    }

    header {
      background-color: #0d0d0d;
      border-top: 4px solid #4dd0e1;
      border-bottom: 3px solid #4dd0e1;
      padding: 1rem;
      text-align: center;
    }

    header img {
      max-height: 60px;
    }

    h1 {
      text-align: center;
      margin: 1rem 0;
      font-size: 2rem;
      color: #f0f0f0;
    }

    .content-box {
      border-radius: 12px;
      padding: 0;
      margin: 0;
      background-color: #1e1e1e;
    }

    #map {
      width: 100%;
      height: 85vh;
      border: none;
      margin: 0 auto;
      display: block;
      border-radius: 8px;
    }

    .button-bar {
      display: flex;
      justify-content: center;
      margin: 1rem 0;
    }

    .button-bar a, .back-button {
      background: #4dd0e1;
      color: #0d0d0d;
      padding: 0.6rem 1.2rem;
      text-decoration: none;
      border-radius: 8px;
      font-weight: bold;
      border: none;
      cursor: pointer;
      box-shadow: 0 0 10px #4dd0e1;
    }

    .back-button:hover {
      background-color: #35c0d6;
    }

    .site-footer {
      text-align: center;
      margin-top: 3rem;
      margin-bottom: 120px;
      font-size: 0.85rem;
      color: #aaa;
    }

    .site-footer a {
      color: #00BFFF;
      text-decoration: none;
    }

    .site-footer a:hover {
      text-decoration: underline;
    }

    @media (max-width: 600px) {
      .ad-banner {
        padding-top: 1rem;
        padding-bottom: 0rem;
      }
    }
  </style>
</head>

<body>
  <div class="ad-banner">
    <iframe src="https://metrofeedus.com/portland/Ads/route-164-dir1-ad.html" style="border:none; width:100%; max-width: 728px; height:90px;"></iframe>
  </div>

  <header>
    <img src="MetroFeedPortlandLogo.png" alt="MetroFeed Portland">
  </header>

  <div class="disclaimer" style="margin: 1rem auto 0.5rem; max-width: 600px; font-size: 0.8rem; color: #bbb; text-align: center; padding: 0.5rem 1rem; background-color: #111; border: 1px dashed #444; border-radius: 6px;">
    ⚠️ This is a Beta program, work in progress. Please REPORT bugs and pretend to be impressed.
  </div>
  <div class="disclaimer" style="margin: 0 auto 1rem; max-width: 600px; font-size: 0.75rem; color: #888; text-align: center; padding: 0.25rem 1rem;">
    This tool is not affiliated with or endorsed by TriMet. For official schedules and service alerts, visit <a href="https://trimet.org" style="color:#4dd0e1;">trimet.org</a>.
  </div>

  <div style="margin: 2rem 0; text-align: center;">
    <button class="back-button" onclick="history.back()">Back</button>
  </div>

  <h1>Route 164 - Direction 1</h1>

  <div class="content-box">
    <div id="map"></div>
    <div style="text-align:right; font-size: 0.7rem; color: #777; margin-top: 0.5rem;">
      Data courtesy of TriMet.
    </div>
  </div>

  <script>
    if (document.referrer === "" && performance.navigation.type === 0) {
      window.location.href = "/index.html";
    }

    const apiKey = "2C4447D4A42083BCD84DE3B8E";
    const routeNumber = 164;
    const direction = parseInt(1);

    const map = L.map('map', {
      center: [45.6, -122.7],
      zoom: 12,
      minZoom: 12,
      maxZoom: 18,
      maxBounds: [[45.3, -123.1], [45.9, -122.3]],
      maxBoundsViscosity: 1.0
    });
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { maxZoom: 19 }).addTo(map);

    const shapeOutbound = [
  [45.512983, -122.681928],
  [45.513081, -122.681866],
  [45.513748, -122.681504],
  [45.514414, -122.68114399999999],
  [45.514898099310585, -122.68088159782114],
  [45.51489809788404, -122.6808815985944],
  [45.51508, -122.680783],
  [45.515742, -122.68042499999999],
  [45.516406, -122.68005899999999],
  [45.51708, -122.67969899999999],
  [45.517746, -122.67933799999999],
  [45.518224927031525, -122.67906901358502],
  [45.518224924373044, -122.67906901507816],
  [45.518403, -122.678969],
  [45.519078, -122.67861399999998],
  [45.519747, -122.678276],
  [45.520412, -122.677891],
  [45.521078, -122.677531],
  [45.521552068882016, -122.67727350722926],
  [45.5215520728847, -122.67727350505515],
  [45.52175, -122.67716599999999],
  [45.5224, -122.67682],
  [45.522606, -122.677606],
  [45.522622, -122.677787],
  [45.522717, -122.67768199999999],
  [45.522774, -122.67761999999999],
  [45.522825, -122.677572],
  [45.5229, -122.67751099999998],
  [45.522959, -122.677471],
  [45.523004, -122.67744399999998],
  [45.523047, -122.677425],
  [45.523762, -122.677477],
  [45.524474, -122.67750799999999],
  [45.525188, -122.67753],
  [45.525901, -122.67755599999998],
  [45.526613, -122.67758299999998],
  [45.527326, -122.67760899999999],
  [45.528041, -122.677623],
  [45.528747, -122.677658],
  [45.529606, -122.677687],
  [45.529735, -122.677673],
  [45.529897, -122.677648],
  [45.530701, -122.67624099999999],
  [45.531968, -122.673959],
  [45.532954, -122.672195],
  [45.533019, -122.67208699999999],
  [45.533116, -122.67191099999998],
  [45.533341, -122.67146999999999],
  [45.533496, -122.67121],
  [45.533513, -122.671023],
  [45.533894, -122.670337],
  [45.534261, -122.669693],
  [45.534288, -122.669628],
  [45.534322, -122.66952399999998],
  [45.534344, -122.669435],
  [45.534354, -122.66939299999999],
  [45.534374, -122.66918599999998],
  [45.534373, -122.669056],
  [45.534371, -122.66876899999998],
  [45.534362, -122.668277],
  [45.534363, -122.66775999999999],
  [45.53437, -122.66673699999998],
  [45.53481, -122.666767],
  [45.5351, -122.66676],
  [45.535439, -122.666749],
  [45.535706, -122.666923],
  [45.535941, -122.66711699999999],
  [45.536615, -122.66773899999998],
  [45.537635, -122.668729],
  [45.538128, -122.6692],
  [45.538434, -122.66951099999999],
  [45.538658, -122.669763],
  [45.541028, -122.67171299999998],
  [45.541924, -122.672811],
  [45.542348, -122.67333899999998],
  [45.542831, -122.67394099999999],
  [45.543499, -122.67469599999998],
  [45.54374, -122.675025],
  [45.543932, -122.67524799999998],
  [45.544075, -122.67545799999999],
  [45.544346, -122.67580999999998],
  [45.544712, -122.676288],
  [45.545236, -122.67683699999999],
  [45.545561, -122.67722599999999],
  [45.545705, -122.677394],
  [45.54591, -122.677614],
  [45.546089, -122.67778599999998],
  [45.546331, -122.67799499999998],
  [45.546571, -122.67816099999999],
  [45.546838, -122.67831399999999],
  [45.547121, -122.67843999999998],
  [45.547531, -122.67856499999999],
  [45.547874, -122.67861399999998],
  [45.548037, -122.678584],
  [45.548757, -122.678588],
  [45.550943, -122.678563],
  [45.55098009713038, -122.67856258265726],
  [45.55098009711037, -122.67856258265752],
  [45.552543, -122.678545],
  [45.55314, -122.67856100000002],
  [45.554637, -122.678539],
  [45.556022, -122.678529],
  [45.556099, -122.67853100000002],
  [45.556407, -122.678532],
  [45.557646, -122.678509],
  [45.559003, -122.678484],
  [45.560911, -122.678479],
  [45.562665, -122.67853500000001],
  [45.563978, -122.678555],
  [45.566396, -122.678514],
  [45.567219, -122.678519],
  [45.569914, -122.678546],
  [45.572531, -122.67858900000002],
  [45.573019, -122.67857],
  [45.574749, -122.67856600000002],
  [45.577186764629914, -122.67850179631242],
  [45.577186764629914, -122.67850179631242],
  [45.577217, -122.678501],
  [45.577222, -122.678501],
  [45.577942, -122.678539],
  [45.580432, -122.678484],
  [45.581176, -122.678508],
  [45.58184, -122.67851500000002],
  [45.582552, -122.67859400000002],
  [45.582952, -122.67867],
  [45.583223, -122.678749],
  [45.583252, -122.67875800000002],
  [45.583734, -122.67891500000002],
  [45.584135, -122.679051],
  [45.584144, -122.67905400000001],
  [45.584238, -122.679096],
  [45.584929, -122.67942],
  [45.587747, -122.680748],
  [45.587761, -122.68075500000002],
  [45.588726, -122.68119500000002],
  [45.589534, -122.68155900000001],
  [45.590623, -122.682039],
  [45.591455, -122.68241700000002],
  [45.59318, -122.683185],
  [45.594939, -122.68397],
  [45.595473, -122.68415800000001],
  [45.595899, -122.684279],
  [45.596453, -122.684385],
  [45.597247, -122.684438],
  [45.598046, -122.684375],
  [45.598966, -122.684167],
  [45.59975, -122.683929],
  [45.601253, -122.68347000000001],
  [45.603363, -122.68288000000001],
  [45.604067, -122.682685],
  [45.605107, -122.682365],
  [45.605575, -122.682168],
  [45.60562, -122.68214900000001],
  [45.605627, -122.68214600000002],
  [45.605718, -122.682112],
  [45.605885, -122.682032],
  [45.606727, -122.681697],
  [45.607242, -122.68147100000002],
  [45.608853, -122.680516],
  [45.609845, -122.67991700000002],
  [45.610301, -122.679681],
  [45.611973, -122.678737],
  [45.61292, -122.678159],
  [45.612951, -122.67813000000001],
  [45.612957, -122.67812800000002],
  [45.612982, -122.67812100000002],
  [45.613133, -122.67803200000002],
  [45.613146, -122.67802500000002],
  [45.618363, -122.67496000000001],
  [45.619504, -122.674281],
  [45.620771, -122.673507],
  [45.62144496783171, -122.67307811137982],
  [45.621444970907646, -122.6730781094224],
  [45.621464, -122.673066],
  [45.621584, -122.67298599999998],
  [45.621668, -122.672926],
  [45.621711, -122.672895],
  [45.621979, -122.67256599999999],
  [45.622069, -122.672466],
  [45.622146, -122.67238199999998],
  [45.622218, -122.672301],
  [45.62228, -122.672223],
  [45.62234, -122.672151],
  [45.622412, -122.67205699999998],
  [45.622494, -122.67191499999998],
  [45.622549, -122.671796],
  [45.622605, -122.67164399999999],
  [45.62264, -122.67148299999998],
  [45.622665, -122.671319],
  [45.622674, -122.67115399999999],
  [45.622674, -122.67100399999998],
  [45.62266, -122.670862],
  [45.622642, -122.67074],
  [45.622611, -122.670613],
  [45.622566, -122.67048199999999],
  [45.622519, -122.670362],
  [45.622464, -122.67024899999998],
  [45.622113, -122.669557],
  [45.621413, -122.66826499999999],
  [45.62099, -122.667417],
  [45.620787, -122.66702699999999],
  [45.620522, -122.66646],
  [45.620312, -122.66599499999998],
  [45.620018, -122.665205],
  [45.619773, -122.66448599999998],
  [45.619664, -122.66408599999998],
  [45.619439, -122.66312199999999],
  [45.618913, -122.66042099999999],
  [45.618777, -122.659713],
  [45.618698, -122.659243],
  [45.618486, -122.657351],
  [45.618408, -122.65632199999999],
  [45.618366, -122.65509299999998],
  [45.618355, -122.653595],
  [45.618372, -122.65231199999998],
  [45.618374, -122.652102],
  [45.618378, -122.651745],
  [45.61838, -122.651626],
  [45.618381, -122.65151199999998],
  [45.618386, -122.65087999999999],
  [45.618391, -122.64966],
  [45.618429, -122.64673099999999],
  [45.618524, -122.642609],
  [45.618534, -122.641963],
  [45.618548, -122.64049899999999],
  [45.618541, -122.638173],
  [45.618515, -122.63548499999999],
  [45.618512, -122.633618],
  [45.618567, -122.628893],
  [45.618548, -122.62772199999999],
  [45.618517, -122.626989],
  [45.618474, -122.62636099999999],
  [45.618416, -122.62567099999998],
  [45.618287, -122.624685],
  [45.618189, -122.62390999999998],
  [45.618015, -122.62275199999999],
  [45.617887, -122.622082],
  [45.617741, -122.621401],
  [45.617537, -122.620527],
  [45.617391, -122.620011],
  [45.617277, -122.61960899999998],
  [45.616994, -122.618657],
  [45.616646, -122.61753199999998],
  [45.616305, -122.616452],
  [45.61558, -122.614162],
  [45.615439, -122.61366499999998],
  [45.615321, -122.61312599999998],
  [45.615267, -122.61278899999999],
  [45.615206, -122.612339],
  [45.615162, -122.611956],
  [45.615134, -122.61110399999998],
  [45.61514, -122.610107],
  [45.61513, -122.609652],
  [45.615106, -122.609232],
  [45.61508, -122.60883299999999],
  [45.615047, -122.60850499999998],
  [45.614981, -122.60808699999998],
  [45.6149, -122.60753799999999],
  [45.614808, -122.60706499999999],
  [45.614673, -122.606493],
  [45.614485, -122.605702],
  [45.61428, -122.60490399999999],
  [45.613746, -122.602717],
  [45.613679, -122.602445],
  [45.613584, -122.60207799999999],
  [45.613508, -122.60178199999999],
  [45.613378, -122.60124199999998],
  [45.613243, -122.60066199999999],
  [45.613167, -122.60024499999999],
  [45.613099, -122.59983299999999],
  [45.613038, -122.59942],
  [45.612981, -122.59892799999999],
  [45.6129, -122.598078],
  [45.612808, -122.597034],
  [45.612711, -122.595923],
  [45.612627, -122.59493099999999],
  [45.612537, -122.59394199999998],
  [45.612443, -122.59294799999999],
  [45.612289, -122.59176299999999],
  [45.612142, -122.590847],
  [45.611897, -122.589546],
  [45.611852, -122.589311],
  [45.611788, -122.589006],
  [45.611461, -122.587427],
  [45.611083, -122.58567699999999],
  [45.610687, -122.583688],
  [45.610216, -122.58138999999998],
  [45.61001, -122.580376],
  [45.609608, -122.578497],
  [45.609435, -122.577658],
  [45.609093, -122.57598599999999],
  [45.608675, -122.57395999999999],
  [45.608296, -122.572187],
  [45.608103, -122.57122199999999],
  [45.607689, -122.569233],
  [45.607305, -122.56742499999999],
  [45.607184, -122.566888],
  [45.606652, -122.564392],
  [45.606393, -122.56321899999999],
  [45.605998, -122.56141],
  [45.605986, -122.56131599999999],
  [45.605355, -122.558338],
  [45.604889, -122.55631399999999],
  [45.604857, -122.55617199999999],
  [45.604829, -122.55603999999998],
  [45.603828, -122.55183199999999],
  [45.603783, -122.55164799999999],
  [45.603759, -122.551525],
  [45.603754, -122.55149799999998],
  [45.603725, -122.551354],
  [45.603695, -122.55120999999998],
  [45.603035, -122.54849799999998],
  [45.602966, -122.54846399999998],
  [45.602864, -122.548403],
  [45.602774, -122.54834299999999],
  [45.602742, -122.548322],
  [45.602646, -122.548212],
  [45.602584, -122.54813599999999],
  [45.602505, -122.54801599999999],
  [45.602432, -122.54788999999998],
  [45.602364, -122.547772],
  [45.602277, -122.547557],
  [45.602208, -122.54733599999999],
  [45.602153, -122.547105],
  [45.602115, -122.54682199999999],
  [45.60207, -122.54625099999998],
  [45.602046, -122.545689],
  [45.602013557833615, -122.5453309564546],
  [45.602013557833615, -122.5453309564546],
  [45.601991, -122.545082],
  [45.60194, -122.54468099999998],
  [45.601777, -122.543736],
  [45.601313, -122.54160599999999],
  [45.600866, -122.53960399999998],
  [45.600183, -122.53667799999998],
  [45.599265, -122.532841],
  [45.598165, -122.528178],
  [45.597888, -122.526974],
  [45.597503, -122.52535799999998],
  [45.597086, -122.52370499999999],
  [45.596289, -122.5208],
  [45.595032, -122.516138],
  [45.594584376267385, -122.514561343145],
  [45.594584374822425, -122.51456133805547],
  [45.594471, -122.514162],
  [45.593776, -122.51155200000001],
  [45.593369, -122.51042100000001],
  [45.592578, -122.50789600000002],
  [45.59247, -122.507538],
  [45.592315, -122.507132],
  [45.591996, -122.50645300000001],
  [45.591342, -122.505113],
  [45.591217, -122.504787],
  [45.591158, -122.504517],
  [45.591137, -122.50420900000002],
  [45.591147, -122.50380400000002],
  [45.591667, -122.503849],
  [45.591726, -122.503848],
  [45.591786, -122.503848],
  [45.592182, -122.503871],
  [45.594216, -122.50386700000001],
  [45.594207, -122.504311],
  [45.594203, -122.504374],
  [45.594194, -122.50441900000001],
  [45.59418, -122.504465],
  [45.594163, -122.504503],
  [45.594145, -122.50454800000001],
  [45.594105, -122.50465],
  [45.594096, -122.504681],
  [45.59409, -122.504713],
  [45.594089, -122.504747],
  [45.594091, -122.50478],
  [45.594097, -122.50480600000002],
  [45.594133, -122.504891],
  [45.594368, -122.50542800000001],
  [45.59458026789611, -122.50595065963098]
];

const stopNames = {
  "5002": "SW 5th &amp; Morrison",
  "5005": "SW 5th &amp; Madison",
  "5008": "SW 5th &amp; Harrison",
  "6213": "SW 6th &amp; Oak",
  "6212": "SW 6th &amp; Yamhill",
  "9008": "Fisher&#x27;s Landing Transit Center: Bay I",
  "6001": "SW 6th &amp; Market",
  "6211": "SW 6th &amp; Jefferson"
};

const stops = [
  { stop_id: "6001", name: "SW 6th &amp; Market", lat: 45.512943, lon: -122.681811, times: ["12:30 PM", "1:30 PM", "2:30 PM", "3:00 PM", "3:30 PM", "3:50 PM", "4:10 PM", "4:30 PM"] },
  { stop_id: "6211", name: "SW 6th &amp; Jefferson", lat: 45.514866, lon: -122.680761, times: ["12:31 PM", "1:31 PM", "2:31 PM", "3:01 PM", "3:31 PM", "3:51 PM", "4:11 PM", "4:31 PM"] },
  { stop_id: "6212", name: "SW 6th &amp; Yamhill", lat: 45.518199, lon: -122.678975, times: ["12:33 PM", "1:33 PM", "2:33 PM", "3:03 PM", "3:33 PM", "3:53 PM", "4:13 PM", "4:33 PM"] },
  { stop_id: "6213", name: "SW 6th &amp; Oak", lat: 45.521525, lon: -122.677172, times: ["12:35 PM", "1:35 PM", "2:35 PM", "3:05 PM", "3:35 PM", "3:55 PM", "4:15 PM", "4:35 PM"] },
  { stop_id: "9008", name: "Fisher&#x27;s Landing Transit Center: Bay I", lat: 45.594627, lon: -122.505912, times: ["6:16 AM", "7:10 AM", "7:54 AM", "9:00 AM", "9:53 AM", "10:50 AM", "11:50 AM", "1:07 PM"] },
  { stop_id: "5002", name: "SW 5th &amp; Morrison", lat: 45.518932, lon: -122.677571, times: ["5:50 AM", "6:42 AM", "7:26 AM", "8:32 AM", "9:25 AM", "10:22 AM", "11:22 AM"] },
  { stop_id: "5005", name: "SW 5th &amp; Madison", lat: 45.515682, lon: -122.679352, times: ["5:51 AM", "6:43 AM", "7:27 AM", "8:33 AM", "9:26 AM", "10:23 AM", "11:23 AM"] },
  { stop_id: "5008", name: "SW 5th &amp; Harrison", lat: 45.510939, lon: -122.681923, times: ["5:53 AM", "6:46 AM", "7:30 AM", "8:36 AM", "9:29 AM", "10:26 AM", "11:26 AM"] },
]

    const polylineOut = L.polyline(shapeOutbound, { color: 'blue', weight: 4, opacity: 0.7 }).addTo(map);
    map.fitBounds(polylineOut.getBounds());

    const nowPT = new Date(new Date().toLocaleString('en-US', { timeZone: 'America/Los_Angeles' }));
    const nowMins = nowPT.getHours() * 60 + nowPT.getMinutes();

    stops.forEach(stop => {
      let highlightedTimes = [];
      let foundNext = false;
      stop.times.forEach(timeStr => {
        let cleanTime = timeStr.trim();
        let [h, m] = cleanTime.split(":");
        let schedMins = parseInt(h, 10) * 60 + parseInt(m, 10);
        if (schedMins < nowMins && nowMins - schedMins > 720) {
          schedMins += 1440;
        }
        if (!foundNext && schedMins >= nowMins) {
          highlightedTimes.push(`<span style="background:#4dd0e1; color:#000; padding:2px 6px; border-radius:6px; font-weight:bold;">${cleanTime}</span>`);
          foundNext = true;
        } else {
          highlightedTimes.push(cleanTime);
        }
      });

      L.circleMarker([stop.lat, stop.lon], {
        radius: 6,
        color: '#4dd0e1',
        fillColor: '#4dd0e1',
        fillOpacity: 0.9,
        weight: 1
      })
      .bindPopup(`<strong>${stop.name}</strong><br>${highlightedTimes.join("<br>") || 'No scheduled times'}`)
      .addTo(map);
    });

    let busMarkers = {};
    async function fetchAndDisplay() {
      const res = await fetch(`https://developer.trimet.org/ws/v2/vehicles?route=${routeNumber}&appID=${apiKey}&json=true`);
      const data = await res.json();
      const buses = (data.resultSet.vehicle || []).filter(v => v.routeNumber == routeNumber && v.direction == direction);

      Object.values(busMarkers).forEach(m => map.removeLayer(m));
      busMarkers = {};
      if (!buses.length) return;

      buses.forEach(bus => {
        if (!bus.latitude || !bus.longitude || !bus.blockID) return;
        const icon = L.divIcon({    
           className: '',
           html: `
            <div style="text-align:center;">
              <div style="background:#0071CE;color:#fff;padding:2px 6px;border-radius:6px;font-weight:bold;">${bus.vehicleID}</div>
              <div style="width:0;height:0;border-left:5px solid transparent;border-right:5px solid transparent;border-top:10px solid #00bfff;margin:auto;"></div>
            </div>
          `,
          iconSize: [40, 30], iconAnchor: [20, 30]
        });
        const marker = L.marker([bus.latitude, bus.longitude], { icon }).addTo(map);
        busMarkers[bus.vehicleID] = marker;
      });
    }
    fetchAndDisplay();
    setInterval(fetchAndDisplay, 15000);
  </script>

  <footer class="site-footer">
    <a href="terms.html">Terms of Use</a> &nbsp;|&nbsp;
    <a href="contact.html">Contact Us</a> &nbsp;|&nbsp;
    <a href="report.html">Report a Problem</a> &nbsp;|&nbsp;
    <a href="dmca.html">DMCA</a> &nbsp;|&nbsp;
    <a href="privacy.html">Privacy Policy</a>
  </footer>

  <script>
    if (!localStorage.getItem('cookieConsent')) {
      document.write(`
        <div id="cookie-banner" style="position: fixed; bottom: 0; left: 0; right: 0; background: #333; color: #fff; padding: 1rem; z-index: 1000; font-size: 0.9rem; line-height: 1.4; text-align: center; box-sizing: border-box;">
          📢 We use cookies to improve functionality and analyze traffic.
          By using MetroFeed, you agree to our 
          <a href='privacy.html' style='color: #4dd0e1; text-decoration: underline;'>Privacy Policy</a>.<br>
          <button onclick='localStorage.setItem("cookieConsent", "true"); document.getElementById("cookie-banner").remove();' style='margin-top: 0.5rem; background: #4dd0e1; color: #000; border: none; padding: 0.5rem 1rem; border-radius: 5px; cursor: pointer; font-weight: bold;'>OK</button>
        </div>
      `);
    }
  </script>
</body>
</html>