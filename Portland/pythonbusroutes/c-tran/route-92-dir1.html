<!DOCTYPE html>
<html lang="en">
<head>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-EL337T4JX4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-EL337T4JX4');
</script>

<meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Route 92 - Direction 1 | MetroFeed Portland</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', sans-serif;
      background-color: #0d0d0d;
      color: #cccccc;
      overflow-y: auto;
    }

    body {
      padding-top: 120px;
    }

    .ad-banner {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      background: #222;
      padding: 0;
      z-index: 1000;
      box-shadow: 0 2px 2px rgba(0,0,0,0.5);
      text-align: center;
    }

    .ad-banner img {
      width: 100%;
      max-width: 728px;
      max-height: 120px;
      display: block;
      margin: 0 auto;
    }
    .home-button {
      position: fixed;
      top: 120px;
      left: 10px;
      background-color: #4dd0e1;
      color: #0d0d0d;
      padding: 0.5rem 1rem;
      font-weight: bold;
      border-radius: 8px;
      text-decoration: none;
      z-index: 1001;
      box-shadow: 0 0 10px #4dd0e1;
    }

    .home-button:hover {
      background-color: #00bcd4;
      color: #ffffff;
    }

    header {
      background-color: #0d0d0d;
      border-top: 4px solid #4dd0e1;
      border-bottom: 3px solid #4dd0e1;
      padding: 1rem;
      text-align: center;
    }

    header img {
      max-height: 60px;
    }

    h1 {
      text-align: center;
      margin: 1rem 0;
      font-size: 2rem;
      color: #f0f0f0;
    }

    .content-box {
      border-radius: 12px;
      padding: 0;
      margin: 0;
      background-color: #1e1e1e;
    }

    #map {
      width: 100%;
      height: 85vh;
      border: none;
      margin: 0 auto;
      display: block;
      border-radius: 8px;
    }

    .button-bar {
      display: flex;
      justify-content: center;
      margin: 1rem 0;
    }

    .button-bar a, .back-button {
      background: #4dd0e1;
      color: #0d0d0d;
      padding: 0.6rem 1.2rem;
      text-decoration: none;
      border-radius: 8px;
      font-weight: bold;
      border: none;
      cursor: pointer;
      box-shadow: 0 0 10px #4dd0e1;
    }

    .back-button:hover {
      background-color: #35c0d6;
    }

    .site-footer {
      text-align: center;
      margin-top: 3rem;
      margin-bottom: 120px;
      font-size: 0.85rem;
      color: #aaa;
    }

    .site-footer a {
      color: #00BFFF;
      text-decoration: none;
    }

    .site-footer a:hover {
      text-decoration: underline;
    }

    @media (max-width: 600px) {
      .ad-banner {
        padding-top: 1rem;
        padding-bottom: 0rem;
      }
    }
  </style>
</head>

<body>
  <div class="ad-banner">
    <iframe src="https://metrofeedus.com/portland/Ads/route-92-dir1-ad.html" style="border:none; width:100%; max-width: 728px; height:90px;"></iframe>
  </div>

  <header>
    <img src="MetroFeedPortlandLogo.png" alt="MetroFeed Portland">
  </header>

  <div class="disclaimer" style="margin: 1rem auto 0.5rem; max-width: 600px; font-size: 0.8rem; color: #bbb; text-align: center; padding: 0.5rem 1rem; background-color: #111; border: 1px dashed #444; border-radius: 6px;">
    ‚ö†Ô∏è This is a Beta program, work in progress. Please REPORT bugs and pretend to be impressed.
  </div>
  <div class="disclaimer" style="margin: 0 auto 1rem; max-width: 600px; font-size: 0.75rem; color: #888; text-align: center; padding: 0.25rem 1rem;">
    This tool is not affiliated with or endorsed by TriMet. For official schedules and service alerts, visit <a href="https://trimet.org" style="color:#4dd0e1;">trimet.org</a>.
  </div>

  <div style="margin: 2rem 0; text-align: center;">
    <button class="back-button" onclick="history.back()">Back</button>
  </div>

  <h1>Route 92 - Direction 1</h1>

  <div class="content-box">
    <div id="map"></div>
    <div style="text-align:right; font-size: 0.7rem; color: #777; margin-top: 0.5rem;">
      Data courtesy of TriMet.
    </div>
  </div>

  <script>
    if (document.referrer === "" && performance.navigation.type === 0) {
      window.location.href = "/index.html";
    }

    const apiKey = "2C4447D4A42083BCD84DE3B8E";
    const routeNumber = 92;
    const direction = parseInt(1);

    const map = L.map('map', {
      center: [45.6, -122.7],
      zoom: 12,
      minZoom: 12,
      maxZoom: 18,
      maxBounds: [[45.3, -123.1], [45.9, -122.3]],
      maxBoundsViscosity: 1.0
    });
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { maxZoom: 19 }).addTo(map);

    const shapeOutbound = [
  [45.617415618372775, -122.48362265349098],
  [45.617323, -122.484621],
  [45.617127, -122.484618],
  [45.616706, -122.484624],
  [45.616583, -122.48461999999999],
  [45.616485, -122.484602],
  [45.616366, -122.484561],
  [45.616244, -122.484501],
  [45.616139, -122.484431],
  [45.616021, -122.48433099999998],
  [45.61595, -122.48426899999998],
  [45.615882, -122.484226],
  [45.615792, -122.48418599999998],
  [45.615679, -122.48414699999998],
  [45.615526, -122.484107],
  [45.615341, -122.484075],
  [45.615346, -122.48390299999998],
  [45.615357, -122.48371099999999],
  [45.615384, -122.48344099999998],
  [45.615416, -122.483198],
  [45.615444, -122.483029],
  [45.615498, -122.48274299999999],
  [45.615547, -122.482509],
  [45.615593, -122.48233299999998],
  [45.615639, -122.482172],
  [45.6157, -122.48196899999999],
  [45.615781, -122.48171499999998],
  [45.615868, -122.48147499999999],
  [45.615993, -122.48117999999998],
  [45.616029, -122.48110199999999],
  [45.616172, -122.480814],
  [45.616286, -122.48056299999999],
  [45.616408, -122.48028999999998],
  [45.616497, -122.48007399999999],
  [45.616563, -122.47991099999999],
  [45.616606, -122.47979],
  [45.616644, -122.47966999999998],
  [45.61668, -122.47955299999998],
  [45.616723, -122.47938499999998],
  [45.616755, -122.479243],
  [45.61677938410824, -122.47912772967017],
  [45.616779384349414, -122.47912772853003],
  [45.616788, -122.479087],
  [45.616821, -122.478921],
  [45.616842, -122.47879100000002],
  [45.616899, -122.478409],
  [45.616906, -122.4783],
  [45.616928, -122.47804999999998],
  [45.616941, -122.477785],
  [45.616946, -122.47763000000002],
  [45.616947, -122.477489],
  [45.616948, -122.477303],
  [45.616944, -122.47599700000002],
  [45.616180706632804, -122.47598676818546],
  [45.61618070662189, -122.4759867681853],
  [45.614706, -122.475967],
  [45.61287, -122.475966],
  [45.611731, -122.47594599999998],
  [45.610044, -122.475919],
  [45.60958170332742, -122.47591477296551],
  [45.609581703500226, -122.47591477296712],
  [45.606763, -122.47588900000001],
  [45.606392073280404, -122.47589819653024],
  [45.60639207305485, -122.47589819653581],
  [45.605916, -122.47591],
  [45.605898, -122.47590799999999],
  [45.605089, -122.47589799999999],
  [45.60431, -122.47587399999999],
  [45.603907, -122.475864],
  [45.603789, -122.475876],
  [45.603594, -122.475902],
  [45.603351, -122.475966],
  [45.60309, -122.476083],
  [45.602964, -122.47614099999998],
  [45.602372, -122.47653599999998],
  [45.60144, -122.477241],
  [45.600782, -122.47771699999998],
  [45.600575, -122.477873],
  [45.600351, -122.477983],
  [45.60034, -122.477989],
  [45.600319, -122.477999],
  [45.600054, -122.478094],
  [45.599802, -122.47815799999998],
  [45.599585, -122.47819199999999],
  [45.599275, -122.47820499999999],
  [45.598431, -122.47818],
  [45.598162693244376, -122.4781751364334],
  [45.598162693748236, -122.47817513644253],
  [45.597438, -122.47816199999998],
  [45.5967, -122.47814799999999],
  [45.595901, -122.47815199999998],
  [45.595727, -122.47815299999999],
  [45.59525, -122.47814299999999],
  [45.594927, -122.47815199999998],
  [45.594623, -122.47815299999999],
  [45.594404, -122.478135],
  [45.594234, -122.47810299999999],
  [45.594189, -122.47807899999998],
  [45.59409, -122.478023],
  [45.593897, -122.477917],
  [45.59375846336758, -122.47780676021164],
  [45.593758469962864, -122.4778067654598],
  [45.593662, -122.47773],
  [45.59356, -122.477633],
  [45.593451, -122.477512],
  [45.593331, -122.477333],
  [45.592754, -122.476246],
  [45.592605, -122.476002],
  [45.592427, -122.475758],
  [45.59229, -122.475634],
  [45.592222, -122.47558599999999],
  [45.592111, -122.475508],
  [45.591932, -122.47540399999998],
  [45.59182, -122.47534899999998],
  [45.59171, -122.475315],
  [45.591432, -122.475285],
  [45.590972, -122.475249],
  [45.590706, -122.47524],
  [45.590428, -122.47519],
  [45.590202, -122.475102],
  [45.589911, -122.474953],
  [45.589524, -122.47470599999998],
  [45.588998, -122.474316],
  [45.588615, -122.47403199999998],
  [45.588108, -122.473699],
  [45.587771, -122.473503],
  [45.587483, -122.473396],
  [45.58719, -122.473325],
  [45.587015, -122.473301],
  [45.586873, -122.473266],
  [45.58656, -122.473254],
  [45.586203, -122.4733],
  [45.585667, -122.473402],
  [45.585084, -122.473554],
  [45.58499, -122.473579],
  [45.584884, -122.473606],
  [45.584766, -122.47362899999999],
  [45.584541, -122.473672],
  [45.58453, -122.473538],
  [45.584516, -122.473357],
  [45.584505, -122.473113],
  [45.584487, -122.472716],
  [45.584413, -122.471187],
  [45.584301, -122.468738],
  [45.584267, -122.46846399999998],
  [45.584189, -122.467999],
  [45.584182, -122.467956],
  [45.584099, -122.467441],
  [45.583976, -122.46681499999998],
  [45.583861, -122.466328],
  [45.583723, -122.465709],
  [45.583559, -122.465125],
  [45.583409, -122.464585],
  [45.583266, -122.464124],
  [45.583049, -122.463402],
  [45.582562, -122.46182299999998],
  [45.582037, -122.460068],
  [45.581606, -122.45860399999998],
  [45.580964, -122.456533],
  [45.58087, -122.456216],
  [45.580527, -122.455053],
  [45.580128, -122.453563],
  [45.578835, -122.448186],
  [45.578749, -122.44777799999999],
  [45.578644, -122.447217],
  [45.578558, -122.44657300000001],
  [45.578489, -122.44588],
  [45.578458, -122.44522],
  [45.57845, -122.444444],
  [45.578491, -122.443588],
  [45.578538, -122.443111],
  [45.578627, -122.442382],
  [45.578726, -122.44181099999999],
  [45.57885, -122.441234],
  [45.580197, -122.435464],
  [45.580316, -122.434666],
  [45.580427, -122.433891],
  [45.580481, -122.433224],
  [45.580467, -122.432537],
  [45.580422, -122.431681],
  [45.580415, -122.431281],
  [45.580434, -122.430993],
  [45.580492, -122.43068699999999],
  [45.580572, -122.430411],
  [45.58065, -122.43020799999998],
  [45.580748, -122.429994],
  [45.580865, -122.42981000000002],
  [45.580946, -122.42967],
  [45.581258, -122.42910099999999],
  [45.581357, -122.428905],
  [45.581702, -122.42824799999998],
  [45.581794, -122.428044],
  [45.581856, -122.427882],
  [45.58191, -122.427749],
  [45.58196, -122.427618],
  [45.581996, -122.427506],
  [45.582035, -122.427366],
  [45.582078, -122.427233],
  [45.582142, -122.427075],
  [45.582083, -122.42703499999999],
  [45.582044, -122.426987],
  [45.582013, -122.426912],
  [45.582002, -122.426812],
  [45.582036, -122.42670299999999],
  [45.582075, -122.426633],
  [45.582138, -122.42659099999999],
  [45.582217, -122.426582],
  [45.58236454012672, -122.42583074976294],
  [45.58236454381953, -122.4258307309598],
  [45.582413, -122.42558400000001],
  [45.58259, -122.42474300000002],
  [45.582897, -122.42340100000001],
  [45.583148, -122.42226200000002],
  [45.583354, -122.42125400000002],
  [45.583455, -122.42084000000001],
  [45.583470849184934, -122.42077649164627],
  [45.583470848887174, -122.42077649283941],
  [45.583597, -122.420271],
  [45.583756, -122.419602],
  [45.584499, -122.415972],
  [45.584845, -122.414141],
  [45.585006, -122.41325],
  [45.585027, -122.41314700000001],
  [45.585062, -122.412888],
  [45.585081, -122.41271900000001],
  [45.58509024777605, -122.41263731131156],
  [45.585090247678195, -122.41263731217592],
  [45.585099, -122.41256000000001],
  [45.585108, -122.41237300000002],
  [45.585108, -122.41222800000001],
  [45.585105, -122.41205700000002],
  [45.585096, -122.411899],
  [45.585073, -122.411647],
  [45.585062, -122.41143300000002],
  [45.585039, -122.41115],
  [45.585027, -122.411008],
  [45.585015, -122.41079500000001],
  [45.584974, -122.41011000000002],
  [45.584974, -122.409998],
  [45.584979, -122.409906],
  [45.584984, -122.40981200000002],
  [45.585001, -122.409635],
  [45.585027, -122.409493],
  [45.585072, -122.409279],
  [45.585099, -122.4092],
  [45.58514, -122.409077],
  [45.585187, -122.408966],
  [45.585234, -122.408853],
  [45.585309, -122.4087],
  [45.585381, -122.40855200000001],
  [45.585469, -122.40838300000001],
  [45.585549, -122.40824000000002],
  [45.58562, -122.40809000000002],
  [45.585712, -122.40791200000001],
  [45.586025, -122.40731900000002],
  [45.586148, -122.40707100000002],
  [45.585546, -122.406454],
  [45.585486448616805, -122.40639002597523],
  [45.585486448199276, -122.40639002552669],
  [45.584967, -122.405832],
  [45.584465, -122.405296],
  [45.58437, -122.40519400000001],
  [45.58444, -122.405049],
  [45.584805, -122.404352],
  [45.585246, -122.40349900000001],
  [45.585684, -122.40266500000001],
  [45.586116, -122.40180600000001],
  [45.58642770024811, -122.40122406738602],
  [45.58642769965772, -122.40122406848825],
  [45.586567, -122.40096400000002],
  [45.587007, -122.400114],
  [45.587448, -122.39926800000002],
  [45.5879, -122.39842300000001],
  [45.588279150695655, -122.39766991627882],
  [45.58827914932671, -122.39766991899788],
  [45.588336, -122.39755700000002],
  [45.588414, -122.39738700000001],
  [45.588457, -122.39730000000002],
  [45.588485, -122.39723200000002],
  [45.588524, -122.39713500000002],
  [45.588553, -122.397043],
  [45.588578, -122.396958],
  [45.5886, -122.396861],
  [45.588619, -122.39675500000001],
  [45.588639, -122.39667000000001],
  [45.588653, -122.39657200000002],
  [45.588668, -122.39643600000001],
  [45.588681, -122.396316],
  [45.588696, -122.395984],
  [45.588726, -122.39529700000001],
  [45.58876747238256, -122.39453651765915],
  [45.58876747236737, -122.39453651793758],
  [45.588815, -122.393665],
  [45.588857, -122.39287400000002],
  [45.58887356234778, -122.39261985362901],
  [45.588873562344496, -122.39261985367922],
  [45.588886, -122.392429],
  [45.588898, -122.392041],
  [45.588897, -122.39176699999999],
  [45.588888, -122.391402],
  [45.588879, -122.391163],
  [45.588876, -122.39103600000001],
  [45.588818, -122.38994799999999],
  [45.58880021495881, -122.38963449505808],
  [45.58880021495993, -122.3896344950781],
  [45.588767, -122.389049],
  [45.588696, -122.388036],
  [45.58867063665353, -122.38764371357463],
  [45.588670636657234, -122.38764371363192],
  [45.588621, -122.386876],
  [45.58861, -122.38677000000001],
  [45.588528, -122.38579500000002],
  [45.588498, -122.38539000000002],
  [45.58848340995907, -122.38512968295396],
  [45.588483409962734, -122.38512968301929],
  [45.588479, -122.38505100000002],
  [45.588466, -122.38468],
  [45.588463, -122.38459600000002],
  [45.588452, -122.3841],
  [45.588453, -122.383675],
  [45.588453, -122.38362900000001],
  [45.588453, -122.383328],
  [45.588459, -122.381527],
  [45.588458532592746, -122.38115284048965],
  [45.588458532592746, -122.38115284048988],
  [45.588457, -122.379926],
  [45.58844969310794, -122.37893104486497],
  [45.58844969310794, -122.37893104486507],
  [45.588439, -122.377475],
  [45.58843771093446, -122.37631183319542],
  [45.58843771093446, -122.37631183319552],
  [45.588436, -122.374768],
  [45.588436, -122.374595],
  [45.588422, -122.37442699999998],
  [45.58841365822595, -122.37435400947702],
  [45.588413658227765, -122.37435400949295],
  [45.588402, -122.37425200000001],
  [45.588365, -122.37406300000002],
  [45.588326, -122.373906],
  [45.588241, -122.37365200000002],
  [45.588183, -122.373498],
  [45.588111, -122.373325],
  [45.587944, -122.37302200000002],
  [45.587667, -122.372671],
  [45.587612, -122.37260900000001],
  [45.587466, -122.37244300000002],
  [45.587134, -122.37207300000001],
  [45.58666588150269, -122.37154841984183],
  [45.58666588328956, -122.37154842184422],
  [45.586222, -122.371051],
  [45.585429651260036, -122.37013220295367],
  [45.58542965244829, -122.37013220433155],
  [45.585351, -122.370041],
  [45.584854, -122.36947600000002],
  [45.584201704232186, -122.36875833557315],
  [45.584201705875444, -122.36875833738108],
  [45.583916, -122.36844399999998],
  [45.583673, -122.368182],
  [45.58341, -122.367893],
  [45.583162373661295, -122.36760999847007],
  [45.583162375680956, -122.36761000077823],
  [45.583081, -122.36751699999999],
  [45.583005, -122.367448],
  [45.582914, -122.367344],
  [45.582814, -122.36722699999999],
  [45.582798, -122.367208],
  [45.582634, -122.36699299999998],
  [45.582511, -122.36680399999999],
  [45.582439, -122.36669],
  [45.58237, -122.366579],
  [45.582312, -122.36648099999998],
  [45.582261, -122.366396],
  [45.582161, -122.36622099999998],
  [45.582057, -122.36602599999999],
  [45.58194, -122.36575099999999],
  [45.581833, -122.36547299999998],
  [45.581725, -122.36513899999999],
  [45.581699, -122.36499599999999],
  [45.581621, -122.36469],
  [45.581567, -122.36441599999999],
  [45.581513, -122.364103],
  [45.581472, -122.36377199999998],
  [45.581454, -122.363575],
  [45.581444, -122.363317],
  [45.581431, -122.363004],
  [45.581423, -122.36267399999998],
  [45.581392, -122.362034],
  [45.58138594145798, -122.36179889901571],
  [45.581385941463715, -122.36179889923834],
  [45.581351, -122.360443],
  [45.581293, -122.358807],
  [45.581270787250205, -122.35799538029579],
  [45.58127078725055, -122.35799538030854],
  [45.581254, -122.357382],
  [45.581164583460215, -122.35503876067816],
  [45.58116458346039, -122.35503876068263],
  [45.581118, -122.35381799999999],
  [45.5811, -122.35270699999998],
  [45.58109222854841, -122.35241945629109],
  [45.581092228548926, -122.3524194563105],
  [45.581087, -122.35222599999999],
  [45.581067, -122.351748],
  [45.581055, -122.350992],
  [45.58103, -122.350331],
  [45.580985, -122.34972999999998],
  [45.580944762566716, -122.34936017065],
  [45.5809447625723, -122.34936017070133],
  [45.580917, -122.349105],
  [45.580854, -122.34874],
  [45.580698, -122.34764799999999],
  [45.58061878203097, -122.3471592491365],
  [45.58061878206832, -122.34715924936697],
  [45.580533, -122.34663],
  [45.580215, -122.344594],
  [45.580061, -122.34360300000002],
  [45.57996661420967, -122.34302255564866],
  [45.57996661428824, -122.34302255613183],
  [45.579894, -122.342576],
  [45.57972, -122.341542],
  [45.579557, -122.34044699999998],
  [45.579504, -122.34016],
  [45.57947, -122.33997],
  [45.579375, -122.33959200000001],
  [45.579266057993145, -122.33925948297906],
  [45.57926605829204, -122.33925948389137],
  [45.579241, -122.339183],
  [45.578886, -122.338332],
  [45.578768, -122.338035],
  [45.578656, -122.33772899999998],
  [45.57855, -122.337439],
  [45.578361, -122.336906],
  [45.57735, -122.33691199999998],
  [45.576691, -122.336925],
  [45.575996, -122.33692399999998],
  [45.574867, -122.336923],
  [45.574594, -122.33691799999998],
  [45.5746, -122.33694000000001],
  [45.574604, -122.336963],
  [45.574605, -122.33698700000001],
  [45.574604, -122.33701],
  [45.5746, -122.337033],
  [45.574594, -122.337055],
  [45.574585, -122.337077],
  [45.574574, -122.33709699999999],
  [45.57456, -122.337116],
  [45.574545, -122.337133],
  [45.574528, -122.337149],
  [45.574509, -122.337162],
  [45.574488, -122.33717399999999],
  [45.574467, -122.337183],
  [45.574444, -122.337189],
  [45.574421, -122.337193],
  [45.574398, -122.337187],
  [45.574377, -122.337179],
  [45.574356, -122.337168],
  [45.574337, -122.337155],
  [45.574319, -122.337141],
  [45.574303, -122.337124],
  [45.574288, -122.337106],
  [45.574276, -122.337087],
  [45.574265, -122.337066],
  [45.574257, -122.337045],
  [45.574251, -122.337023],
  [45.574247, -122.337],
  [45.574246, -122.336977],
  [45.574247, -122.33695399999999],
  [45.574251, -122.336931],
  [45.574256, -122.336909],
  [45.574258, -122.336879],
  [45.574264, -122.33685],
  [45.574274, -122.336822],
  [45.574288, -122.336796],
  [45.574306, -122.336772],
  [45.574327, -122.33675099999999],
  [45.574351, -122.33673299999998],
  [45.574378, -122.336718],
  [45.574171, -122.33492],
  [45.573927, -122.333212],
  [45.573162, -122.32788499999998],
  [45.573006, -122.326772],
  [45.572613, -122.324088],
  [45.57211, -122.320721],
  [45.573157, -122.32068799999999],
  [45.573155, -122.321049],
  [45.573154, -122.321175],
  [45.57316528268349, -122.32156354741274]
];

const stopNames = {
  "2911": "Mill Plain &amp; 190th Ave",
  "2318": "NE 3rd Ave &amp; 3rd Loop",
  "2319": "NE 3rd Ave 2700 Block",
  "2316": "NE 3rd Ave 1800 Block",
  "6079": "SE 192nd Ave &amp; Mill Plain",
  "1173": "E St 2600 Block",
  "1171": "E St 1700 Block",
  "2315": "NE 3rd Ave &amp; Crown Rd",
  "2284": "Adams St &amp; 5th Ave",
  "2312": "NE 3rd Ave 2100 Block",
  "6048": "NE 3rd Ave &amp; Franklin St",
  "2159": "NW 6th Ave 400 Block",
  "2331": "E St &amp; Washougal River Rd",
  "2336": "E Street 2900 Block",
  "2321": "NE 3rd Ave &amp; Shepherd Rd",
  "252": "Addy St &amp; Addy Loop",
  "1169": "NE 3rd Ave 1400 Block",
  "967": "NW 6th Ave &amp; 6th Ave",
  "968": "NW 6th Ave &amp; Ivy",
  "6080": "SE 192nd Ave &amp; 15th St",
  "6081": "SE 192nd Ave &amp; 20th St",
  "2323": "NE 3rd Ave at Lacamas Center",
  "2322": "NE 3rd Ave 3100 Block",
  "2320": "NE 3rd Ave 2800 Block",
  "2327": "E St &amp; 9th St",
  "2325": "E St 600 Block",
  "2324": "NE 3rd Ave 3500 Block",
  "2329": "E St 1200 Block",
  "2314": "NE 3rd Ave &amp; E First Ave",
  "9033": "Mill Plain Transit Center: Bay F",
  "2333": "E St 2200 Block",
  "2334": "E St &amp; 24th St",
  "1168": "NE 3rd Ave &amp; Joy St",
  "6082": "SE 192nd Ave &amp; 31st St",
  "6233": "SE 192nd Ave &amp; 41st Dr"
};

const stops = [
  { stop_id: "9033", name: "Mill Plain Transit Center: Bay F", lat: 45.617486, lon: -122.483636, times: ["5:55 AM", "6:25 AM", "6:55 AM", "7:25 AM", "7:55 AM", "8:25 AM", "8:55 AM", "9:25 AM"] },
  { stop_id: "2911", name: "Mill Plain &amp; 190th Ave", lat: 45.616669, lon: -122.47908, times: ["5:56 AM", "6:26 AM", "6:56 AM", "7:26 AM", "7:56 AM", "8:26 AM", "8:56 AM", "9:26 AM"] },
  { stop_id: "6079", name: "SE 192nd Ave &amp; Mill Plain", lat: 45.616179, lon: -122.476247, times: ["5:56 AM", "6:26 AM", "6:56 AM", "7:26 AM", "7:57 AM", "8:27 AM", "8:57 AM", "9:27 AM"] },
  { stop_id: "6080", name: "SE 192nd Ave &amp; 15th St", lat: 45.609581, lon: -122.476072, times: ["5:57 AM", "6:27 AM", "6:57 AM", "7:27 AM", "7:58 AM", "8:28 AM", "8:58 AM", "9:28 AM"] },
  { stop_id: "6081", name: "SE 192nd Ave &amp; 20th St", lat: 45.606394, lon: -122.476057, times: ["5:58 AM", "6:28 AM", "6:58 AM", "7:28 AM", "7:59 AM", "8:29 AM", "8:59 AM", "9:29 AM"] },
  { stop_id: "6082", name: "SE 192nd Ave &amp; 31st St", lat: 45.598161, lon: -122.478366, times: ["6:00 AM", "6:30 AM", "7:00 AM", "7:30 AM", "8:01 AM", "8:31 AM", "9:01 AM", "9:31 AM"] },
  { stop_id: "6233", name: "SE 192nd Ave &amp; 41st Dr", lat: 45.593705, lon: -122.477944, times: ["6:00 AM", "6:30 AM", "7:00 AM", "7:30 AM", "8:01 AM", "8:31 AM", "9:01 AM", "9:31 AM"] },
  { stop_id: "967", name: "NW 6th Ave &amp; 6th Ave", lat: 45.582243, lon: -122.425782, times: ["6:06 AM", "6:36 AM", "7:06 AM", "7:36 AM", "8:07 AM", "8:37 AM", "9:07 AM", "9:37 AM"] },
  { stop_id: "968", name: "NW 6th Ave &amp; Ivy", lat: 45.583411, lon: -122.420746, times: ["6:06 AM", "6:36 AM", "7:06 AM", "7:36 AM", "8:07 AM", "8:37 AM", "9:07 AM", "9:37 AM"] },
  { stop_id: "2159", name: "NW 6th Ave 400 Block", lat: 45.585024, lon: -122.412622, times: ["6:07 AM", "6:37 AM", "7:07 AM", "7:37 AM", "8:08 AM", "8:38 AM", "9:08 AM", "9:38 AM"] },
  { stop_id: "2284", name: "Adams St &amp; 5th Ave", lat: 45.585447, lon: -122.406465, times: ["6:08 AM", "6:38 AM", "7:08 AM", "7:38 AM", "8:09 AM", "8:39 AM", "9:09 AM", "9:39 AM"] },
  { stop_id: "6048", name: "NE 3rd Ave &amp; Franklin St", lat: 45.586349, lon: -122.401138, times: ["6:09 AM", "6:39 AM", "7:09 AM", "7:39 AM", "8:10 AM", "8:40 AM", "9:10 AM", "9:40 AM"] },
  { stop_id: "1168", name: "NE 3rd Ave &amp; Joy St", lat: 45.588216, lon: -122.397605, times: ["6:09 AM", "6:39 AM", "7:09 AM", "7:39 AM", "8:10 AM", "8:40 AM", "9:10 AM", "9:40 AM"] },
  { stop_id: "1169", name: "NE 3rd Ave 1400 Block", lat: 45.588682, lon: -122.394527, times: ["6:09 AM", "6:39 AM", "7:09 AM", "7:39 AM", "8:10 AM", "8:40 AM", "9:10 AM", "9:40 AM"] },
  { stop_id: "2314", name: "NE 3rd Ave &amp; E First Ave", lat: 45.588792, lon: -122.392609, times: ["6:10 AM", "6:40 AM", "7:10 AM", "7:40 AM", "8:11 AM", "8:41 AM", "9:11 AM", "9:41 AM"] },
  { stop_id: "2315", name: "NE 3rd Ave &amp; Crown Rd", lat: 45.588675, lon: -122.389649, times: ["6:10 AM", "6:40 AM", "7:10 AM", "7:40 AM", "8:11 AM", "8:41 AM", "9:11 AM", "9:41 AM"] },
  { stop_id: "2316", name: "NE 3rd Ave 1800 Block", lat: 45.58857, lon: -122.387657, times: ["6:10 AM", "6:40 AM", "7:10 AM", "7:40 AM", "8:11 AM", "8:41 AM", "9:11 AM", "9:41 AM"] },
  { stop_id: "2312", name: "NE 3rd Ave 2100 Block", lat: 45.588402, lon: -122.385139, times: ["6:10 AM", "6:40 AM", "7:10 AM", "7:40 AM", "8:11 AM", "8:41 AM", "9:11 AM", "9:41 AM"] },
  { stop_id: "2318", name: "NE 3rd Ave &amp; 3rd Loop", lat: 45.588396, lon: -122.381153, times: ["6:11 AM", "6:41 AM", "7:11 AM", "7:41 AM", "8:12 AM", "8:42 AM", "9:12 AM", "9:42 AM"] },
  { stop_id: "2319", name: "NE 3rd Ave 2700 Block", lat: 45.588386, lon: -122.378932, times: ["6:11 AM", "6:41 AM", "7:11 AM", "7:41 AM", "8:12 AM", "8:42 AM", "9:12 AM", "9:42 AM"] },
  { stop_id: "2320", name: "NE 3rd Ave 2800 Block", lat: 45.588364, lon: -122.376312, times: ["6:11 AM", "6:41 AM", "7:11 AM", "7:41 AM", "8:12 AM", "8:42 AM", "9:12 AM", "9:42 AM"] },
  { stop_id: "2321", name: "NE 3rd Ave &amp; Shepherd Rd", lat: 45.588298, lon: -122.374381, times: ["6:11 AM", "6:41 AM", "7:11 AM", "7:41 AM", "8:12 AM", "8:42 AM", "9:12 AM", "9:42 AM"] },
  { stop_id: "2322", name: "NE 3rd Ave 3100 Block", lat: 45.586603, lon: -122.371663, times: ["6:12 AM", "6:42 AM", "7:12 AM", "7:42 AM", "8:13 AM", "8:43 AM", "9:13 AM", "9:43 AM"] },
  { stop_id: "2323", name: "NE 3rd Ave at Lacamas Center", lat: 45.585369, lon: -122.370239, times: ["6:12 AM", "6:42 AM", "7:12 AM", "7:42 AM", "8:13 AM", "8:43 AM", "9:13 AM", "9:43 AM"] },
  { stop_id: "2324", name: "NE 3rd Ave 3500 Block", lat: 45.584148, lon: -122.368858, times: ["6:12 AM", "6:42 AM", "7:12 AM", "7:42 AM", "8:13 AM", "8:43 AM", "9:13 AM", "9:43 AM"] },
  { stop_id: "2325", name: "E St 600 Block", lat: 45.583098, lon: -122.367725, times: ["6:12 AM", "6:42 AM", "7:12 AM", "7:42 AM", "8:13 AM", "8:43 AM", "9:13 AM", "9:43 AM"] },
  { stop_id: "2327", name: "E St &amp; 9th St", lat: 45.581327, lon: -122.361802, times: ["6:13 AM", "6:43 AM", "7:13 AM", "7:43 AM", "8:14 AM", "8:44 AM", "9:14 AM", "9:44 AM"] },
  { stop_id: "2329", name: "E St 1200 Block", lat: 45.581206, lon: -122.357999, times: ["6:14 AM", "6:44 AM", "7:14 AM", "7:44 AM", "8:15 AM", "8:45 AM", "9:15 AM", "9:45 AM"] },
  { stop_id: "2331", name: "E St &amp; Washougal River Rd", lat: 45.581123, lon: -122.355042, times: ["6:14 AM", "6:44 AM", "7:14 AM", "7:44 AM", "8:15 AM", "8:45 AM", "9:15 AM", "9:45 AM"] },
  { stop_id: "1171", name: "E St 1700 Block", lat: 45.581028, lon: -122.352423, times: ["6:14 AM", "6:44 AM", "7:14 AM", "7:44 AM", "8:15 AM", "8:45 AM", "9:15 AM", "9:45 AM"] },
  { stop_id: "2333", name: "E St 2200 Block", lat: 45.580887, lon: -122.349373, times: ["6:14 AM", "6:44 AM", "7:14 AM", "7:44 AM", "8:15 AM", "8:45 AM", "9:15 AM", "9:45 AM"] },
  { stop_id: "2334", name: "E St &amp; 24th St", lat: 45.580547, lon: -122.347183, times: ["6:15 AM", "6:45 AM", "7:15 AM", "7:45 AM", "8:16 AM", "8:46 AM", "9:16 AM", "9:46 AM"] },
  { stop_id: "1173", name: "E St 2600 Block", lat: 45.579899, lon: -122.343045, times: ["6:15 AM", "6:45 AM", "7:15 AM", "7:45 AM", "8:16 AM", "8:46 AM", "9:16 AM", "9:46 AM"] },
  { stop_id: "2336", name: "E Street 2900 Block", lat: 45.579198, lon: -122.339305, times: ["6:16 AM", "6:46 AM", "7:16 AM", "7:46 AM", "8:17 AM", "8:47 AM", "9:17 AM", "9:47 AM"] },
  { stop_id: "252", name: "Addy St &amp; Addy Loop", lat: 45.573242, lon: -122.321559, times: ["6:19 AM", "6:49 AM", "7:19 AM", "7:49 AM", "8:20 AM", "8:50 AM", "9:20 AM", "9:50 AM"] },
]

    const polylineOut = L.polyline(shapeOutbound, { color: 'blue', weight: 4, opacity: 0.7 }).addTo(map);
    map.fitBounds(polylineOut.getBounds());

    const nowPT = new Date(new Date().toLocaleString('en-US', { timeZone: 'America/Los_Angeles' }));
    const nowMins = nowPT.getHours() * 60 + nowPT.getMinutes();

    stops.forEach(stop => {
      let highlightedTimes = [];
      let foundNext = false;
      stop.times.forEach(timeStr => {
        let cleanTime = timeStr.trim();
        let [h, m] = cleanTime.split(":");
        let schedMins = parseInt(h, 10) * 60 + parseInt(m, 10);
        if (schedMins < nowMins && nowMins - schedMins > 720) {
          schedMins += 1440;
        }
        if (!foundNext && schedMins >= nowMins) {
          highlightedTimes.push(`<span style="background:#4dd0e1; color:#000; padding:2px 6px; border-radius:6px; font-weight:bold;">${cleanTime}</span>`);
          foundNext = true;
        } else {
          highlightedTimes.push(cleanTime);
        }
      });

      L.circleMarker([stop.lat, stop.lon], {
        radius: 6,
        color: '#4dd0e1',
        fillColor: '#4dd0e1',
        fillOpacity: 0.9,
        weight: 1
      })
      .bindPopup(`<strong>${stop.name}</strong><br>${highlightedTimes.join("<br>") || 'No scheduled times'}`)
      .addTo(map);
    });

    let busMarkers = {};
    async function fetchAndDisplay() {
      const res = await fetch(`https://developer.trimet.org/ws/v2/vehicles?route=${routeNumber}&appID=${apiKey}&json=true`);
      const data = await res.json();
      const buses = (data.resultSet.vehicle || []).filter(v => v.routeNumber == routeNumber && v.direction == direction);

      Object.values(busMarkers).forEach(m => map.removeLayer(m));
      busMarkers = {};
      if (!buses.length) return;

      buses.forEach(bus => {
        if (!bus.latitude || !bus.longitude || !bus.blockID) return;
        const icon = L.divIcon({    
           className: '',
           html: `
            <div style="text-align:center;">
              <div style="background:#0071CE;color:#fff;padding:2px 6px;border-radius:6px;font-weight:bold;">${bus.vehicleID}</div>
              <div style="width:0;height:0;border-left:5px solid transparent;border-right:5px solid transparent;border-top:10px solid #00bfff;margin:auto;"></div>
            </div>
          `,
          iconSize: [40, 30], iconAnchor: [20, 30]
        });
        const marker = L.marker([bus.latitude, bus.longitude], { icon }).addTo(map);
        busMarkers[bus.vehicleID] = marker;
      });
    }
    fetchAndDisplay();
    setInterval(fetchAndDisplay, 15000);
  </script>

  <footer class="site-footer">
    <a href="terms.html">Terms of Use</a> &nbsp;|&nbsp;
    <a href="contact.html">Contact Us</a> &nbsp;|&nbsp;
    <a href="report.html">Report a Problem</a> &nbsp;|&nbsp;
    <a href="dmca.html">DMCA</a> &nbsp;|&nbsp;
    <a href="privacy.html">Privacy Policy</a>
  </footer>

  <script>
    if (!localStorage.getItem('cookieConsent')) {
      document.write(`
        <div id="cookie-banner" style="position: fixed; bottom: 0; left: 0; right: 0; background: #333; color: #fff; padding: 1rem; z-index: 1000; font-size: 0.9rem; line-height: 1.4; text-align: center; box-sizing: border-box;">
          üì¢ We use cookies to improve functionality and analyze traffic.
          By using MetroFeed, you agree to our 
          <a href='privacy.html' style='color: #4dd0e1; text-decoration: underline;'>Privacy Policy</a>.<br>
          <button onclick='localStorage.setItem("cookieConsent", "true"); document.getElementById("cookie-banner").remove();' style='margin-top: 0.5rem; background: #4dd0e1; color: #000; border: none; padding: 0.5rem 1rem; border-radius: 5px; cursor: pointer; font-weight: bold;'>OK</button>
        </div>
      `);
    }
  </script>
</body>
</html>