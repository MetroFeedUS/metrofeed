<!DOCTYPE html>
<html lang="en">
<head>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-EL337T4JX4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-EL337T4JX4');
</script>

<meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Route 190 - Direction 1 | MetroFeed Portland</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', sans-serif;
      background-color: #0d0d0d;
      color: #cccccc;
      overflow-y: auto;
    }

    body {
      padding-top: 120px;
    }

    .ad-banner {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      background: #222;
      padding: 0;
      z-index: 1000;
      box-shadow: 0 2px 2px rgba(0,0,0,0.5);
      text-align: center;
    }

    .ad-banner img {
      width: 100%;
      max-width: 728px;
      max-height: 120px;
      display: block;
      margin: 0 auto;
    }
    .home-button {
      position: fixed;
      top: 120px;
      left: 10px;
      background-color: #4dd0e1;
      color: #0d0d0d;
      padding: 0.5rem 1rem;
      font-weight: bold;
      border-radius: 8px;
      text-decoration: none;
      z-index: 1001;
      box-shadow: 0 0 10px #4dd0e1;
    }

    .home-button:hover {
      background-color: #00bcd4;
      color: #ffffff;
    }

    header {
      background-color: #0d0d0d;
      border-top: 4px solid #4dd0e1;
      border-bottom: 3px solid #4dd0e1;
      padding: 1rem;
      text-align: center;
    }

    header img {
      max-height: 60px;
    }

    h1 {
      text-align: center;
      margin: 1rem 0;
      font-size: 2rem;
      color: #f0f0f0;
    }

    .content-box {
      border-radius: 12px;
      padding: 0;
      margin: 0;
      background-color: #1e1e1e;
    }

    #map {
      width: 100%;
      height: 85vh;
      border: none;
      margin: 0 auto;
      display: block;
      border-radius: 8px;
    }

    .button-bar {
      display: flex;
      justify-content: center;
      margin: 1rem 0;
    }

    .button-bar a, .back-button {
      background: #4dd0e1;
      color: #0d0d0d;
      padding: 0.6rem 1.2rem;
      text-decoration: none;
      border-radius: 8px;
      font-weight: bold;
      border: none;
      cursor: pointer;
      box-shadow: 0 0 10px #4dd0e1;
    }

    .back-button:hover {
      background-color: #35c0d6;
    }

    .site-footer {
      text-align: center;
      margin-top: 3rem;
      margin-bottom: 120px;
      font-size: 0.85rem;
      color: #aaa;
    }

    .site-footer a {
      color: #00BFFF;
      text-decoration: none;
    }

    .site-footer a:hover {
      text-decoration: underline;
    }

    @media (max-width: 600px) {
      .ad-banner {
        padding-top: 1rem;
        padding-bottom: 0rem;
      }
    }
  </style>
</head>

<body>
  <div class="ad-banner">
    <iframe src="https://metrofeedus.com/portland/Ads/route-190-dir1-ad.html" style="border:none; width:100%; max-width: 728px; height:90px;"></iframe>
  </div>

  <header>
    <img src="MetroFeedPortlandLogo.png" alt="MetroFeed Portland">
  </header>

  <div class="disclaimer" style="margin: 1rem auto 0.5rem; max-width: 600px; font-size: 0.8rem; color: #bbb; text-align: center; padding: 0.5rem 1rem; background-color: #111; border: 1px dashed #444; border-radius: 6px;">
    ‚ö†Ô∏è This is a Beta program, work in progress. Please REPORT bugs and pretend to be impressed.
  </div>
  <div class="disclaimer" style="margin: 0 auto 1rem; max-width: 600px; font-size: 0.75rem; color: #888; text-align: center; padding: 0.25rem 1rem;">
    This tool is not affiliated with or endorsed by TriMet. For official schedules and service alerts, visit <a href="https://trimet.org" style="color:#4dd0e1;">trimet.org</a>.
  </div>

  <div style="margin: 2rem 0; text-align: center;">
    <button class="back-button" onclick="history.back()">Back</button>
  </div>

  <h1>Route 190 - Direction 1</h1>

  <div class="content-box">
    <div id="map"></div>
    <div style="text-align:right; font-size: 0.7rem; color: #777; margin-top: 0.5rem;">
      Data courtesy of TriMet.
    </div>
  </div>

  <script>
    if (document.referrer === "" && performance.navigation.type === 0) {
      window.location.href = "/index.html";
    }

    const apiKey = "2C4447D4A42083BCD84DE3B8E";
    const routeNumber = 190;
    const direction = parseInt(1);

    const map = L.map('map', {
      center: [45.6, -122.7],
      zoom: 12,
      minZoom: 12,
      maxZoom: 18,
      maxBounds: [[45.3, -123.1], [45.9, -122.3]],
      maxBoundsViscosity: 1.0
    });
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { maxZoom: 19 }).addTo(map);

    const shapeOutbound = [
  [45.499301, -122.68267300000001],
  [45.499223, -122.68257900000002],
  [45.499167, -122.68247],
  [45.499137, -122.68235],
  [45.499088, -122.68213],
  [45.499042, -122.68189],
  [45.498986, -122.681686],
  [45.498943, -122.681599],
  [45.498885, -122.68152],
  [45.498795, -122.681413],
  [45.498704, -122.68132800000001],
  [45.498493, -122.68120299999998],
  [45.497117, -122.680427],
  [45.496971, -122.680405],
  [45.496783, -122.680392],
  [45.496662, -122.680406],
  [45.496574, -122.680427],
  [45.496467, -122.68046299999999],
  [45.496379, -122.68050399999998],
  [45.496304, -122.68055400000001],
  [45.496197, -122.680625],
  [45.496106, -122.680703],
  [45.496035, -122.68078699999998],
  [45.495919, -122.680956],
  [45.495805, -122.681208],
  [45.495488, -122.68206],
  [45.495406, -122.682215],
  [45.49532, -122.682336],
  [45.495253, -122.682393],
  [45.495189, -122.682429],
  [45.49512, -122.682458],
  [45.494983, -122.682474],
  [45.494892, -122.682467],
  [45.494783, -122.68244299999999],
  [45.494682, -122.68238],
  [45.494441, -122.68309],
  [45.49442, -122.683208],
  [45.494418, -122.68331500000001],
  [45.494439, -122.683412],
  [45.494499, -122.683507],
  [45.494567, -122.68354599999999],
  [45.494627, -122.683562],
  [45.494683, -122.683562],
  [45.494788, -122.683548],
  [45.494919, -122.683503],
  [45.49502, -122.683457],
  [45.495106, -122.683408],
  [45.495205, -122.683298],
  [45.495318, -122.683125],
  [45.495409, -122.682989],
  [45.495514, -122.68286599999999],
  [45.495588, -122.682795],
  [45.495677, -122.68273299999998],
  [45.495744, -122.682704],
  [45.495888, -122.682649],
  [45.49606, -122.682561],
  [45.496257, -122.682445],
  [45.49653045758876, -122.68227373806045],
  [45.496530458469806, -122.68227373750865],
  [45.496744, -122.68214],
  [45.497025, -122.681935],
  [45.497124, -122.68190200000001],
  [45.497222, -122.68191500000002],
  [45.497301, -122.68194200000002],
  [45.497355, -122.681971],
  [45.497417, -122.68205300000001],
  [45.497471, -122.68216400000001],
  [45.497518, -122.682314],
  [45.497526, -122.682424],
  [45.497518, -122.682552],
  [45.49745, -122.682764],
  [45.49736, -122.682876],
  [45.497287, -122.682964],
  [45.49701408834932, -122.68318108881304],
  [45.49701408960263, -122.68318108781608],
  [45.496583, -122.683524],
  [45.496103, -122.683815],
  [45.495969, -122.683875],
  [45.495908, -122.68398399999998],
  [45.495882, -122.684122],
  [45.495882, -122.68425999999998],
  [45.495947, -122.68443699999999],
  [45.496049, -122.68454099999998],
  [45.496166, -122.68459499999999],
  [45.496253, -122.684604],
  [45.496314, -122.68458599999998],
  [45.496374, -122.684557],
  [45.49645, -122.684546],
  [45.496515, -122.68455899999998],
  [45.496565, -122.68461799999999],
  [45.496595, -122.68472399999999],
  [45.496627, -122.684958],
  [45.496683, -122.68509299999998],
  [45.496818, -122.685619],
  [45.496993206148176, -122.68649939724926],
  [45.49699320612855, -122.68649939715064],
  [45.497139, -122.68723200000001],
  [45.49730928160457, -122.68817320282398],
  [45.497313351134224, -122.68817177034563],
  [45.497351, -122.68837899999998],
  [45.497456, -122.68895199999999],
  [45.497509, -122.689149],
  [45.497605, -122.68940999999998],
  [45.497799, -122.68952599999999],
  [45.497932, -122.68957299999998],
  [45.498022, -122.68959699999999],
  [45.498103, -122.689598],
  [45.498177, -122.68958399999998],
  [45.498318, -122.689536],
  [45.498398, -122.689482],
  [45.498468, -122.689415],
  [45.498581, -122.689276],
  [45.498896, -122.68861199999999],
  [45.499005, -122.6884],
  [45.499092, -122.688198],
  [45.499132, -122.688137],
  [45.499174, -122.688103],
  [45.499222, -122.68808699999998],
  [45.499157, -122.687701],
  [45.499152, -122.68766099999999],
  [45.499146, -122.68760499999999],
  [45.499143, -122.68756199999999],
  [45.499145, -122.687314],
  [45.49914324681266, -122.68728504133544],
  [45.499176, -122.687003],
  [45.499308, -122.685993],
  [45.499336, -122.685818],
  [45.499372, -122.685697],
  [45.499417, -122.685586],
  [45.49942862205823, -122.68556923375206],
  [45.499478, -122.685498],
  [45.499547, -122.68540500000002],
  [45.500141, -122.68460200000001],
  [45.50033, -122.684347],
  [45.50033496252817, -122.68434079683979],
  [45.500558, -122.684062],
  [45.500607, -122.684018],
  [45.500699, -122.68397],
  [45.500848, -122.683962],
  [45.500981, -122.683988],
  [45.501092, -122.68404],
  [45.501179, -122.684073],
  [45.501342, -122.68411499999999],
  [45.501501, -122.68413],
  [45.502046, -122.684198],
  [45.502137, -122.684236],
  [45.502197, -122.68432999999999],
  [45.502238, -122.684458],
  [45.502221, -122.684598],
  [45.501866, -122.68585699999998],
  [45.501797, -122.685953],
  [45.501694, -122.686096],
  [45.501629, -122.686248],
  [45.501602, -122.68638099999998],
  [45.501605, -122.68649299999998],
  [45.501612, -122.686613],
  [45.501643, -122.68672],
  [45.501718, -122.686842],
  [45.501835, -122.686987],
  [45.501905, -122.68708099999999],
  [45.501942, -122.687153],
  [45.501988, -122.687253],
  [45.502005, -122.68738],
  [45.502016, -122.687549],
  [45.502018, -122.687697],
  [45.501991, -122.68782999999999],
  [45.50191, -122.688058],
  [45.501854, -122.68826],
  [45.501861, -122.68840099999998],
  [45.501927, -122.688593],
  [45.502037, -122.688847],
  [45.502076, -122.689],
  [45.502126, -122.68925799999998],
  [45.502393, -122.690767],
  [45.50244, -122.69088],
  [45.502515, -122.690974],
  [45.502605, -122.69099799999998],
  [45.502692, -122.690981],
  [45.502794, -122.69090999999999],
  [45.502815, -122.690814],
  [45.502826, -122.690709],
  [45.502809, -122.690607],
  [45.5027, -122.690079],
  [45.50266, -122.689805],
  [45.502643, -122.68957399999998],
  [45.502657, -122.689324],
  [45.502739, -122.688316],
  [45.502829, -122.68787299999998],
  [45.502878, -122.687576],
  [45.502999, -122.686952],
  [45.503094, -122.686592],
  [45.503152, -122.68643599999999],
  [45.503225, -122.686264],
  [45.503398, -122.685943],
  [45.503697, -122.68543099999998],
  [45.504056, -122.684689],
  [45.504148, -122.68453199999999],
  [45.504254, -122.68442099999999],
  [45.504327, -122.684365],
  [45.504424, -122.68430999999998],
  [45.504531, -122.684285],
  [45.504618, -122.68426899999999],
  [45.504721, -122.684262],
  [45.505142, -122.68428],
  [45.505217, -122.684281],
  [45.505223, -122.68428],
  [45.505926, -122.68432999999999],
  [45.506639, -122.684298],
  [45.507157, -122.68426599999998],
  [45.507428, -122.684236],
  [45.507606, -122.68421699999999],
  [45.507804, -122.68421199999999],
  [45.508159, -122.684344],
  [45.508275, -122.684415],
  [45.508372, -122.684504],
  [45.508453, -122.68463399999999],
  [45.508552, -122.68486299999999],
  [45.508713, -122.685243],
  [45.508785, -122.685405],
  [45.508923, -122.68570199999999],
  [45.5091, -122.686004],
  [45.509387, -122.68645],
  [45.509806, -122.68712799999999],
  [45.509832, -122.687161],
  [45.509943, -122.68729799999998],
  [45.510174, -122.687543],
  [45.510342, -122.687712],
  [45.510611, -122.687977],
  [45.510926, -122.68825299999999],
  [45.511311, -122.688551],
  [45.511863, -122.688922],
  [45.512145, -122.689073],
  [45.512498, -122.68923],
  [45.512958, -122.689343],
  [45.513341, -122.68937199999999],
  [45.513567, -122.68935399999998],
  [45.51384, -122.689319],
  [45.514025, -122.689276],
  [45.514133, -122.68925299999998],
  [45.514326, -122.68917],
  [45.514427, -122.689127],
  [45.514674, -122.689009],
  [45.514898, -122.68888599999998],
  [45.515376, -122.688604],
  [45.515599, -122.68847],
  [45.51629, -122.688153],
  [45.516942, -122.687795],
  [45.518294, -122.687044],
  [45.518948, -122.686675],
  [45.519532, -122.686358],
  [45.519611, -122.686317],
  [45.520281, -122.685971],
  [45.520518, -122.685855],
  [45.520675, -122.685774],
  [45.520958, -122.68566],
  [45.521009, -122.685637],
  [45.520958, -122.68566],
  [45.521189, -122.685585],
  [45.52133, -122.685558],
  [45.521509, -122.68554299999998],
  [45.521688, -122.685559],
  [45.521976, -122.685585],
  [45.522212, -122.685635],
  [45.52246, -122.685715],
  [45.522677, -122.68580599999999],
  [45.522898, -122.68591799999999],
  [45.523607, -122.68629399999999],
  [45.523833, -122.68639999999999],
  [45.524055, -122.68649399999998],
  [45.524226, -122.686556],
  [45.524429, -122.68660899999999],
  [45.5246, -122.68664699999998],
  [45.524824, -122.686681],
  [45.525023, -122.686699],
  [45.526465, -122.686733],
  [45.528334, -122.686786],
  [45.528588, -122.686786],
  [45.529299, -122.68680799999998],
  [45.53001, -122.68682799999999],
  [45.530723, -122.68685],
  [45.531435, -122.686872],
  [45.532151, -122.686913],
  [45.532863, -122.686953],
  [45.533565, -122.686969],
  [45.533709, -122.68696999999999],
  [45.533891, -122.68696199999998],
  [45.534013, -122.686953],
  [45.534089, -122.68694],
  [45.534195, -122.68692399999999],
  [45.5343, -122.686884],
  [45.534414, -122.686846],
  [45.534544, -122.686786],
  [45.534746, -122.686673],
  [45.534859, -122.68660599999998],
  [45.535017, -122.686467],
  [45.535228, -122.68627799999999],
  [45.535521, -122.68595],
  [45.535588, -122.68586299999998],
  [45.535851, -122.685539],
  [45.53607, -122.68527099999999],
  [45.53778, -122.683172],
  [45.538836, -122.681837],
  [45.539696, -122.680784],
  [45.540215, -122.680157],
  [45.540758, -122.67948099999998],
  [45.540896, -122.67928099999999],
  [45.541019, -122.679164],
  [45.541153, -122.679006],
  [45.541668, -122.678395],
  [45.541872, -122.678073],
  [45.542406, -122.67733199999999],
  [45.542618, -122.677143],
  [45.542823, -122.676957],
  [45.543187, -122.676692],
  [45.543428, -122.676491],
  [45.543727, -122.676342],
  [45.543835, -122.67630599999998],
  [45.543951, -122.676274],
  [45.544082, -122.676248],
  [45.544183, -122.676239],
  [45.544363, -122.676225],
  [45.544617, -122.676252],
  [45.544715, -122.676286],
  [45.544847, -122.676338],
  [45.544923, -122.676368],
  [45.545036, -122.676423],
  [45.545135, -122.676486],
  [45.545306, -122.67661599999998],
  [45.545443, -122.67672699999999],
  [45.545987, -122.67721099999999],
  [45.54644, -122.67762],
  [45.546759, -122.67789399999998],
  [45.547131, -122.678187],
  [45.547581, -122.678403],
  [45.548037, -122.67858399999999],
  [45.548757, -122.67858799999999],
  [45.550967, -122.678564],
  [45.552543, -122.67854499999999],
  [45.55314, -122.678561],
  [45.554637, -122.67853899999999],
  [45.556018, -122.67852899999998],
  [45.556094, -122.67852899999998],
  [45.556407, -122.678532],
  [45.557647, -122.678509],
  [45.559004, -122.67848399999998],
  [45.560912, -122.67847899999998],
  [45.562677, -122.678524],
  [45.563833, -122.678511],
  [45.566406, -122.67853299999999],
  [45.567219, -122.678519],
  [45.569915, -122.678546],
  [45.572531, -122.67858999999999],
  [45.573027, -122.678574],
  [45.574749, -122.678566],
  [45.577217, -122.6785],
  [45.577937, -122.67853799999999],
  [45.580428, -122.67848299999999],
  [45.581171, -122.678507],
  [45.581834, -122.678514],
  [45.582546, -122.67859199999998],
  [45.582947, -122.678669],
  [45.583218, -122.67874899999998],
  [45.583247, -122.67875699999999],
  [45.58373, -122.67891499999999],
  [45.584138, -122.67905399999998],
  [45.584238, -122.679096],
  [45.584924, -122.67942],
  [45.587743, -122.680748],
  [45.588726, -122.68119399999999],
  [45.589535, -122.68155999999999],
  [45.590617, -122.68203799999999],
  [45.591455, -122.68241699999999],
  [45.59318, -122.683185],
  [45.594939, -122.68397],
  [45.595517, -122.68416599999999],
  [45.595898, -122.684253],
  [45.596729, -122.684402],
  [45.597281, -122.68442199999998],
  [45.598046, -122.68437499999999],
  [45.598966, -122.68416699999999],
  [45.59975, -122.683929],
  [45.601253, -122.68346999999999],
  [45.603363, -122.68287999999998],
  [45.604068, -122.68268599999999],
  [45.605106, -122.68236399999999],
  [45.605652, -122.682136],
  [45.605718, -122.682112],
  [45.605885, -122.682032],
  [45.606727, -122.681697],
  [45.607242, -122.681471],
  [45.608853, -122.680517],
  [45.609849, -122.679941],
  [45.610301, -122.679681],
  [45.611973, -122.678737],
  [45.61292, -122.67815899999998],
  [45.612951, -122.67813],
  [45.612957, -122.678128],
  [45.612982, -122.67812099999999],
  [45.613133, -122.678032],
  [45.613146, -122.678025],
  [45.618363, -122.67496],
  [45.619504, -122.67428099999998],
  [45.620771, -122.673507],
  [45.621464, -122.673066],
  [45.621584, -122.672986],
  [45.621668, -122.672926],
  [45.621711, -122.672895],
  [45.621979, -122.672566],
  [45.622069, -122.672466],
  [45.622146, -122.67238199999998],
  [45.622218, -122.672301],
  [45.62228, -122.67222299999999],
  [45.62234, -122.672151],
  [45.622412, -122.67205699999998],
  [45.622494, -122.671915],
  [45.622549, -122.67179599999999],
  [45.622605, -122.67164399999999],
  [45.62264, -122.671483],
  [45.622665, -122.67131899999998],
  [45.622674, -122.671154],
  [45.622674, -122.67100399999998],
  [45.62266, -122.670862],
  [45.622642, -122.67073999999998],
  [45.622611, -122.670613],
  [45.622566, -122.67048199999999],
  [45.622519, -122.67036199999998],
  [45.622464, -122.670249],
  [45.622113, -122.669557],
  [45.621413, -122.668265],
  [45.62099, -122.667417],
  [45.620787, -122.66702699999999],
  [45.620522, -122.66646],
  [45.620312, -122.665995],
  [45.620018, -122.665205],
  [45.619773, -122.664485],
  [45.619665, -122.664085],
  [45.619439, -122.663122],
  [45.618913, -122.660421],
  [45.618777, -122.659713],
  [45.618698, -122.659243],
  [45.618486, -122.657351],
  [45.618408, -122.656322],
  [45.618366, -122.655093],
  [45.618355, -122.65359499999998],
  [45.618372, -122.65231199999998],
  [45.618374, -122.652102],
  [45.618378, -122.65174499999999],
  [45.61838, -122.65162599999998],
  [45.618381, -122.651512],
  [45.618386, -122.65088],
  [45.618391, -122.64966],
  [45.618429, -122.646731],
  [45.618524, -122.64260899999998],
  [45.618534, -122.641963],
  [45.618548, -122.64049899999999],
  [45.618541, -122.638173],
  [45.618515, -122.635485],
  [45.618512, -122.633618],
  [45.618567, -122.628893],
  [45.618548, -122.627722],
  [45.618517, -122.626989],
  [45.618474, -122.626361],
  [45.618416, -122.625671],
  [45.618287, -122.62468499999999],
  [45.618189, -122.62391],
  [45.618015, -122.622752],
  [45.617887, -122.62208199999999],
  [45.617741, -122.62140099999999],
  [45.617537, -122.620527],
  [45.617391, -122.62001099999999],
  [45.617277, -122.619609],
  [45.616994, -122.618657],
  [45.616646, -122.617532],
  [45.616305, -122.61645199999998],
  [45.61558, -122.61416199999998],
  [45.615439, -122.613665],
  [45.615321, -122.613126],
  [45.615267, -122.612789],
  [45.615206, -122.612339],
  [45.615162, -122.61195599999999],
  [45.615137, -122.611761],
  [45.615095, -122.611527],
  [45.615049, -122.610808],
  [45.615027, -122.610705],
  [45.615011, -122.61067399999999],
  [45.614988, -122.610651],
  [45.614817, -122.61057299999999],
  [45.614744, -122.61099699999998],
  [45.614752, -122.611381],
  [45.614773, -122.611561],
  [45.614793, -122.611693],
  [45.614823, -122.61183699999998],
  [45.614881, -122.612023],
  [45.614979, -122.612285],
  [45.615068, -122.612464],
  [45.615094, -122.612515],
  [45.615267, -122.612789],
  [45.615387, -122.61294499999998],
  [45.615524, -122.61310299999998],
  [45.615653, -122.613212],
  [45.61569, -122.613238],
  [45.615867, -122.613365],
  [45.616015, -122.613458],
  [45.616309, -122.61362],
  [45.616471, -122.613724],
  [45.616579, -122.613794],
  [45.616766, -122.613926],
  [45.616977, -122.614093],
  [45.617049, -122.614139],
  [45.61722, -122.614254],
  [45.617513, -122.61454699999999],
  [45.617546, -122.614573],
  [45.617588, -122.61459299999999],
  [45.617615, -122.614601],
  [45.617652, -122.61460299999999],
  [45.617686, -122.61459799999999],
  [45.617723, -122.614584],
  [45.617768, -122.614555],
  [45.617884, -122.61449499999999],
  [45.617788, -122.614268],
  [45.617517, -122.61359399999999],
  [45.617397, -122.613295],
  [45.617102, -122.612519],
  [45.616282, -122.61041099999998],
  [45.616062, -122.60981899999999],
  [45.615909, -122.60944799999999],
  [45.615756, -122.609058],
  [45.615609, -122.608667],
  [45.615465, -122.608271],
  [45.615342, -122.60792199999999],
  [45.615196, -122.607483],
  [45.615051, -122.607045],
  [45.614844, -122.606296],
  [45.614676, -122.60568799999999],
  [45.614615, -122.605437],
  [45.61456, -122.60521399999999],
  [45.614463, -122.604816],
  [45.614296, -122.604134],
  [45.615035, -122.603645],
  [45.615104, -122.60359],
  [45.615152, -122.603539],
  [45.615207, -122.603473],
  [45.61525, -122.60340599999999],
  [45.615283, -122.603326],
  [45.615306, -122.60325399999999],
  [45.615328, -122.603175],
  [45.615348, -122.60308599999999],
  [45.615365, -122.602983],
  [45.615375, -122.602903],
  [45.61539, -122.602788],
  [45.615409, -122.602627],
  [45.615435, -122.60244999999999],
  [45.615452, -122.602389],
  [45.615471, -122.60233599999998],
  [45.615492, -122.602286],
  [45.615517, -122.602252],
  [45.615547, -122.602221],
  [45.615587, -122.602195],
  [45.615619, -122.60217799999998],
  [45.61568, -122.602162],
  [45.616235, -122.602102],
  [45.616905, -122.6021],
  [45.617991, -122.60212599999998],
  [45.619628, -122.602146],
  [45.620483, -122.60216],
  [45.620967, -122.602168],
  [45.621754, -122.60217199999998],
  [45.621906, -122.602174],
  [45.62198, -122.602169],
  [45.622043, -122.602163],
  [45.622119, -122.602156],
  [45.62217, -122.602151],
  [45.622229, -122.60213699999998],
  [45.622294, -122.602111],
  [45.622346, -122.602092],
  [45.622401, -122.602067],
  [45.622491, -122.60202899999999],
  [45.622647, -122.60192099999999],
  [45.622755, -122.60185699999998],
  [45.622842, -122.601803],
  [45.622904, -122.601767],
  [45.62298, -122.60174],
  [45.623058, -122.601715],
  [45.623134, -122.601695],
  [45.623214, -122.601678],
  [45.623292, -122.601665],
  [45.62337, -122.60165799999999],
  [45.623449, -122.60165199999999],
  [45.624057, -122.601661],
  [45.626841, -122.60171799999999],
  [45.626984, -122.60171399999999],
  [45.62818, -122.60175799999999],
  [45.628794, -122.601688],
  [45.628976, -122.601681],
  [45.630479, -122.601527],
  [45.630606, -122.601512],
  [45.630734, -122.60149599999998],
  [45.630861, -122.601475],
  [45.630988, -122.601451],
  [45.631114, -122.601424],
  [45.63124, -122.60139399999998],
  [45.631365, -122.601361],
  [45.63149, -122.60132299999998],
  [45.631614, -122.60128499999999],
  [45.631738, -122.601242],
  [45.631862, -122.601197],
  [45.631985, -122.601147],
  [45.632107, -122.601096],
  [45.632229, -122.60104],
  [45.632349, -122.600984],
  [45.632471, -122.600922],
  [45.632656, -122.600822],
  [45.633439, -122.600408],
  [45.633498, -122.600374],
  [45.633555, -122.600345],
  [45.633614, -122.600317],
  [45.633672, -122.60028799999999],
  [45.633732, -122.60026399999998],
  [45.633791, -122.600239],
  [45.633852, -122.600216],
  [45.633912, -122.600196],
  [45.633971, -122.60017599999999],
  [45.634032, -122.60015699999998],
  [45.634093, -122.600142],
  [45.634154, -122.60012599999999],
  [45.634214, -122.60011199999998],
  [45.634275, -122.60010099999998],
  [45.634338, -122.60009],
  [45.634399, -122.600081],
  [45.634461, -122.60007399999999],
  [45.634521, -122.600068],
  [45.634583, -122.60006299999999],
  [45.634691, -122.60005899999999],
  [45.63563, -122.600103],
  [45.636706, -122.600129],
  [45.638667, -122.600188],
  [45.639449, -122.600211],
  [45.639523, -122.60021199999998],
  [45.639619, -122.600216],
  [45.639714, -122.60021899999998],
  [45.63981, -122.600234],
  [45.639905, -122.60025],
  [45.639998, -122.60027699999999],
  [45.640091, -122.600304],
  [45.640186, -122.60033099999998],
  [45.640278, -122.60037099999998],
  [45.640368, -122.600412],
  [45.640677, -122.600526],
  [45.640794, -122.600574],
  [45.640908, -122.600623],
  [45.640972, -122.60064999999999],
  [45.64103, -122.600671],
  [45.641091, -122.60069499999999],
  [45.641158, -122.600714],
  [45.641232, -122.600733],
  [45.641313, -122.60075199999999],
  [45.641385, -122.600767],
  [45.641454, -122.600778],
  [45.641525, -122.600792],
  [45.641609, -122.60080299999998],
  [45.641526, -122.599029]
];

const stopNames = {
  "3185": "SW US Veterans Rd &amp; Building #16",
  "3187": "3515 SW US Veterans Rd",
  "3186": "US Veterans Hospital",
  "3188": "3505 SW US Veterans Rd",
  "6019": "SW Campus Dr &amp; Terwilliger",
  "112": "Andresen Park &amp; Ride",
  "3193": "SW Sam Jackson Pk &amp; US Veterans Rd",
  "3192": "SW Sam Jackson Pk &amp; OHSU",
  "3194": "SW Sam Jackson Pk &amp; Campus Dr"
};

const stops = [
  { stop_id: "6019", name: "SW Campus Dr &amp; Terwilliger", lat: 45.499278, lon: -122.682766, times: ["3:40 PM", "4:10 PM", "4:40 PM", "5:10 PM"] },
  { stop_id: "3185", name: "SW US Veterans Rd &amp; Building #16", lat: 45.496521, lon: -122.682243, times: ["3:43 PM", "4:13 PM", "4:43 PM", "5:13 PM"] },
  { stop_id: "3186", name: "US Veterans Hospital", lat: 45.497059, lon: -122.683296, times: ["3:44 PM", "4:14 PM", "4:44 PM", "5:14 PM"] },
  { stop_id: "3187", name: "3515 SW US Veterans Rd", lat: 45.497009, lon: -122.686493, times: ["3:45 PM", "4:15 PM", "4:45 PM", "5:15 PM"] },
  { stop_id: "3188", name: "3505 SW US Veterans Rd", lat: 45.497356, lon: -122.688156, times: ["3:46 PM", "4:16 PM", "4:46 PM", "5:16 PM"] },
  { stop_id: "3193", name: "SW Sam Jackson Pk &amp; US Veterans Rd", lat: 45.49905, lon: -122.687263, times: ["3:47 PM", "4:17 PM", "4:47 PM", "5:17 PM"] },
  { stop_id: "3192", name: "SW Sam Jackson Pk &amp; OHSU", lat: 45.499359, lon: -122.685471, times: ["3:48 PM", "4:18 PM", "4:48 PM", "5:18 PM"] },
  { stop_id: "3194", name: "SW Sam Jackson Pk &amp; Campus Dr", lat: 45.50034, lon: -122.684349, times: ["3:48 PM", "4:18 PM", "4:48 PM", "5:18 PM"] },
  { stop_id: "112", name: "Andresen Park &amp; Ride", lat: 45.641637, lon: -122.598955, times: ["4:53 PM", "5:29 PM", "5:56 PM", "6:19 PM"] },
]

    const polylineOut = L.polyline(shapeOutbound, { color: 'blue', weight: 4, opacity: 0.7 }).addTo(map);
    map.fitBounds(polylineOut.getBounds());

    const nowPT = new Date(new Date().toLocaleString('en-US', { timeZone: 'America/Los_Angeles' }));
    const nowMins = nowPT.getHours() * 60 + nowPT.getMinutes();

    stops.forEach(stop => {
      let highlightedTimes = [];
      let foundNext = false;
      stop.times.forEach(timeStr => {
        let cleanTime = timeStr.trim();
        let [h, m] = cleanTime.split(":");
        let schedMins = parseInt(h, 10) * 60 + parseInt(m, 10);
        if (schedMins < nowMins && nowMins - schedMins > 720) {
          schedMins += 1440;
        }
        if (!foundNext && schedMins >= nowMins) {
          highlightedTimes.push(`<span style="background:#4dd0e1; color:#000; padding:2px 6px; border-radius:6px; font-weight:bold;">${cleanTime}</span>`);
          foundNext = true;
        } else {
          highlightedTimes.push(cleanTime);
        }
      });

      L.circleMarker([stop.lat, stop.lon], {
        radius: 6,
        color: '#4dd0e1',
        fillColor: '#4dd0e1',
        fillOpacity: 0.9,
        weight: 1
      })
      .bindPopup(`<strong>${stop.name}</strong><br>${highlightedTimes.join("<br>") || 'No scheduled times'}`)
      .addTo(map);
    });

    let busMarkers = {};
    async function fetchAndDisplay() {
      const res = await fetch(`https://developer.trimet.org/ws/v2/vehicles?route=${routeNumber}&appID=${apiKey}&json=true`);
      const data = await res.json();
      const buses = (data.resultSet.vehicle || []).filter(v => v.routeNumber == routeNumber && v.direction == direction);

      Object.values(busMarkers).forEach(m => map.removeLayer(m));
      busMarkers = {};
      if (!buses.length) return;

      buses.forEach(bus => {
        if (!bus.latitude || !bus.longitude || !bus.blockID) return;
        const icon = L.divIcon({    
           className: '',
           html: `
            <div style="text-align:center;">
              <div style="background:#0071CE;color:#fff;padding:2px 6px;border-radius:6px;font-weight:bold;">${bus.vehicleID}</div>
              <div style="width:0;height:0;border-left:5px solid transparent;border-right:5px solid transparent;border-top:10px solid #00bfff;margin:auto;"></div>
            </div>
          `,
          iconSize: [40, 30], iconAnchor: [20, 30]
        });
        const marker = L.marker([bus.latitude, bus.longitude], { icon }).addTo(map);
        busMarkers[bus.vehicleID] = marker;
      });
    }
    fetchAndDisplay();
    setInterval(fetchAndDisplay, 15000);
  </script>

  <footer class="site-footer">
    <a href="terms.html">Terms of Use</a> &nbsp;|&nbsp;
    <a href="contact.html">Contact Us</a> &nbsp;|&nbsp;
    <a href="report.html">Report a Problem</a> &nbsp;|&nbsp;
    <a href="dmca.html">DMCA</a> &nbsp;|&nbsp;
    <a href="privacy.html">Privacy Policy</a>
  </footer>

  <script>
    if (!localStorage.getItem('cookieConsent')) {
      document.write(`
        <div id="cookie-banner" style="position: fixed; bottom: 0; left: 0; right: 0; background: #333; color: #fff; padding: 1rem; z-index: 1000; font-size: 0.9rem; line-height: 1.4; text-align: center; box-sizing: border-box;">
          üì¢ We use cookies to improve functionality and analyze traffic.
          By using MetroFeed, you agree to our 
          <a href='privacy.html' style='color: #4dd0e1; text-decoration: underline;'>Privacy Policy</a>.<br>
          <button onclick='localStorage.setItem("cookieConsent", "true"); document.getElementById("cookie-banner").remove();' style='margin-top: 0.5rem; background: #4dd0e1; color: #000; border: none; padding: 0.5rem 1rem; border-radius: 5px; cursor: pointer; font-weight: bold;'>OK</button>
        </div>
      `);
    }
  </script>
</body>
</html>