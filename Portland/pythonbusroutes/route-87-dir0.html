<!DOCTYPE html>
<html lang="en">
<head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-EL337T4JX4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-EL337T4JX4');
</script>

<meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Route 87 - To Powell & 182nd | MetroFeed Portland</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', sans-serif;
      background-color: #0d0d0d;
      color: #cccccc;
      overflow-y: auto;
    }

    /* BACK BUTTON */
    .back-button-fixed {
      position: fixed;
      top: 20px;
      left: 20px;
      width: 45px;
      height: 45px;
      background-color: #4dd0e1;
      border: 2px solid #000;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1001;
      box-shadow: 0 0 10px #4dd0e1;
      cursor: pointer;
      transition: background 0.2s;
      outline: none;
    }
    .back-button-fixed:active, .back-button-fixed:focus {
      background-color: #1976d2;
    }
    .back-button-fixed svg {
      width: 24px;
      height: 24px;
      fill: #000;
      display: block;
    }
    .back-button-fixed:active svg,
    .back-button-fixed:focus svg {
      fill: #fff;
    }

    header {
      background-color: #0d0d0d;
      border-top: 4px solid #4dd0e1;
      border-bottom: 3px solid #4dd0e1;
      padding: 1rem;
      text-align: center;
    }

    header img {
      max-height: 60px;
    }

    h1 {
      text-align: center;
      margin: 1rem 0;
      font-size: 2rem;
      color: #f0f0f0;
    }

    .content-box {
      border-radius: 12px;
      padding: 0;
      margin: 0;
      background-color: #1e1e1e;
    }

    #map {
      width: 100%;
      height: 85vh;
      border: none;
      margin: 0 auto;
      display: block;
      border-radius: 8px;
    }

    .button-bar {
      display: flex;
      justify-content: center;
      margin: 1rem 0;
    }

    .button-bar a, .back-button {
      background: #4dd0e1;
      color: #0d0d0d;
      padding: 0.6rem 1.2rem;
      text-decoration: none;
      border-radius: 8px;
      font-weight: bold;
      border: none;
      cursor: pointer;
      box-shadow: 0 0 10px #4dd0e1;
    }

    .back-button:hover {
      background-color: #35c0d6;
    }

    .site-footer {
      text-align: center;
      margin-top: 3rem;
      margin-bottom: 120px;
      font-size: 0.85rem;
      color: #aaa;
    }

    .site-footer a {
      color: #00BFFF;
      text-decoration: none;
    }

    .site-footer a:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>
  
  <header>
    <img src="MetroFeedPortlandLogo.png" alt="MetroFeed Portland">
  </header>

  <!-- Beta Disclaimers -->
  <div class="disclaimer" style="margin: 1rem auto 0.5rem; max-width: 600px; font-size: 0.8rem; color: #bbb; text-align: center; padding: 0.5rem 1rem; background-color: #111; border: 1px dashed #444; border-radius: 6px;">
    ‚ö†Ô∏è This is a Beta program, work in progress. Please REPORT bugs and pretend to be impressed.
  </div>
  <div class="disclaimer" style="margin: 0 auto 1rem; max-width: 600px; font-size: 0.75rem; color: #888; text-align: center; padding: 0.25rem 1rem;">
    This tool is not affiliated with or endorsed by TriMet. For official schedules and service alerts, visit <a href="https://trimet.org" style="color:#4dd0e1;">trimet.org</a>.
  </div>

  <!-- Back button -->
  <button class="back-button-fixed" onclick="history.back()" aria-label="Go back">
    <svg viewBox="0 0 24 24">
      <path d="M15.5 19c-.28 0-.53-.11-.71-.29l-6.5-6.5a1.003 1.003 0 010-1.42l6.5-6.5a1.003 1.003 0 011.42 1.42L10.41 12l6.3 6.29a1.003 1.003 0 01-1.21 1.54z"/>
    </svg>
  </button>

  <h1>Route 87 - To Powell & 182nd</h1>

  <div class="content-box">
    <div id="map"></div>
    <div style="text-align:right; font-size: 0.7rem; color: #777; margin-top: 0.5rem;">
      Data courtesy of TriMet.
    </div>
  </div>

  <script>
    if (document.referrer === "" && performance.navigation.type === 0) {
      window.location.href = "/index.html";
    }

    const apiKey = "2C4447D4A42083BCD84DE3B8E";
    const routeNumber = 87;
    const direction = parseInt(0);

    const map = L.map('map', {
      center: [45.6, -122.7],
      zoom: 12,
      minZoom: 12,
      maxZoom: 18,
      maxBounds: [[45.3, -123.1], [45.9, -122.3]],
      maxBoundsViscosity: 1.0
    });
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { maxZoom: 19 }).addTo(map);

    const shapeOutbound = [
  [45.530556, -122.563858],
  [45.530678, -122.563903],
  [45.531008, -122.564005],
  [45.531055, -122.564003],
  [45.531106, -122.563969],
  [45.531154, -122.563897],
  [45.531162, -122.563873],
  [45.531172, -122.563846],
  [45.531186, -122.563794],
  [45.531199, -122.563739],
  [45.531234, -122.563555],
  [45.531163, -122.563535],
  [45.531062, -122.563504],
  [45.530303, -122.563198],
  [45.530197, -122.563158],
  [45.529906, -122.563116],
  [45.529894, -122.563118],
  [45.529758, -122.563141],
  [45.529692, -122.563131],
  [45.529684, -122.56313],
  [45.529636, -122.56312],
  [45.529533, -122.563066],
  [45.529466, -122.563],
  [45.529468, -122.562594],
  [45.52947, -122.562054],
  [45.529477, -122.561942],
  [45.529488, -122.561828],
  [45.529481, -122.561113],
  [45.529482, -122.560866],
  [45.529483, -122.560035],
  [45.529484, -122.559244],
  [45.529487, -122.558267],
  [45.529486, -122.558114],
  [45.529903, -122.558111],
  [45.529991, -122.55811],
  [45.530643, -122.558099],
  [45.530683, -122.558098],
  [45.530888, -122.558096],
  [45.531275, -122.558091],
  [45.531357, -122.55809],
  [45.531613, -122.558088],
  [45.531766, -122.558086],
  [45.532051, -122.558083],
  [45.532791, -122.558072],
  [45.532947, -122.558069],
  [45.533005, -122.558068],
  [45.53309, -122.558067],
  [45.533186, -122.558066],
  [45.533538, -122.558063],
  [45.533629, -122.558066],
  [45.533903, -122.558063],
  [45.534024, -122.558061],
  [45.534131, -122.55806],
  [45.534206, -122.558058],
  [45.534403, -122.558056],
  [45.535261, -122.558039],
  [45.53546, -122.558036],
  [45.536297, -122.558023],
  [45.536848, -122.558015],
  [45.537436, -122.558005],
  [45.537615, -122.558003],
  [45.537695, -122.558002],
  [45.537808, -122.558001],
  [45.537838, -122.558001],
  [45.538068, -122.557997],
  [45.538325, -122.557993],
  [45.538566, -122.557989],
  [45.538933, -122.557985],
  [45.539476, -122.557977],
  [45.539663, -122.557974],
  [45.540161, -122.557966],
  [45.540254, -122.557964],
  [45.540701, -122.557958],
  [45.541081, -122.557952],
  [45.541384, -122.557948],
  [45.541679, -122.557941],
  [45.54189, -122.557931],
  [45.541996, -122.557923],
  [45.542206, -122.557905],
  [45.542398, -122.557889],
  [45.542676, -122.557868],
  [45.542857, -122.557862],
  [45.54325, -122.557855],
  [45.543576, -122.55785],
  [45.544145, -122.55784],
  [45.544909, -122.557834],
  [45.545945, -122.557816],
  [45.54767, -122.557785],
  [45.547966, -122.55778],
  [45.548106, -122.557775],
  [45.54818, -122.557775],
  [45.548415, -122.557775],
  [45.548491, -122.557776],
  [45.548523, -122.557777],
  [45.548668, -122.557783],
  [45.549064, -122.557809],
  [45.549318, -122.557816],
  [45.549602, -122.557818],
  [45.549956, -122.557816],
  [45.550213, -122.557814],
  [45.550399, -122.557812],
  [45.550803, -122.55781],
  [45.551199, -122.557806],
  [45.55154, -122.557802],
  [45.551778, -122.5578],
  [45.551992, -122.557799],
  [45.552786, -122.557793],
  [45.553581, -122.557788],
  [45.554074, -122.557784],
  [45.554496, -122.557782],
  [45.554798, -122.557779],
  [45.554893, -122.557778],
  [45.555318, -122.557775],
  [45.555389, -122.557775],
  [45.555388, -122.557924],
  [45.555386, -122.558487],
  [45.555386, -122.558508],
  [45.555385, -122.55864],
  [45.555385, -122.55882],
  [45.555385, -122.558906],
  [45.555386, -122.559188],
  [45.555386, -122.559292],
  [45.555384, -122.55973],
  [45.555383, -122.560143],
  [45.555384, -122.560814],
  [45.555382, -122.561416],
  [45.55538, -122.561851],
  [45.555379, -122.562336],
  [45.555379, -122.562836],
  [45.55538, -122.56373],
  [45.55538, -122.563874],
  [45.555384, -122.564886],
  [45.555385, -122.565371],
  [45.555387, -122.565698],
  [45.555388, -122.566062],
  [45.555388, -122.56628],
  [45.555391, -122.567505],
  [45.555391, -122.567652],
  [45.555391, -122.567766],
  [45.555394, -122.56823],
  [45.555651, -122.568231],
  [45.55613, -122.568232],
  [45.556543, -122.568234],
  [45.556583, -122.568241],
  [45.556663, -122.568269],
  [45.556821, -122.567883],
  [45.556924, -122.567621],
  [45.55696, -122.567528],
  [45.557131, -122.567108],
  [45.557598, -122.565933],
  [45.557792, -122.565434],
  [45.557894, -122.565169],
  [45.557994, -122.56523],
  [45.558039, -122.565242],
  [45.55807, -122.565245],
  [45.558158, -122.565241],
  [45.558233, -122.565225],
  [45.558312, -122.565188],
  [45.55842, -122.565084],
  [45.558637, -122.564812],
  [45.558797, -122.564613],
  [45.558801, -122.564607],
  [45.558847, -122.56455],
  [45.558884, -122.56449],
  [45.558895, -122.564443],
  [45.558888, -122.564384],
  [45.558862, -122.564329],
  [45.558747, -122.564229],
  [45.558582, -122.564109],
  [45.558367, -122.563954],
  [45.558332, -122.564046],
  [45.558138, -122.564539],
  [45.557894, -122.565169],
  [45.557792, -122.565434],
  [45.557598, -122.565933],
  [45.557131, -122.567108],
  [45.55696, -122.567528],
  [45.556924, -122.567621],
  [45.556821, -122.567883],
  [45.556663, -122.568269],
  [45.556583, -122.568241],
  [45.556543, -122.568234],
  [45.55613, -122.568232],
  [45.555651, -122.568231],
  [45.555394, -122.56823],
  [45.555391, -122.567748],
  [45.555391, -122.567652],
  [45.555391, -122.567505],
  [45.555388, -122.56628],
  [45.555388, -122.566062],
  [45.555387, -122.565698],
  [45.555385, -122.565371],
  [45.555384, -122.564886],
  [45.55538, -122.563874],
  [45.555379, -122.562836],
  [45.555379, -122.562802],
  [45.555379, -122.562336],
  [45.55538, -122.561851],
  [45.555383, -122.560939],
  [45.555384, -122.560814],
  [45.555383, -122.560143],
  [45.555384, -122.55973],
  [45.555386, -122.559292],
  [45.555386, -122.559188],
  [45.555385, -122.558906],
  [45.555385, -122.55882],
  [45.555385, -122.55864],
  [45.555386, -122.558508],
  [45.555388, -122.557964],
  [45.555388, -122.557924],
  [45.555389, -122.557775],
  [45.555391, -122.557623],
  [45.55539, -122.557004],
  [45.555389, -122.556304],
  [45.55539, -122.556082],
  [45.555388, -122.555408],
  [45.555387, -122.554733],
  [45.55565, -122.554731],
  [45.55635, -122.554724],
  [45.556699, -122.554724],
  [45.557196, -122.554725],
  [45.558184, -122.554728],
  [45.558747, -122.554728],
  [45.558875, -122.55473],
  [45.558983, -122.554738],
  [45.559178, -122.554737],
  [45.559705, -122.554733],
  [45.55991, -122.554727],
  [45.560229, -122.554723],
  [45.561416, -122.554729],
  [45.561573, -122.55473],
  [45.562082, -122.55473],
  [45.562226, -122.55473],
  [45.56238, -122.55473],
  [45.563005, -122.554728],
  [45.563929, -122.554724],
  [45.564224, -122.554722],
  [45.564275, -122.554722],
  [45.564516, -122.554721],
  [45.56531, -122.554716],
  [45.565359, -122.554716],
  [45.565969, -122.554721],
  [45.566089, -122.554717],
  [45.56617, -122.554709],
  [45.566243, -122.55469],
  [45.566303, -122.554663],
  [45.566361, -122.554621],
  [45.566426, -122.554566],
  [45.566485, -122.554507],
  [45.566593, -122.554378],
  [45.566793, -122.554131],
  [45.566918, -122.553973],
  [45.566979, -122.55389],
  [45.567099, -122.553718],
  [45.567184, -122.553592],
  [45.567356, -122.553313],
  [45.567491, -122.553089],
  [45.567542, -122.553005],
  [45.567995, -122.552292],
  [45.568062, -122.552177],
  [45.568112, -122.552076],
  [45.568137, -122.552009],
  [45.568151, -122.551966],
  [45.568171, -122.551887],
  [45.568182, -122.551802],
  [45.568186, -122.551696],
  [45.568187, -122.551678],
  [45.568187, -122.551189],
  [45.568187, -122.549908],
  [45.568186, -122.549097],
  [45.568186, -122.548388],
  [45.568187, -122.548246],
  [45.568182, -122.547438],
  [45.568181, -122.547169],
  [45.568181, -122.547139],
  [45.568178, -122.546737],
  [45.568174, -122.546452],
  [45.568171, -122.546161],
  [45.568168, -122.546062],
  [45.568166, -122.546003],
  [45.568157, -122.545915],
  [45.568139, -122.545823],
  [45.568117, -122.545737],
  [45.568086, -122.545648],
  [45.568057, -122.545575],
  [45.568021, -122.545504],
  [45.567982, -122.54544],
  [45.567925, -122.545366],
  [45.567821, -122.54526],
  [45.56777, -122.545204],
  [45.567735, -122.545154],
  [45.567705, -122.545083],
  [45.567682, -122.545013],
  [45.567667, -122.544924],
  [45.567664, -122.544844],
  [45.567668, -122.544766],
  [45.567685, -122.544681],
  [45.567707, -122.544612],
  [45.567735, -122.544551],
  [45.567774, -122.544484],
  [45.567831, -122.544412],
  [45.567962, -122.544306],
  [45.567844, -122.544088],
  [45.567599, -122.543647],
  [45.567458, -122.543399],
  [45.567353, -122.543177],
  [45.567281, -122.543013],
  [45.567202, -122.542814],
  [45.567196, -122.542793],
  [45.567181, -122.542743],
  [45.567117, -122.542532],
  [45.567079, -122.542396],
  [45.567035, -122.542213],
  [45.567, -122.542023],
  [45.566969, -122.541801],
  [45.566961, -122.541724],
  [45.566951, -122.541626],
  [45.566942, -122.541412],
  [45.566939, -122.541241],
  [45.566941, -122.541043],
  [45.566948, -122.540892],
  [45.56695, -122.540849],
  [45.566968, -122.540655],
  [45.566993, -122.540463],
  [45.566967, -122.540294],
  [45.567038, -122.539854],
  [45.567169, -122.539044],
  [45.567218, -122.538746],
  [45.567225, -122.5387],
  [45.567265, -122.538446],
  [45.56729, -122.538221],
  [45.567297, -122.538115],
  [45.567302, -122.538032],
  [45.567308, -122.537862],
  [45.567306, -122.537668],
  [45.567283, -122.537334],
  [45.56726, -122.53715],
  [45.567229, -122.53696],
  [45.567196, -122.536792],
  [45.567163, -122.536655],
  [45.567118, -122.536494],
  [45.567073, -122.536353],
  [45.567058, -122.53631],
  [45.567013, -122.536189],
  [45.567004, -122.536025],
  [45.566922, -122.535841],
  [45.566837, -122.535678],
  [45.566741, -122.535518],
  [45.566647, -122.53538],
  [45.566555, -122.535256],
  [45.566426, -122.535091],
  [45.566315, -122.534958],
  [45.566234, -122.534956],
  [45.565998, -122.53467],
  [45.565919, -122.534564],
  [45.565818, -122.534383],
  [45.565709, -122.534154],
  [45.565641, -122.533984],
  [45.565547, -122.533729],
  [45.565494, -122.533578],
  [45.565449, -122.533452],
  [45.565351, -122.53319],
  [45.565193, -122.532745],
  [45.565192, -122.532743],
  [45.565198, -122.532544],
  [45.565029, -122.532068],
  [45.564969, -122.531899],
  [45.564906, -122.531717],
  [45.564779, -122.531353],
  [45.564725, -122.531198],
  [45.564662, -122.531028],
  [45.564616, -122.530915],
  [45.564557, -122.530786],
  [45.564463, -122.530721],
  [45.564386, -122.530585],
  [45.564312, -122.53047],
  [45.564229, -122.530347],
  [45.564123, -122.530213],
  [45.564099, -122.530096],
  [45.564026, -122.530018],
  [45.563957, -122.52995],
  [45.563795, -122.529804],
  [45.563704, -122.5298],
  [45.56362, -122.529722],
  [45.563515, -122.5296],
  [45.563415, -122.529474],
  [45.563324, -122.52935],
  [45.563267, -122.529257],
  [45.563198, -122.529134],
  [45.563133, -122.529017],
  [45.563063, -122.528872],
  [45.56299, -122.5287],
  [45.562935, -122.528551],
  [45.562859, -122.528302],
  [45.562851, -122.528086],
  [45.562781, -122.527714],
  [45.562763, -122.527627],
  [45.562724, -122.527432],
  [45.562558, -122.526608],
  [45.562464, -122.526141],
  [45.56238, -122.525671],
  [45.562293, -122.525129],
  [45.562219, -122.524667],
  [45.562113, -122.523985],
  [45.562093, -122.523853],
  [45.562048, -122.523549],
  [45.562013, -122.52327],
  [45.561985, -122.523026],
  [45.561966, -122.522788],
  [45.561962, -122.522745],
  [45.561903, -122.522611],
  [45.561891, -122.522338],
  [45.561884, -122.522158],
  [45.561882, -122.52197],
  [45.561881, -122.521542],
  [45.561881, -122.521377],
  [45.561881, -122.521145],
  [45.56188, -122.519999],
  [45.56188, -122.519775],
  [45.561877, -122.519605],
  [45.56187, -122.51949],
  [45.561858, -122.519336],
  [45.561836, -122.519158],
  [45.561807, -122.518986],
  [45.561769, -122.518805],
  [45.561724, -122.518623],
  [45.561688, -122.518503],
  [45.561644, -122.518378],
  [45.561585, -122.518221],
  [45.561515, -122.518062],
  [45.561401, -122.517833],
  [45.561279, -122.517595],
  [45.561024, -122.517083],
  [45.560645, -122.516337],
  [45.560502, -122.516055],
  [45.560454, -122.515955],
  [45.56022, -122.515493],
  [45.560022, -122.515105],
  [45.559848, -122.514744],
  [45.559798, -122.514623],
  [45.559747, -122.514492],
  [45.559706, -122.514374],
  [45.559665, -122.514236],
  [45.559632, -122.514114],
  [45.559599, -122.513975],
  [45.559566, -122.513811],
  [45.559539, -122.513636],
  [45.559522, -122.513492],
  [45.559505, -122.513317],
  [45.559549, -122.513199],
  [45.559545, -122.512911],
  [45.559542, -122.5125],
  [45.559495, -122.512372],
  [45.559497, -122.51187],
  [45.559496, -122.511414],
  [45.559495, -122.510297],
  [45.559495, -122.51009],
  [45.559497, -122.509394],
  [45.559497, -122.509303],
  [45.559497, -122.509096],
  [45.559492, -122.508936],
  [45.559478, -122.508746],
  [45.559457, -122.508547],
  [45.559433, -122.508392],
  [45.559404, -122.508242],
  [45.559333, -122.507935],
  [45.559357, -122.507829],
  [45.559327, -122.507698],
  [45.55924, -122.50732],
  [45.559164, -122.507216],
  [45.558962, -122.506349],
  [45.558983, -122.506219],
  [45.558895, -122.505841],
  [45.558806, -122.505465],
  [45.558621, -122.504676],
  [45.558538, -122.504544],
  [45.558076, -122.502568],
  [45.557772, -122.501273],
  [45.557601, -122.500497],
  [45.557601, -122.500232],
  [45.557551, -122.500012],
  [45.557424, -122.499427],
  [45.557309, -122.498904],
  [45.557188, -122.49834],
  [45.557061, -122.497754],
  [45.556982, -122.497633],
  [45.556735, -122.496478],
  [45.556758, -122.496348],
  [45.556563, -122.495448],
  [45.55653, -122.495294],
  [45.556499, -122.49515],
  [45.556415, -122.495011],
  [45.556254, -122.494261],
  [45.55604, -122.493269],
  [45.555971, -122.492987],
  [45.555985, -122.49285],
  [45.555929, -122.492666],
  [45.555865, -122.492483],
  [45.555814, -122.492336],
  [45.555697, -122.492209],
  [45.555621, -122.492039],
  [45.555463, -122.491727],
  [45.555275, -122.491406],
  [45.555151, -122.491236],
  [45.555042, -122.491099],
  [45.554895, -122.490929],
  [45.554547, -122.490563],
  [45.554175, -122.490144],
  [45.554139, -122.490012],
  [45.55403, -122.48989],
  [45.553935, -122.48977],
  [45.553882, -122.489694],
  [45.55377, -122.48953],
  [45.553668, -122.489355],
  [45.553587, -122.489197],
  [45.55352, -122.489047],
  [45.553473, -122.488925],
  [45.553405, -122.488734],
  [45.553317, -122.488607],
  [45.553265, -122.488406],
  [45.553236, -122.488268],
  [45.553212, -122.48812],
  [45.553186, -122.487931],
  [45.553171, -122.487781],
  [45.553161, -122.487612],
  [45.553157, -122.487422],
  [45.553156, -122.486853],
  [45.553156, -122.486125],
  [45.553166, -122.485407],
  [45.553169, -122.485078],
  [45.553167, -122.484635],
  [45.553165, -122.484488],
  [45.553158, -122.484141],
  [45.553156, -122.483954],
  [45.553155, -122.483748],
  [45.553155, -122.482235],
  [45.553155, -122.482033],
  [45.553154, -122.481264],
  [45.553154, -122.480994],
  [45.553154, -122.480851],
  [45.553152, -122.480708],
  [45.553144, -122.480523],
  [45.553137, -122.480411],
  [45.55312, -122.48023],
  [45.553097, -122.480056],
  [45.55307, -122.479894],
  [45.553029, -122.4797],
  [45.552984, -122.479515],
  [45.552937, -122.479353],
  [45.552903, -122.479247],
  [45.552857, -122.479111],
  [45.552758, -122.47887],
  [45.552708, -122.478761],
  [45.552643, -122.478631],
  [45.552575, -122.478507],
  [45.552487, -122.478363],
  [45.552385, -122.478212],
  [45.55229, -122.478085],
  [45.55218, -122.477952],
  [45.552051, -122.477815],
  [45.55198, -122.477748],
  [45.551914, -122.47769],
  [45.551802, -122.477598],
  [45.551684, -122.477513],
  [45.551595, -122.477456],
  [45.551508, -122.477408],
  [45.551446, -122.477373],
  [45.551328, -122.47732],
  [45.551202, -122.47727],
  [45.551075, -122.47723],
  [45.550948, -122.477199],
  [45.550869, -122.477184],
  [45.5508, -122.477174],
  [45.550685, -122.477163],
  [45.550109, -122.477159],
  [45.549582, -122.477149],
  [45.549461, -122.477089],
  [45.547657, -122.477092],
  [45.547341, -122.477095],
  [45.547186, -122.477161],
  [45.546935, -122.477173],
  [45.546821, -122.47718],
  [45.546524, -122.477199],
  [45.54631, -122.47722],
  [45.546285, -122.477222],
  [45.546159, -122.477242],
  [45.545961, -122.477195],
  [45.545819, -122.477217],
  [45.545435, -122.477261],
  [45.5451, -122.477282],
  [45.544747, -122.477296],
  [45.544345, -122.477305],
  [45.544249, -122.477306],
  [45.544074, -122.477307],
  [45.544033, -122.477308],
  [45.543734, -122.477308],
  [45.543166, -122.477312],
  [45.542826, -122.477318],
  [45.542599, -122.477317],
  [45.542403, -122.477316],
  [45.541797, -122.477317],
  [45.541175, -122.47731],
  [45.540851, -122.477308],
  [45.540713, -122.477305],
  [45.540418, -122.477288],
  [45.540321, -122.477362],
  [45.539986, -122.477351],
  [45.539782, -122.477344],
  [45.53942, -122.477338],
  [45.538874, -122.477333],
  [45.538472, -122.477332],
  [45.538184, -122.477333],
  [45.537338, -122.477333],
  [45.53729, -122.477333],
  [45.537108, -122.477265],
  [45.537, -122.477263],
  [45.536664, -122.477265],
  [45.535778, -122.47727],
  [45.535483, -122.477271],
  [45.535082, -122.477272],
  [45.534872, -122.477272],
  [45.534699, -122.477272],
  [45.534587, -122.477271],
  [45.534373, -122.477273],
  [45.534109, -122.477275],
  [45.53406, -122.477275],
  [45.533671, -122.477278],
  [45.532894, -122.477271],
  [45.532579, -122.47727],
  [45.531851, -122.477268],
  [45.531733, -122.477267],
  [45.531251, -122.47727],
  [45.531094, -122.47727],
  [45.530982, -122.477266],
  [45.53087, -122.477257],
  [45.530746, -122.47724],
  [45.530615, -122.477216],
  [45.53054, -122.4772],
  [45.530428, -122.477174],
  [45.530117, -122.477094],
  [45.530014, -122.477073],
  [45.529913, -122.477059],
  [45.529759, -122.477043],
  [45.529673, -122.477035],
  [45.529556, -122.47703],
  [45.52888, -122.477038],
  [45.528182, -122.477047],
  [45.528105, -122.477048],
  [45.527721, -122.477053],
  [45.527649, -122.477053],
  [45.527515, -122.477055],
  [45.527049, -122.477061],
  [45.527001, -122.477062],
  [45.526947, -122.477062],
  [45.526826, -122.477064],
  [45.526515, -122.477068],
  [45.526411, -122.477067],
  [45.526292, -122.477066],
  [45.526012, -122.477071],
  [45.525754, -122.477075],
  [45.525616, -122.477078],
  [45.525005, -122.477087],
  [45.524474, -122.477094],
  [45.523856, -122.477101],
  [45.523749, -122.477102],
  [45.522663, -122.477118],
  [45.522391, -122.477121],
  [45.522164, -122.477125],
  [45.5221, -122.477125],
  [45.522036, -122.477126],
  [45.522017, -122.477126],
  [45.521997, -122.477126],
  [45.52191, -122.477127],
  [45.521842, -122.477127],
  [45.52151, -122.477131],
  [45.5215, -122.477131],
  [45.521217, -122.477135],
  [45.520549, -122.477143],
  [45.519859, -122.477154],
  [45.519371, -122.47716],
  [45.519305, -122.477161],
  [45.519162, -122.477161],
  [45.519007, -122.47716],
  [45.518932, -122.477156],
  [45.518788, -122.477138],
  [45.518689, -122.47712],
  [45.518472, -122.477072],
  [45.518129, -122.476998],
  [45.51789, -122.476946],
  [45.516803, -122.476708],
  [45.516619, -122.476667],
  [45.516503, -122.47663],
  [45.516398, -122.476588],
  [45.516282, -122.476527],
  [45.516194, -122.476465],
  [45.516073, -122.476375],
  [45.515969, -122.476281],
  [45.5158, -122.476126],
  [45.515763, -122.476092],
  [45.515696, -122.47604],
  [45.51559, -122.475964],
  [45.51552, -122.475927],
  [45.515437, -122.47588],
  [45.515332, -122.475836],
  [45.515224, -122.4758],
  [45.515122, -122.475778],
  [45.515012, -122.475762],
  [45.514953, -122.47576],
  [45.514834, -122.475755],
  [45.51462, -122.475756],
  [45.514504, -122.475751],
  [45.514352, -122.47575],
  [45.513661, -122.475742],
  [45.513035, -122.475731],
  [45.512553, -122.475725],
  [45.512416, -122.475724],
  [45.512308, -122.475722],
  [45.511947, -122.475717],
  [45.51158, -122.475711],
  [45.510489, -122.475701],
  [45.509698, -122.47569],
  [45.50959, -122.475689],
  [45.509127, -122.475682],
  [45.508201, -122.47567],
  [45.507873, -122.475666],
  [45.507676, -122.475663],
  [45.507382, -122.47566],
  [45.506915, -122.475654],
  [45.506076, -122.475643],
  [45.504688, -122.475625],
  [45.50457, -122.475624],
  [45.504187, -122.475622],
  [45.503826, -122.47562],
  [45.5034, -122.475618],
  [45.502734, -122.475614],
  [45.502185, -122.475608],
  [45.501506, -122.475607],
  [45.50114, -122.475604],
  [45.500859, -122.475603],
  [45.500597, -122.475602],
  [45.500283, -122.475601],
  [45.499279, -122.475595],
  [45.49812, -122.475588],
  [45.497648, -122.475584],
  [45.497335, -122.475582],
  [45.497253, -122.475644],
  [45.49705, -122.475643],
  [45.496816, -122.475643],
  [45.496785, -122.475622],
  [45.496715, -122.475576],
  [45.495625, -122.475572],
  [45.495521, -122.475571],
  [45.495158, -122.475569],
  [45.494951, -122.475568],
  [45.494748, -122.475566],
  [45.494457, -122.475565],
  [45.493682, -122.475561],
  [45.493005, -122.475559],
  [45.49243, -122.475556],
  [45.492332, -122.475555],
  [45.491769, -122.475551],
  [45.491675, -122.475551],
  [45.491546, -122.47555],
  [45.491407, -122.475613],
  [45.491223, -122.475612],
  [45.490983, -122.475634],
  [45.490439, -122.475633],
  [45.490309, -122.475543],
  [45.490249, -122.475349],
  [45.490021, -122.474597],
  [45.489848, -122.474014],
  [45.489797, -122.473823],
  [45.489729, -122.473517],
  [45.489702, -122.473393]
];

const stopNames = {
  "4287": "10000 Block NE Pacific St",
  "4522": "W Powell &amp; SW Duniway",
  "4724": "NE Prescott &amp; 102nd",
  "4730": "NE Prescott &amp; 102nd",
  "4766": "NE Prescott &amp; 92nd",
  "4767": "NE Prescott &amp; 92nd",
  "4769": "NE Prescott &amp; 97th",
  "4770": "NE Prescott &amp; 99th",
  "6506": "NE 102nd &amp; Beech",
  "6508": "NE 102nd &amp; Brazee",
  "6514": "NE 102nd &amp; Fremont",
  "6522": "1200 Block NE 102nd",
  "6528": "NE 102nd &amp; Shaver",
  "6530": "NE 102nd &amp; Tillamook",
  "6531": "NE 102nd &amp; Weidler",
  "6912": "NE 181st &amp; Davis",
  "6920": "NE 181st &amp; Glisan",
  "6923": "NE 181st &amp; Wasco",
  "6929": "SE 181st &amp; Yamhill",
  "6935": "SE 182nd &amp; Division",
  "6937": "SE 182nd &amp; Lincoln",
  "6938": "SE 182nd &amp; Market",
  "6943": "SE 182nd &amp; Stephens",
  "6944": "SE 182nd &amp; Tibbetts",
  "8194": "Gateway TC (drop off only stop)",
  "8580": "NE 181st &amp; Halsey",
  "8714": "NE 181st &amp; San Rafael",
  "8800": "4100 Block SE 182nd",
  "9061": "SE 181st &amp; E Burnside",
  "9106": "NE 105th &amp; Simpson",
  "9108": "NE Airport Way &amp; Ainsworth Circle",
  "9110": "NE Airport Way &amp; 122nd",
  "9112": "NE Airport Way &amp; 138th",
  "9619": "NE 105th &amp; Marx",
  "10699": "2900 Block NE 181st",
  "10716": "NE Airport Way &amp; Win Sivers Drive",
  "10717": "13100 Block NE Airport Way",
  "10718": "NE Airport Way &amp; 148th",
  "10719": "NE Airport Way &amp; 152nd Pl",
  "10720": "16400 Block NE Airport Way",
  "10721": "NE Airport Way &amp; Sandy Blvd",
  "10856": "Parkrose/ Sumner Transit Center",
  "10864": "Gateway Transit Center ",
  "10994": "NE Airport Way &amp; 158th",
  "11014": "NE Airport Way &amp; Riverside",
  "11073": "SE 181st Ave &amp; 180th Ave",
  "11231": "NE 181st &amp; Wilkes Rd",
  "13076": "SE 182nd &amp; Bush Terrace",
  "13199": "3500 Block SE 182nd",
  "13201": "NE Airport Way &amp; Mason Ct",
  "13598": "800 Block NE 181st",
  "13913": "9800 Block NE Prescott",
  "13914": "NE Prescott &amp; 96th",
  "14075": "NE 102nd &amp; Morris St",
  "14194": "NE Holman &amp; 112th",
  "14606": "NE 105th &amp; Prescott",
  "14607": "NE 105th &amp; Sandy"
};

const stops = [
  { stop_id: "8194", name: "Gateway TC (drop off only stop)", lat: 45.530568, lon: -122.563773, times: ["6:49 AM", "7:02 AM", "7:17 AM", "7:32 AM", "7:47 AM", "8:02 AM", "8:17 AM", "8:32 AM"] },
  { stop_id: "10864", name: "Gateway Transit Center ", lat: 45.5299, lon: -122.563177, times: ["6:51 AM", "7:04 AM", "7:19 AM", "7:34 AM", "7:49 AM", "8:04 AM", "8:19 AM", "8:34 AM"] },
  { stop_id: "4287", name: "10000 Block NE Pacific St", lat: 45.529407, lon: -122.560866, times: ["6:51 AM", "7:04 AM", "7:19 AM", "7:34 AM", "7:49 AM", "8:04 AM", "8:19 AM", "8:34 AM"] },
  { stop_id: "6522", name: "1200 Block NE 102nd", lat: 45.531609, lon: -122.55794, times: ["6:52 AM", "7:05 AM", "7:20 AM", "7:35 AM", "7:50 AM", "8:05 AM", "8:20 AM", "8:35 AM"] },
  { stop_id: "6531", name: "NE 102nd &amp; Weidler", lat: 45.533937, lon: -122.557906, times: ["6:53 AM", "7:06 AM", "7:21 AM", "7:36 AM", "7:51 AM", "8:06 AM", "8:21 AM", "8:36 AM"] },
  { stop_id: "6530", name: "NE 102nd &amp; Tillamook", lat: 45.537436, lon: -122.557861, times: ["6:54 AM", "7:07 AM", "7:22 AM", "7:37 AM", "7:52 AM", "8:07 AM", "8:22 AM", "8:37 AM"] },
  { stop_id: "6508", name: "NE 102nd &amp; Brazee", lat: 45.540159, lon: -122.557809, times: ["6:54 AM", "7:08 AM", "7:23 AM", "7:38 AM", "7:53 AM", "8:08 AM", "8:23 AM", "8:38 AM"] },
  { stop_id: "14075", name: "NE 102nd &amp; Morris St", lat: 45.543249, lon: -122.5577, times: ["6:55 AM", "7:09 AM", "7:24 AM", "7:39 AM", "7:54 AM", "8:09 AM", "8:24 AM", "8:39 AM"] },
  { stop_id: "6514", name: "NE 102nd &amp; Fremont", lat: 45.548415, lon: -122.55761, times: ["6:56 AM", "7:10 AM", "7:25 AM", "7:40 AM", "7:55 AM", "8:10 AM", "8:25 AM", "8:40 AM"] },
  { stop_id: "6506", name: "NE 102nd &amp; Beech", lat: 45.550213, lon: -122.557672, times: ["6:57 AM", "7:11 AM", "7:26 AM", "7:41 AM", "7:56 AM", "8:11 AM", "8:26 AM", "8:41 AM"] },
  { stop_id: "6528", name: "NE 102nd &amp; Shaver", lat: 45.551539, lon: -122.557669, times: ["6:57 AM", "7:11 AM", "7:26 AM", "7:41 AM", "7:56 AM", "8:11 AM", "8:26 AM", "8:41 AM"] },
  { stop_id: "4730", name: "NE Prescott &amp; 102nd", lat: 45.55547, lon: -122.55849, times: ["6:58 AM", "7:12 AM", "7:27 AM", "7:42 AM", "7:57 AM", "8:12 AM", "8:27 AM", "8:42 AM"] },
  { stop_id: "13913", name: "9800 Block NE Prescott", lat: 45.555468, lon: -122.561417, times: ["6:59 AM", "7:13 AM", "7:28 AM", "7:43 AM", "7:58 AM", "8:13 AM", "8:28 AM", "8:43 AM"] },
  { stop_id: "13914", name: "NE Prescott &amp; 96th", lat: 45.555432, lon: -122.56373, times: ["6:59 AM", "7:13 AM", "7:28 AM", "7:43 AM", "7:58 AM", "8:13 AM", "8:28 AM", "8:43 AM"] },
  { stop_id: "4767", name: "NE Prescott &amp; 92nd", lat: 45.555453, lon: -122.567765, times: ["7:00 AM", "7:14 AM", "7:29 AM", "7:44 AM", "7:59 AM", "8:14 AM", "8:29 AM", "8:44 AM"] },
  { stop_id: "10856", name: "Parkrose/ Sumner Transit Center", lat: 45.558736, lon: -122.564507, times: ["6:47 AM", "7:02 AM", "7:16 AM", "7:31 AM", "7:46 AM", "8:01 AM", "8:16 AM", "8:31 AM"] },
  { stop_id: "4766", name: "NE Prescott &amp; 92nd", lat: 45.555318, lon: -122.567749, times: ["6:48 AM", "7:03 AM", "7:17 AM", "7:32 AM", "7:47 AM", "8:02 AM", "8:17 AM", "8:32 AM"] },
  { stop_id: "4769", name: "NE Prescott &amp; 97th", lat: 45.555333, lon: -122.562811, times: ["6:48 AM", "7:03 AM", "7:18 AM", "7:33 AM", "7:48 AM", "8:03 AM", "8:18 AM", "8:33 AM"] },
  { stop_id: "4770", name: "NE Prescott &amp; 99th", lat: 45.55531, lon: -122.560937, times: ["6:49 AM", "7:04 AM", "7:18 AM", "7:33 AM", "7:48 AM", "8:03 AM", "8:18 AM", "8:33 AM"] },
  { stop_id: "4724", name: "NE Prescott &amp; 102nd", lat: 45.55532, lon: -122.557964, times: ["6:49 AM", "7:04 AM", "7:18 AM", "7:33 AM", "7:48 AM", "8:03 AM", "8:18 AM", "8:33 AM"] },
  { stop_id: "14606", name: "NE 105th &amp; Prescott", lat: 45.555657, lon: -122.554658, times: ["6:50 AM", "7:05 AM", "7:19 AM", "7:34 AM", "7:49 AM", "8:04 AM", "8:19 AM", "8:34 AM"] },
  { stop_id: "14607", name: "NE 105th &amp; Sandy", lat: 45.559185, lon: -122.554671, times: ["6:50 AM", "7:05 AM", "7:20 AM", "7:35 AM", "7:50 AM", "8:05 AM", "8:20 AM", "8:35 AM"] },
  { stop_id: "9619", name: "NE 105th &amp; Marx", lat: 45.561417, lon: -122.554642, times: ["6:51 AM", "7:06 AM", "7:20 AM", "7:35 AM", "7:50 AM", "8:05 AM", "8:20 AM", "8:35 AM"] },
  { stop_id: "9106", name: "NE 105th &amp; Simpson", lat: 45.565359, lon: -122.55463, times: ["6:52 AM", "7:07 AM", "7:21 AM", "7:36 AM", "7:51 AM", "8:06 AM", "8:21 AM", "8:36 AM"] },
  { stop_id: "14194", name: "NE Holman &amp; 112th", lat: 45.568129, lon: -122.547138, times: ["6:53 AM", "7:08 AM", "7:23 AM", "7:38 AM", "7:53 AM", "8:08 AM", "8:23 AM", "8:38 AM"] },
  { stop_id: "9108", name: "NE Airport Way &amp; Ainsworth Circle", lat: 45.56708, lon: -122.542864, times: ["6:54 AM", "7:09 AM", "7:24 AM", "7:39 AM", "7:54 AM", "8:09 AM", "8:24 AM", "8:39 AM"] },
  { stop_id: "10716", name: "NE Airport Way &amp; Win Sivers Drive", lat: 45.567236, lon: -122.538107, times: ["6:55 AM", "7:10 AM", "7:24 AM", "7:39 AM", "7:54 AM", "8:09 AM", "8:24 AM", "8:39 AM"] },
  { stop_id: "9110", name: "NE Airport Way &amp; 122nd", lat: 45.565148, lon: -122.532777, times: ["6:56 AM", "7:11 AM", "7:26 AM", "7:41 AM", "7:56 AM", "8:11 AM", "8:26 AM", "8:41 AM"] },
  { stop_id: "10717", name: "13100 Block NE Airport Way", lat: 45.562619, lon: -122.527475, times: ["6:56 AM", "7:11 AM", "7:26 AM", "7:41 AM", "7:56 AM", "8:11 AM", "8:26 AM", "8:41 AM"] },
  { stop_id: "9112", name: "NE Airport Way &amp; 138th", lat: 45.56182, lon: -122.521542, times: ["6:57 AM", "7:12 AM", "7:27 AM", "7:42 AM", "7:57 AM", "8:12 AM", "8:27 AM", "8:42 AM"] },
  { stop_id: "10718", name: "NE Airport Way &amp; 148th", lat: 45.559438, lon: -122.509394, times: ["6:59 AM", "7:14 AM", "7:29 AM", "7:44 AM", "7:59 AM", "8:14 AM", "8:29 AM", "8:44 AM"] },
  { stop_id: "10719", name: "NE Airport Way &amp; 152nd Pl", lat: 45.558789, lon: -122.505891, times: ["6:59 AM", "7:14 AM", "7:29 AM", "7:44 AM", "7:59 AM", "8:14 AM", "8:29 AM", "8:44 AM"] },
  { stop_id: "10994", name: "NE Airport Way &amp; 158th", lat: 45.557314, lon: -122.499476, times: ["7:00 AM", "7:15 AM", "7:30 AM", "7:45 AM", "8:00 AM", "8:15 AM", "8:30 AM", "8:45 AM"] },
  { stop_id: "10720", name: "16400 Block NE Airport Way", lat: 45.556459, lon: -122.495494, times: ["7:01 AM", "7:16 AM", "7:31 AM", "7:46 AM", "8:01 AM", "8:16 AM", "8:31 AM", "8:46 AM"] },
  { stop_id: "13201", name: "NE Airport Way &amp; Mason Ct", lat: 45.553802, lon: -122.489805, times: ["7:02 AM", "7:17 AM", "7:32 AM", "7:47 AM", "8:02 AM", "8:17 AM", "8:32 AM", "8:47 AM"] },
  { stop_id: "11014", name: "NE Airport Way &amp; Riverside", lat: 45.553094, lon: -122.481264, times: ["7:03 AM", "7:18 AM", "7:33 AM", "7:48 AM", "8:03 AM", "8:18 AM", "8:33 AM", "8:48 AM"] },
  { stop_id: "10721", name: "NE Airport Way &amp; Sandy Blvd", lat: 45.546312, lon: -122.477303, times: ["7:05 AM", "7:20 AM", "7:35 AM", "7:50 AM", "8:05 AM", "8:20 AM", "8:35 AM", "8:50 AM"] },
  { stop_id: "10699", name: "2900 Block NE 181st", lat: 45.544075, lon: -122.477486, times: ["7:05 AM", "7:20 AM", "7:35 AM", "7:50 AM", "8:05 AM", "8:20 AM", "8:35 AM", "8:50 AM"] },
  { stop_id: "11231", name: "NE 181st &amp; Wilkes Rd", lat: 45.539984, lon: -122.477449, times: ["7:06 AM", "7:21 AM", "7:36 AM", "7:51 AM", "8:06 AM", "8:21 AM", "8:36 AM", "8:51 AM"] },
  { stop_id: "8714", name: "NE 181st &amp; San Rafael", lat: 45.537338, lon: -122.477428, times: ["7:07 AM", "7:22 AM", "7:37 AM", "7:52 AM", "8:07 AM", "8:22 AM", "8:37 AM", "8:52 AM"] },
  { stop_id: "8580", name: "NE 181st &amp; Halsey", lat: 45.534872, lon: -122.477429, times: ["7:08 AM", "7:23 AM", "7:38 AM", "7:53 AM", "8:08 AM", "8:23 AM", "8:38 AM", "8:53 AM"] },
  { stop_id: "6923", name: "NE 181st &amp; Wasco", lat: 45.531851, lon: -122.47744, times: ["7:09 AM", "7:24 AM", "7:39 AM", "7:54 AM", "8:09 AM", "8:24 AM", "8:39 AM", "8:54 AM"] },
  { stop_id: "13598", name: "800 Block NE 181st", lat: 45.528881, lon: -122.477191, times: ["7:10 AM", "7:25 AM", "7:40 AM", "7:55 AM", "8:10 AM", "8:25 AM", "8:40 AM", "8:55 AM"] },
  { stop_id: "6920", name: "NE 181st &amp; Glisan", lat: 45.526012, lon: -122.47723, times: ["7:10 AM", "7:25 AM", "7:40 AM", "7:55 AM", "8:10 AM", "8:25 AM", "8:40 AM", "8:55 AM"] },
  { stop_id: "6912", name: "NE 181st &amp; Davis", lat: 45.523855, lon: -122.477246, times: ["7:11 AM", "7:26 AM", "7:41 AM", "7:56 AM", "8:11 AM", "8:26 AM", "8:41 AM", "8:56 AM"] },
  { stop_id: "9061", name: "SE 181st &amp; E Burnside", lat: 45.521511, lon: -122.477278, times: ["7:12 AM", "7:27 AM", "7:42 AM", "7:57 AM", "8:12 AM", "8:27 AM", "8:42 AM", "8:57 AM"] },
  { stop_id: "11073", name: "SE 181st Ave &amp; 180th Ave", lat: 45.51811, lon: -122.477135, times: ["7:13 AM", "7:28 AM", "7:43 AM", "7:58 AM", "8:13 AM", "8:28 AM", "8:43 AM", "8:58 AM"] },
  { stop_id: "6929", name: "SE 181st &amp; Yamhill", lat: 45.515745, lon: -122.476242, times: ["7:14 AM", "7:29 AM", "7:44 AM", "7:59 AM", "8:14 AM", "8:29 AM", "8:44 AM", "8:59 AM"] },
  { stop_id: "6938", name: "SE 182nd &amp; Market", lat: 45.51242, lon: -122.475879, times: ["7:15 AM", "7:30 AM", "7:45 AM", "8:00 AM", "8:15 AM", "8:30 AM", "8:45 AM", "9:00 AM"] },
  { stop_id: "6943", name: "SE 182nd &amp; Stephens", lat: 45.509695, lon: -122.475841, times: ["7:15 AM", "7:30 AM", "7:45 AM", "8:00 AM", "8:15 AM", "8:30 AM", "8:45 AM", "9:00 AM"] },
  { stop_id: "6937", name: "SE 182nd &amp; Lincoln", lat: 45.507674, lon: -122.475804, times: ["6:46 AM", "7:16 AM", "7:31 AM", "7:46 AM", "8:01 AM", "8:16 AM", "8:31 AM", "8:46 AM"] },
  { stop_id: "6935", name: "SE 182nd &amp; Division", lat: 45.504186, lon: -122.475783, times: ["6:47 AM", "7:17 AM", "7:32 AM", "7:47 AM", "8:02 AM", "8:17 AM", "8:32 AM", "8:47 AM"] },
  { stop_id: "6944", name: "SE 182nd &amp; Tibbetts", lat: 45.500857, lon: -122.475741, times: ["6:48 AM", "7:18 AM", "7:33 AM", "7:48 AM", "8:03 AM", "8:18 AM", "8:33 AM", "8:48 AM"] },
  { stop_id: "13199", name: "3500 Block SE 182nd", lat: 45.496759, lon: -122.475694, times: ["6:49 AM", "7:19 AM", "7:34 AM", "7:49 AM", "8:04 AM", "8:19 AM", "8:34 AM", "8:49 AM"] },
  { stop_id: "13076", name: "SE 182nd &amp; Bush Terrace", lat: 45.494953, lon: -122.475695, times: ["6:50 AM", "7:20 AM", "7:35 AM", "7:50 AM", "8:05 AM", "8:20 AM", "8:35 AM", "8:50 AM"] },
  { stop_id: "8800", name: "4100 Block SE 182nd", lat: 45.49243, lon: -122.475699, times: ["6:50 AM", "7:20 AM", "7:35 AM", "7:50 AM", "8:05 AM", "8:20 AM", "8:35 AM", "8:50 AM"] },
  { stop_id: "4522", name: "W Powell &amp; SW Duniway", lat: 45.489637, lon: -122.473421, times: ["6:52 AM", "7:22 AM", "7:37 AM", "7:52 AM", "8:07 AM", "8:22 AM", "8:37 AM", "8:52 AM"] },
]

    const polylineOut = L.polyline(shapeOutbound, { color: 'blue', weight: 4, opacity: 0.7 }).addTo(map);
    map.fitBounds(polylineOut.getBounds());

    const nowPT = new Date(new Date().toLocaleString('en-US', { timeZone: 'America/Los_Angeles' }));
    const nowMins = nowPT.getHours() * 60 + nowPT.getMinutes();

    stops.forEach(stop => {
      let highlightedTimes = [];
      let foundNext = false;
      stop.times.forEach(timeStr => {
        let cleanTime = timeStr.trim();
        let [h, m] = cleanTime.split(":");
        let schedMins = parseInt(h, 10) * 60 + parseInt(m, 10);
        if (schedMins < nowMins && nowMins - schedMins > 720) {
          schedMins += 1440;
        }
        if (!foundNext && schedMins >= nowMins) {
          highlightedTimes.push(`<span style="background:#4dd0e1; color:#000; padding:2px 6px; border-radius:6px; font-weight:bold;">${cleanTime}</span>`);
          foundNext = true;
        } else {
          highlightedTimes.push(cleanTime);
        }
      });

      L.circleMarker([stop.lat, stop.lon], {
        radius: 6,
        color: '#4dd0e1',
        fillColor: '#4dd0e1',
        fillOpacity: 0.9,
        weight: 1
      })
      .bindPopup(`<strong>${stop.name}</strong><br>${highlightedTimes.join("<br>") || 'No scheduled times'}`)
      .addTo(map);
    });

    let busMarkers = {};
    async function fetchAndDisplay() {
      const res = await fetch(`https://developer.trimet.org/ws/v2/vehicles?route=${routeNumber}&appID=${apiKey}&json=true`);
      const data = await res.json();
      const buses = (data.resultSet.vehicle || []).filter(v => v.routeNumber == routeNumber && v.direction == direction);

      Object.values(busMarkers).forEach(m => map.removeLayer(m));
      busMarkers = {};
      if (!buses.length) return;

      buses.forEach(bus => {
        if (!bus.latitude || !bus.longitude || !bus.blockID) return;
        const icon = L.divIcon({    
           className: '',
           html: `
            <div style="text-align:center;">
              <div style="background:#0071CE;color:#fff;padding:2px 6px;border-radius:6px;font-weight:bold;">${bus.vehicleID}</div>
              <div style="width:0;height:0;border-left:5px solid transparent;border-right:5px solid transparent;border-top:10px solid #00bfff;margin:auto;"></div>
            </div>
          `,
          iconSize: [40, 30], iconAnchor: [20, 30]
        });
        const marker = L.marker([bus.latitude, bus.longitude], { icon }).addTo(map);
        busMarkers[bus.vehicleID] = marker;
      });
    }
    fetchAndDisplay();
    setInterval(fetchAndDisplay, 15000);
  </script>

  <footer class="site-footer">
    <a href="terms.html">Terms of Use</a> &nbsp;|&nbsp;
    <a href="contact.html">Contact Us</a> &nbsp;|&nbsp;
    <a href="report.html">Report a Problem</a> &nbsp;|&nbsp;
    <a href="dmca.html">DMCA</a> &nbsp;|&nbsp;
    <a href="privacy.html">Privacy Policy</a>
  </footer>

  <script>
    if (!localStorage.getItem('cookieConsent')) {
      document.write(`
        <div id="cookie-banner" style="position: fixed; bottom: 0; left: 0; right: 0; background: #333; color: #fff; padding: 1rem; z-index: 1000; font-size: 0.9rem; line-height: 1.4; text-align: center; box-sizing: border-box;">
          üì¢ We use cookies to improve functionality and analyze traffic.
          By using MetroFeed, you agree to our 
          <a href='privacy.html' style='color: #4dd0e1; text-decoration: underline;'>Privacy Policy</a>.<br>
          <button onclick='localStorage.setItem("cookieConsent", "true"); document.getElementById("cookie-banner").remove();' style='margin-top: 0.5rem; background: #4dd0e1; color: #000; border: none; padding: 0.5rem 1rem; border-radius: 5px; cursor: pointer; font-weight: bold;'>OK</button>
        </div>
      `);
    }
  </script>
</body>
</html>