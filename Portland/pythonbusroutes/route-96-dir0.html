<!DOCTYPE html>
<html lang="en">
<head>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-EL337T4JX4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-EL337T4JX4');
</script>

<meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Route 96 - To Commerce Circle | MetroFeed Portland</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', sans-serif;
      background-color: #0d0d0d;
      color: #cccccc;
      overflow-y: auto;
    }

    .home-button {
      position: fixed;
      top: 120px;
      left: 10px;
      background-color: #4dd0e1;
      color: #0d0d0d;
      padding: 0.5rem 1rem;
      font-weight: bold;
      border-radius: 8px;
      text-decoration: none;
      z-index: 1001;
      box-shadow: 0 0 10px #4dd0e1;
    }

    .home-button:hover {
      background-color: #00bcd4;
      color: #ffffff;
    }

    header {
      background-color: #0d0d0d;
      border-top: 4px solid #4dd0e1;
      border-bottom: 3px solid #4dd0e1;
      padding: 1rem;
      text-align: center;
    }

    header img {
      max-height: 60px;
    }

    h1 {
      text-align: center;
      margin: 1rem 0;
      font-size: 2rem;
      color: #f0f0f0;
    }

    .content-box {
      border-radius: 12px;
      padding: 0;
      margin: 0;
      background-color: #1e1e1e;
    }

    #map {
      width: 100%;
      height: 85vh;
      border: none;
      margin: 0 auto;
      display: block;
      border-radius: 8px;
    }

    .button-bar {
      display: flex;
      justify-content: center;
      margin: 1rem 0;
    }

    .button-bar a, .back-button {
      background: #4dd0e1;
      color: #0d0d0d;
      padding: 0.6rem 1.2rem;
      text-decoration: none;
      border-radius: 8px;
      font-weight: bold;
      border: none;
      cursor: pointer;
      box-shadow: 0 0 10px #4dd0e1;
    }

    .back-button:hover {
      background-color: #35c0d6;
    }

    .site-footer {
      text-align: center;
      margin-top: 3rem;
      margin-bottom: 120px;
      font-size: 0.85rem;
      color: #aaa;
    }

    .site-footer a {
      color: #00BFFF;
      text-decoration: none;
    }

    .site-footer a:hover {
      text-decoration: underline;
    }

    
    }
  </style>
</head>

<body>
  

  <header>
    <img src="MetroFeedPortlandLogo.png" alt="MetroFeed Portland">
  </header>

  <div class="disclaimer" style="margin: 1rem auto 0.5rem; max-width: 600px; font-size: 0.8rem; color: #bbb; text-align: center; padding: 0.5rem 1rem; background-color: #111; border: 1px dashed #444; border-radius: 6px;">
    ‚ö†Ô∏è This is a Beta program, work in progress. Please REPORT bugs and pretend to be impressed.
  </div>
  <div class="disclaimer" style="margin: 0 auto 1rem; max-width: 600px; font-size: 0.75rem; color: #888; text-align: center; padding: 0.25rem 1rem;">
    This tool is not affiliated with or endorsed by TriMet. For official schedules and service alerts, visit <a href="https://trimet.org" style="color:#4dd0e1;">trimet.org</a>.
  </div>

  <div style="margin: 2rem 0; text-align: center;">
    <button class="back-button" onclick="history.back()">Back</button>
  </div>

  <h1>Route 96 - To Commerce Circle</h1>

  <div class="content-box">
    <div id="map"></div>
    <div style="text-align:right; font-size: 0.7rem; color: #777; margin-top: 0.5rem;">
      Data courtesy of TriMet.
    </div>
  </div>

  <script>
    if (document.referrer === "" && performance.navigation.type === 0) {
      window.location.href = "/index.html";
    }

    const apiKey = "2C4447D4A42083BCD84DE3B8E";
    const routeNumber = 96;
    const direction = parseInt(0);

    const map = L.map('map', {
      center: [45.6, -122.7],
      zoom: 12,
      minZoom: 12,
      maxZoom: 18,
      maxBounds: [[45.3, -123.1], [45.9, -122.3]],
      maxBoundsViscosity: 1.0
    });
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { maxZoom: 19 }).addTo(map);

    const shapeOutbound = [
  [45.515379, -122.684774],
  [45.515373, -122.684748],
  [45.51534, -122.684626],
  [45.515333, -122.684597],
  [45.515285, -122.684419],
  [45.515237, -122.684237],
  [45.515083, -122.683659],
  [45.514967, -122.683221],
  [45.514942, -122.683128],
  [45.514679, -122.68214],
  [45.5145, -122.681466],
  [45.514444, -122.681256],
  [45.514415, -122.681146],
  [45.514408, -122.681121],
  [45.514382, -122.681022],
  [45.514274, -122.680616],
  [45.514175, -122.680244],
  [45.514141, -122.680117],
  [45.514133, -122.680086],
  [45.514111, -122.680004],
  [45.514005, -122.679607],
  [45.513957, -122.679425],
  [45.513866, -122.679083],
  [45.513603, -122.678095],
  [45.513359, -122.677176],
  [45.513332, -122.677076],
  [45.513145, -122.676372],
  [45.513084, -122.676141],
  [45.512833, -122.675199],
  [45.512664, -122.675291],
  [45.512325, -122.675474],
  [45.51225, -122.675515],
  [45.512124, -122.675476],
  [45.512039, -122.675514],
  [45.511529, -122.675797],
  [45.51146, -122.675844],
  [45.511387, -122.675568],
  [45.511355, -122.675495],
  [45.5113, -122.675423],
  [45.511253, -122.675389],
  [45.511207, -122.67536],
  [45.511155, -122.675341],
  [45.511098, -122.675333],
  [45.511048, -122.675339],
  [45.510987, -122.675361],
  [45.510936, -122.675382],
  [45.510854, -122.675423],
  [45.510025, -122.675874],
  [45.510016, -122.675879],
  [45.509951, -122.675925],
  [45.509896, -122.675963],
  [45.509633, -122.676104],
  [45.509537, -122.676145],
  [45.509421, -122.676189],
  [45.509317, -122.676222],
  [45.509163, -122.676264],
  [45.509065, -122.676285],
  [45.508989, -122.676299],
  [45.508859, -122.67631],
  [45.508729, -122.67631],
  [45.508657, -122.676308],
  [45.508608, -122.676306],
  [45.508404, -122.676292],
  [45.508273, -122.676278],
  [45.508136, -122.676257],
  [45.508014, -122.676228],
  [45.507856, -122.676181],
  [45.50771, -122.676131],
  [45.507623, -122.676096],
  [45.507529, -122.67606],
  [45.507443, -122.676037],
  [45.507427, -122.676032],
  [45.507369, -122.676016],
  [45.507358, -122.676013],
  [45.507276, -122.675991],
  [45.507141, -122.675939],
  [45.506961, -122.67587],
  [45.506826, -122.675815],
  [45.50604, -122.675488],
  [45.505457, -122.675258],
  [45.505231, -122.675166],
  [45.504834, -122.674998],
  [45.504445, -122.674827],
  [45.503083, -122.674271],
  [45.502909, -122.674247],
  [45.502013, -122.673882],
  [45.501539, -122.673703],
  [45.501055, -122.673535],
  [45.50088, -122.67349],
  [45.500736, -122.673464],
  [45.50042, -122.673418],
  [45.5001, -122.67339],
  [45.499796, -122.673379],
  [45.499532, -122.673385],
  [45.499169, -122.67339],
  [45.498731, -122.673405],
  [45.497708, -122.673446],
  [45.497505, -122.673495],
  [45.494843, -122.673585],
  [45.493967, -122.673621],
  [45.493574, -122.673664],
  [45.493353, -122.673712],
  [45.492772, -122.673837],
  [45.492306, -122.673992],
  [45.491839, -122.674191],
  [45.491392, -122.674427],
  [45.491281, -122.67448],
  [45.491051, -122.674628],
  [45.490832, -122.674783],
  [45.490597, -122.674967],
  [45.490301, -122.675204],
  [45.489982, -122.675496],
  [45.489747, -122.675723],
  [45.489412, -122.676098],
  [45.48879, -122.676856],
  [45.488196, -122.677687],
  [45.48781, -122.678167],
  [45.487525, -122.67848],
  [45.487209, -122.678762],
  [45.486982, -122.678922],
  [45.486789, -122.679042],
  [45.486589, -122.679133],
  [45.486477, -122.679189],
  [45.486337, -122.679237],
  [45.48612, -122.679286],
  [45.485831, -122.67932],
  [45.48551, -122.67933],
  [45.485313, -122.679321],
  [45.485093, -122.679302],
  [45.484697, -122.679258],
  [45.483717, -122.679117],
  [45.483068, -122.679021],
  [45.482513, -122.678976],
  [45.48227, -122.678953],
  [45.482047, -122.678938],
  [45.481626, -122.678932],
  [45.480751, -122.678926],
  [45.480142, -122.678924],
  [45.47936, -122.678923],
  [45.478715, -122.678921],
  [45.477907, -122.678918],
  [45.477555, -122.678921],
  [45.47666, -122.678875],
  [45.476478, -122.67885],
  [45.476341, -122.678831],
  [45.476144, -122.678788],
  [45.475814, -122.678709],
  [45.47523, -122.678546],
  [45.475167, -122.678525],
  [45.47447, -122.678293],
  [45.47366, -122.677978],
  [45.472842, -122.677658],
  [45.472456, -122.677528],
  [45.472143, -122.677454],
  [45.471902, -122.677429],
  [45.471597, -122.677455],
  [45.471218, -122.677576],
  [45.471008, -122.677695],
  [45.470754, -122.677863],
  [45.470507, -122.678114],
  [45.470323, -122.678354],
  [45.470111, -122.678713],
  [45.470011, -122.678907],
  [45.469934, -122.679085],
  [45.469827, -122.679398],
  [45.469742, -122.679745],
  [45.46971, -122.680009],
  [45.469688, -122.680262],
  [45.469681, -122.680544],
  [45.469686, -122.680823],
  [45.469719, -122.68117],
  [45.469769, -122.681519],
  [45.469824, -122.681878],
  [45.470095, -122.683379],
  [45.470162, -122.683749],
  [45.470252, -122.684327],
  [45.470291, -122.684628],
  [45.470332, -122.684972],
  [45.47037, -122.685393],
  [45.470384, -122.685664],
  [45.470401, -122.686069],
  [45.470403, -122.686549],
  [45.47038, -122.686987],
  [45.470349, -122.687473],
  [45.470296, -122.687964],
  [45.470215, -122.688472],
  [45.470164, -122.688737],
  [45.4701, -122.688979],
  [45.47002, -122.689254],
  [45.469919, -122.689505],
  [45.469808, -122.689731],
  [45.469695, -122.689942],
  [45.469539, -122.690175],
  [45.469403, -122.690356],
  [45.469161, -122.690618],
  [45.468749, -122.691014],
  [45.468326, -122.691404],
  [45.468118, -122.69161],
  [45.467862, -122.691883],
  [45.467691, -122.692084],
  [45.467517, -122.692299],
  [45.46717, -122.692793],
  [45.466865, -122.693258],
  [45.466164, -122.694366],
  [45.465818, -122.694931],
  [45.465484, -122.695506],
  [45.464134, -122.698218],
  [45.463788, -122.698883],
  [45.463166, -122.699951],
  [45.462748, -122.700694],
  [45.46214, -122.701749],
  [45.461792, -122.702359],
  [45.461613, -122.702669],
  [45.460918, -122.70387],
  [45.460627, -122.704364],
  [45.460465, -122.704644],
  [45.460035, -122.705384],
  [45.459769, -122.705847],
  [45.458826, -122.707475],
  [45.458352, -122.708333],
  [45.457848, -122.709256],
  [45.457333, -122.710183],
  [45.456364, -122.711945],
  [45.456017, -122.71257],
  [45.454806, -122.714777],
  [45.454468, -122.7154],
  [45.45428, -122.715804],
  [45.45417, -122.716042],
  [45.454086, -122.716239],
  [45.45392, -122.716671],
  [45.453845, -122.716906],
  [45.453767, -122.717192],
  [45.45372, -122.717376],
  [45.453649, -122.717741],
  [45.453591, -122.718135],
  [45.453563, -122.718426],
  [45.453539, -122.718761],
  [45.453537, -122.719124],
  [45.45355, -122.719605],
  [45.453579, -122.720123],
  [45.453618, -122.720894],
  [45.453646, -122.721338],
  [45.453677, -122.722066],
  [45.453681, -122.72267],
  [45.453667, -122.72303],
  [45.45364, -122.723387],
  [45.453615, -122.723661],
  [45.453586, -122.723922],
  [45.453501, -122.724398],
  [45.453471, -122.724539],
  [45.45347, -122.724667],
  [45.453372, -122.725035],
  [45.453282, -122.725338],
  [45.453191, -122.725616],
  [45.453011, -122.726064],
  [45.452886, -122.726335],
  [45.4528, -122.726505],
  [45.452684, -122.726722],
  [45.452484, -122.727023],
  [45.452296, -122.727298],
  [45.452195, -122.727436],
  [45.451931, -122.727749],
  [45.451748, -122.727951],
  [45.451585, -122.728104],
  [45.451503, -122.728173],
  [45.451208, -122.728418],
  [45.450904, -122.72863],
  [45.450617, -122.72882],
  [45.449992, -122.729206],
  [45.448729, -122.729978],
  [45.448532, -122.730108],
  [45.448253, -122.730299],
  [45.448044, -122.730453],
  [45.447768, -122.73068],
  [45.447624, -122.730812],
  [45.447401, -122.731037],
  [45.447344, -122.731102],
  [45.447249, -122.731209],
  [45.447145, -122.731331],
  [45.446927, -122.731578],
  [45.446718, -122.731877],
  [45.446601, -122.732062],
  [45.446482, -122.732265],
  [45.446378, -122.732445],
  [45.446242, -122.732713],
  [45.446114, -122.732994],
  [45.445971, -122.73333],
  [45.445838, -122.733701],
  [45.44575, -122.733962],
  [45.445649, -122.734316],
  [45.44556, -122.734676],
  [45.445478, -122.735045],
  [45.445368, -122.735655],
  [45.445161, -122.73675],
  [45.445085, -122.73702],
  [45.444984, -122.73743],
  [45.444905, -122.737709],
  [45.444807, -122.738006],
  [45.444708, -122.738278],
  [45.444591, -122.738548],
  [45.444498, -122.738741],
  [45.444391, -122.73894],
  [45.444261, -122.739169],
  [45.44412, -122.739385],
  [45.443993, -122.739563],
  [45.443857, -122.739739],
  [45.443697, -122.739927],
  [45.443603, -122.740032],
  [45.44329, -122.740334],
  [45.44306, -122.74054],
  [45.442572, -122.740958],
  [45.442209, -122.741272],
  [45.441858, -122.741578],
  [45.441183, -122.742158],
  [45.440911, -122.742389],
  [45.440614, -122.742634],
  [45.440468, -122.742777],
  [45.440318, -122.742889],
  [45.440086, -122.743056],
  [45.439715, -122.743308],
  [45.439444, -122.74348],
  [45.43905, -122.743686],
  [45.438814, -122.743811],
  [45.438583, -122.743913],
  [45.438351, -122.744009],
  [45.438149, -122.744087],
  [45.437924, -122.744166],
  [45.437529, -122.744262],
  [45.437101, -122.744318],
  [45.436687, -122.744345],
  [45.436229, -122.744347],
  [45.434604, -122.744333],
  [45.433738, -122.744326],
  [45.432959, -122.744317],
  [45.430871, -122.744301],
  [45.430433, -122.744297],
  [45.428903, -122.744283],
  [45.426987, -122.744261],
  [45.426351, -122.744245],
  [45.421811, -122.744203],
  [45.42118, -122.744198],
  [45.420705, -122.744196],
  [45.419863, -122.74419],
  [45.418862, -122.744197],
  [45.417867, -122.74419],
  [45.416903, -122.744182],
  [45.416018, -122.744164],
  [45.415714, -122.744218],
  [45.415204, -122.744214],
  [45.414505, -122.744202],
  [45.412675, -122.74419],
  [45.410833, -122.744161],
  [45.410511, -122.744149],
  [45.410012, -122.744144],
  [45.409233, -122.744139],
  [45.40866, -122.744137],
  [45.408099, -122.744137],
  [45.407618, -122.744132],
  [45.407019, -122.744172],
  [45.406374, -122.744227],
  [45.405997, -122.744271],
  [45.405644, -122.744317],
  [45.405073, -122.744399],
  [45.403754, -122.744684],
  [45.403624, -122.74471],
  [45.403359, -122.744771],
  [45.403035, -122.74485],
  [45.402317, -122.745051],
  [45.401621, -122.745264],
  [45.40062, -122.745616],
  [45.400053, -122.745839],
  [45.399554, -122.746113],
  [45.399346, -122.746202],
  [45.398946, -122.746407],
  [45.398548, -122.746612],
  [45.398113, -122.746874],
  [45.398002, -122.74694],
  [45.397727, -122.747112],
  [45.397453, -122.747296],
  [45.397327, -122.747385],
  [45.397302, -122.747402],
  [45.397112, -122.747564],
  [45.397102, -122.747572],
  [45.396944, -122.747709],
  [45.396789, -122.74782],
  [45.396658, -122.747895],
  [45.396526, -122.747953],
  [45.396331, -122.74802],
  [45.396429, -122.748184],
  [45.396422, -122.748284],
  [45.396402, -122.748472],
  [45.396364, -122.74879],
  [45.396356, -122.748857],
  [45.39635, -122.748905],
  [45.39632, -122.749033],
  [45.396286, -122.749174],
  [45.396245, -122.749308],
  [45.396199, -122.749425],
  [45.39614, -122.749567],
  [45.396034, -122.749797],
  [45.395851, -122.74993],
  [45.395673, -122.749764],
  [45.395273, -122.749352],
  [45.39516, -122.749241],
  [45.395052, -122.749156],
  [45.395121, -122.748957],
  [45.39515, -122.748689],
  [45.395009, -122.74869],
  [45.39477, -122.748678],
  [45.394609, -122.748669],
  [45.394517, -122.748682],
  [45.394184, -122.748576],
  [45.394137, -122.748571],
  [45.394099, -122.74858],
  [45.394063, -122.748592],
  [45.394039, -122.748621],
  [45.394022, -122.748647],
  [45.394009, -122.748695],
  [45.393996, -122.748756],
  [45.393947, -122.748969],
  [45.393473, -122.748958],
  [45.393383, -122.748961],
  [45.393312, -122.748971],
  [45.393213, -122.748994],
  [45.393117, -122.749019],
  [45.393067, -122.749036],
  [45.393016, -122.749056],
  [45.392927, -122.749101],
  [45.392887, -122.749125],
  [45.392835, -122.749161],
  [45.392772, -122.749215],
  [45.392685, -122.7493],
  [45.392621, -122.749374],
  [45.392559, -122.749456],
  [45.392513, -122.749525],
  [45.392463, -122.7496],
  [45.392113, -122.750231],
  [45.392048, -122.75034],
  [45.391973, -122.750444],
  [45.391247, -122.751491],
  [45.39122, -122.75153],
  [45.390928, -122.751951],
  [45.390415, -122.752692],
  [45.390181, -122.753029],
  [45.390149, -122.753075],
  [45.390021, -122.753268],
  [45.389995, -122.753307],
  [45.389926, -122.75342],
  [45.389896, -122.753485],
  [45.3898, -122.75369],
  [45.389763, -122.753785],
  [45.38974, -122.753851],
  [45.38969, -122.754003],
  [45.389594, -122.754296],
  [45.389386, -122.754898],
  [45.389201, -122.755505],
  [45.389087, -122.755855],
  [45.389058, -122.755975],
  [45.389048, -122.756053],
  [45.389045, -122.756218],
  [45.389047, -122.75637],
  [45.38894, -122.756389],
  [45.388872, -122.756408],
  [45.388665, -122.756491],
  [45.388619, -122.75651],
  [45.388438, -122.756581],
  [45.388298, -122.756639],
  [45.387828, -122.756826],
  [45.387637, -122.756902],
  [45.387485, -122.756961],
  [45.387172, -122.757078],
  [45.387019, -122.757136],
  [45.38685, -122.7572],
  [45.386478, -122.75733],
  [45.386114, -122.757474],
  [45.385803, -122.757607],
  [45.385642, -122.757689],
  [45.385545, -122.757747],
  [45.385499, -122.757779],
  [45.385466, -122.757802],
  [45.385339, -122.757908],
  [45.385218, -122.758032],
  [45.385117, -122.758164],
  [45.385088, -122.758202],
  [45.38499, -122.758364],
  [45.384957, -122.758434],
  [45.384929, -122.758495],
  [45.384873, -122.75863],
  [45.384783, -122.758907],
  [45.384752, -122.759018],
  [45.38463, -122.758966],
  [45.384413, -122.758927],
  [45.384327, -122.758911],
  [45.384209, -122.758888],
  [45.384157, -122.758879],
  [45.383779, -122.758807],
  [45.383616, -122.758772],
  [45.383525, -122.758753],
  [45.383439, -122.758735],
  [45.383373, -122.758719],
  [45.383202, -122.758679],
  [45.383064, -122.758651],
  [45.382969, -122.758632],
  [45.382953, -122.758629],
  [45.382741, -122.758596],
  [45.382663, -122.758585],
  [45.382556, -122.758579],
  [45.382466, -122.758572],
  [45.382391, -122.758581],
  [45.382324, -122.758599],
  [45.382256, -122.758627],
  [45.382197, -122.758657],
  [45.382057, -122.758747],
  [45.382025, -122.758768],
  [45.381832, -122.758901],
  [45.381797, -122.758925],
  [45.381751, -122.75895],
  [45.381695, -122.758974],
  [45.38162, -122.759001],
  [45.381539, -122.759023],
  [45.381453, -122.75904],
  [45.38137, -122.759047],
  [45.38084, -122.759049],
  [45.380582, -122.75905],
  [45.380275, -122.759052],
  [45.38016, -122.759053],
  [45.380073, -122.759122],
  [45.379523, -122.75911],
  [45.379423, -122.759036],
  [45.379244, -122.759056],
  [45.378997, -122.759093],
  [45.378918, -122.759121],
  [45.378842, -122.759149],
  [45.378753, -122.759184],
  [45.37868, -122.75922],
  [45.378597, -122.759264],
  [45.378515, -122.75931],
  [45.378464, -122.759425],
  [45.378379, -122.759482],
  [45.37828, -122.759559],
  [45.378176, -122.759654],
  [45.378044, -122.759792],
  [45.377937, -122.759921],
  [45.377625, -122.760342],
  [45.377568, -122.760421],
  [45.377499, -122.760508],
  [45.377446, -122.760569],
  [45.377339, -122.760668],
  [45.377284, -122.760711],
  [45.377215, -122.760759],
  [45.377155, -122.760795],
  [45.377057, -122.760836],
  [45.377013, -122.760847],
  [45.376987, -122.760854],
  [45.376919, -122.760873],
  [45.376904, -122.760878],
  [45.376821, -122.760896],
  [45.376776, -122.7609],
  [45.376726, -122.760903],
  [45.376677, -122.760905],
  [45.376592, -122.7609],
  [45.376537, -122.760896],
  [45.376496, -122.760889],
  [45.376471, -122.760884],
  [45.376422, -122.760868],
  [45.376359, -122.760843],
  [45.376303, -122.760817],
  [45.376179, -122.760752],
  [45.376081, -122.760701],
  [45.376003, -122.760668],
  [45.375922, -122.760646],
  [45.375822, -122.760623],
  [45.375775, -122.76062],
  [45.375752, -122.760619],
  [45.37546, -122.760614],
  [45.375385, -122.76055],
  [45.375383, -122.760681],
  [45.375384, -122.761028],
  [45.375382, -122.761203],
  [45.375378, -122.762793],
  [45.37537, -122.763743],
  [45.375369, -122.76395],
  [45.375359, -122.765259],
  [45.375353, -122.765447],
  [45.375352, -122.765459],
  [45.375345, -122.765549],
  [45.37533, -122.7657],
  [45.375313, -122.765881],
  [45.375304, -122.766062],
  [45.375302, -122.766177],
  [45.375301, -122.766303],
  [45.375304, -122.766645],
  [45.375305, -122.766997],
  [45.375311, -122.767387],
  [45.375315, -122.76756],
  [45.375202, -122.767655],
  [45.374929, -122.767882],
  [45.373851, -122.768829],
  [45.372966, -122.769611],
  [45.372876, -122.76969],
  [45.372433, -122.770082],
  [45.372089, -122.770385],
  [45.371792, -122.770635],
  [45.371659, -122.770758],
  [45.371219, -122.771141],
  [45.370963, -122.771364],
  [45.370872, -122.771443],
  [45.370067, -122.772141],
  [45.369929, -122.772253],
  [45.369847, -122.772316],
  [45.369747, -122.772376],
  [45.36965, -122.772422],
  [45.369587, -122.772446],
  [45.369557, -122.772458],
  [45.36924, -122.772561],
  [45.369152, -122.772591],
  [45.368994, -122.772648],
  [45.368863, -122.772696],
  [45.368222, -122.772928],
  [45.368067, -122.772983],
  [45.367912, -122.773025],
  [45.36779, -122.773047],
  [45.367671, -122.773056],
  [45.367552, -122.773064],
  [45.367246, -122.773066],
  [45.366849, -122.773073],
  [45.366437, -122.773087],
  [45.365517, -122.773121],
  [45.365113, -122.773136],
  [45.365062, -122.773138],
  [45.364983, -122.773137],
  [45.364904, -122.773138],
  [45.364534, -122.773151],
  [45.36368, -122.773182],
  [45.363218, -122.773195],
  [45.363045, -122.773203],
  [45.362922, -122.773214],
  [45.36286, -122.773224],
  [45.3628, -122.773239],
  [45.362674, -122.773279],
  [45.362571, -122.773323],
  [45.362473, -122.773375],
  [45.362281, -122.77349],
  [45.361886, -122.773759],
  [45.361127, -122.774271],
  [45.360955, -122.774388],
  [45.360826, -122.774471],
  [45.360727, -122.774526],
  [45.360627, -122.774569],
  [45.360549, -122.7746],
  [45.360378, -122.774658],
  [45.360338, -122.77467],
  [45.36028, -122.774686],
  [45.360179, -122.774706],
  [45.360062, -122.774711],
  [45.359868, -122.77472],
  [45.359693, -122.774724],
  [45.358922, -122.77472],
  [45.358093, -122.774721],
  [45.357705, -122.774722],
  [45.356766, -122.774752],
  [45.35587, -122.774763],
  [45.355575, -122.774773],
  [45.355495, -122.774766],
  [45.355391, -122.774763],
  [45.355189, -122.774759],
  [45.355131, -122.774758],
  [45.354569, -122.774748],
  [45.354354, -122.774744],
  [45.35407, -122.774749],
  [45.353787, -122.774753],
  [45.353681, -122.774753],
  [45.35357, -122.774754],
  [45.353384, -122.774749],
  [45.353056, -122.77474],
  [45.352649, -122.774724],
  [45.351946, -122.774716],
  [45.351144, -122.774723],
  [45.35104, -122.774719],
  [45.350849, -122.774716],
  [45.350353, -122.774721],
  [45.35024, -122.774733],
  [45.35013, -122.774734],
  [45.350013, -122.774749],
  [45.34989, -122.774779],
  [45.349778, -122.774818],
  [45.34948, -122.774914],
  [45.349052, -122.775067],
  [45.348841, -122.775105],
  [45.348648, -122.775106],
  [45.348418, -122.7751],
  [45.347296, -122.775021],
  [45.347064, -122.774988],
  [45.346974, -122.774976],
  [45.345798, -122.774881],
  [45.345193, -122.774839],
  [45.344881, -122.774808],
  [45.344664, -122.774766],
  [45.344411, -122.774683],
  [45.344125, -122.774562],
  [45.343788, -122.774341],
  [45.343564, -122.774172],
  [45.343448, -122.774085],
  [45.343301, -122.774002],
  [45.343142, -122.773907],
  [45.34286, -122.773802],
  [45.342293, -122.773722],
  [45.341991, -122.773746],
  [45.341812, -122.773763],
  [45.341716, -122.773784],
  [45.341626, -122.773802],
  [45.341526, -122.773815],
  [45.341428, -122.773822],
  [45.341334, -122.77383],
  [45.34124, -122.773831],
  [45.341033, -122.773806],
  [45.340919, -122.773789],
  [45.340679, -122.773717],
  [45.340604, -122.773694],
  [45.340493, -122.773659],
  [45.340359, -122.773618],
  [45.340246, -122.773574],
  [45.340153, -122.773542],
  [45.339761, -122.773407],
  [45.339176, -122.773194],
  [45.338955, -122.773119],
  [45.338836, -122.773082],
  [45.338718, -122.773037],
  [45.338351, -122.772912],
  [45.33817, -122.773002],
  [45.338121, -122.772993],
  [45.338065, -122.772989],
  [45.338034, -122.772991],
  [45.338002, -122.773005],
  [45.337966, -122.773026],
  [45.337909, -122.773076],
  [45.337791, -122.773172],
  [45.337776, -122.77337],
  [45.337718, -122.77366],
  [45.337675, -122.77382],
  [45.337667, -122.773892],
  [45.337659, -122.773968],
  [45.337644, -122.774141],
  [45.33764, -122.774294],
  [45.337638, -122.774601],
  [45.337638, -122.774707],
  [45.337636, -122.775075],
  [45.337632, -122.776191],
  [45.337627, -122.776319],
  [45.337616, -122.776424],
  [45.337594, -122.776526],
  [45.337564, -122.776624],
  [45.337523, -122.776742],
  [45.337475, -122.776842],
  [45.337423, -122.776929],
  [45.337348, -122.777025],
  [45.337277, -122.777091],
  [45.337218, -122.777142],
  [45.337149, -122.777185],
  [45.337093, -122.777211],
  [45.337039, -122.777232],
  [45.336942, -122.777251],
  [45.336856, -122.777255],
  [45.336462, -122.777251],
  [45.336377, -122.77725],
  [45.336154, -122.777248],
  [45.336014, -122.777246],
  [45.335915, -122.777239],
  [45.335825, -122.777214],
  [45.335741, -122.777173],
  [45.335724, -122.777162],
  [45.335672, -122.777129],
  [45.335546, -122.777012],
  [45.335474, -122.776917],
  [45.335395, -122.77678],
  [45.335347, -122.776666],
  [45.33531, -122.77655],
  [45.335281, -122.776412],
  [45.335273, -122.776349],
  [45.335264, -122.776234],
  [45.335265, -122.775595],
  [45.335265, -122.7755],
  [45.335265, -122.775495]
];

const stopNames = {
  "495": "18200 Block SW Boones Ferry Rd",
  "500": "SW Boones Ferry Rd &amp; Alsea",
  "501": "SW Boones Ferry Rd &amp; Apache",
  "514": "SW Lower Boones Ferry &amp; Childs Rd",
  "522": "SW Boones Ferry Rd &amp; Day",
  "530": "SW Boones Ferry Rd &amp; Ibach",
  "542": "SW Boones Ferry Rd &amp; Norwood",
  "558": "18000 Block SW Lower Boones Ferry",
  "563": "SW Boones Ferry Rd &amp; Siletz",
  "1108": "SW Columbia &amp; Park Ave",
  "3779": "SW Martinazzi &amp; Seneca",
  "5004": "SW Sagert &amp; 86th",
  "7880": "Tualatin Park &amp; Ride",
  "8252": "SW Martinazzi &amp; Martinazzi Square",
  "8274": "SW Martinazzi &amp; Mohawk",
  "8276": "SW Sagert &amp; Tillamook",
  "8278": "SW Sagert &amp; Tillamook",
  "8285": "SW Martinazzi &amp; Mohawk",
  "8391": "9900 Block SW Commerce Circle",
  "8788": "SW Sagert &amp; 86th",
  "8891": "24300 Block SW Boones Ferry Rd",
  "8956": "I-5 Off Ramp &amp; SW Lower Boones Ferry",
  "9026": "SW Martinazzi &amp; Tualatin-Sherwood",
  "9352": "SW Boones Ferry Rd &amp; Avery",
  "9484": "9400 Block SW Commerce Circle",
  "9512": "SW Boones Ferry Rd &amp; Iowa Dr",
  "10712": "S Harbor &amp; Harrison",
  "11001": "S Harbor &amp; Montgomery",
  "12794": "SW Columbia between 5th &amp; 4th",
  "12795": "SW Columbia &amp; 1st",
  "13493": "10100 Block SW Commerce Circle",
  "14574": "SW Boones Ferry Rd &amp; Salinan"
};

const stops = [
  { stop_id: "1108", name: "SW Columbia &amp; Park Ave", lat: 45.514919, lon: -122.683248, times: ["2:40 PM", "3:09 PM", "3:40 PM", "4:09 PM", "4:40 PM", "5:10 PM", "5:40 PM", "6:10 PM"] },
  { stop_id: "12794", name: "SW Columbia between 5th &amp; 4th", lat: 45.513954, lon: -122.679634, times: ["2:42 PM", "3:12 PM", "3:42 PM", "4:12 PM", "4:42 PM", "5:12 PM", "5:42 PM", "6:12 PM"] },
  { stop_id: "12795", name: "SW Columbia &amp; 1st", lat: 45.513088, lon: -122.676402, times: ["2:42 PM", "3:12 PM", "3:42 PM", "4:12 PM", "4:42 PM", "5:12 PM", "5:42 PM", "6:12 PM"] },
  { stop_id: "11001", name: "S Harbor &amp; Montgomery", lat: 45.510045, lon: -122.675946, times: ["2:42 PM", "3:12 PM", "3:42 PM", "4:12 PM", "4:42 PM", "5:13 PM", "5:42 PM", "6:12 PM"] },
  { stop_id: "10712", name: "S Harbor &amp; Harrison", lat: 45.507127, lon: -122.675992, times: ["2:43 PM", "3:13 PM", "3:43 PM", "4:13 PM", "4:43 PM", "5:13 PM", "5:43 PM", "6:13 PM"] },
  { stop_id: "8956", name: "I-5 Off Ramp &amp; SW Lower Boones Ferry", lat: 45.397158, lon: -122.747711, times: ["2:19 PM", "3:02 PM", "3:32 PM", "4:02 PM", "4:34 PM", "5:04 PM", "5:35 PM", "6:03 PM"] },
  { stop_id: "7880", name: "Tualatin Park &amp; Ride", lat: 45.394763, lon: -122.748759, times: ["2:20 PM", "3:03 PM", "3:33 PM", "4:03 PM", "4:35 PM", "5:05 PM", "5:36 PM", "6:04 PM"] },
  { stop_id: "558", name: "18000 Block SW Lower Boones Ferry", lat: 45.390978, lon: -122.752021, times: ["2:21 PM", "3:04 PM", "3:34 PM", "4:04 PM", "4:36 PM", "5:06 PM", "5:37 PM", "6:05 PM"] },
  { stop_id: "514", name: "SW Lower Boones Ferry &amp; Childs Rd", lat: 45.390074, lon: -122.753345, times: ["2:21 PM", "3:04 PM", "3:34 PM", "4:04 PM", "4:36 PM", "5:07 PM", "5:38 PM", "6:05 PM"] },
  { stop_id: "495", name: "18200 Block SW Boones Ferry Rd", lat: 45.387046, lon: -122.757268, times: ["2:22 PM", "3:06 PM", "3:36 PM", "4:06 PM", "4:38 PM", "5:08 PM", "5:39 PM", "6:07 PM"] },
  { stop_id: "3779", name: "SW Martinazzi &amp; Seneca", lat: 45.383605, lon: -122.758878, times: ["2:23 PM", "3:07 PM", "3:37 PM", "4:07 PM", "4:39 PM", "5:10 PM", "5:41 PM", "6:08 PM"] },
  { stop_id: "9026", name: "SW Martinazzi &amp; Tualatin-Sherwood", lat: 45.381872, lon: -122.75903, times: ["2:24 PM", "3:08 PM", "3:38 PM", "4:08 PM", "4:40 PM", "5:10 PM", "5:41 PM", "6:09 PM"] },
  { stop_id: "8252", name: "SW Martinazzi &amp; Martinazzi Square", lat: 45.380275, lon: -122.759196, times: ["2:24 PM", "3:08 PM", "3:38 PM", "4:08 PM", "4:40 PM", "5:11 PM", "5:42 PM", "6:09 PM"] },
  { stop_id: "8274", name: "SW Martinazzi &amp; Mohawk", lat: 45.37693, lon: -122.760942, times: ["2:25 PM", "3:09 PM", "3:39 PM", "4:09 PM", "4:41 PM", "5:12 PM", "5:43 PM", "6:10 PM"] },
  { stop_id: "8276", name: "SW Sagert &amp; Tillamook", lat: 45.375434, lon: -122.76395, times: ["2:27 PM", "3:11 PM", "3:41 PM", "4:11 PM", "4:43 PM", "5:14 PM", "5:45 PM", "6:12 PM"] },
  { stop_id: "8788", name: "SW Sagert &amp; 86th", lat: 45.375414, lon: -122.765467, times: ["2:27 PM", "3:11 PM", "3:41 PM", "4:11 PM", "4:43 PM", "5:14 PM", "5:45 PM", "6:12 PM"] },
  { stop_id: "501", name: "SW Boones Ferry Rd &amp; Apache", lat: 45.372988, lon: -122.769659, times: ["2:28 PM", "3:12 PM", "3:42 PM", "4:12 PM", "4:44 PM", "5:15 PM", "5:46 PM", "6:13 PM"] },
  { stop_id: "9352", name: "SW Boones Ferry Rd &amp; Avery", lat: 45.370926, lon: -122.771577, times: ["2:29 PM", "3:13 PM", "3:43 PM", "4:13 PM", "4:45 PM", "5:16 PM", "5:46 PM", "6:13 PM"] },
  { stop_id: "563", name: "SW Boones Ferry Rd &amp; Siletz", lat: 45.36901, lon: -122.772722, times: ["2:29 PM", "3:13 PM", "3:43 PM", "4:13 PM", "4:45 PM", "5:16 PM", "5:47 PM", "6:14 PM"] },
  { stop_id: "500", name: "SW Boones Ferry Rd &amp; Alsea", lat: 45.365116, lon: -122.773244, times: ["2:30 PM", "3:14 PM", "3:45 PM", "4:15 PM", "4:47 PM", "5:17 PM", "5:48 PM", "6:15 PM"] },
  { stop_id: "530", name: "SW Boones Ferry Rd &amp; Ibach", lat: 45.360359, lon: -122.774812, times: ["2:32 PM", "3:16 PM", "3:46 PM", "4:16 PM", "4:48 PM", "5:19 PM", "5:49 PM", "6:16 PM"] },
  { stop_id: "9512", name: "SW Boones Ferry Rd &amp; Iowa Dr", lat: 45.35519, lon: -122.774901, times: ["2:33 PM", "3:17 PM", "3:48 PM", "4:18 PM", "4:50 PM", "5:20 PM", "5:51 PM", "6:17 PM"] },
  { stop_id: "542", name: "SW Boones Ferry Rd &amp; Norwood", lat: 45.353388, lon: -122.774865, times: ["2:34 PM", "3:18 PM", "3:48 PM", "4:18 PM", "4:50 PM", "5:21 PM", "5:51 PM", "6:17 PM"] },
  { stop_id: "14574", name: "SW Boones Ferry Rd &amp; Salinan", lat: 45.348096, lon: -122.775172, times: ["2:35 PM", "3:19 PM", "3:50 PM", "4:20 PM", "4:52 PM", "5:22 PM", "5:53 PM", "6:19 PM"] },
  { stop_id: "8891", name: "24300 Block SW Boones Ferry Rd", lat: 45.343521, lon: -122.774284, times: ["2:36 PM", "3:20 PM", "3:51 PM", "4:21 PM", "4:53 PM", "5:23 PM", "5:54 PM", "6:20 PM"] },
  { stop_id: "522", name: "SW Boones Ferry Rd &amp; Day", lat: 45.340127, lon: -122.773694, times: ["2:37 PM", "3:21 PM", "3:52 PM", "4:22 PM", "4:54 PM", "5:24 PM", "5:54 PM", "6:21 PM"] },
  { stop_id: "9484", name: "9400 Block SW Commerce Circle", lat: 45.337695, lon: -122.774601, times: ["2:38 PM", "3:22 PM", "3:53 PM", "4:23 PM", "4:55 PM", "5:25 PM", "5:55 PM", "6:21 PM"] },
  { stop_id: "8391", name: "9900 Block SW Commerce Circle", lat: 45.336462, lon: -122.777343, times: ["2:39 PM", "3:23 PM", "3:54 PM", "4:24 PM", "4:56 PM", "5:26 PM", "5:56 PM", "6:22 PM"] },
  { stop_id: "13493", name: "10100 Block SW Commerce Circle", lat: 45.33519, lon: -122.775493, times: ["2:40 PM", "3:24 PM", "3:55 PM", "4:25 PM", "4:57 PM", "5:27 PM", "5:57 PM", "6:23 PM"] },
  { stop_id: "5004", name: "SW Sagert &amp; 86th", lat: 45.375235, lon: -122.765776, times: ["9:27 AM", "10:28 AM", "11:28 AM", "12:28 PM", "1:29 PM"] },
  { stop_id: "8278", name: "SW Sagert &amp; Tillamook", lat: 45.375284, lon: -122.763408, times: ["9:28 AM", "10:28 AM", "11:28 AM", "12:28 PM", "1:29 PM"] },
  { stop_id: "8285", name: "SW Martinazzi &amp; Mohawk", lat: 45.376144, lon: -122.760435, times: ["9:29 AM", "10:30 AM", "11:30 AM", "12:30 PM", "1:31 PM"] },
]

    const polylineOut = L.polyline(shapeOutbound, { color: 'blue', weight: 4, opacity: 0.7 }).addTo(map);
    map.fitBounds(polylineOut.getBounds());

    const nowPT = new Date(new Date().toLocaleString('en-US', { timeZone: 'America/Los_Angeles' }));
    const nowMins = nowPT.getHours() * 60 + nowPT.getMinutes();

    stops.forEach(stop => {
      let highlightedTimes = [];
      let foundNext = false;
      stop.times.forEach(timeStr => {
        let cleanTime = timeStr.trim();
        let [h, m] = cleanTime.split(":");
        let schedMins = parseInt(h, 10) * 60 + parseInt(m, 10);
        if (schedMins < nowMins && nowMins - schedMins > 720) {
          schedMins += 1440;
        }
        if (!foundNext && schedMins >= nowMins) {
          highlightedTimes.push(`<span style="background:#4dd0e1; color:#000; padding:2px 6px; border-radius:6px; font-weight:bold;">${cleanTime}</span>`);
          foundNext = true;
        } else {
          highlightedTimes.push(cleanTime);
        }
      });

      L.circleMarker([stop.lat, stop.lon], {
        radius: 6,
        color: '#4dd0e1',
        fillColor: '#4dd0e1',
        fillOpacity: 0.9,
        weight: 1
      })
      .bindPopup(`<strong>${stop.name}</strong><br>${highlightedTimes.join("<br>") || 'No scheduled times'}`)
      .addTo(map);
    });

    let busMarkers = {};
    async function fetchAndDisplay() {
      const res = await fetch(`https://developer.trimet.org/ws/v2/vehicles?route=${routeNumber}&appID=${apiKey}&json=true`);
      const data = await res.json();
      const buses = (data.resultSet.vehicle || []).filter(v => v.routeNumber == routeNumber && v.direction == direction);

      Object.values(busMarkers).forEach(m => map.removeLayer(m));
      busMarkers = {};
      if (!buses.length) return;

      buses.forEach(bus => {
        if (!bus.latitude || !bus.longitude || !bus.blockID) return;
        const icon = L.divIcon({    
           className: '',
           html: `
            <div style="text-align:center;">
              <div style="background:#0071CE;color:#fff;padding:2px 6px;border-radius:6px;font-weight:bold;">${bus.vehicleID}</div>
              <div style="width:0;height:0;border-left:5px solid transparent;border-right:5px solid transparent;border-top:10px solid #00bfff;margin:auto;"></div>
            </div>
          `,
          iconSize: [40, 30], iconAnchor: [20, 30]
        });
        const marker = L.marker([bus.latitude, bus.longitude], { icon }).addTo(map);
        busMarkers[bus.vehicleID] = marker;
      });
    }
    fetchAndDisplay();
    setInterval(fetchAndDisplay, 15000);
  </script>

  <footer class="site-footer">
    <a href="terms.html">Terms of Use</a> &nbsp;|&nbsp;
    <a href="contact.html">Contact Us</a> &nbsp;|&nbsp;
    <a href="report.html">Report a Problem</a> &nbsp;|&nbsp;
    <a href="dmca.html">DMCA</a> &nbsp;|&nbsp;
    <a href="privacy.html">Privacy Policy</a>
  </footer>

  <script>
    if (!localStorage.getItem('cookieConsent')) {
      document.write(`
        <div id="cookie-banner" style="position: fixed; bottom: 0; left: 0; right: 0; background: #333; color: #fff; padding: 1rem; z-index: 1000; font-size: 0.9rem; line-height: 1.4; text-align: center; box-sizing: border-box;">
          üì¢ We use cookies to improve functionality and analyze traffic.
          By using MetroFeed, you agree to our 
          <a href='privacy.html' style='color: #4dd0e1; text-decoration: underline;'>Privacy Policy</a>.<br>
          <button onclick='localStorage.setItem("cookieConsent", "true"); document.getElementById("cookie-banner").remove();' style='margin-top: 0.5rem; background: #4dd0e1; color: #000; border: none; padding: 0.5rem 1rem; border-radius: 5px; cursor: pointer; font-weight: bold;'>OK</button>
        </div>
      `);
    }
  </script>
</body>
</html>