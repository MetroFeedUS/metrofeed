<!DOCTYPE html>
<html lang="en">
<head>
  
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2219550569810489"
     crossorigin="anonymous"></script>

<meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Route 153 - To Lake Oswego Transit Center | MetroFeed Portland</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background-color: #0d0d0d;
      color: #cccccc;
    }
    header {
      background-color: #0d0d0d;
      border-bottom: 3px solid #4dd0e1;
      padding: 1rem;
      text-align: center;
    }
    header img {
      max-height: 60px;
    }
     .ad-banner {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      background: #222;
      padding: 0;
      z-index: 1000;
      box-shadow: 0 2px 2px rgba(0,0,0,0.5);
      text-align: center;
    }

    .ad-banner img {
      width: 100%;
      max-width: 728px;
      height: 90px;
      
      display: block;
      margin: 0 auto;
    }
    h1 {
      text-align: center;
      margin: 1rem 0;
      font-size: 2rem;
      color: #f0f0f0;
    }
    .content-box {
      border: 2px solid #4dd0e1;
      border-radius: 12px;
      padding: 1rem;
      margin: 1rem;
      background-color: #1e1e1e;
    }
    #map {
  width: 100vw;
  min-width: 100vw;
  height: 400px;
  border-radius: 0;
  margin-left: 50%;
  transform: translateX(-50%);
  border: none;
  box-shadow: none;
  padding: 0;
}
    .button-bar {
      display: flex;
      justify-content: center;
      margin: 1rem 0;
    }
    .button-bar a {
      background: #4dd0e1;
      color: #0d0d0d;
      padding: 0.5rem 1rem;
      text-decoration: none;
      border-radius: 8px;
      font-weight: bold;
    }

.back-button {
  background-color: #4dd0e1;
  color: #0d0d0d;
  border: none;
  padding: 0.6rem 1.2rem;
  font-size: 1rem;
  font-weight: bold;
  border-radius: 8px;
  cursor: pointer;
  box-shadow: 0 0 10px #4dd0e1;
  text-decoration: none;
}
.back-button:hover {
  background-color: #35c0d6;
}
.site-footer {
      text-align: center;
      margin-top: 3rem;
      margin-bottom: 120px;
      font-size: 0.85rem;
      color: #aaa;
    }
    .site-footer a {
      color: #00BFFF;
      text-decoration: none;
    }
    .site-footer a:hover {
      text-decoration: underline;
    }
  @media (max-width: 600px) {
      .ad-banner {
        padding-top: 1rem;
        padding-bottom: rem;
      }
    }
  </style>
</head>
<body>
 
  <!-- üü¶ Auto-Injected Banner Ad (route-specific) -->
  <div class="ad-banner">
    <iframe src="https://metrofeedus.com/portland/Ads/route-153-dir1-ad.html" style="border:none; width:100%; max-width 728px; height:90px;"></iframe>
  </div>


 <header>
    <img src="MetroFeedPortlandLogo.png" alt="MetroFeed Portland">
  </header>

  <div class="disclaimer" style="margin: 1rem auto 0.5rem; max-width: 600px; font-size: 0.8rem; color: #bbb; text-align: center; padding: 0.5rem 1rem; background-color: #111; border: 1px dashed #444; border-radius: 6px;">
    ‚ö†Ô∏è This is a Beta program, work in progress. Please REPORT bugs and pretend to be impressed.
  </div>
  <div class="disclaimer" style="margin: 0 auto 1rem; max-width: 600px; font-size: 0.75rem; color: #888; text-align: center; padding: 0.25rem 1rem;">
    This tool is not affiliated with or endorsed by TriMet. For official schedules and service alerts, visit <a href="https://trimet.org" style="color:#4dd0e1;">trimet.org</a>.
  </div>

  <div style="margin: 2rem 0; text-align: center;">
  <button class="back-button" onclick="history.back()">‚¨Ö Back</button>
  </div>

  <h1>Route 153 - To Lake Oswego Transit Center</h1>

  <div class="content-box">
    <div id="map"></div>
    <div style="text-align:right; font-size: 0.7rem; color: #777; margin-top: 0.5rem;">
      Data courtesy of TriMet.
    </div>
  </div>

  
  <script>
  const apiKey = "2C4447D4A42083BCD84DE3B8E";
  const routeNumber = 153;
  const direction = parseInt(1);

  // --- Set map bounds and zoom limits ---
  const bounds = L.latLngBounds(
    [45.40, -122.85], // SW
    [45.65, -122.45]  // NE
  );

  const map = L.map('map', {
    maxBounds: bounds,
    maxBoundsViscosity: 1.0,
    minZoom: 12,   // Don't allow zooming out past city
    maxZoom: 19,   // Allow good zoom in
    zoomControl: true,
    scrollWheelZoom: true,
    dragging: true
  }).setView([45.52, -122.68], 13);

  map.setMaxBounds(bounds);

// Keep map locked in bounds if user somehow escapes
map.on('moveend', function() {
  if (!bounds.contains(map.getCenter())) {
    map.panInsideBounds(bounds, { animate: true });
  }
});

  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    maxZoom: 19
  }).addTo(map);

  const shapeOutbound = [
  [45.345073, -122.655039],
  [45.345191, -122.654635],
  [45.345435, -122.653799],
  [45.345493, -122.653601],
  [45.345666, -122.653014],
  [45.345695, -122.652918],
  [45.345733, -122.652793],
  [45.345761, -122.652701],
  [45.34578, -122.652636],
  [45.345872, -122.652321],
  [45.345889, -122.652261],
  [45.345907, -122.652195],
  [45.345918, -122.652133],
  [45.345925, -122.652086],
  [45.345928, -122.652028],
  [45.345927, -122.651847],
  [45.345814, -122.651845],
  [45.345707, -122.651846],
  [45.34557, -122.651846],
  [45.345522, -122.651847],
  [45.345465, -122.651848],
  [45.345415, -122.651844],
  [45.345379, -122.651838],
  [45.345331, -122.651824],
  [45.345281, -122.651805],
  [45.345208, -122.651764],
  [45.345156, -122.651941],
  [45.345119, -122.652072],
  [45.345017, -122.652429],
  [45.344973, -122.652574],
  [45.344961, -122.652616],
  [45.344901, -122.65282],
  [45.344832, -122.653055],
  [45.3446, -122.653848],
  [45.344566, -122.653966],
  [45.344505, -122.654175],
  [45.344435, -122.654415],
  [45.344293, -122.654909],
  [45.34419, -122.655269],
  [45.344131, -122.655477],
  [45.344066, -122.655704],
  [45.343824, -122.656556],
  [45.343818, -122.656578],
  [45.343757, -122.656797],
  [45.343697, -122.657011],
  [45.343476, -122.657799],
  [45.343424, -122.657982],
  [45.343392, -122.658095],
  [45.343117, -122.659034],
  [45.34307, -122.659221],
  [45.343037, -122.659377],
  [45.343008, -122.659517],
  [45.342987, -122.659666],
  [45.342971, -122.659821],
  [45.342961, -122.659977],
  [45.342962, -122.660111],
  [45.342968, -122.660233],
  [45.34297, -122.660293],
  [45.342982, -122.660412],
  [45.342999, -122.66055],
  [45.343057, -122.660906],
  [45.343442, -122.663174],
  [45.343493, -122.663479],
  [45.343679, -122.664578],
  [45.343755, -122.665047],
  [45.343792, -122.665217],
  [45.343816, -122.665327],
  [45.343862, -122.665498],
  [45.34395, -122.665791],
  [45.344145, -122.666424],
  [45.344276, -122.666855],
  [45.34431, -122.666967],
  [45.345392, -122.666963],
  [45.345897, -122.666961],
  [45.347556, -122.666961],
  [45.347632, -122.666962],
  [45.347729, -122.666963],
  [45.34787, -122.666966],
  [45.348176, -122.666973],
  [45.348914, -122.666973],
  [45.34898, -122.666973],
  [45.349603, -122.66697],
  [45.349833, -122.666966],
  [45.350498, -122.666966],
  [45.350949, -122.666963],
  [45.351124, -122.666962],
  [45.351315, -122.666949],
  [45.351328, -122.666425],
  [45.351372, -122.664666],
  [45.351399, -122.663429],
  [45.351407, -122.663251],
  [45.351414, -122.663192],
  [45.351446, -122.663066],
  [45.351477, -122.662981],
  [45.351519, -122.662858],
  [45.351524, -122.662846],
  [45.35161, -122.662547],
  [45.351648, -122.662358],
  [45.351667, -122.662238],
  [45.351682, -122.66212],
  [45.351693, -122.661947],
  [45.351701, -122.661643],
  [45.351708, -122.661467],
  [45.351749, -122.661033],
  [45.351789, -122.660663],
  [45.351847, -122.660068],
  [45.351883, -122.659685],
  [45.351904, -122.65944],
  [45.351947, -122.658843],
  [45.35195, -122.658796],
  [45.35197, -122.658495],
  [45.351971, -122.658325],
  [45.351967, -122.65821],
  [45.351957, -122.658114],
  [45.351936, -122.657991],
  [45.351916, -122.657902],
  [45.351886, -122.657811],
  [45.351853, -122.657732],
  [45.351716, -122.657459],
  [45.351509, -122.657047],
  [45.35144, -122.656915],
  [45.351245, -122.656493],
  [45.351071, -122.656117],
  [45.350908, -122.655818],
  [45.350856, -122.655714],
  [45.350742, -122.655502],
  [45.350559, -122.655135],
  [45.350411, -122.654819],
  [45.350021, -122.653989],
  [45.349786, -122.653468],
  [45.349632, -122.653141],
  [45.349481, -122.652818],
  [45.349451, -122.652752],
  [45.349279, -122.652372],
  [45.348982, -122.65175],
  [45.348862, -122.651492],
  [45.348736, -122.651181],
  [45.348678, -122.651016],
  [45.34866, -122.650947],
  [45.348632, -122.650841],
  [45.348574, -122.650536],
  [45.348558, -122.650446],
  [45.348543, -122.650316],
  [45.348531, -122.650176],
  [45.348526, -122.650072],
  [45.348524, -122.649999],
  [45.348523, -122.649922],
  [45.348524, -122.649821],
  [45.348529, -122.649727],
  [45.348533, -122.64965],
  [45.34854, -122.649576],
  [45.348548, -122.649492],
  [45.348558, -122.649409],
  [45.348567, -122.649344],
  [45.348577, -122.649281],
  [45.348616, -122.649048],
  [45.348738, -122.648427],
  [45.348877, -122.647729],
  [45.348984, -122.647177],
  [45.349133, -122.646441],
  [45.349167, -122.64628],
  [45.349185, -122.646201],
  [45.349203, -122.646129],
  [45.349226, -122.64605],
  [45.349247, -122.645982],
  [45.349276, -122.645902],
  [45.349317, -122.645801],
  [45.349347, -122.64574],
  [45.349381, -122.645675],
  [45.349428, -122.645593],
  [45.349497, -122.645489],
  [45.349538, -122.645431],
  [45.349583, -122.645375],
  [45.349654, -122.645293],
  [45.349954, -122.64497],
  [45.350348, -122.644565],
  [45.350677, -122.644217],
  [45.350916, -122.643974],
  [45.350986, -122.643904],
  [45.351059, -122.643833],
  [45.351231, -122.643672],
  [45.351264, -122.643565],
  [45.351339, -122.643492],
  [45.351406, -122.643435],
  [45.351474, -122.643382],
  [45.351535, -122.643345],
  [45.351607, -122.643306],
  [45.351675, -122.643274],
  [45.351742, -122.643249],
  [45.351805, -122.64323],
  [45.351861, -122.643219],
  [45.351944, -122.643213],
  [45.352051, -122.64322],
  [45.352112, -122.643226],
  [45.352185, -122.643237],
  [45.352248, -122.643254],
  [45.352506, -122.643329],
  [45.352623, -122.643365],
  [45.353455, -122.643604],
  [45.353591, -122.643651],
  [45.354049, -122.643782],
  [45.354776, -122.643995],
  [45.354948, -122.644046],
  [45.355003, -122.644065],
  [45.355058, -122.644085],
  [45.355116, -122.644109],
  [45.355168, -122.644137],
  [45.355224, -122.644167],
  [45.355302, -122.644216],
  [45.355357, -122.644254],
  [45.355401, -122.644285],
  [45.355455, -122.644325],
  [45.355499, -122.644363],
  [45.355682, -122.644535],
  [45.355752, -122.644611],
  [45.355898, -122.644771],
  [45.355971, -122.644853],
  [45.356067, -122.644959],
  [45.356914, -122.645877],
  [45.357059, -122.646031],
  [45.357111, -122.646081],
  [45.357147, -122.646115],
  [45.357242, -122.646196],
  [45.357305, -122.646242],
  [45.357391, -122.6463],
  [45.357485, -122.646348],
  [45.357573, -122.646384],
  [45.357668, -122.646411],
  [45.35771, -122.646418],
  [45.357768, -122.646427],
  [45.357853, -122.646433],
  [45.357968, -122.646432],
  [45.358042, -122.646423],
  [45.358108, -122.646412],
  [45.358172, -122.646397],
  [45.358249, -122.64637],
  [45.358302, -122.646349],
  [45.358407, -122.646301],
  [45.358489, -122.646255],
  [45.358575, -122.646199],
  [45.358647, -122.646155],
  [45.358746, -122.646107],
  [45.358814, -122.646079],
  [45.358849, -122.646062],
  [45.358894, -122.646045],
  [45.358952, -122.646026],
  [45.35904, -122.646007],
  [45.359127, -122.645995],
  [45.359208, -122.645989],
  [45.359283, -122.645989],
  [45.359385, -122.645997],
  [45.359477, -122.646014],
  [45.359577, -122.646034],
  [45.359711, -122.646081],
  [45.359811, -122.646138],
  [45.359895, -122.646191],
  [45.359966, -122.646242],
  [45.36002, -122.646285],
  [45.360079, -122.646335],
  [45.360584, -122.646808],
  [45.360891, -122.647096],
  [45.361088, -122.647274],
  [45.361161, -122.647343],
  [45.361213, -122.647397],
  [45.361283, -122.647475],
  [45.361342, -122.647544],
  [45.361379, -122.647594],
  [45.361433, -122.647664],
  [45.361655, -122.648015],
  [45.361754, -122.648158],
  [45.361838, -122.648277],
  [45.361923, -122.648384],
  [45.362025, -122.648494],
  [45.362116, -122.648576],
  [45.362191, -122.648639],
  [45.36226, -122.648687],
  [45.362308, -122.648718],
  [45.362371, -122.648754],
  [45.362439, -122.648791],
  [45.362508, -122.64882],
  [45.362534, -122.64883],
  [45.362611, -122.648857],
  [45.362697, -122.648881],
  [45.362785, -122.648916],
  [45.362875, -122.648925],
  [45.362985, -122.64893],
  [45.363099, -122.648924],
  [45.363181, -122.648914],
  [45.363296, -122.648889],
  [45.36338, -122.648865],
  [45.363472, -122.648833],
  [45.363726, -122.648729],
  [45.364186, -122.64855],
  [45.364262, -122.648582],
  [45.364338, -122.648551],
  [45.364611, -122.648442],
  [45.364667, -122.648421],
  [45.364855, -122.648351],
  [45.365115, -122.648253],
  [45.365221, -122.648211],
  [45.36531, -122.648114],
  [45.365706, -122.647958],
  [45.365771, -122.647938],
  [45.365833, -122.64792],
  [45.365895, -122.647906],
  [45.365955, -122.647894],
  [45.366001, -122.647887],
  [45.366051, -122.647882],
  [45.366116, -122.647874],
  [45.366176, -122.64786],
  [45.366236, -122.647846],
  [45.366345, -122.64781],
  [45.366403, -122.647785],
  [45.366465, -122.647756],
  [45.36654, -122.647716],
  [45.366664, -122.647636],
  [45.366744, -122.647651],
  [45.366944, -122.64749],
  [45.367025, -122.647436],
  [45.36712, -122.647382],
  [45.367215, -122.647336],
  [45.367294, -122.647305],
  [45.367372, -122.647281],
  [45.367449, -122.647199],
  [45.367566, -122.647178],
  [45.367761, -122.647139],
  [45.367959, -122.647076],
  [45.368143, -122.647016],
  [45.368239, -122.647045],
  [45.368358, -122.647005],
  [45.368628, -122.646914],
  [45.368741, -122.646879],
  [45.368786, -122.646799],
  [45.36883, -122.646783],
  [45.369063, -122.646695],
  [45.369086, -122.646686],
  [45.369147, -122.646716],
  [45.369211, -122.646677],
  [45.369297, -122.646627],
  [45.369386, -122.646571],
  [45.369456, -122.646528],
  [45.369541, -122.646488],
  [45.369635, -122.64645],
  [45.369824, -122.646381],
  [45.369976, -122.646329],
  [45.370004, -122.64632],
  [45.370199, -122.646246],
  [45.370258, -122.646217],
  [45.370308, -122.64619],
  [45.370364, -122.646155],
  [45.370459, -122.646081],
  [45.370513, -122.64603],
  [45.370808, -122.645735],
  [45.370851, -122.645698],
  [45.370907, -122.645652],
  [45.370978, -122.645599],
  [45.371047, -122.645551],
  [45.371123, -122.645503],
  [45.371282, -122.645423],
  [45.37136, -122.645386],
  [45.371415, -122.645365],
  [45.371632, -122.645317],
  [45.3717, -122.645307],
  [45.371774, -122.645302],
  [45.371846, -122.6453],
  [45.371913, -122.645254],
  [45.37207, -122.645274],
  [45.372077, -122.645275],
  [45.372178, -122.645292],
  [45.372284, -122.645325],
  [45.372423, -122.645373],
  [45.372499, -122.645409],
  [45.372569, -122.645444],
  [45.372647, -122.645494],
  [45.372766, -122.645576],
  [45.372874, -122.645658],
  [45.37299, -122.645746],
  [45.373923, -122.64647],
  [45.373929, -122.646475],
  [45.374041, -122.646551],
  [45.374115, -122.646622],
  [45.374406, -122.646841],
  [45.374868, -122.647198],
  [45.374967, -122.647274],
  [45.375204, -122.647454],
  [45.375288, -122.647528],
  [45.3756, -122.647759],
  [45.375754, -122.647878],
  [45.37585, -122.647951],
  [45.375929, -122.648006],
  [45.37599, -122.64804],
  [45.376049, -122.648077],
  [45.376075, -122.648093],
  [45.376164, -122.648128],
  [45.376251, -122.648155],
  [45.376357, -122.64817],
  [45.376434, -122.648179],
  [45.376912, -122.64817],
  [45.377056, -122.648167],
  [45.377162, -122.64822],
  [45.377165, -122.648351],
  [45.377166, -122.648729],
  [45.377184, -122.650851],
  [45.377199, -122.652252],
  [45.377208, -122.65294],
  [45.377207, -122.653121],
  [45.3772, -122.653261],
  [45.377187, -122.653404],
  [45.377159, -122.653583],
  [45.377123, -122.653729],
  [45.377085, -122.65386],
  [45.377069, -122.653903],
  [45.377036, -122.653997],
  [45.377003, -122.654083],
  [45.376734, -122.65477],
  [45.376552, -122.655244],
  [45.376375, -122.655686],
  [45.376354, -122.65574],
  [45.37628, -122.655817],
  [45.376678, -122.656173],
  [45.377045, -122.656447],
  [45.377132, -122.656508],
  [45.377226, -122.65657],
  [45.377394, -122.656677],
  [45.37757, -122.656783],
  [45.377671, -122.65684],
  [45.37821, -122.657162],
  [45.378359, -122.657253],
  [45.378499, -122.657339],
  [45.378562, -122.657383],
  [45.378623, -122.657426],
  [45.378711, -122.657493],
  [45.378793, -122.657557],
  [45.378894, -122.657641],
  [45.378978, -122.657714],
  [45.379078, -122.657807],
  [45.379207, -122.657938],
  [45.379289, -122.658026],
  [45.379365, -122.658112],
  [45.379485, -122.658261],
  [45.379608, -122.65842],
  [45.379853, -122.658737],
  [45.379899, -122.6588],
  [45.379941, -122.658853],
  [45.380137, -122.659116],
  [45.380229, -122.659253],
  [45.380272, -122.659322],
  [45.380303, -122.659377],
  [45.38034, -122.659447],
  [45.380381, -122.659527],
  [45.380411, -122.659589],
  [45.380453, -122.659688],
  [45.380648, -122.660147],
  [45.380949, -122.660879],
  [45.381252, -122.661624],
  [45.381419, -122.662054],
  [45.381502, -122.662267],
  [45.381579, -122.662475],
  [45.381658, -122.662699],
  [45.381732, -122.662911],
  [45.381809, -122.663129],
  [45.381866, -122.663304],
  [45.382062, -122.663873],
  [45.382209, -122.664297],
  [45.382286, -122.664511],
  [45.382309, -122.664576],
  [45.382332, -122.664631],
  [45.382416, -122.664833],
  [45.38246, -122.664934],
  [45.382504, -122.665033],
  [45.382553, -122.66514],
  [45.382607, -122.66525],
  [45.382694, -122.665417],
  [45.382921, -122.665847],
  [45.383737, -122.667373],
  [45.384145, -122.668123],
  [45.384506, -122.668769],
  [45.384563, -122.668867],
  [45.38459, -122.668911],
  [45.384635, -122.668983],
  [45.384676, -122.669042],
  [45.384776, -122.669181],
  [45.384841, -122.669262],
  [45.384906, -122.66934],
  [45.38514, -122.669614],
  [45.385257, -122.669754],
  [45.385369, -122.669885],
  [45.385552, -122.670119],
  [45.385641, -122.670235],
  [45.385724, -122.670348],
  [45.385961, -122.670687],
  [45.386077, -122.670848],
  [45.386389, -122.671304],
  [45.386484, -122.67145],
  [45.386536, -122.671527],
  [45.38658, -122.671599],
  [45.386637, -122.671695],
  [45.386707, -122.671817],
  [45.386737, -122.671871],
  [45.386816, -122.672023],
  [45.386892, -122.672172],
  [45.387189, -122.672779],
  [45.387375, -122.673165],
  [45.387565, -122.673553],
  [45.387723, -122.673884],
  [45.387889, -122.674223],
  [45.388973, -122.676391],
  [45.389298, -122.677037],
  [45.389367, -122.677173],
  [45.389673, -122.677778],
  [45.389784, -122.677985],
  [45.389897, -122.678184],
  [45.389922, -122.678226],
  [45.389988, -122.678336],
  [45.390104, -122.678518],
  [45.390411, -122.678951],
  [45.390665, -122.679287],
  [45.390842, -122.679514],
  [45.390963, -122.679674],
  [45.391153, -122.679942],
  [45.391183, -122.67999],
  [45.391206, -122.680029],
  [45.391235, -122.680082],
  [45.391259, -122.68013],
  [45.391278, -122.680174],
  [45.3913, -122.680229],
  [45.391319, -122.680282],
  [45.391351, -122.680386],
  [45.391369, -122.680454],
  [45.391383, -122.680524],
  [45.391393, -122.680581],
  [45.391399, -122.68063],
  [45.391405, -122.680683],
  [45.391409, -122.680739],
  [45.391413, -122.680809],
  [45.391418, -122.680919],
  [45.391422, -122.681145],
  [45.391426, -122.681655],
  [45.391431, -122.682449],
  [45.391439, -122.683788],
  [45.391442, -122.683926],
  [45.391443, -122.683985],
  [45.391447, -122.684041],
  [45.391459, -122.684162],
  [45.391469, -122.684244],
  [45.39148, -122.684327],
  [45.391501, -122.684439],
  [45.391523, -122.684541],
  [45.391557, -122.684686],
  [45.391595, -122.684837],
  [45.391677, -122.685149],
  [45.391756, -122.685457],
  [45.391836, -122.685756],
  [45.39213, -122.68688],
  [45.392472, -122.688163],
  [45.392788, -122.689336],
  [45.392798, -122.689374],
  [45.392863, -122.689521],
  [45.392938, -122.68979],
  [45.39296, -122.689857],
  [45.392982, -122.689912],
  [45.393011, -122.689958],
  [45.393063, -122.690007],
  [45.393113, -122.69003],
  [45.393156, -122.690071],
  [45.393216, -122.690085],
  [45.393256, -122.690089],
  [45.393304, -122.690082],
  [45.393359, -122.690063],
  [45.393415, -122.690036],
  [45.393557, -122.689966],
  [45.393642, -122.689961],
  [45.394195, -122.689672],
  [45.394758, -122.689369],
  [45.394979, -122.689253],
  [45.395378, -122.689033],
  [45.395597, -122.688898],
  [45.395803, -122.688774],
  [45.396016, -122.688658],
  [45.396296, -122.6885],
  [45.396406, -122.688431],
  [45.3965, -122.688366],
  [45.396687, -122.688231],
  [45.396801, -122.688137],
  [45.396896, -122.688053],
  [45.397049, -122.687903],
  [45.397178, -122.687758],
  [45.397457, -122.687408],
  [45.397649, -122.687164],
  [45.397762, -122.687034],
  [45.397907, -122.686856],
  [45.398204, -122.686486],
  [45.398443, -122.686183],
  [45.398797, -122.685741],
  [45.398986, -122.68551],
  [45.399278, -122.685158],
  [45.399517, -122.684871],
  [45.399729, -122.68462],
  [45.400117, -122.684155],
  [45.400404, -122.683815],
  [45.400582, -122.683602],
  [45.400819, -122.683316],
  [45.400927, -122.683187],
  [45.401021, -122.683076],
  [45.401342, -122.6827],
  [45.401593, -122.682396],
  [45.40169, -122.682278],
  [45.401901, -122.682035],
  [45.402121, -122.681765],
  [45.402382, -122.681452],
  [45.402582, -122.681208],
  [45.40273, -122.681016],
  [45.403031, -122.680618],
  [45.403287, -122.680292],
  [45.403629, -122.679871],
  [45.403814, -122.679648],
  [45.404109, -122.679296],
  [45.404195, -122.679199],
  [45.404257, -122.679134],
  [45.404326, -122.679066],
  [45.404404, -122.679],
  [45.404507, -122.678922],
  [45.404642, -122.678838],
  [45.404768, -122.678769],
  [45.404963, -122.678667],
  [45.405127, -122.678581],
  [45.405365, -122.678452],
  [45.405655, -122.678289],
  [45.405737, -122.678207],
  [45.405975, -122.678057],
  [45.406097, -122.67797],
  [45.406194, -122.677904],
  [45.406252, -122.677853],
  [45.406306, -122.677801],
  [45.406387, -122.677698],
  [45.406437, -122.677622],
  [45.406474, -122.677562],
  [45.406515, -122.67748],
  [45.406574, -122.677353],
  [45.406645, -122.677207],
  [45.406697, -122.677095],
  [45.406775, -122.676933],
  [45.406858, -122.676856],
  [45.407001, -122.676554],
  [45.407042, -122.676466],
  [45.407117, -122.676322],
  [45.407165, -122.67623],
  [45.407201, -122.676161],
  [45.407328, -122.675936],
  [45.407411, -122.675803],
  [45.407668, -122.675393],
  [45.407929, -122.674974],
  [45.40798, -122.674879],
  [45.408029, -122.674779],
  [45.40808, -122.674634],
  [45.408126, -122.674486],
  [45.408164, -122.67432],
  [45.408193, -122.674214],
  [45.408295, -122.673758],
  [45.408453, -122.673121],
  [45.408582, -122.672614],
  [45.408703, -122.672221],
  [45.408775, -122.671985],
  [45.40903, -122.671154],
  [45.409283, -122.670301],
  [45.409615, -122.66921],
  [45.409667, -122.66905],
  [45.409826, -122.668525],
  [45.409926, -122.668205],
  [45.409969, -122.668083],
  [45.410017, -122.667965],
  [45.41006, -122.667867],
  [45.410127, -122.667733],
  [45.41017, -122.667653],
  [45.41039, -122.667257],
  [45.410481, -122.66709],
  [45.410516, -122.667013],
  [45.410576, -122.666859],
  [45.410597, -122.666788],
  [45.410618, -122.666699],
  [45.410655, -122.666496],
  [45.410771, -122.665875],
  [45.410802, -122.665707],
  [45.410819, -122.665612],
  [45.410876, -122.665305],
  [45.410902, -122.665163],
  [45.410975, -122.664748],
  [45.410999, -122.66461],
  [45.411126, -122.664643],
  [45.411218, -122.66465],
  [45.411314, -122.664642],
  [45.411446, -122.66462],
  [45.411562, -122.664596],
  [45.411782, -122.664551],
  [45.411865, -122.664534],
  [45.411927, -122.66446],
  [45.412138, -122.664418],
  [45.412209, -122.664469],
  [45.412278, -122.664454],
  [45.412669, -122.664371],
  [45.412761, -122.664351],
  [45.412947, -122.664312],
  [45.413038, -122.664293],
  [45.413117, -122.664277],
  [45.413289, -122.664241],
  [45.413357, -122.664156],
  [45.41367, -122.66409],
  [45.413758, -122.664132],
  [45.414123, -122.664055],
  [45.414184, -122.663974],
  [45.414452, -122.663914],
  [45.414605, -122.663881],
  [45.414787, -122.663841],
  [45.414878, -122.66389],
  [45.41525, -122.663806],
  [45.415475, -122.663755],
  [45.415493, -122.663751],
  [45.415561, -122.663735],
  [45.415701, -122.663701],
  [45.415946, -122.663652],
  [45.416045, -122.663632],
  [45.416382, -122.663555],
  [45.417006, -122.663419],
  [45.417051, -122.663344],
  [45.417098, -122.663332],
  [45.417219, -122.663303],
  [45.417294, -122.663283],
  [45.417339, -122.66327],
  [45.417423, -122.663321],
  [45.417493, -122.663307],
  [45.417746, -122.663255],
  [45.417998, -122.663203],
  [45.418052, -122.663124],
  [45.418057, -122.663123],
  [45.418194, -122.66309],
  [45.418508, -122.663021],
  [45.418613, -122.663062],
  [45.418787, -122.663022],
  [45.419076, -122.662956],
  [45.419174, -122.662933],
  [45.419237, -122.662881],
  [45.419275, -122.662855],
  [45.419289, -122.663002],
  [45.419294, -122.663054],
  [45.419347, -122.663578],
  [45.419366, -122.663741],
  [45.419419, -122.664232],
  [45.41949, -122.664884],
  [45.41952, -122.665165],
  [45.419555, -122.665503],
  [45.419611, -122.665996],
  [45.419626, -122.666129],
  [45.419666, -122.666492],
  [45.419693, -122.666735],
  [45.419762, -122.667358],
  [45.419817, -122.667856],
  [45.419783, -122.667972],
  [45.419833, -122.668429],
  [45.419851, -122.668595],
  [45.419919, -122.669211],
  [45.421212, -122.668923],
  [45.421145, -122.668305],
  [45.421121, -122.668092]
];

const stopNames = {
  "3811": "600 Block McVey",
  "3814": "McVey &amp; Cornell",
  "5307": "McVey &amp; Parrish",
  "5509": "N State &amp; Foothills Rd",
  "5512": "S State &amp; North Shore Rd",
  "5514": "S State &amp; Wilbur",
  "9545": "Lake Oswego Transit Center",
  "10526": "Salamo &amp; Barrington Dr",
  "10528": "Salamo &amp; Day Rd",
  "10530": "Salamo &amp; Rosemont",
  "14485": "8th Ave &amp; 13th St",
  "14494": "Willamette Falls Dr &amp; 14th",
  "14495": "Willamette Falls Dr &amp; 19th St",
  "14496": "Willamette Falls Dr &amp; Ostman",
  "14497": "Ostman &amp; Dollar",
  "14498": "Ostman &amp; Blankenship",
  "14499": "Blankenship &amp; 19th",
  "14500": "Blankenship &amp; Debok",
  "14501": "Blankenship &amp; Virginia Ln",
  "14502": "Blankenship &amp; Tannler Dr",
  "14503": "Salamo &amp; Bland Circle",
  "14504": "Santa Anita &amp; Horton",
  "14505": "Santa Anita &amp; Pimlico",
  "14506": "Hidden Springs &amp; Suncrest Dr",
  "14507": "Stafford &amp; Bergis"
};

const stops = [
  { stop_id: "14485", name: "8th Ave &amp; 13th St", lat: 45.345032, lon: -122.655013, times: ["11:33 AM", "12:32 PM", "1:33 PM", "2:31 PM", "3:30 PM", "4:31 PM", "5:31 PM", "6:33 AM"] },
  { stop_id: "14494", name: "Willamette Falls Dr &amp; 14th", lat: 45.343865, lon: -122.6566, times: ["11:34 AM", "12:33 PM", "1:34 PM", "2:32 PM", "3:31 PM", "4:32 PM", "5:32 PM", "6:34 AM"] },
  { stop_id: "14495", name: "Willamette Falls Dr &amp; 19th St", lat: 45.343564, lon: -122.663452, times: ["11:35 AM", "12:34 PM", "1:35 PM", "2:33 PM", "3:32 PM", "4:33 PM", "5:33 PM", "6:35 AM"] },
  { stop_id: "14496", name: "Willamette Falls Dr &amp; Ostman", lat: 45.344336, lon: -122.666817, times: ["11:36 AM", "12:35 PM", "1:36 PM", "2:34 PM", "3:33 PM", "4:34 PM", "5:34 PM", "6:36 AM"] },
  { stop_id: "14497", name: "Ostman &amp; Dollar", lat: 45.347873, lon: -122.666875, times: ["11:37 AM", "12:36 PM", "1:37 PM", "2:35 PM", "3:34 PM", "4:35 PM", "5:35 PM", "6:37 AM"] },
  { stop_id: "14498", name: "Ostman &amp; Blankenship", lat: 45.350951, lon: -122.666876, times: ["11:38 AM", "12:37 PM", "1:38 PM", "2:36 PM", "3:35 PM", "4:36 PM", "5:36 PM", "6:38 AM"] },
  { stop_id: "14499", name: "Blankenship &amp; 19th", lat: 45.351474, lon: -122.662823, times: ["11:39 AM", "12:38 PM", "1:39 PM", "2:37 PM", "3:36 PM", "4:37 PM", "5:37 PM", "6:39 AM"] },
  { stop_id: "14500", name: "Blankenship &amp; Debok", lat: 45.351879, lon: -122.658832, times: ["11:39 AM", "12:38 PM", "1:39 PM", "2:37 PM", "3:36 PM", "4:37 PM", "5:37 PM", "6:39 AM"] },
  { stop_id: "14501", name: "Blankenship &amp; Virginia Ln", lat: 45.351182, lon: -122.656552, times: ["11:40 AM", "12:39 PM", "1:40 PM", "2:38 PM", "3:37 PM", "4:38 PM", "5:38 PM", "6:40 AM"] },
  { stop_id: "14502", name: "Blankenship &amp; Tannler Dr", lat: 45.349571, lon: -122.653199, times: ["11:41 AM", "12:40 PM", "1:41 PM", "2:39 PM", "3:38 PM", "4:39 PM", "5:39 PM", "6:41 AM"] },
  { stop_id: "10526", name: "Salamo &amp; Barrington Dr", lat: 45.351737, lon: -122.643197, times: ["11:43 AM", "12:42 PM", "1:43 PM", "2:41 PM", "3:40 PM", "4:41 PM", "5:41 PM", "6:43 AM"] },
  { stop_id: "14503", name: "Salamo &amp; Bland Circle", lat: 45.357716, lon: -122.646364, times: ["11:44 AM", "12:43 PM", "1:44 PM", "2:42 PM", "3:41 PM", "4:43 PM", "5:43 PM", "6:44 AM"] },
  { stop_id: "10528", name: "Salamo &amp; Day Rd", lat: 45.362545, lon: -122.64878, times: ["11:46 AM", "12:45 PM", "1:46 PM", "2:44 PM", "3:43 PM", "4:45 PM", "5:45 PM", "6:46 AM"] },
  { stop_id: "10530", name: "Salamo &amp; Rosemont", lat: 45.36905, lon: -122.64662, times: ["11:47 AM", "12:46 PM", "1:47 PM", "2:45 PM", "3:44 PM", "4:46 PM", "5:46 PM", "6:47 AM"] },
  { stop_id: "14504", name: "Santa Anita &amp; Horton", lat: 45.372078, lon: -122.645182, times: ["11:47 AM", "12:46 PM", "1:47 PM", "2:45 PM", "3:44 PM", "4:46 PM", "5:46 PM", "6:47 AM"] },
  { stop_id: "14505", name: "Santa Anita &amp; Pimlico", lat: 45.373947, lon: -122.646408, times: ["11:48 AM", "12:47 PM", "1:48 PM", "2:46 PM", "3:45 PM", "4:47 PM", "5:47 PM", "6:47 AM"] },
  { stop_id: "14506", name: "Hidden Springs &amp; Suncrest Dr", lat: 45.377133, lon: -122.653945, times: ["11:49 AM", "12:48 PM", "1:49 PM", "2:47 PM", "3:46 PM", "4:48 PM", "5:48 PM", "6:49 AM"] },
  { stop_id: "14507", name: "Stafford &amp; Bergis", lat: 45.40078, lon: -122.683244, times: ["11:56 AM", "12:55 PM", "1:56 PM", "2:55 PM", "3:54 PM", "4:56 PM", "5:56 PM", "6:55 AM"] },
  { stop_id: "5307", name: "McVey &amp; Parrish", lat: 45.406915, lon: -122.676472, times: ["11:58 AM", "12:57 PM", "1:58 PM", "2:57 PM", "3:56 PM", "4:58 PM", "5:58 PM", "6:57 AM"] },
  { stop_id: "3814", name: "McVey &amp; Cornell", lat: 45.408714, lon: -122.671944, times: ["11:59 AM", "12:58 PM", "1:59 PM", "2:58 PM", "3:57 PM", "4:59 PM", "5:59 PM", "6:58 AM"] },
  { stop_id: "3811", name: "600 Block McVey", lat: 45.410707, lon: -122.665853, times: ["12:00 PM", "12:59 PM", "2:00 PM", "2:59 PM", "3:58 PM", "5:00 PM", "6:00 PM", "6:59 AM"] },
  { stop_id: "5514", name: "S State &amp; Wilbur", lat: 45.412934, lon: -122.664192, times: ["12:01 PM", "1:00 PM", "2:01 PM", "3:00 PM", "3:59 PM", "5:01 PM", "6:01 PM", "7:00 AM"] },
  { stop_id: "5512", name: "S State &amp; North Shore Rd", lat: 45.415481, lon: -122.663643, times: ["12:02 PM", "1:01 PM", "2:02 PM", "3:01 PM", "4:00 PM", "5:02 PM", "6:02 PM", "7:01 AM"] },
  { stop_id: "5509", name: "N State &amp; Foothills Rd", lat: 45.418046, lon: -122.663034, times: ["12:03 PM", "1:02 PM", "2:03 PM", "3:02 PM", "4:01 PM", "5:03 PM", "6:03 PM", "7:02 AM"] },
  { stop_id: "9545", name: "Lake Oswego Transit Center", lat: 45.421057, lon: -122.668105, times: ["12:06 PM", "1:05 PM", "2:06 PM", "3:05 PM", "4:04 PM", "5:06 PM", "6:06 PM", "7:05 AM"] },
]

  const polylineOut = L.polyline(shapeOutbound, {
    color: 'blue',
    weight: 4,
    opacity: 0.7
  }).addTo(map);

  map.fitBounds(polylineOut.getBounds());

  stops.forEach(stop => {
    const marker = L.circleMarker([stop.lat, stop.lon], {
      radius: 6,
      color: '#4dd0e1',
      fillColor: '#4dd0e1',
      fillOpacity: 0.9,
      weight: 1
    });

    const popupContent = `
      <strong>${stop.name}</strong><br>
      ${stop.times && stop.times.length ? stop.times.join("<br>") : "No scheduled times"}
    `;

    marker.bindPopup(popupContent);
    marker.addTo(map);
  });

  let busMarkers = {};

  async function fetchAndDisplay() {
    const res = await fetch(`https://developer.trimet.org/ws/v2/vehicles?route=${routeNumber}&appID=${apiKey}&json=true`);
    const data = await res.json();
    const buses = (data.resultSet.vehicle || []).filter(v =>
      v.routeNumber == routeNumber && v.direction == direction
    );

    Object.values(busMarkers).forEach(m => map.removeLayer(m));
    busMarkers = {};

    if (buses.length === 0) return;

    buses.forEach(bus => {
      if (!bus.latitude || !bus.longitude || !bus.blockID) return;

      const icon = L.divIcon({
        className: '',
        html: `
          <div style="text-align:center;">
            <div style="background:#0071CE;color:#fff;padding:2px 6px;border-radius:6px;font-weight:bold;">${bus.vehicleID}</div>
            <div style="width:0;height:0;border-left:5px solid transparent;border-right:5px solid transparent;border-top:10px solid #00bfff;margin:auto;"></div>
          </div>
        `,
        iconSize: [40, 30],
        iconAnchor: [20, 30]
      });

      const marker = L.marker([bus.latitude, bus.longitude], { icon }).addTo(map);
      busMarkers[bus.vehicleID] = marker;
    });
  }

  fetchAndDisplay();
  setInterval(fetchAndDisplay, 15000);
  </script>

<footer class="site-footer">
  <a href="terms.html">Terms of Use</a> &nbsp;|&nbsp;
  <a href="contact.html">Contact Us</a> &nbsp;|&nbsp;
  <a href="report.html">Report a Problem</a> &nbsp;|&nbsp;
  <a href="privacy.html">Privacy Policy</a>
</footer>

  <script>
    if (!localStorage.getItem('cookieConsent')) {
      document.write(`
        <div id="cookie-banner" style="position: fixed; bottom: 0; left: 0; right: 0; background: #333; color: #fff; padding: 1rem; z-index: 1000; font-size: 0.9rem; line-height: 1.4; text-align: center; box-sizing: border-box;">
          üì¢ We use cookies to improve functionality and analyze traffic.
          By using MetroFeed, you agree to our 
          <a href='privacy.html' style='color: #4dd0e1; text-decoration: underline;'>Privacy Policy</a>.<br>
          <button onclick='localStorage.setItem("cookieConsent", "true"); document.getElementById("cookie-banner").remove();' style='margin-top: 0.5rem; background: #4dd0e1; color: #000; border: none; padding: 0.5rem 1rem; border-radius: 5px; cursor: pointer; font-weight: bold;'>OK</button>
        </div>
      `);
    }
</script>


</body>
</html>