<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Route 98 – Westbound | MetroFeed Portland</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background-color: #0d0d0d;
      color: #cccccc;
    }
    header {
      background-color: #0d0d0d;
      border-bottom: 3px solid #4dd0e1;
      padding: 1rem;
      text-align: center;
    }
    header img {
      max-height: 60px;
    }
    .ad-banner {
      text-align: center;
      margin: 1rem auto;
      background-color: #222;
      color: #888;
      padding: 1rem;
      border: 2px dashed #4dd0e1;
      font-size: 0.9rem;
      border-radius: 8px;
    }
    h1 {
      text-align: center;
      margin: 1rem 0;
      font-size: 2rem;
      color: #f0f0f0;
    }
    .content-box {
      border: 2px solid #4dd0e1;
      border-radius: 12px;
      padding: 1rem;
      margin: 1rem;
      background-color: #1e1e1e;
    }
    #map {
      width: 100%;
      height: 400px;
      border-radius: 8px;
    }
    .button-bar {
      display: flex;
      justify-content: center;
      margin: 1rem 0;
    }
    .button-bar a {
      background: #4dd0e1;
      color: #0d0d0d;
      padding: 0.5rem 1rem;
      text-decoration: none;
      border-radius: 8px;
      font-weight: bold;
    }

.back-button {
  background-color: #4dd0e1;
  color: #0d0d0d;
  border: none;
  padding: 0.6rem 1.2rem;
  font-size: 1rem;
  font-weight: bold;
  border-radius: 8px;
  cursor: pointer;
  box-shadow: 0 0 10px #4dd0e1;
  text-decoration: none;
}
.back-button:hover {
  background-color: #35c0d6;
}
.site-footer {
      text-align: center;
      margin-top: 3rem;
      margin-bottom: 120px;
      font-size: 0.85rem;
      color: #aaa;
    }
    .site-footer a {
      color: #00BFFF;
      text-decoration: none;
    }
    .site-footer a:hover {
      text-decoration: underline;
    }

  </style>
</head>
<body>
  <header>
    <img src="MetroFeedPortlandLogo.png" alt="MetroFeed Portland">
  </header>

  <div class="ad-banner">
    [Ad Banner Placeholder — 300x250]
  </div>

  <div class="disclaimer" style="margin: 1rem auto 0.5rem; max-width: 600px; font-size: 0.8rem; color: #bbb; text-align: center; padding: 0.5rem 1rem; background-color: #111; border: 1px dashed #444; border-radius: 6px;">
    ⚠️ This is a Beta program, work in progress. Please REPORT bugs and pretend to be impressed.
  </div>
  <div class="disclaimer" style="margin: 0 auto 1rem; max-width: 600px; font-size: 0.75rem; color: #888; text-align: center; padding: 0.25rem 1rem;">
    This tool is not affiliated with or endorsed by TriMet. For official schedules and service alerts, visit <a href="https://trimet.org" style="color:#4dd0e1;">trimet.org</a>.
  </div>

  <div style="margin: 2rem 0; text-align: center;">
  <button class="back-button" onclick="history.back()">⬅ Back</button>
  </div>

  <h1>Route 98 – Westbound</h1>

  <div class="content-box">
    <div id="map"></div>
    <div style="text-align:right; font-size: 0.7rem; color: #777; margin-top: 0.5rem;">
      Data courtesy of TriMet.
    </div>
  </div>

  
  <script>
  const apiKey = "2C4447D4A42083BCD84DE3B8E";
  const routeNumber = 98;
  const direction = parseInt(1);

  const map = L.map('map').setView([45.6, -122.7], 12);
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    maxZoom: 19
  }).addTo(map);

  const shapeOutbound = [
  [45.502351, -122.417994],
  [45.502346, -122.417994],
  [45.50234, -122.417994],
  [45.50233, -122.417997],
  [45.502197, -122.418115],
  [45.502012, -122.418114],
  [45.501954, -122.418072],
  [45.501924, -122.418007],
  [45.501918, -122.417954],
  [45.501923, -122.417903],
  [45.501948, -122.41782],
  [45.502009, -122.417778],
  [45.502892, -122.417805],
  [45.503055, -122.41781],
  [45.503052, -122.418016],
  [45.503045, -122.418492],
  [45.503038, -122.418962],
  [45.503034, -122.419209],
  [45.503023, -122.419908],
  [45.503017, -122.421107],
  [45.50299, -122.423046],
  [45.502981, -122.42367],
  [45.502973, -122.424301],
  [45.50297, -122.424479],
  [45.502948, -122.426062],
  [45.502938, -122.426245],
  [45.502933, -122.426334],
  [45.50293, -122.426627],
  [45.502923, -122.427269],
  [45.502922, -122.427323],
  [45.502919, -122.427622],
  [45.502919, -122.427821],
  [45.502948, -122.427975],
  [45.50297, -122.428087],
  [45.503008, -122.428251],
  [45.503056, -122.42843],
  [45.503201, -122.428927],
  [45.503418, -122.429668],
  [45.503776, -122.430915],
  [45.503792, -122.430991],
  [45.503858, -122.430991],
  [45.504327, -122.43099],
  [45.504407, -122.430991],
  [45.504513, -122.430993],
  [45.504513, -122.431138],
  [45.504514, -122.432219],
  [45.504514, -122.432359],
  [45.504517, -122.432908],
  [45.504517, -122.432951],
  [45.504517, -122.433016],
  [45.504513, -122.433595],
  [45.504512, -122.433902],
  [45.504513, -122.433998],
  [45.504522, -122.435396],
  [45.504523, -122.435508],
  [45.504526, -122.435663],
  [45.504528, -122.435828],
  [45.50453, -122.436564],
  [45.504532, -122.436959],
  [45.504532, -122.438172],
  [45.504538, -122.439357],
  [45.504537, -122.439434],
  [45.504539, -122.440917],
  [45.50454, -122.441099],
  [45.504612, -122.441099],
  [45.505217, -122.441096],
  [45.505876, -122.44109],
  [45.506673, -122.441087],
  [45.50764, -122.441082],
  [45.507722, -122.441075],
  [45.507825, -122.441057],
  [45.507887, -122.441037],
  [45.507928, -122.441025],
  [45.507984, -122.441009],
  [45.508149, -122.440959],
  [45.508229, -122.440926],
  [45.508334, -122.440867],
  [45.50848, -122.440786],
  [45.50914, -122.440412],
  [45.509806, -122.440043],
  [45.510325, -122.43975],
  [45.511023, -122.439356],
  [45.511133, -122.439294],
  [45.51136, -122.440121],
  [45.511572, -122.440863],
  [45.511642, -122.440935],
  [45.511791, -122.441483],
  [45.511783, -122.44164],
  [45.511919, -122.442123],
  [45.512319, -122.443569],
  [45.512639, -122.444769],
  [45.512667, -122.444882],
  [45.512849, -122.445624],
  [45.513239, -122.447322],
  [45.513599, -122.448929],
  [45.513978, -122.450604],
  [45.514033, -122.450852],
  [45.514261, -122.451869],
  [45.514496, -122.452918],
  [45.51461, -122.453422],
  [45.51495, -122.454984],
  [45.514981, -122.455118],
  [45.515392, -122.456931],
  [45.515739, -122.458443],
  [45.515812, -122.458568],
  [45.515883, -122.458855],
  [45.515995, -122.459274],
  [45.516086, -122.459595],
  [45.516248, -122.460136],
  [45.516294, -122.460287],
  [45.516343, -122.460433],
  [45.516366, -122.460503],
  [45.51646, -122.460789],
  [45.516554, -122.461062],
  [45.516666, -122.461376],
  [45.51674, -122.461569],
  [45.516764, -122.461633],
  [45.516875, -122.461919],
  [45.516993, -122.462206],
  [45.517148, -122.462571],
  [45.517277, -122.462872],
  [45.517549, -122.463516],
  [45.518051, -122.464703],
  [45.518233, -122.465132],
  [45.518521, -122.465773],
  [45.518647, -122.466072],
  [45.51882, -122.466474],
  [45.518976, -122.466848],
  [45.519104, -122.467141],
  [45.51918, -122.467314],
  [45.519463, -122.467954],
  [45.519666, -122.468427],
  [45.519882, -122.468942],
  [45.520031, -122.469341],
  [45.520331, -122.470049],
  [45.520404, -122.4702],
  [45.52047, -122.470336],
  [45.520649, -122.470757],
  [45.520698, -122.47087],
  [45.520837, -122.471207],
  [45.521059, -122.471775],
  [45.52118, -122.472091],
  [45.521272, -122.472344],
  [45.521333, -122.472517],
  [45.521417, -122.472781],
  [45.521474, -122.47297],
  [45.52154, -122.473211],
  [45.521587, -122.473375],
  [45.521658, -122.473653],
  [45.521726, -122.473952],
  [45.521764, -122.474121],
  [45.521796, -122.474282],
  [45.521847, -122.474554],
  [45.5219, -122.474874],
  [45.521938, -122.475131],
  [45.521969, -122.475376],
  [45.522026, -122.475789],
  [45.522052, -122.476034],
  [45.522068, -122.476243],
  [45.522079, -122.476424],
  [45.52209, -122.476645],
  [45.5221, -122.477125],
  [45.522104, -122.477352],
  [45.522108, -122.477573],
  [45.522111, -122.477748],
  [45.52211, -122.478742],
  [45.522096, -122.479928],
  [45.522097, -122.480406],
  [45.5221, -122.480794],
  [45.522103, -122.480916],
  [45.522108, -122.481021],
  [45.522115, -122.481266],
  [45.522123, -122.481551],
  [45.522129, -122.482118],
  [45.522131, -122.48236],
  [45.522142, -122.48348],
  [45.522143, -122.483641],
  [45.522146, -122.483761],
  [45.522148, -122.483835],
  [45.522166, -122.48438],
  [45.522169, -122.484556],
  [45.522175, -122.485448],
  [45.522179, -122.485924],
  [45.522183, -122.48615],
  [45.522187, -122.486382],
  [45.522189, -122.486682],
  [45.522194, -122.487488],
  [45.522183, -122.48829],
  [45.522189, -122.489236],
  [45.522203, -122.490668],
  [45.522204, -122.491163],
  [45.5222, -122.491449],
  [45.522196, -122.491785],
  [45.522196, -122.492038],
  [45.5222, -122.492295],
  [45.522205, -122.49253],
  [45.522217, -122.492881],
  [45.522224, -122.493284],
  [45.522226, -122.493387],
  [45.522231, -122.49399],
  [45.522251, -122.494705],
  [45.522255, -122.495528],
  [45.522264, -122.496237],
  [45.522268, -122.496468],
  [45.522272, -122.496684],
  [45.522273, -122.496953],
  [45.522276, -122.497354],
  [45.522275, -122.497893],
  [45.52227, -122.498237],
  [45.522266, -122.498618],
  [45.522267, -122.498805],
  [45.522269, -122.499019],
  [45.522275, -122.499632],
  [45.522278, -122.499996],
  [45.522284, -122.500555],
  [45.522295, -122.501577],
  [45.522295, -122.501681],
  [45.522291, -122.502078],
  [45.522282, -122.502511],
  [45.522282, -122.502788],
  [45.52229, -122.503314],
  [45.522291, -122.503625],
  [45.522297, -122.503842],
  [45.522308, -122.504144],
  [45.52232, -122.504631],
  [45.52232, -122.504729],
  [45.522319, -122.504994],
  [45.522312, -122.505474],
  [45.522309, -122.505678],
  [45.522323, -122.507134],
  [45.522325, -122.507387],
  [45.522337, -122.507746],
  [45.522346, -122.508087],
  [45.52237, -122.508946],
  [45.522376, -122.509711],
  [45.522386, -122.510659],
  [45.522387, -122.510883],
  [45.522391, -122.511247],
  [45.522394, -122.511491],
  [45.522395, -122.512136],
  [45.522389, -122.51278],
  [45.52239, -122.513239],
  [45.522412, -122.515816],
  [45.522423, -122.517106],
  [45.522433, -122.51838],
  [45.522434, -122.518489],
  [45.522454, -122.519367],
  [45.522457, -122.519667],
  [45.522459, -122.519952],
  [45.522462, -122.520372],
  [45.522465, -122.520745],
  [45.522467, -122.520959],
  [45.52247, -122.521199],
  [45.522476, -122.521918],
  [45.522477, -122.522383],
  [45.522473, -122.522971],
  [45.522465, -122.523529],
  [45.522464, -122.523635],
  [45.522461, -122.524089],
  [45.52247, -122.525377],
  [45.522478, -122.525791],
  [45.522486, -122.526107],
  [45.5225, -122.526613],
  [45.522502, -122.52694],
  [45.522501, -122.52741],
  [45.522501, -122.527747],
  [45.522497, -122.527925],
  [45.522494, -122.528092],
  [45.522499, -122.529102],
  [45.522512, -122.530816],
  [45.522512, -122.530859],
  [45.522534, -122.531709],
  [45.522535, -122.531807],
  [45.522534, -122.532151],
  [45.522527, -122.532561],
  [45.52253, -122.533905],
  [45.522536, -122.534494],
  [45.522541, -122.534728],
  [45.522553, -122.535246],
  [45.522585, -122.53592],
  [45.522589, -122.536235],
  [45.522583, -122.536502],
  [45.522578, -122.536745],
  [45.522583, -122.537546],
  [45.522588, -122.537773],
  [45.522592, -122.538008],
  [45.522596, -122.538477],
  [45.522598, -122.538706],
  [45.522598, -122.539194],
  [45.522587, -122.539904],
  [45.522594, -122.540835],
  [45.5226, -122.54116],
  [45.522613, -122.541574],
  [45.522616, -122.541787],
  [45.522615, -122.542372],
  [45.522617, -122.542923],
  [45.522617, -122.543093],
  [45.52263, -122.544916],
  [45.522639, -122.545356],
  [45.522643, -122.545532],
  [45.522641, -122.545836],
  [45.522644, -122.546228],
  [45.522646, -122.54677],
  [45.522646, -122.546949],
  [45.522634, -122.547459],
  [45.522627, -122.548],
  [45.52264, -122.549686],
  [45.522662, -122.55063],
  [45.522682, -122.551172],
  [45.522685, -122.551909],
  [45.522685, -122.552169],
  [45.522686, -122.552352],
  [45.522685, -122.552614],
  [45.522671, -122.553204],
  [45.522666, -122.553833],
  [45.522672, -122.554539],
  [45.522676, -122.554987],
  [45.52269, -122.55557],
  [45.52271, -122.556272],
  [45.522721, -122.556764],
  [45.522723, -122.557041],
  [45.522723, -122.557106],
  [45.522721, -122.557423],
  [45.522725, -122.558071],
  [45.52273, -122.558291],
  [45.522736, -122.558516],
  [45.522739, -122.55919],
  [45.522738, -122.55929],
  [45.522733, -122.559828],
  [45.522738, -122.560909],
  [45.522744, -122.561625],
  [45.52275, -122.562272],
  [45.522794, -122.56228],
  [45.523145, -122.562264],
  [45.524011, -122.562235],
  [45.524688, -122.562217],
  [45.525281, -122.562197],
  [45.525319, -122.562195],
  [45.525402, -122.562193],
  [45.525503, -122.56218],
  [45.525566, -122.562165],
  [45.525662, -122.562127],
  [45.525717, -122.562097],
  [45.5258, -122.56204],
  [45.525855, -122.562013],
  [45.525914, -122.561994],
  [45.526032, -122.561984],
  [45.526166, -122.561978],
  [45.526284, -122.561981],
  [45.52641, -122.561985],
  [45.527497, -122.561961],
  [45.52772, -122.561958],
  [45.528199, -122.561952],
  [45.528369, -122.56195],
  [45.528501, -122.561948],
  [45.528923, -122.561944],
  [45.529477, -122.561942],
  [45.52947, -122.562054],
  [45.529468, -122.562594],
  [45.529466, -122.563],
  [45.529533, -122.563066],
  [45.529537, -122.563312],
  [45.529537, -122.563337],
  [45.529538, -122.563394],
  [45.529547, -122.563465],
  [45.529549, -122.563479],
  [45.529567, -122.563548],
  [45.529588, -122.563598],
  [45.529653, -122.563654],
  [45.529748, -122.56368],
  [45.529938, -122.563661],
  [45.530105, -122.56369],
  [45.530678, -122.563903],
  [45.530875, -122.563964]
];

const stopNames = {
  "8193": "Gateway Transit Center",
  "8196": "Gateway Transit Center",
  "10877": "E Burnside &amp; NE 102nd",
  "13638": "Gresham Central Transit Center",
  "14022": "E Burnside &amp; NE 148th",
  "14023": "E Burnside &amp; NE 122nd",
  "14079": "E Burnside &amp; SE 197th MAX Stn (at Kaiser)",
  "14151": "E Burnside &amp; 187th/188th",
  "14152": "E Burnside &amp; NE 181st",
  "14153": "E Burnside &amp; NE 172nd",
  "14154": "E Burnside &amp; NE 162nd",
  "14232": "Cleveland Ave Park &amp; Ride",
  "14234": "NW Division &amp; Ava Ln",
  "14545": "NW Civic Dr &amp; 15th"
};

const stops = [
  { stop_id: "14232", name: "Cleveland Ave Park &amp; Ride", lat: 45.503106, lon: -122.418964, times: ["3:17 AM"] },
  { stop_id: "13638", name: "Gresham Central Transit Center", lat: 45.502993, lon: -122.427271, times: ["3:20 AM"] },
  { stop_id: "14234", name: "NW Division &amp; Ava Ln", lat: 45.504597, lon: -122.436563, times: ["3:22 AM"] },
  { stop_id: "14545", name: "NW Civic Dr &amp; 15th", lat: 45.508285, lon: -122.440793, times: ["3:24 AM"] },
  { stop_id: "14079", name: "E Burnside &amp; SE 197th MAX Stn (at Kaiser)", lat: 45.516776, lon: -122.461523, times: ["3:31 AM"] },
  { stop_id: "14151", name: "E Burnside &amp; 187th/188th", lat: 45.520676, lon: -122.470697, times: ["3:32 AM"] },
  { stop_id: "14152", name: "E Burnside &amp; NE 181st", lat: 45.522143, lon: -122.477567, times: ["3:33 AM"] },
  { stop_id: "14153", name: "E Burnside &amp; NE 172nd", lat: 45.52222, lon: -122.486692, times: ["3:01 AM"] },
  { stop_id: "14154", name: "E Burnside &amp; NE 162nd", lat: 45.522307, lon: -122.497091, times: ["3:02 AM"] },
  { stop_id: "14022", name: "E Burnside &amp; NE 148th", lat: 45.522425, lon: -122.51117, times: ["3:03 AM"] },
  { stop_id: "14023", name: "E Burnside &amp; NE 122nd", lat: 45.522629, lon: -122.538549, times: ["3:07 AM"] },
  { stop_id: "10877", name: "E Burnside &amp; NE 102nd", lat: 45.522766, lon: -122.55929, times: ["3:12 AM"] },
  { stop_id: "8196", name: "Gateway Transit Center", lat: 45.530884, lon: -122.563895, times: ["3:16 AM"] },
  { stop_id: "8193", name: "Gateway Transit Center", lat: 45.530408, lon: -122.563715, times: ["10:00 AM"] },
]

  const polylineOut = L.polyline(shapeOutbound, {
    color: 'blue',
    weight: 4,
    opacity: 0.7
  }).addTo(map);

  map.fitBounds(polylineOut.getBounds());

  stops.forEach(stop => {
    const marker = L.circleMarker([stop.lat, stop.lon], {
      radius: 6,
      color: '#4dd0e1',
      fillColor: '#4dd0e1',
      fillOpacity: 0.9,
      weight: 1
    });

    const popupContent = `
      <strong>${stop.name}</strong><br>
      ${stop.times && stop.times.length ? stop.times.join("<br>") : "No scheduled times"}
    `;

    marker.bindPopup(popupContent);
    marker.addTo(map);
  });

  let busMarkers = {};

  async function fetchAndDisplay() {
    const res = await fetch(`https://developer.trimet.org/ws/v2/vehicles?route=${routeNumber}&appID=${apiKey}&json=true`);
    const data = await res.json();
    const buses = (data.resultSet.vehicle || []).filter(v =>
      v.routeNumber == routeNumber && v.direction == direction
    );

    Object.values(busMarkers).forEach(m => map.removeLayer(m));
    busMarkers = {};

    if (buses.length === 0) return;

    buses.forEach(bus => {
      if (!bus.latitude || !bus.longitude || !bus.blockID) return;

      const icon = L.divIcon({
        className: '',
        html: `
          <div style="text-align:center;">
            <div style="background:#0071CE;color:#fff;padding:2px 6px;border-radius:6px;font-weight:bold;">${bus.vehicleID}</div>
            <div style="width:0;height:0;border-left:5px solid transparent;border-right:5px solid transparent;border-top:10px solid #00bfff;margin:auto;"></div>
          </div>
        `,
        iconSize: [40, 30],
        iconAnchor: [20, 30]
      });

      const marker = L.marker([bus.latitude, bus.longitude], { icon }).addTo(map);
      busMarkers[bus.vehicleID] = marker;
    });
  }

  fetchAndDisplay();
  setInterval(fetchAndDisplay, 15000);
  </script>

<footer class="site-footer">
  <a href="terms.html">Terms of Use</a> &nbsp;|&nbsp;
  <a href="contact.html">Contact Us</a> &nbsp;|&nbsp;
  <a href="report.html">Report a Problem</a> &nbsp;|&nbsp;
  <a href="privacy.html">Privacy Policy</a>
</footer>

<div id="cookie-banner" style="display: none; position: fixed; bottom: 0; width: 100%; background: #333; color: #fff; text-align: center; padding: 1rem; z-index: 1000; font-size: 0.9rem;">
  📢 We use cookies for personalized ads and analytics. By using MetroFeed, you agree to our 
  <a href="privacy.html" style="color: #4dd0e1; text-decoration: underline;">Privacy Policy</a>.
  <button onclick="acceptCookies()" style="margin-left: 1rem; background: #4dd0e1; color: #000; border: none; padding: 0.5rem 1rem; border-radius: 5px; cursor: pointer;">OK</button>
</div>

<script>
  function acceptCookies() {
    localStorage.setItem('cookieConsent', 'true');
    document.getElementById('cookie-banner').style.display = 'none';
  }

  window.onload = function() {
    if (!localStorage.getItem('cookieConsent')) {
      document.getElementById('cookie-banner').style.display = 'block';
    }
  }
</script>


</body>
</html>