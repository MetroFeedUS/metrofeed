<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Portland Alerts - MetroFeed</title>
  <link rel="icon" href="favicon.ico" type="image/x-icon">
  <link rel="apple-touch-icon" href="metrofeedsimplelogo.png">
  <link rel="icon" type="image/png" sizes="512x512" href="metrofeedsimplelogo.png">
  <style>
    html, body {
      margin: 0; padding: 0;
      font-family: 'Segoe UI', sans-serif;
      background: #0d0d0d;
      color: #cccccc;
      min-height: 100vh;
    }
    header {
      background: #0d0d0d;
      border-top: 4px solid #4dd0e1;
      border-bottom: 4px solid #4dd0e1;
      text-align: center;
      padding: 1rem 0 1rem 0;
      position: relative;
    }
    header img {
      max-width: 200px;
      height: auto;
    }
    .back-button {
      position: absolute;
      top: 16px;
      left: 20px;
      width: 45px;
      height: 45px;
      background: #4dd0e1;
      border: 2px solid #000;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1001;
      box-shadow: 0 0 10px #4dd0e1;
      cursor: pointer;
      transition: background 0.2s;
      outline: none;
    }
    .back-button:active, .back-button:focus {
      background: #1976d2;
    }
    .back-button svg {
      width: 24px;
      height: 24px;
      fill: #000;
      display: block;
    }
    .main-content {
      max-width: 540px;
      margin: 2rem auto 2rem auto;
      padding: 0 1rem;
    }
    h2 {
      color: #4dd0e1;
      text-align: center;
      margin-bottom: 1.2rem;
      font-size: 1.8rem;
      letter-spacing: 0.01em;
      text-shadow: 0 1px 0 #222, 0 0 8px #4dd0e1bb;
    }
    .alerts-feed {
      background: #181818;
      border: 2px dashed #4dd0e1;
      border-radius: 14px;
      padding: 1.6rem 1.1rem 1.2rem 1.1rem;
      margin-bottom: 2rem;
      min-height: 120px;
      text-align: center;
      color: #fff;
      font-size: 1.08rem;
      letter-spacing: 0.01em;
      box-shadow: 0 0 12px #222, 0 0 8px #4dd0e1aa;
    }
    .alert-card {
      background: #23272a;
      border-left: 5px solid #F7630C;
      border-radius: 10px;
      margin: 1.3rem 0;
      padding: 1.1rem 1rem 0.85rem 1.1rem;
      box-shadow: 0 0 10px #4dd0e155;
      text-align: left;
      color: #fff;
      position: relative;
      transition: box-shadow .18s;
    }
    .alert-card:hover {
      box-shadow: 0 0 16px #4dd0e1, 0 0 8px #F7630C88;
    }
    .alert-title {
      color: #4dd0e1;
      font-size: 1.15rem;
      font-weight: bold;
      letter-spacing: 0.02em;
      margin-bottom: 0.3rem;
      text-shadow: 0 1px 0 #222, 0 0 6px #4dd0e1bb;
    }
    .alert-time {
      color: #ffa500;
      font-size: 0.97rem;
      font-style: italic;
      margin-bottom: 0.35rem;
      display: block;
    }
    .alert-desc {
      color: #f8f8f8;
      font-size: 1.04rem;
      margin-bottom: 0.8rem;
      margin-top: 0.2rem;
    }
    .alert-link {
      color: #4dd0e1;
      text-decoration: underline;
      font-size: 1.02rem;
      font-weight: bold;
    }
    .site-footer {
      text-align: center;
      margin-top: 3rem;
      margin-bottom: 120px;
      font-size: 0.8rem;
      color: #888;
    }
    .site-footer a {
      color: #4dd0e1;
      text-decoration: none;
      margin: 0 6px;
    }
    .site-footer a:hover { text-decoration: underline; }
    @media (max-width: 600px) {
      .main-content { padding: 0 0.3rem; }
      .alerts-feed { padding: 1rem 0.2rem; }
      h2 { font-size: 1.35rem; }
      .alert-card { padding: 0.9rem 0.7rem 0.7rem 0.85rem; }
    }
  </style>
</head>
<body>

  <header>
    <img src="MetroFeedPortlandLogo.png" alt="MetroFeed Logo" />
    <!-- BACK BUTTON -->
    <button class="back-button" onclick="history.back()" aria-label="Go back">
      <svg viewBox="0 0 24 24">
        <path d="M15.5 19c-.28 0-.53-.11-.71-.29l-6.5-6.5a1.003 1.003 0 010-1.42l6.5-6.5a1.003 1.003 0 011.42 1.42L10.41 12l6.3 6.29a1.003 1.003 0 01-1.21 1.54z"/>
      </svg>
    </button>
  </header>

  <div class="main-content">
    <h2>Portland Area Alerts</h2>
    <div class="alerts-feed" id="alerts-feed">
      <span>Loading TriMet alerts…</span>
    </div>
  </div>

  <footer class="site-footer">
    <a href="terms.html">Terms of Use</a> &nbsp;|&nbsp;
    <a href="contact.html">Contact Us</a> &nbsp;|&nbsp;
    <a href="report.html">Report a Problem</a> &nbsp;|&nbsp;
    <a href="dmca.html">DMCA</a> &nbsp;|&nbsp;
    <a href="privacy.html">Privacy Policy</a>
  </footer>

  <script>
const apiKey = "2C4447D4A42083BCD84DE3B8E";
const apiUrl = `https://developer.trimet.org/ws/V1/FeedSpecAlerts/alerts.json?appID=${apiKey}`;

const alertsFeed = document.getElementById('alerts-feed');
alertsFeed.innerHTML = "<span>Loading TriMet alerts…</span>";

fetch(apiUrl)
  .then(response => response.json())
  .then(data => {
    if (data.alerts && data.alerts.length > 0) {
      alertsFeed.innerHTML = "";
      data.alerts.slice(0, 10).forEach(alert => {
        let issued = alert.published ? new Date(alert.published).toLocaleString() : '';
        let desc = alert.description || '';
        let header = alert.header || 'TriMet Alert';
        let link = alert.infoURL || "https://trimet.org/alerts/";

        const alertCard = document.createElement('div');
        alertCard.className = 'alert-card';
        alertCard.innerHTML = `
          <div class="alert-title">${header}</div>
          <span class="alert-time">${issued}</span>
          <div class="alert-desc">${desc.slice(0,180)}${desc.length>180?'…':''}</div>
          <a class="alert-link" href="${link}" target="_blank">Full Alert →</a>
        `;
        alertsFeed.appendChild(alertCard);
      });
    } else {
      alertsFeed.innerHTML = "<span>No active TriMet alerts.</span>";
    }
  })
  .catch(() => {
    alertsFeed.innerHTML = "<span style='color:#ffa500;'>Could not load TriMet alerts. Try again later.</span>";
  });
</script>

</body>
</html>
